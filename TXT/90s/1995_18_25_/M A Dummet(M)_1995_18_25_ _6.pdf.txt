ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARIANZA
Universidíid Nacional de Colombia
ABSTRACT. Se muestra como el análisis de desvío de los modelos lineales generalizados es una alternativa al análisis de varianza.

Introducción


   Una de las metodologías estadísticas más utilizadas en Cienciais Agropecuarias es

sin duda el análisis de varianza. Este tipo de estudio descompone la suma de cuaulra-

dos total en la suma de cuadrados de los efectos que inciden en la variable respuesta.

Esto permite, en caso de tenerse un modelo balanceaido con efectos fijos, la posibilidad

de responder de manera práctica a cuestiones tales como si un tratamiento es mejor

o no que otro, (por medio de comparaciones planeadas de efectos de tratanúentos) u

otras semeJEintes por medio de otras pruebas.

Debido al éxito alcanzado por los modelos estadísticos basados en el análisis de var-

ianza, en la práctica se suele asumir como verdawieros los supuestos de éste. Uno de

ellos, es la distribución normal de los errores; suposición de hecho muy fuerte pero in-

tuitivamente raizonable y que lo único que aporta a la metodología es la formau:ión de

    Key words and phrases. Análisis de varianza, Desvío, modelos lineales generalizados, GLIM.

                                                47

48                              iMIGUEL A. DUMETT

intervalos de confianza para los parámetros involucrados en el modelo y la posibilidad

de docimar hipótesis acerca de estos.


Sin embargo, estas herramientas de estimación son esenciades en la práctica y por ello

no puede omitirse una suposición distribucional para los errores. Pero, lo que si puede

hacerse es cambiar la distribución por otra y tratar de construir un análogo al análisis

de varianza. Surge entonces el problema de cual debe ser esa distribución alternativa.


Una de las motivaciones de realizar este trabajo es mostrar como los modelos lineales

generalizados son una adternativa válida para proponer modelos estadísticos a difer-

entes situaciones. En ellos, existen varios aspectos relevantes, uno de los cuales es la

versatilidad para la elección de la distribución del error y otro el anáfisis de desvío

(que consiste en descomponer la función desvío del modelo en la suma de desvíos que

inciden en la variable respuesta). Este análisis es una herramnienta muy poderosa pero

suele ser desconocida en nuestro medio. Pretendemos efectuar una aproximación a

este análisis a partir del análisis de varianza con efectos fijos balanceados aplicado a

un caso particular.


Siguiendo los lineamientos usuales en los modelos lineales generadizados descritos por

Jorgensen (1992), se utilizairá la familia de distribuciones denonünawla modelos de

dispersión exponencial y que incluye a la farrúUa exponencial natural como una sub-

familia.


A continuación indicamos el orden que se seguirá en este trabajo. Primero se pre-

senta como trabaja el análisis de variamza pa^a un modelo de de efectos fijos cruzados

balanceados con 4 factores; luego, se introduce la farrúha de modelos de dispersión,

entre cuyos miembros se encuentra la distribución normal (esencial en el análisis de

     ANÁLISIS DEL DESVIO : UNA ALTERNATIVA AL ANÁLISIS DE VARL\NZA                         49

varianza) y se indica que el sentido de la generaUzación será permitir otrais distribu-

ciones diferentes a la normal con media cero y varianza constante para los errores, A

continuación, se introduce la función desvío, la cual en el caso de suponer una dis-

tribución normal coincidirá con la suma de cuadrados clásica. Finalmente, se indica

en que consiste el análisis del desvio; como la metodología correspondiente es análoga

con la que se realiza en el análisis de varianza y se ilustra esto con dos ejemplos,


                1. Modelo d e Efectos Fijos Cruzados Balanceados


  Para ser más explícitos supongamos un diseño de 4 factores. Como lo muestran

Johnson y Leone (1964), el modelo estadístico correspondiente Se escribe como


      yiijki =A-i-Bt-i-Ci + Dj-\-Ek-b iBC)ti + {BD)tj                                    (1,1)

                + iBE)tk + {CD)ij + {CE)ik + {DE)jk + {BCD)tij + {BCE)tik

                -t- {BDE),jk + {CDE)ijk + {BCDE)tijk + ft.vti



      í = l,- -,6;      i = l,--,c;    j = l,--,d-,      k = l,--,e;       1=1,--   ,n


junto a

                  X;Bt = 0; ^ C . = 0 ;         Y.^j=Q;       X^í^* = 0;                 (1.2)




          ^ ( B C ) « = 0; ^ ( S C ) n = 0; Yl^BD)tj = Q; ^ ( S 7 ) ) „ = 0;
           t                  i                  t                 j

          Y,{BE)tk = Q; ^ ( B f ; ) t t = 0 ;   5](CD).,-= 0; ^(CD).-^ = 0;
           t                  k                      i                 j

          Y,{CE)ik = Q; J^(C£:)a=0;             ^^(DE)^, = 0; ^ ( D E ) , , = 0;

50                                     MIGUEL A. DUMETT




              J2{BCD)tij = 0-, Yl{BCD)tij = 0; ^(flCD),^ = 0;
                   <                       i                          i

              Y^iBCE)tik = 0; J2^BCE)tik = 0; ^{BCE)t,k = 0;
                   t                       í                          k

              Y,iBDE)t,k = 0, X^(BDf;).;t = 0; Yl^^^^h" = ^'
               t                          i                           k

              Y,{CDE)ijk = ();           Y . ^ C D E \ j k = Q;      ^ ( C D E ) ^ ^ , = 0;
               i                           J                          k

                       Y^{BCDE)t,jk = 0;                Yí{BCDE)ti,k = 0;
                        t                                   i

                       5 ^ ( 5 C D £ : ) , o i = 0;      J2iBCDE)tijk = O
                        ;•                                  t

Se debe entender que cada una de las sumas amteriores debe ser igual a cero para

cualesquiera de los valores que lomen los subíndices que aparecen sobre los cuales

no se efectúa dicha suma. Además, aunque esta forma de imponer restricciones no

estimables sobre los efectos de los tratamientos no es la usual, las estándares se siguen

de éstas. Por ejemplo, usualmente se escribe


                             J2{BC)ti = J^iBQti = J2(^C)ti = O
                              t                 I               tl



lo cual es redundamte, ya que de los dos primeros sumandos se sigue el tercero pues


                                  ^(BC),. = $^($](5C),,)=0.
                                  tt                t   i



     También se consideran los siguientes supuestos


                                               Eiitijki) = O                                  (1.3a)


                                              Var{etijki) = cr'                               (1.3b)

                                               Cov{í) = (r'^l                                 (1.3c)

     ANÁLISIS DEL DESVIO ; UNA ALTERNATIVA AL ANÁLISIS DE VARIANZA                51

                                     etijk, ~ N{0,(T^)                       (1.3d)




  En estos modelos pueden construirse tablas de anáUsis de variamza para probar las

hipótesis más usuales entre las cuades están las siguientes


                                77, : S i = ••• = fl6 = 0                     (1.4)




                                 Uo • Cl = • • • = Ce = O

                                H o : D i = - = D j = 0

                                H o : E i = - = E e = 0


                           Ho : { B C ) n = • • = ( B C ) t c = O

                           7f. : ( B D ) u = • • • = (51>)td = O

                           Ho : { B E ) n = ••- = { B E ) u = O

                           Ho : ( C D ) n =        • • = {CD)cé = O

                           Ho • i C E ) i i = • • • = {CE)ce = O

                           Ho : i D E ) i i = ••• = ( D E ) i , = O

                        H o : i B C D ) i i i = - - = {BCD)bcd = 0

                        Ho : i B C E ) i i i = •     = (BCE)bce = O

                        Ho:{BDE)iii = - - = ( B D E ) i i , = 0

                        Ho : { C D E ) i n =       • • = {CDE),je = O

                     Ho : { B C D E ) n n = -•• = {BCDE)icde = O



   Según Johnson y Leone (1964), la tabla de análisis de varianza es como sigue

52                                               MIGUEL A. DUMETT

                                   TABLA 1. ANÁLISIS DE VARIANZA




 Fuente                        Suma de Cuadrados                             Cuadrados Medios Esperados

                                                                                     _2   I cden ^         D2
     B                            í—< caen        bcden
                                   1                                                                 f



     C                                bden        bcden                              <T^ +    ^ E C ?
                                                                                                     i

     D                            í-^ been        be
                                                  bcden                              <^^ + TIT E ^ j
                                                                                                   ;•




                                                    -i
                                  Í - ' bcdn      bcden                              „2^b^Y,El

     BC       . ¿ ^ den           l~^ t d e n            bden   "^ bcden        a' + ^rrf^rTT E(5C)?.

     BD       c-j       cen       l—i cden        Í—- been          bcden
                                                                               ^' + íFTfcTE(5D)?;

     BE                           y^ Lt-^ _ v^ V ..t. . y
                  tk    cdn       A^ cden         i - ' ftcdn
                                                        i»'<"    "^ bcden
                                                                "^
                                                                               <^^ + f í r f ^ E ( 5 £ ) ? *

     CD           i-é   ben       i—I bden        ¿-t been      '^ icdi        -^ + (írf^PITE(CD)^-
                                                                                                         •i

     CE                 6en       ¿7^ bden        i—i bcdn          bcden



     DE       i-~t      ben       /—' 6cen        l-^ bcdn      '   bcden      -^ + fdrfc7E(i^í:),^.
              ]k                   ]               k


     BCD     • y y..,., y - y,i..           _ y ^ V i ^ _ Y^ y..i,. I
             í-^   -    íLí den               ¿-Í cen     ¿-.i ben ~         ^' + (t-l)(c'-V-l)E(^C¿^)?i;
             ti;         fl                    t;          I;


                  V^VL                            ..j.. _
                                L v ^ y l ^ + T yicen               y;*...
                                                                    icden
                  ^ - ' cden      ^ ^ 6den          ^


     BCE   Y" üii^ _ v^ yL                      v- yLt. _ v^ v i i . .
           i-"         dn      ¿-J
                                                                               + (i-l)(c-"l)(e-l) E ( 5 C ' ^ ) í . i
           ttib                 ti den          ^tk can         4iH- *án '                                ti'ib

                                       „3
                  ¿ j caen      ' ¿ - Í iden    ' L-. been          bcden
                   t               i               k

     ANÁLISIS DEL DESVIO : UNA ALTERNATIVA AL ANÁLISIS DE VARIANZA                                             53

                                         (... continuación de la Tabla 1)




 Fuente                     Suma de Cuadrados                                       Cuadrados Medios Esperados

  BDE      E
           \jk
               cn
                  y«i*-   _ y ^ y i j . .
                             ^
                              tj
                                     cen
                                             _5^yi..*.
                                                 ^
                                                 tk
                                                      can
                                                              _ ^ » • • » •
                                                                 ^
                                                                 jk
                                                                        ben "^
                                                                              i                 íT^-h




                 í-^ caen "^ i—^ besn "^ ^             been           bcden          (i-l)( "!)(._!) E(S¿>n%

  CDE      ¿j      in         ¿-' "Sen           ¿^   iañ        ¿-' icn      '                 <T2+
           ij*                »j                 li               jk



                 Elíá^ + El¿¿^ + Eicen^ - icden                                      (c-iw-ix«-i) E(c^^).ji

 BCDE      ¿—í       n         ^-í      en             ' ^-^     -'•«
                                                                 ien     '                      ff='+
           tijt                 «Ú


                               ^—' caen               ' icden                     (l-iXc-i)"á-i)(.-i5 E(5Cr^í^)tijt
                                t

Residual                                Diferencia


  Total                                 ytijkl        icden
                                tl;t/




donde los grados de libertad de cada factor aparecen en el denominador del coeficiente

que multiplica al segundo sumando del esperado de los cuadrados medios.


  También es posible estimar cada uno de los términos del modelo (1.1). Como lo

54                                      MIGUEL A. DUMETT


muestra Graybill (1961), los estimadores vienen dados por


                                                Á= y       ;


                                           Bt = yt.... - y      ;

                                           Ci =y.i.. - y        ;


                                           Dj - y . j - y       ;


                                          Ek = y . . k . - y     ;

                               {BC)ti = yti       - V t . . - y.i. + y

                               i B D ) t j = yt.j.. - yt.. - y . j . . + y


                               {BE)tk = yt.ib - yt... - y . k . + y

                               {CD)ij = y.ij - y i... - y . j . -\- y


                               {CE)ik = y.i.k. - y.i. - y . k . + y

                              {DE)jk = y..jk. - y . j . . - y...k. + y

            {BCD)tij = ytij.. - yu... - y t j . - y.ij.. + s/t... + y.i... + y . j . . - y...

           {BCE)tik = yti.k. - yti... - yt.k. - y.t.it. + yt... + y.i.. + y...k. - y..

           {BDE)tjk = yt.jk. - y t j . . - yt.k. - y.jk. + yt.... + y . j . . + y . k . - y..

           { C b E ) i j k = y.ijk. - y.ij. - i i k . - y .Jk + y.i.. + y . j + y . k . - y .




     (BCDE)tijk = ytijk. - ytij.. - yti.k. - yt.jk. - y.ijk. + yu... + ytj.. + yt.k. + y.ij..


                       + y.i.k. + y . j k . - yt... - Q i . - y . j . . - y. .*. + y


atóícomo los cuadrados medios esperados peu'a ff^. Paira poder realizar la prueba de

las hipótesis (1.4) es fundamental el supuesto de normalidad (1.3 d).

     ANÁLISIS DEL DESVIO : UNA ALTERNATIVA AL ANÁLISIS DE VARIANZA                   55

             2. Modelo con Efectos F^jos Cruzados Balanceados

                         sin la Hipótesis de N o r m a l i d a d


  Nuevamente consideraremos un modelo de 4 factores. Debido a que la normalidad

de ítijki implica la normalidad de yujki, (11) y (1-3) son equivalientes a


     Ptijki = A-\-Bt + Ci + Dj-^-Ek-^                                             (2.1)

              + {BC)u + iBD)tj + {BE)tk + {CD)ij -I- {CE)ik + (7)£)>t+

              + {BCD)tij + iBCE)tik + {BDE)tjk + {CDE)ijk + (BCDE)tijk


      t = l,-,b;      i=l,--,c;      j = l,--,d-,      k = l,---,e-,   1=1, -^n




                                   E{ytijki) = Utijk                              (2,2a)


                                   Var{ytijk,) = cr^                               (2,2)

                                    Coi;(y) = (T^ I                               (2,2c)


                                 ytijkl-^Nip,ijki,<r^)                            (2.2d)


   El análisis de vairianza utiUza de forma esencial la suma de cuadrados y descompone

esta en sumas de cuawirados independientes, de manera que en la medida en que la

suma de cuadrados del error sea menor, mejor ajustará el modelo (11). Por ello,

suele minimizarse la suma de cuadrados en muchas de las aplicaciones estadísticas en

donde no se hacen supuestos a cerca de las distribuciones del error, Pero, mininúzar

cuadrados (en caso de suponer una distribución para el error) es equivalente a suponer

una distribución normal v obtener estimadores de máxima verosimilitud.

56                                 MIGUEL A. DUMETT

El supuesto de normalidad para el error suele ser muy natural en muchais aphcaciones

pero en otras no. Así surge la necesidad de un análisis de varianza para distribuciones

no normales (en caso de tener no normalidad debemos cambiar 2.2 c) por 2.2d) las

ytijkl son independientes entre sí).

     En lo que sigue se mostrará que el análisis de desvío es una herramienta análoga

al análisis de varianza pero más flexible en dos aspectos:

     (1) Permite que la variable dependiente tenga una gama mucho más amplia de

         distribuciones (entre las cuales está incluida la normal y en ese caso el amálisis

         del desvío se reduce al análisis de varianza clásico.

     (2) Provee de mayor cantidad de pruebas de hipótesis con una mayor simplicidad.

Supongamos que Y es una variable aleatoria no degenerada con función de distribución

de probabiüdades dada por


                               p{y;9,X) = a{y;X)e^^yo-«>^^                            (2.3)


     donde 9 y X son los parámetros de la distribución con (í, A) G 6 x A, con

0 = {6 6 IR; /         a(¡/;A) e^** d9 < oo) y con a,K funciones suficientemente diferen-
              supp a

ciables. Jorgensen (1992) demuestra que 0 es un intervalo y que A es un semigrupo

aditivo, el cual coincide con A = R"*" o A = 2+ si se supone además que A C M y que

IGA.

Se demuestra fácihnente que las distribuciones normal, binomial, Poisson, binomial

negativa, gama (chi cuadrado, exponencial), secante hipérbohca Generalizada; la Pois-

son compuesta con gama, las generadas por extremo estables (ver Feller, 1971) (en

donde generada significa que o es la extremo estable y /c es tal que 2.3 sea una

distribución de probabilidades) y aquellas generadas por cualquier distribución no

     ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARUNZA                       57

degenerada pueden escribirse de la forma (2.3).

Jorgensen (1992) también prueba que si int 0 es diferente de vacío y V no tiene

una distribución degenerada entonces E{Y) = XK'{$) y Var{Y) = XK"{9). Como la

variable aleatoria es no degeneraida Var{Y) > O y por lo tanto r = K' es monótona

creciente y tiene inversa. Si hateemos p = T{9) entonces 9 = T~^{p) y en ese caso

E{Y) = X p y Var{Y) = XV{p) donde V{p) = «"(r-i(/i)) > 0. La función V es

importante porque indica cuad es la relación funcional que hay entre la varianza y el

valor esperado de la variaible supuesto A conocido y se denomina función de varianza.

Un resultado muy importante dice que lais funciones de variamza caracterizam una

distribución dentro de la faimilia de dispersión exponencial.

Si hacemos a^ = 1/A y dado que 9 = r~^(/i) entonces (2,3) puede escribirse como,

Jorgensen (1992),


                     p(y;/i,(T') = aiy-,<T-') c''-'(y^-'M-«(r-'(/i)))                (2,4)


En esta expresión se han cambiado los parámetros (S, A) G 0 x A por {p, tr^) G íí x E

donde Q = r(7nt0) y E = A~^, A la familia (2,4) se le denota por ED{p, <T^).

Supongamos que se toma una muestra aleatoria independiente de tamaño n de de

variables adeatorias Yi que toman vadores yt de acuerdo a


                               a(yi;u;«r-2)e"'"'"''('"'''*)


donde t{yi,pi) = yiT~^{pi) — K ( T ~ ^ { P Í ) ) y con los U;Í, j = 1, • • ,n conocidos. En-

tonces, el logairitmo de la función de verosimihtud viene dado por

                                 n                            n
               tn L{p, (T^ y) = 5 3 ' " a{yi;wi(r-^) + (T'^ Y ^ •Wit(yi,Hi).          (2,5)
                                1=1                           j=i

58                                    MIGUEL A. DUMETT

Se define la función de desvío del vector de parámetros p = {pi, • • • ,pn) dado el

vector de observaciones y = (yi,- • • ,yn) por

                                n           n
              D{p-, y) = 2j2d-=2Y^Wi (sup^.^ntiyi, íi*) - í(y., /i.))                (2.6)
                            1=1            1=1



Esta definición es en reahdad —2 ln R, donde Ti es la razón de verosimihtud entre el

modelo obtenido a partir de los /ÍÍ , j = 1, • • , n y el modelo obtenido a partir de los

p ' , i = 1, • • , n, donde los p ' son los que mejor explican la muestra aleatoria ¡/¿.

Se observa fácilmente que D(p-,y) > O pues cada df > O ya que p ' es el que hace

"máximo" í(y¡,/i,) conocido y, mientras que <(i/,-,/j,) es el valor de t conocidos pi y

yi-

Por otro lado (2.6) muestra la naturaleza aditiva del desvío.

De (2.5) se tiene que


                            lnLÍp,<r'-,y) = c ( a ' - , y ) - ^ ^                     (2.7)



con
                            n
               <:{(r'^,y) = ^       ('na(ytiu;iCT-"^)-f u;,(T"^supp-gn<(yi,/íí)]      (2.8)
                           1=1


Luego, de (2,7), maucimizaír ln L{p,(T'^-,y) es equivalente a minimizar D{p-,y) ya que

c{cr'^\y) es independiente de /i y al derivar (2.5) respecto de p e igualar a cero (para

encontrar loa estimadores de máxima verosimilitud) se obtiene una expresión inde-

pendiente de (T^.

El cálculo del término sup^'^nt[yi,p*) se puede realizar de la siguiente manera. Con-

sidere

                          l{9) = t(y,p) = t{y,T(9)) = y 9 - K Í 9 )                   (2.9)

     ANÁLISIS DEL DESVIO : UNA ALTERNATIVA AL ANÁLISIS DE VARDVNZA                  59

entonces


                             l'{9) = y-K'{e) = y-T{9)                            (2.10)




                             l"{9) = - K " ( 9 ) = -V(/i) < Q                    (2.11)


Por lo tanto, de la concavidad estricta de /, ella posee un único máximo el cual ocurre

en 9. Si í G 7n<0 entonces igualando a cero (2.10) se tiene


                                       9=T-'{y)                                  (2,12)


  Como para una vairiable aleatoria continua, la frontera de 0 tiene probabilidad

cero, entonces (2.12) existe con probabilidad 1. Lo mismo para paira las distribuciones

mixtas que son miembros de la familia de dispersión exponencial. En camnbio, para el

caso discreto, la frontera tiene una probabilidad positiva y puede ocurrir que (2.12)

no tenga solución. Sin embargo, para los casos discretos que más se presentam en

las aplicaciones como Poisson, binomial, binonúal negativa ese no es el caso y por lo

tanto (2.12) existe.

   Entonces, es posible expresar el desvío de la siguiente manera

                                n
                  D Í P ; y) = 2 ^ ti;, ((y.fl. - K{9Í) - {yi9i - «(».)))        (2.13)
                               i=\

Si y ~ N{pY, <r^) entonces




y en este caso 9 = pY, K{9) = \9^ y a{y-,cr^) = (2iro-^)~i/^ e " ^ . Luego, K' = r =

r - i = Id-, p = P Y ; V{p)= 1 yt{y,p) = y p - V .

60                               MIGUEL A. DUMETT

Si se toma una muestra aleatoria de tamaño n entonces Y ~ N{p,CT^W) donde

Y = ( Y i , - - ,y„); p = { p i , - - ,Pn) y W = diag{w^^}, de (2.13) se tiene que


                    D{p-, y) = 2 ¿ Wiiiyf - ^yf) - (y./i.- - \P1))
                                 1=1




                                      "    1           1
                                 1=1      ^2




                               J2Myi-f^i?                                            (214)
                                t=l


que es la suma de cuadrados pesados con pesos lUj y si los w; = 1, i = 1,              • ,n

entonces se obtiene la suma de cuadrados considerada en el análisis de varianza con

distribución normal para Y.

Como se mencionó anteriormente, maximizar la función de verosimilitud es equiva-

lente a minimizar la función desvío. Una ventaja de utilizar esta última estadística

reside en la posibilidad de cambiar de distribución de la variable aleatoria depen-

diente (dentro de la ampha fanüha de modelos de dispersión exponencial) y comparar

los desvíos calculados para cada uno de esos modelos, obteniendo como mejor ajuste

aquel modelo para el cual se obtenga el menor desvío.

En la página que sigue se muestra una tabla, lomada de Jorgensen (1992), página 65

con los desvíos de las distribuciones miembros de la farrúlia de dispersión exponencial

más relevantes.

Si denotamos por Di el desvío de un modelo con ki grados de Ubertad (donde

kl = n — pi) con el que se está trabajando y por D2 el desvío de un submodelo

del anterior con Á:2 grados de libertad (donde k2 = -n — p2 y k2 < ki lo que implica

Pl > P2)i SS decir, que tiene sólo un subconjunto de los parámetros que aparecen en el

     ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARL^NZA                           61

primer modelo y por w = min{wi,--• ,Wn}, y si entendemos por lu —+ oo que todas

lais tí;, son suficientemente grandes entonces puede demoetrairse que

                             Di      2
                                                                                          (2.15)
                             -Z2~4>i)              «     u;^oo
                 D2-D1        2
                      2      ^(ti-ia)         ®'   iy-*00             O 81   n-»oo        (2.16)

                                        TABLA 2

                              DESVÍOS EN MODELOS


            Modelo                                              Desvío
                                                          n
            Normal                                       E «'.(!/«• - V^i?
                                                         «=1



             Poison                           2Et^<(yi'n--(S'.-Ai.))
                                               •=1        ^           /*••           '


           Binomial                 2Eu;..(y./n^'-(m-v..)/n(^-;¡0)
                                        i=i    ^         M»                     \m-piJI

      Binomial Negativa              2E«;.(y../n;¡;-.(y. + r)/n(; + ^;))

            Gascona
                                                   iti         V/ii            Vi'

      Secante Hiperbólica         2¿.,(„„«„„(ii^).i,„(ii|))
         GeneraUzada

       Inversa Gaussiana
                                                       .5 .:?<--->'
    Modelo con Varianza p^        2("-i)é<«i(»íiír'+(.,=*'(^-»))
     p?¿ 0,1,2,3; a = £5!

     Modelo con Vawianza                  2¿u;<e''*(eV--''--l-(yi-/i.))
          Exponencial

62                                      MIGUEL A. DUMETT


     Debido a que no se conocen los parámetros p del modelo, el desvío tiene que ser

eslimado. Para ello, si relacionamos caída uno de los parámetros p del modelo (n en

tolad) con p parámetros /3 con p < n entonces p dependerá de »/ y se tendrá p = p{0)

y por lo tanto D{p-,y) = D{p{0)-,y); es.decir, el desvío dependerá exclusivamente de

los nuevos parámetros 0.

Luego, una vez eslimado 0 se tendrá una estimación del desvío y a partir de ahí, con-

siderando (2.5) será posible obtener una estimación para a^ mediante procedimientos

iterativos.

Por otro lado, es importante observar que lats distribuciones discretas más importamtes

sólo poseen un parámetro (por ejemplo, la Poisson) y en ese caso tiene que hacerse

A = 1 en (2.3) o el parámetro A tiene un valor conocido de antemano (por ejemplo,

en la binomial se tendrá que A = n, donde n es el número de ensayos preestablecido).

     En ambos casos, carece de sentido reahzau- una estimación de cr"^.


     3. Modelo con Efectos F^os Cruzados Badanceados sin la Hipótesis d e

N o r m a l i d a d en el Contexto d e los Modelos Lineales Generalizados


     Consideremos nuevamente (2.1)


        P t i j k i = A + B t + Ci + D j + E k - ^                                    (3.1)

                  + {BC)u + {BD)tj + {BE)tk + {CD)ij + {CE)ik + {DE)jk^

                  + {BCD)ti¡ + iBCE)tik + {BDE)tjk + {CDE)ijk + {BCDE)tijk




         í=l,        ,6;    » = 1, •• ,c;      j = l,--,d-,   k = l,-••,€-,   1=1,-

     ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARUNZA                  63

pero sin los supuestos (2.2) sino solamente con


                        Las ytijkl son independientes entre sí                 (3.2a)




                y<i;K ~ ED{ptijki,<^^/mijki) con los wtij^i conocidos.         (3.2b)


  Es muy interesante observar que si hacemos / = 1 en (3.1) y se supone una dis-

tribución Poisson para Y en 3.2 b) tenemos el modelo logístico para tablas de contin-

gencia.

Por un modelo lineal generalizaulo se entiende un modelo que consta de dos compo-

nentes. Una aleatoria que especifica la distribución de la variable dependiente siendo


                        Z,~ED{p„a^/w.),             s=l,-,n                      (3.3)


con los w, conocidos y donde además se supone que las Z, son independientes entre sí y

una componente sistemática que relaciona el valor esperado de la variable dependiente

con los parámetros 0 del modelo a través de una matriz de diseño X (constante y

conocida) y de una función g de enlace inversible, suficientemente diferenciable de la

siguiente manera

                      gitis) = r),= x,Q0o + z,i/?i - ! - • • + x,p0p             (3,4)

o equivalentemente p , = g~^{^¡),).

El algoritmo de estimación de los parámetros 0 = {0o,- - ,0p) sigue el proceso itera-

tivo denominado método score para parámetros de Fisher, el cual Dumett (1995) lo

expresa de la siguiente manera



                      ^(m+i) ^ (^x'H^"''^WX)-^X'H'^"'^Wy*^"'^                    (3.5)

64                                   MIGUEL A. DUMETT

donde

                       y' = X 0 + G { y - p )

                        G = diag{g'ip,)}

                                                             1 (dp,\^
                       H = diag{h,}           con    h,
                                                            V{p.)\dTj.)

                       W = diag{w,}

en donde (m) indica la estimación en la m—ésima iteración. A y* se le denomina

variable dependiente modificada. Debido a (3.4), p, depende de 0 entonces H, G, y*

dependen de 0. El proceso iterativo se inicia con p° = y,, es decir se estima el valor

promedio por el dato observado.

Es fácil ver que (3.1) y (3.2) pueden ser vistos como un modelo lineal generalizado

si (3.1) se considera la componente sistemática con g = Id (lo que implica que

G = 7„ y i7 = d i a g { V - \ p . ) } ) y donde 0o = A; 0i = Bi;- •, 0t = Bt, 0t+i =

Ci; - - • ; /3t4.i = C,-; /3t+i+i = Di; • • y así sucesivamente donde p = t-^-i-\-j-^k-i-

ti -I- tj -\-tk-\- ij -^-ik -h jk -\- tij -\- tik -\- tjk -\- ijk -f- tijk y n = tijkl y la componente

aleatoria viene dada por (3.2).

En caso de especificar la distribución normal para Y se tendrá H = In,

y* = y pues p = X 0 y el esquema iterativo se reducirá a un algoritmo no iterativo

para 0 dado por

                                     0 = {X*WX)-^X'Wy                                          (3.6)

los cuales son conocidos como los estimadores de máxima verosimilitud ponderados

por W p a n 0.

Como estimador de a^ se toma más frecuentemente

                                          a' = ^ i f ^                                         (3.7)
                                                    n—p

     ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARIANZA                   65

En Jorgensen (1992) también existen resultados distribucionales asociados a los esti-

madores de 0 y a-^ entre los cuales se encuentran


            0^N{0,(T^{X*H{0)WX)~^),              si   u;-oo      o si   n^oo       (3.8)


                 ,    ^   ^  === ~ tp I         si    tx;-+oo   o si    n—•00      (3.9)
              ^ a ^ {X*H{0)WX)-j

                       (n — ki)á^       .¡                                        ,„ , „ .
                       ^^ ^           xfn-k^y         SI « ; ^ o o               (3.10)

       ., ,      TT ~ ^('ti — Jt2," — *i)        si    ly—•00    o si   n—•00      (311)

       o-* (kl - *2)

en donde Di, D2, fci, k2 tienen los mismos significados de antes.

Se puede observar el paurecido notable con las fórmulas de distribución para los modelos

de regresión normal multivairiaulo.

Es importamte observar que no pueden utilizarse siempre estos resultados distribu-

cionales pues a parte de tener que verificar las condiciones de ser resultados lírrüte

cuando lu —• 00 o cuando n —• 00, no se conoce necesariamente el vador de tr^. Pero,

a^ si es conocido en la mayoría de las distribuciones discretas que son miembros de

la familia de dispersión exponenciail y en esos casos es posible realizar un estudio más

completo.

Como se mencionó amteriormente, el desvío es de naturaleza awlitiva. Esto nos permite

realizaír un análisis del desvío análogo al análisis de variamza. Teniendo en cuenta los

resultados distribucionales (2.15)-(2,16) y (3.8)-(3.11) la tabla de análisis de desvío

se formula de la siguiente manera (tomada de Jorgensen, (1992), pág 98).

66                               MIGUEL A. DUMETT

                       TABLA 3. ANÁLISIS DEL DESVIO



           Modelo    Desvío          g.l.    ADi        A g.l.   a''     F

             Hl        Di             /i                         *(i)


             Hi        D2             /2    D2-D1       /2-/1    *(2)    7-2

             H3        D3             h     D3-D2       h-f2     ^(^3)   7^3




     donde Hi D H2 "2 -     es una sucesión de hipótesis anidadas (modelos), 77, con

desvío D, y f, grados de libertad. En esta tabla, D significa desvío; / grados de

libertad; A A = Di — D i - i , es la diferencia de dos desvíos del modelo y del modelo

anterior; Agí. = fi — f i - i , es la diferencia de grados de libertad del modelo y del

modelo anterior; a"^ es el estimaulor de <r^ dado por D{p{0)-, y)/f y F es el valor de

la estadística

                                       (A-7:>i-i)/(/i-/i-i)
                              7^1-
                                              •^(.-1)

la cual debe compararse contra el valor crítico de una distribución F con /,• — /,_i

y /i_i grados de Ubertad para docimar Tí, bajo 7/,_i de la manera siguiente : si se

rechaza la prueba se acepta 77,. Se empieza probando 772 '>ajo Hi.

     4. Ejemplos

     En esta sección se presentan dos ejemplos. El primero de ellos fué tomado de

un texto de análisis de varianza clásico y por lo tamto es posible desarrollar un

anáfisis tradicional del mismo. Dicho ejemplo también se analiza con los mismos

supuestos pero dentro del contexto de los modelos hneales generahzados de manera

     ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARIANZA                    67

que se puedan compawar ambas metodologías de trabajo. Una vez dentro del marco

de los modelos hneales generalizados se ajustarán los datos suponiendo otras distribu-

ciones para la variable dependiente y se encontrarán mejores resultados que con la

distribución normal.

  El segundo ejemplo fué creado por el autor del presente trabajo, utilizando simu-

lación de distribuciones normales, con el objeto de estudiar que ocurre en esos casos

con los nnodelos de distribuciones alternativas.

  Todos los ejenq>Ios han sido desarrollados con el paquete GLIM (Generalized Lin-

ear Interactive Modeling), el cual fué desarrollado por la Royal Statistical Society

especificamente paira el análisis de modelos lineales generalizados. E^te software es el

único en su género y en estos momentos SAS posee un procedimiento llamado GEN-

MOD para trabajar con modelos hneales generalizados, el cual se encuentra en estado

de experimentación.

Ejemplo 1. Este problema ha sido tomado de Scheffé (1959) pág 145. Este es un

experimento con 4 fau^tores. Las observau:iones son el contenido de una mezcla (en

gramos) de un cierto producto aJimenticio en un estado de experimentación. Loe

niveles del factor A son tres tipos de sal; los de B corresponden a las cantidades de

esas sales (las mismas camtidades molares paira cada sal); las de C son camtidades de

cierto ácido y las de D son dos diferentes aditivos (dice el texto, que esos datos fueron

proporcionados por Mr. Otto Dykstra Jr. y reproducido con el permiso del Research

Center of General Foods Corporation). Los datos y las tablas de anáfisis de varianza

y de desvío para este modelo se presentan en las páginas siguientes.

   En la tabla de análisis de desvío se comenzó por el modelo completo y se fue

quitando en cada paso un término al modelo (sin que necesariamente sea un proce-

68                              MIGUEL A. DUMETT

dinúento backward) pau-a mostrar la naturaleza secuencial de este procedimiento. El

objetivo primordial de haber realizado esto es mostrar que ambos análisis coinciden

para el caso de distribución normal. Una vez entendido como funciona la tabla de

análisis de desvío, procedemos a ajustar estos modelos con otras distribuciones.

     En el apéndice se muestra la salida del programa GLIM para estos mismos datos

suponiendo distribuciones normal, gaima, Poisson e inversa Gaussiana y para cada

una de esos modelos se plantean 4 modelos : primero el que contiene las interacciones

de orden tres, luego el que incluye sólo interacciones de orden dos, después el que

no tiene interacciones y finalmente el modelo de únicamente la constante (salvo en el

caso normal en que no se incluye este último debido a que el modelo sin interacciones

es insuficiente para ajustar los datos). En el apéndice puede encontrarse el programa

GLIM utilizado.

                        TABLA 4. DATOS DEL EJEMPLO 1



                                             NIVEL DE C
             NIVEL DE A       NIVEL DE B           1          2
                                              NIVEL DE D NIVEL DE D
                                                1    2     1    2

                   1                1           8      5        8      4
                                    2          17      11      13      10
                                    3          22      16      20      15


                   2                1           7       3      10       5
                                    2          26      17      24      19
                                    3          34      32      34      29


                   3                1          10      5       9       4
                                    2          24      14      24      16
                                    3          39      33      36      34

     ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARL\NZA                    69

Los resultados se pueden observar en la tabla que se encuentra en la página 74.

En ella, Mo es el modelo que incluye todos los términos del modelo incluidas las

interacciones entre tres few;tores; Mi incluye todas las intera«:ciones; AÍ3 es el modelo

sin interacciones y M4 es el modelo que sólo tiene como predictor la constante.


Se observa fácilmente que entre las cuatro distribuciones utilizadas, la normal tiene

el desvío más alto no importa si se considera el modelo con las interacciones entre

tres factores, con interacciones simples, sin interacciones o de sólo la constante. Sin

embargo, esto es sólo un indicador pues no podemos concluir nada salvo en el caso de

la Poisson pues dado que se conoce a^ = 1, por (2,15) es posible comparar el desvío

con una tabla x^- En este caso, aceptamos el modelo pues 0.25 < 9.488 = xl 0,95

y dado que los modelos gauna e inversa Gaussiana tienen un desvío menor taunbién

se pueden aceptar. Debido a que 5.33 «         9.49 = Xu) entonces podenK» aceptar

también al modelo normal.


Es fácil observar que la diferencia de dos desvíos consecutivos cualesquiera coincide

con la suma de cuadrados asociaida al término que se retiró del modelo. Por ejemplo,

la diferencia de desvíos entre el segundo y el tercer modelo es 12.000 - 6.833 = 5.167,

que es exaw;tamente la suma de cuadrados asociada al término C D E (el cuad fue

retirado del segundo modelo para obtener el tercero). Lo nüsmo ocurre con los grados

de libertad. La diferencia de grados de hbertad entre aquellos modelos es 2 que son

los grados de libertad asociados a C D E .

70                              MIGUEL A. DUMETT

             TABLA 5. ANÁLISIS DE VARIANZA DEL EJEMPLO 1



                Fuente     Suma de Cuadrados      Grados de Libertad

                                                            2

                                                            2

                                                            1

                                                            1

                                                            4

                                                            2

                                                            2

                                                            2

                                                            2

                  DE               2.250                    1

                 BCD               8.667                    4

                 BCE               10.000                   4

                 BDE               1.500                    2

                 CDE               5.168                    2

                 BCDE               5.33                    4

                Residual             0                      0


                 Total           4091.639                   35




     Debido a que sólo se tiene una observación por cada combinación de factores, la

suma de cuadrados de los residuos es cero y no es posible estimar <j^.

    ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARIANZA               71

                                      TABLA 6

                    ANÁLISIS DEL DESVIO - EJEMPLO 1



Modelo                                                           Desvío   gl-

B + C ^ D + E-^B.C-\- B D + B.E -t- C D -I- C E -f- b.E+
B.C.D -I- B.C.E + B.D.E -(- C.D.E -1- B.C.D.E

fl-fC + £)-f-£;+ B.C + B.D-Ir B.E -I- C D -f- C E 4- D.E-^       5.333
B C D -I- B.C.E + B.D.E -f C.7),í;

S-l-C-t-D-fí-f B.C -I- B.D -\- B.E -f C D -I- C.JE 4- D.£;+      6,833
B.C.D + B.C.E-^C.D.E

S-HC-fD + £^ + B.C + B.D -h B . Í ; -h C D + C E -I- £>.£;+      12.000
B.C.D-1-B.C.Í;

B-|-C-l-£)-t-£-l- B.C -t- B.D -I- B.£ -1- C D -(- C.£ + D.E-\-   20,667    12
B.C.E

ñ-f-C-t-D-t-i'-l- B.C + B.D + B.E -f- C D -t- C Í ; -I- D.E      30,667    16

B -f- C + D + £ + B.C + B,D -t- B.f; -1- C D -I- Cf;             32.917    17

B + C 4- D -f- £? + B.C -I- B.D -h C D -f C£:                    36.417    19

B 4- C -I- D -t- f; -f B.C -f B.D -1- C S                        40.583    21

B 4-C 4-D 4-£ 4-B.C 4-Cf;                                        45,750    23

B4-C4-D4-f;4-B.C                                                 58.250    25

B4-C4-D-hf;                                                      396.03    29

B4-C4-f;                                                         398,28    30

B4-C                                                             638.53    31

C                                                                1142,6    33

Constante                                                        4091,6    35

72                             MIGUEL A, DUMETT

                     TABLA 7, DESVIO DEL EJEMPLO 1

                         DIFERENTES DISTRIBUCIONES




         Modelo           Desvío    /     ADi      A/    a^        F

         Normal
          Ml               5,33     4                    1,33

           MJ              30,67    16    25.33    12    1.92     1,59

           Ma             396,03    29   365.36    13   13.66     14,64

           M4             4091,60   35   3695.57   6    116.90    45,09


         Gamma
          Ml               0,08     4                   0,020

           M2              0.31     16    0.23     12   0.019     0,96

           M3               1.82    29    1.51     13   0.063     6,11

           Mi              16.05    35    14.23     6   0.459     37,65


          Poisson
            Ml              0,25    4

            M2              2,43    16    2.18     12

            M3             13.43    29    11.00    13

            M4             238.52   35   225.11     6


     Inversa Gaussiana
            Ml             0.0002   4                   0.00005

            M2             0.006    16   0.0058    12   0.00038   9.67

            M3              0.14    29   0.1340    13   0.00483   27.13

            M4              1.30    35     1,16     6   0.03714   40.03

     ANÁLISIS DEL DESVÍO : UNA ALTERNATIVA AL ANÁLISIS DE VARL\NZA                   73

Dado que para un nivel de confianza del 95% se tienen 7^i2,4 = 5.91; T^is.is = 2.40;

7^6,29 = 2.43 y que para un nivel de confianza del 99% se tienen Fi2,4 = 14.37;

^13,16 = 3,50; F6,29 = 3,50 se observa fácilmente que en el caso normal el modelo M2

(el que considera las interacciones) es el adecuado (si se toma un nivel de confianza

del 99% y no del 95%) pues aunque Mi también los ajusta, son innecesaurias las

interau:ciones de tres factores; en el caso gama el modelo M4 más simple y que ajusta

muy bien los datos y en el cuál además se observa que tanto los factores como sus

interacciones son ágnificativas núentras que las interacciones entre tres factores no es

significativa; en el caso inversa Gaussiana (el mejor de todos pues los desvíos son muy

pequeños) aunque el modelo M4 es el mejor debido a su simplicidad, son significativas

tanto los factores como las interacciones entre tres fau:tore8; en el caao Poisson se

observa que el mejor modelo por su simplicidaui es el Afa siendo significativas las

interacciones pero no asilas interaw:ciones entre tres factores.

Es posible anahzar cada factor por separsulo en caula uno de estos modelos y obtener

los estimados de los parámetros y de sus desviaciones estándar así como residuades sin

mayor esfuerzo pues estamos dentro del contexto de los modelos lineales generalizados

pero esto escaparía al objetivo principad del presente trabajo.

Ejemplo 2. Se generaron números aleatorios de distribución normad para que me-

diante SGPLUS de acuerdo al modelo siguiente :


                          yti, = A 4- B, 4- C 4- {BC)u 4- em


donde t = 1,2,3; i = 1,2,3,4; / = 1,2,3 y de manera que se cumplieran las condi-

ciones ^ B , = 0; EC"; = 0; YliBC)t = 0; Y2{HC)i = O, Para ello se eligieron los

siguientes valores para los parámetros : A = 100; Bi = 50; B2 = —30;

74                                MIGUEL A. DUMETT


Ba = - 2 0 ; Ci = 16; C2 = -10; C3 = - 1 2 ; C4 = 6; (BC)ii = 2; (BC)i2 = 1;

(BC)i3 = - 1 ; (BC)i4 = - 2 ; (BC)2i = 3; (BC)22 = - 3 ; (BC)23 = - 1 ; (BC)24 =

1; (BC)3i = - 5 ; (BC)32 = 2; (BC)33 = 2; (BC)i4 = 1.

Los datos obtenidos y el programa GLIM que se utilizó están en el apéndice. Los

primera fila de datos corresponde a ym; la segunda a yi2i; • ••. Se observa fácilmente

que el modelo normal que ajusta es el que incluye el término de interacción mientras

que el que sólo contiene los factores no ajusta (de acuerdo a como se generaron los

datos). Sin embargo, los modelos gama y Gaussiana inversa ajustan mucho mejor

aún considerando sólo el modelo constante. Por otro lado, no se incluye un ajuste

con el modelo Poisson pues los números aleatorios generados son reales y no tendría

sentido suponer una variable dependiente Poisson. En caso de multiplicar por 1000

las observaciones para poder utilizar una distribución Poisson, el análisis de desvío

muestra que ninguno de los modelos sirve paua explicar los datos.

Lo irónico de este ejemplo es que a pesar de generar una variable normal resultan

ajuslando mejor la distribución gama y Gaussiana inversa. Esto se debe a que no

se genero una muestra grande (sólo 5 valores) en cada caso. Sin embargo, esto nos

debe llevaír a replantearnos seriamente la elección de la distribución normal como

mecanismo que explica la parle aleatoria del modelo.


BIBLIOGRAFÍA
Cordeiro, G. (1986), Modelos Lineares Generalizados VII SINAPE (Simposio Nacional de Probabilidade e Estatística), Universidades Estadual de Campiñas, Campiñas, Sao Paulo.
Dumett, M. (1995), Modelos Lineales Generalizados (imprenta). Universidad Nacional de Colombia, Bogotá.
Feller, W. (1971), An Introduction to Probability Theory and Its Applications Volume II Second Edition, John Wiey, New York, N.Y..
Graybill, F . (1961), An Introduction to Linear Statistical Models Volume I, Me Graw Hill, New York, N.Y,,
Johnson, N. y Leone, F, (1964), Statistics and Experimental Design, John Wiley, New York, N,Y,.
Jorgensen, B. (1992), The Theory of Exponencial Dispersión Models and Analysis of Deviance (Monografias de Matemáticas N Sl), IMPA (Instituto de Matemática Pura e Aplicada, Rio de Janeiro.
Scheffé, H. (1959), The Analysis of Variance, John Wiley, New York, N.Y..


