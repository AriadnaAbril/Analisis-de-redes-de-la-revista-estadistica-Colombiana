Variable Selection in Switching Dynamic Regression Models. Selección de variables en modelos de regresión dinámicos de cambios de régimen
Universidad de Colima, Colima, México. Colegio de Postgraduados, Texcoco, México.  Universidad de Colima, Colima, México
Abstract
Complex dynamic phenomena in which dynamics is related to events (modes) that cause structural changes over time, are well described by the switching linear dynamical system (SLDS). We extend the SLDS by allowing the measurement noise to be mode-speciﬁc, a ﬂexible way to model non stationary data. Additionally, for models that are functions of explanatory variables, we adapt a variable selection method to identify which of them are signiﬁcant in each mode. Our proposed model is a ﬂexible Bayesian nonparametric model that allows to learn about the number of modes and their location, and within each mode, it identiﬁes the signiﬁcant variables and estimates the regression coeﬃcients. The model performance is evaluated by simulation and two application examples from a dataset of meteorological time series of Barranquilla, Colombia are presented.
Key words: bayesian ﬁltering and smoothing; dirichlet process; hierarchical model; state-space model.
Resumen
Fenómenos dinámicos complejos en los que la dinámica está relacionada con eventos (modos) que provocan cambios estructurales a lo largo del tiempo, se aproximan mediante un sistema dinámico lineal de cambio de régimen (SDLR). Extendemos el SDLR al permitir que el error de medición sea especíﬁco del modo, una forma ﬂexible de modelar datos no estacionarios. Además, para los modelos que son funciones de variables explicativas, adaptamos un método de selección de variables para identiﬁcar cuáles de ellas son signiﬁcativas en cada modo. El modelo propuesto es un modelo bayesiano no paramétrico ﬂexible que permite conocer el número de modos y su ubicación, y dentro de cada modo, identiﬁca las variables signiﬁcativas y estima los coeﬁcientes de regresión. El desempeño del modelo se evalúa mediante simulación y se presentan dos ejemplos de aplicación de un conjunto de datos de series de tiempo meteorológicas de Barranquilla, Colombia.
Palabras clave: ﬁltrado y suavizamiento bayesianos; modelos de espacio-estado; modelos jerárquicos; procesos Dirichlet.




1. Introduction

   The dynamic nature of many phenomena in ﬁelds such as ﬁnance and economics
(Kim, 1994; Carvalho & Lopes, 2007; West, 2013; Zeng & Wu, 2013; McAlinn
& West, 2016), human motion (Bregler, 1997, June; Pavlović et al., 2001), and
environment (Lamon III et al., 1998; Huerta et al., 2004; Velasco-Cruz et al.,
2012), has motivated the development of ﬂexible methods in order to be able to
handle changing conditions in the environment of the phenomena through time.
For instance, several changes may occur in an endemic disease that may trigger an
epidemic, or become highly contagious and thus trigger a pandemic; as a result, its
rate of occurrence might change dramatically. The economic system of a country
may change from a command-based economy to a market-based economy, or to
a green economy, and then modify its economic activity. In modeling the rate
of occurrence of a desease or the economic activity of a country through time,
diﬀerent states or modes account for changes the phenomena exhibit. Each mode is
associated by an event (endemic, epidemic, pandemic; command economy, market
economy, green economy), and the time series within each mode can be modeled
by a linear dynamic system, such that the complex dynamics of the whole series
can be approximated as switches among conditionally linear dynamical modes,
known as Switching Linear Dynamical System (SLDS).
    The SLDS can be viewed as a combination of the Hidden Markov Model (HMM)
with a set of Linear Dynamical Systems (LDSs). In the HMM, the observations,
which can be either discrete or continuous, are conditionally independent given a
sequence of unobserved (hidden) discrete-valued modes that satisfy the Markov
property. The LDS is considered an extension of the HMM with a linear
structure on continuous latent (hidden) variables, most commonly Gaussian. The
assumption of linearity and Gaussianity is speciﬁc to the LDS, but the dependence
structure of the observations on the hidden variables is part of the deﬁnition of
a general state-space model (Kalman, 1963, 1960). The SLDS is then formed by
multiple Markov chains of continuous linear-Gaussian latent variables, each one
associated with a value of the hidden discrete variable, such that the dynamics of

                Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                     233

a phenomenon is modeled by switching linear models, according to the underlying
mode 1 sequence.
     Inference in both, the HMM and the LDS, involves the quantiﬁcation of the
uncertainty associated with the unobserved variable at a particular time instance
conditional on a sequence of data. To be explicit, let c be the hidden variable and
y the observed variable, such that yt is assumed conditionally independent of all
other observations given the state ct , for t = 1, 2, . . . , T . The sequence of states
follows a ﬁrst order Markov chain; if c is discrete-valued the process is a HMM, but
if c is linear-Gaussian the process is a LDS. We use the notation x1:t to compactly
represent the sequence {x1 , . . . , xt }. The main inference problem resides in the
computation of p(c1:T |y1:T ). Since computing the full joint distribution of the
states at all time steps is computationally very ineﬃcient, it is more convenient
to compute the marginal distribution p(ct |y1:l ). Three diﬀerent conditions are
identiﬁed depending on l and t. If l < t then it is known as prediction; if l = t
then it is referred to as ﬁltering; and if l > t then it is the smoothing problem. A
recursive algorithm known as the forward-backward algorithm is commonly used
to solve the inference problems. Since the LDS is a linear-Gaussian model, the
joint distributions, as well as the marginals and conditionals, are Gaussians. It is
well-known that the ﬁltering-smoothing problems for the LDS are solved by the
Kalman ﬁlter (Kalman, 1960) and Kalman smoother (Rauch et al., 1965).
     The HMM can be viewed as a mixture model. The observations are regarded
as being drawn independently from a mixture of distributions F (θ), such that
yt |θt ∼ F (θt ), where θt are the parameters of the mixture component to which yt
belongs, and F (·) represents the distribution of the mixture. In this context, the
discrete variable ct indexes the parameters of the mixture component generating
observation yt as yt |{θk }∞ k=1 , ct ∼ F (θct ). If two data points, yt and yl , belong
to the same component (cluster), their component parameters will be identical,
θt = θl . In the Bayesian nonparametric context, a Dirichlet Process (DP; Ferguson
1973) is used as a prior over the parameters of the mixture components. The
resulting model is known as Dirichlet Process Mixture Model (DPMM; Antoniak
1974), which is used in a variety of clustering applications where the number of
clusters is not known a priori.
    In deﬁning the SLDS, the DPMM in its hierarchical extension, proposed by Teh
et al. (2006), and the LDS are fundamental. Fox et al. (2011a) develop a sampling
algorithm that combines a truncated approximation of the DP (see Ishwaran &
James, 2001, 2002; Ishwaran & Zarepour, 2002b) with an eﬃcient joint sampling
of the mode (due to the hidden Markov model) and states sequences (due to
the linear dynamical system). The model is developed for time series exhibiting
dynamical behaviors with the dynamics of the latent state process being mode-
speciﬁc, only. Additionally, the model does not relate the time series to any
explanatory variables other than intercept. In this paper we present an extension
of the SLDS of Fox et al. (2011a), consisting of making the measurement model
mode-speciﬁc. More precisely, the variance of the noise of this model is mode-
   1 The term state has a generic use in the state-space models. To avoid confusion, the continuous

hidden variables are referred to as states, while the discrete hidden variables are referred to as
modes.


                  Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

234            Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


speciﬁc. Also, the time series is described in terms of a regression model with
explanatory variables. Furthermore, we include a variable selection method based
on the formulation of Kuo & Mallick (1998). An important implication of it is that
the design matrix is mode-speciﬁc, which is an element to distinguish between the
distributions in the mixture. By employing a changing design matrix allows us
to describe changing relationships between variables as time evolves. As a result,
our proposed model is a ﬂexible dynamic regression model for learning about the
number of component distributions, for identifying the important variables, for
determining where the mode changes originate, and for estimating the regression
coeﬃcients.
   The outline of the paper is as follows. In Section 2 we provide some basic
background on the forward-backward procedure, the DPMM, the hierarchical
DPMM, and the sticky hierarchical DPMM (Fox et al., 2011a). The proposed
model is derived in Section 3. We outline a Gibbs sampler and present results on
synthetic datasets in Section 4. We use the proposed model on two applications by
using a real dataset of meteorological series of Barranquilla, Colombia in Section
5. The paper concludes with a discussion.


2. Preliminaries
2.1. Forward-Backward Procedure
      Consider the following general probabilistic state-space model:

                              ct ∼ p(ct |ct−1 )
                              yt ∼ p(yt |ct ), t = 1, . . . , T.                         (1)

This dynamic model describes the system’s dynamics and its uncertainties by a
Markov chain on the state c, and a measurement model that describes yt as a
function of ct .
   The above state-space model is completely speciﬁed by the initial distribution
p(c0 ) as
                                             ∏
                                             t
                    p(c0:t , y1:t ) = p(c0 )   p(ci |ci−1 )p(yi |ci ).        (2)
                                             i=1

From (2) one can derive any other distribution of interest. Because computing
the full joint distribution of the states at all time steps is computationally very
ineﬃcient, the following marginal distributions for each t = 1, . . . , T are considered
instead: ﬁltering distributions p(ct |y1:t ); prediction distributions p(ct+n |y1:t ), n =
1, 2, . . .; and smoothing distributions p(ct |y1:T ). The two most important examples
of state-space models are the HMM in which the hidden variables are discrete-
valued random variables, and the LDS in which the state variables are Gaussians.
Analytical derivations of the marginal distributions above are straightforward in
both the HMM and the LDS. However, we only provide the resulting distributions
for the LDS. For a review of the inference problems in both the HMM and the

                 Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                    235

LDS see Bishop (2006) and Barber (2012) (Meinhold & Singpurwalla, 1983 and
Petris et al., 2009 are excellent references for beginners and practitioners in LDS).
   Since the LDS is a linear-Gaussian model, the joint distributions over all latent
and observed variables are Gaussian. The closed form solutions resulting from the
Gaussian assumption allow us to have optimal algorithms for Bayesian ﬁltering
and smoothing. The ﬁltering problem is solved by the well-known Kalman ﬁlter
(Kalman, 1960); the corresponding smoothing problem is solved by the Rauch-
Tung-Striebel smoother (RTSS) (Rauch et al., 1965). We brieﬂy outline the
algorithms.

2.1.1. Kalman ﬁlter

    For the ﬁltering problem, the data are supposed to arrive sequentially in time.
We aim to estimate the current value of the state vector, based on the observations
up to time t, in order to update our estimates and forecasts as new data become
available at time t + 1. For a general state-space model deﬁned by (1), the ﬁltering
distribution can be computed as

                            p(yt |ct , y1:t−1 )p(ct |y1:t−1 )   p(yt |ct )p(ct |y1:t−1 )
           p(ct |y1:t ) =                                     =                          ,   (3)
                                      p(yt |y1:t−1 )                p(yt |y1:t−1 )

where p(ct |y1:t−1 ) and p(yt |y1:t−1 ) are the one-step-ahead predictive distributions
for the states and for the measurements, respectively. Speciﬁcally for the LDS,
consider the following model:

                             ct = At ct−1 + et , et ∼ N (0, Σt ),
                               yt = Xt′ ct + wt , wt ∼ N (0, rt ),                           (4)

which is a simple linear-Gaussian case of (1) with ct a vector of size p and yt scalar.
The matrix At is known as evolution matrix, and Xt is a vector of explanatory
variables. The evolution error et and the measurement error wt are internally and
mutually independent random variables, such that for all (t, t′ ), t ̸= t′ , et and et′
are independent, wt and wt′ are independent, and et and wt′ are independent (see
West & Harrison, 1997 for an extensive review of LDSs). The model can readily
be extended to the case where yt is a vector.
    Using standard results of the multivariate Gaussian distribution to the model
in (4), it follows that the marginal and conditional distributions in (3) are
also Gaussians, which are completely determined by their means and variances.
Assuming that
                         p(ct−1 |y1:t−1 ) = N (ft−1 , Ft−1 ),




                Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

236            Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


the solution of the ﬁltering problem for LDS is given by
  mt = E(ct |y1:t−1 ) = E(At ct−1 + et |y1:t−1 ) = At ft−1
  St = Var(ct |y1:t−1 ) = Var(At ct−1 + et |y1:t−1 ) = At Ft−1 A′t + Σt
   at = E(yt |y1:t−1 ) = E(E(yt |ct , y1:t−1 )|y1:t−1 ) = E(Xt′ ct |y1:t−1 ) = Xt′ mt
  Qt = Var(yt |y1:t−1 ) = E(Var(yt |ct , y1:t−1 )|y1:t−1 ) + Var(E(yt |ct , y1:t−1 )|y1:t−1 )
       = rt + Xt′ St Xt .
Then, it can be shown that (ct |y1:t ) ∼ N (ft , Ft ), where:
        ft = Ft (Xt rt−1 yt + St−1 mt ) = mt + St Xt (Xt′ St Xt + rt )−1 (yt − Xt′ mt )
        Ft = (St−1 + Xt rt−1 Xt′ )−1 = St − St Xt (Xt′ St Xt + rt )−1 Xt′ St

   One can learn about the state sequence c1:T by working sequentially forwards in
time; starting with c0 ∼ p(c0 ) in order to compute p(c1 |y1:1 ), and then estimating
the ﬁltering distribution p(ct |y1:t ), t = 2, . . . , T , as new data become available (see
Petris et al., 2009).

2.1.2. Kalman smoother

    For the smoothing, we aim to retrospectively estimate the current value of the
state vector. That is to say, we have observations of a time series up to time T
to compute the conditional distributions of ct given y1:T , for any t < T , using the
backward-recursive algorithm.
   For a general state-space model deﬁned in (1), the smoothing distributions can
be computed as
                                         ∫
                                            p(ct+1 |ct )
             p(ct |y1:T ) = p(ct |y1:t )                  p(ct+1 |y1:T )dct+1 . (5)
                                           p(ct+1 |y1:t )

  Because the distributions in (5) are Gaussians, p(ct |y1:T ) is Gaussian, with
mean and variance given by
                                                                        −1
      bt = E(ct |y1:T ) = E(E(ct |ct+1 , y1:T )|y1:T ) = ft + Ft A′t+1 St+1 (bt+1 − mt+1 ).
   Bt = Var(ct |y1:T ) = Var(E(ct |ct+1 , y1:T )|y1:T ) + E(Var(ct |ct+1 , y1:T )|y1:T )
                    −1        −1                           −1
        = Ft A′t+1 St+1 Bt+1 St+1 At+1 Ft + Ft − Ft A′t+1 St+1 At+1 Ft
                         −1                 −1
        = Ft + Ft A′t+1 St+1 (Bt+1 − St+1 )St+1 At+1 Ft .

    The algorithm begins with (cT |y1:T ) ∼ N (bT = fT , BT = FT ), and then it
proceeds backward in time to compute p(ct |y1:T ), t = T − 1, . . . , 1 (see Petris
et al., 2009).


2.2. Dirichlet Process Mixture Model
    Let (X , A) be a measurable space such that X is a space and A is a σ-algebra
of subsets of X . Let α̃ = αG0 be a ﬁnite non-null measure on (X , A). Then,

                   Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                237

a stochastic process G, indexed by elements A of A, is said to be a DP on
(X , A) with parameter α̃ if for any measurable partition (A1 , . . . , Ak ) of X , the
random vector (G(A1 ), . . . , G(Ak )) has a Dirichlet distribution with parameter
(α̃(A1 ), . . . , α̃(Ak )) (Ferguson, 1973), or equivalently, (αG0 (A1 ), . . . , αG0 (Ak ))
(Rodríguez, 2007). G is a random probability measure on (X , A), G(∅) is
degenerate at 0, G(X ) is degenerate at 1, and G(A) takes values only in the
interval [0, 1].
    An alternative deﬁnition of the DP, known as the stick-breaking construction,
is provided in Sethuraman (1994). A random probability measure given by
                                            ∞
                                            ∑
                                      G=          πj δ θ j                               (6)
                                            j=1

                                                                 ∏j−1
has a DP(α, G0 ) prior if θj ∼ G0 i.i.d and πj = wj k=1 (1 − wk ) with
∑j∞∼ Beta(1, α) i.i.d. δθ denotes a probability measure concentrated at θ, and
w
   j=1 πj = 1 with probability one. This constructive deﬁnition of the DP shows
that G is discrete, even if G0 is a continuous distribution. In the context of
mixture models, a DP is used as prior on mixture components; this model is
known as Dirichlet Process Mixture Model (Antoniak, 1974). The model applies to
a sequence of data y1 , . . . , yn that are regarded as exchangeable. The distribution
from which the yi are drawn is a mixture of distributions of the form F (θ), with
the mixing distribution over θ being G. The prior for this mixing distribution is
a DP with concentration parameter α and baseline distribution G0 . Formally, the
DPMM can be represented by the hierarchical model

                                      G ∼ DP(α, G0 )
                                    θi |G ∼ G                                            (7)
                                   yi |θi ∼ F (θi ).
            ∑∞
   Due to j=1 πj = 1 with probability one, π = {πj }∞         j=1 can be interpreted
as a random probability measure on the positive integers. Let zi be a indicator
variable that speciﬁes the mixture component associated with the observation yi ,
such that zi takes values on {1, 2, . . .}. Then, the model in (7) can be rewritten as
             ∞
             ∑
        G=         πj δθj⋆                                        π|α ∼ GEM(α)
             j=1

                                        θj⋆ |G0 ∼ G0                                     (8)
                                            zi |π ∼ π
                                          ⋆ ∞
                               yi |zi , {θj }j=1 ∼ F (θz⋆i ),

where GEM(·) denotes a stick-breaking construction. Note that the parameters θi
in the model (7) take on values θj⋆ with probability πj . Each value θj⋆ deﬁnes a
state of the system, and zi speciﬁes to which state yi belongs. The variable zi is
also known as state variable.

                 Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

238           Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


   Posterior inference of the DPMM is typically carried out using either the
representation of the DP as a Pólya urn (Blackwell & MacQueen, 1973), or
the Blocked Gibbs Sampler (BGS) (Ishwaran & James, 2001), which is based
on approximations of the DP by K ﬁnite mixture models. The BGS avoids
marginalizing over the prior, thus allowing the prior to be directly involved in
the Gibbs sampling scheme.



2.3. Hierarchical Dirichlet Process Mixture Model

    Let (X , A) be a measurable space. The hierarchical Dirichlet process (HDP) is
a distribution over a set of random probability measures Gj over (X , A). Each Gj
is conditionally independent given G0 , with distribution Gj ∼ DP(α, G0 ), where
G0 is a global probability measure distributed as DP(γ, H0 ) (Teh et al., 2006).
Similar to the DP, the HDP can be used as the prior distribution in a mixture
model. Speciﬁcally, it splits the data into a number of groups and inside each
group the data are subdivided into subgroups; however, clusters characteristics
(parameters) are shared among groups. By deﬁning G0 as a drawn from a DP, the
HDP encourages groups to have atoms in common. The model is an immediate
extension of the DPMM known as Hierarchical Dirichlet Process Mixture Model
(HDPMM).
      The HDPMM can be represented by the conditional distributions:

              G0 |γ, H0 ∼ DP(γ, H0 )                 Gj |α, G0 ∼ DP(α, G0 )             (9a)
                θji |Gj ∼ Gj                            yji |θji ∼ F (θji ),            (9b)

where j indexes the group and i indexes the observations within a group; θji
speciﬁes the mixture component associated with the observation yji . The HDPMM
assumes that the observations are exchangeable within each group and also at the
group level. Given Gj , the θji are conditionally independent. The baseline H0
provides the prior distribution for the θji , and it can be continuous or discrete.
    Given that G0 is itself a draw from a DP, it has a stick-breaking representation
as in (6). Then, the HDP in equation (9a) can be written as

                         ∞
                         ∑                                   ∞
                                                             ∑
                  G0 =         λ k δ θk               Gj =         πjk δθk ,            (10)
                         k=1                                 k=1


where θk is the parameter of the kth mixture component; π j = {πjk }∞      k=1 and
λ = {λk }∞ k=1 are interpreted   as probability measures  on  the positive integers.
Since G0 is the baseline distribution for each Gj , and G0 places non-zero mass on
the atoms θ = {θk }∞k=1 , the atoms of Gj also come from θ. Then, the submodel j
shares the same set of mixture components, but has diﬀerent mixing proportions
π j . Given that Gj is independent given G0 , the weights π j are conditionally
independent given λ, and π j ∼ DP(α, λ) (see Teh et al., 2006 for further details).

                 Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                  239

   Let zji be mode variables, such that θji = θzji , zji ∈ {1, 2, . . .}, the HDPMM
can be represented by the following conditional distributions:
            ∞
            ∑
     G0 =         λ k δ θk                                             λ|γ ∼ GEM(γ)
            k=1
            ∑∞
     Gj =         πjk δθk                                           π j |α, λ ∼ DP(α, λ)
            k=1
                                              θk |H0 ∼ H0                                  (11)
                                              zji |π j ∼ π j
                                 yji |zji , {θk }∞
                                                 k=1 ∼ F (θzji ).


    Placing a DP prior on G0 creates a shared and unbounded support for each of
the group-speciﬁc distributions Gj . Posterior inference in the HDPMM is based in
the Pólya urn representation of the DP; Gibbs sampling algorithms are proposed
in Teh et al. (2006) and Wang & Wang (2013).


2.4. Sticky Hierarchical Dirichlet Process Mixture Model
    One limitation of the HDP prior is that does not diﬀerentiate self-transitions
from moves between diﬀerent modes; as a result, the sampling algorithms often
create redundant modes and rapidly switch among them. To address this issue,
Fox et al. (2011b) propose to augment the HDP prior to include a parameter for
self-transition bias, and place a separate prior on this parameter. Speciﬁcally, they
propose to sample transition distributions π j as follows:

                                     λ|γ ∼ GEM(γ)
                                              (                )
                                                      αλ + κδj
                             π j |α, γ, κ ∼ DP α + κ,            ,                         (12)
                                                       α+κ

where δj is a measure concentrated at j. In equation (12), an amount κ > 0,
named sticky parameter, is added to the jth component of αλ, which increases
the expected probability of self-transition by an amount proportional to κ. That
is, the expected set of weights for the transition distribution π j is given by:
                                               α        κ
                             E[πjk |λ, κ] =       λk +     δ(j, k),                        (13)
                                              α+κ      α+κ

where δ(j, k) is the Kronecker delta, such that E[πjj |λ, κ] = α+κ
                                                                α        κ
                                                                   λk + α+κ .
   The Sticky Hierarchical Dirichlet Process Mixture Model (sticky HDPMM) is
represented by model (11), replacing the prior on π j by (12).
   Two inference algorithms for the sticky HDP are presented in Fox et al. (2011b):
(1) sampling via direct assignments, which marginalizes over the inﬁnite set of
mode-speciﬁc transition distributions π k and parameters θk , and sequentially
sampling zt given all other mode assignments z−t = {z1 , . . . , zt−1 , zt+1 , . . . , zT },

                  Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

240          Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


the observations y1:T , and the global transition distribution λ. Each zt is sampled
as if the associated yt was the last observation. That is, the sampler initializes
with z1 given y1 , λ, and the hyperparameters; it then samples z2 given z1 , y1:2 ,
λ, and the hyperparameters, and so on. When a sample z1:T is completed, λ and
the hyperparameters are updated. This method is a Pólya urn Gibbs sampler that
uses a one-coordinate-at-a-time updates for the parameters, similar to the update
proposed by Escobar (1988), MacEachern (1994) and Escobar & West (1995) for
DPMM, which suﬀers from slow mixing (see Ishwaran & James, 2001 to review
several limitations of Pólya urn Gibbs sampling); (2) Blocked sampling of mode
sequence, which jointly samples the mode sequence z1:T given the observations
y1:T , the transition probabilities π k , and the parameters θk . The sampler is based
on a weak limit approximation to the DP prior on λ (Ishwaran & Zarepour, 2000;
2002a; 2002b), which induces a K-ﬁnite Dirichlet prior on π k , where K is the
chosen truncation level. The sampling of z1:T is carried out by a forward-backward
procedure that ﬁrst sample z1 from p(z1 |y1:T , π, θ), then conditioned on this value,
sample z2 from p(z2 |z1 , y1:T , π, θ), and so on (see Fox et al., 2011b for more details).


3. The Model
   We start with a hierarchical model of the class of LDSs, which relates an
observation yt 2 to a latent state vector β t through the same dynamic structure
and assumptions of model (1):

                                    β t = Aβ t−1 + et                                 (14a)
                                     yt = X t β t + w t ,                             (14b)

where the evolution error et ∼ N (0, Σt ) and the measurement error wt ∼ N (0, rt )
satisfy the same independence assumptions of model (4). The evolution matrix At
and the design matrix Xt are assumed known.
    The LDS is useful in describing data with dynamic parameters; however,
numerous of such data are structurally more complex, such that they can not be
represented by a single model, but can be well-modeled as switching between a set
of dynamic models. That is to say, the dynamic system is divided into segments,
each one modeled by a potentially diﬀerent LDS; separated segments could be
described by a single model, but adjacent segments are modeled by diﬀerent LDSs.
These switches are speciﬁed by a discrete latent variable that identiﬁes the state or
mode of the system in each segment. When the latent mode variable is a discrete-
time Markov process, the model is referred to as Switching Linear Dynamical
System (SLDS).




  2 The general normal LDS is deﬁned for a vector observation.




                 Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                         241

    In a SLDS, each mode is associated with a linear dynamic process hierarchically
as follows:
                                    zt |zt−1 ∼ π zt−1                                            (15a)
                                            (zt )         (z )
                                   β t = A β t−1 + et t                                      (15b)
                                                    (z )
                                   yt = X t β t + w t t ,                                        (15c)
where zt is a Markovian switching variable that speciﬁes which LDS is used, i.e.,
                                              (z )
the mode. Given zt , the evolution error et t |zt ∼ N (0, Σ(zt ) ) and the observational
        (zt )
error wt |zt ∼ N (0, r ) exhibit the same independence assumptions as in
                                (zt )

the LDS. The LDS and the switching process are related by the dependence
of {A(zt ) , Σ(zt ) , r(zt ) } on zt . The output at each time, yt , is determined by
stochastically choosing the continuous latent variable, β t , using the mode of the
discrete latent variable as a switch, and then emitting an observation from the
corresponding conditional output distribution.
     Similar to the inference problems in the LDS, the inference in the SLDS
involves computing the posterior distribution of β t and zt , given the data
y1:T . Nevertheless, both exact ﬁltered and smoothed inference in the SLDS are
numerically intractable, scaling exponentially with time (see Barber, 2012). Fox
et al. (2011a) propose an extension of the HDPMM of Teh et al. (2006) (described
in Section 2.3) for the SLDS, assuming the latent states are mode-speciﬁc, while the
measurement mechanism is not. That is, the β t depends on zt through both the
evolution matrix A(zt ) and the evolution error e(zt ) , while the yt is independent on
zt , such that wt ∼ N (0, r). Additionally, the measurement matrix Xt is a shared
matrix, such that for all t, Xt = C, where C contains ﬁxed intercepts. To carry
out inference, the SLDS of Fox et al. (2011a) is divided into two main components:
the HDPMM and the LDS. The former is approximated by:
         ∑
         K
  G0 =         λ k δ θk               λ|γ ∼ Dir(γ/K, . . . , γ/K)
         k=1
         ∑
         K
  Gj =         πjk δθk                π j |α, λ, κ ∼ Dir (αλ1 , . . . , αλj + κ, . . . , αλK )
         k=1
                               θk |H0 ∼ H0                                                        (16)
                              zt |zt−1 ∼ π zt−1
                                                    (z )
                          β t = A(zt ) β t−1 + et t ,

    where θk = {A(k) , Σ(k) } and K is the truncation level. As K → ∞, this model
converges in distribution to the HDPMM (when κ = 0) described in Section 2.3,
and to its sticky extension of Section 2.4 (see Ishwaran & Zarepour, 2002b; Teh
et al., 2006). The LDS component uses the state equation as a latent process
instead of being observable. Speciﬁcally,
                                                           (z )
                                   β t = A(zt ) β t−1 + et t
                                    yt = Cβ t + wt .                                              (17)


                   Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

242                Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


      Brieﬂy, the algorithm iterates as follows:

  1. Sample (β 1:T |z1:T , θk , r).

  2. Sample (z1:T |β 1:T , π k , θk ).

  3. Sample (π k |z1:T , β 1:T , y1:T ).

  4. Sample (θk , r|z1:T , β 1:T , y1:T ).

    The SDLS model is a way of modeling discontinuous changes over time in
an evolving time series. Those changes are expressed by diﬀerent values of the
state vectors β t . The discontinuity is due to the DP prior that induces clustering
at the θk values. In this paper, we propose an extension of the SLDS of Fox
et al. (2011a) to allow for dependence of yt on zt through both the design matrix
Xt , by introducing a indicator variable, and the observational error wt . The
model is based on the hypothesis that an explanatory variable can be relevant to a
time segment or mode, but may not be signiﬁcant to others, due to, for example,
unanticipated event or an event that is not present through the complete time
series. And by making the measurement noise be mode-speciﬁc, we allow the
variance to change across modes.
   The proposed hierarchical model is summarized in equations (18a)-(18d). The
model has a level for the indicator variable γj , which includes or omits the jth
predictor in the observation equation as described below.

                                  zt |zt−1 ∼ π zt−1                                          (18a)
                                      (z )
                                     γj t ∼ Be(1, pj )                                       (18b)
                                                                (z )
                                       β t = A(zt ) β t−1 + et t                              (18c)
                                                (z )′       (z )
                                         yt = X t t β t + w t t ,                            (18d)

           (z )′         (z )        (z )             (k)                           (k)
where Xt t = {1γ1 t xt1 · · · γp t xtp } and γj             = {0, 1}, such that if γj     = 1, then
                                                                       (k)
the jth predictor xtj is included in the model, and it is excluded if γj = 0. All of
the other parameters are deﬁned in equation (15a)-(15c). This model, which we
named VS-SLDS, allows us to describe changing relationships between variables
as time evolves, an useful issue in practical applications due to the dynamic nature
of the time series.
   To carry out inference, we proceed by dividing the model in two main
components, similar to Fox et al. (2011a). We sample the probability measures
{λ, π k } and the hyperparameters {α, κ, γ} involved in model (16) as in Fox et al.
(2011b). As proposed by Fox et al. (2011a), we consider the Automatic Relevance
Determination (ARD) prior on the dynamic matrix A(k) , an inverse-Wishart (IW)
on Σ(k) , and an inverse-Gamma (IG) on the measurement noise r(k) . We block-
sample the mode and state sequences by using a variant of the forward-backward
algorithm. Blocked samplers (Ishwaran & James, 2001) are based on truncated
approximations of the DP. They are straightforward to code and tend to have

                     Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                              243

better mixing rate than marginal samplers. However, we block-sample the mode
sequence by working on a marginal model. Speciﬁcally, we use the predictive
distribution of the observations, which involves integration over the state sequence.
By using standard results about the multivariate Gaussian distribution (see Section
2.1), we know the predictive distribution is Gaussian, so that it suﬃces to compute
the moments by directly applying laws of the iterated expectation:
                                                                    (z       )′
         E(yt+1 |y1:t , θ) = E(E(yt+1 |β t+1 , θ)|y1:t ) = Xt+1
                                                              t+1
                                                                  E(β t+1 |y1:t , θ)
                                  (z
                                 t+1   )′
                            = Xt+1   ft,t+1                                                         (19a)
      Var(yt+1 |y1:t , θ) = Var(E(yt+1 |β t+1 , θ)|y1:t ) + E(Var(yt+1 |β t+1 , θ)|y1:t )
                                  (z   )′                         (z     )
                                 t+1
                            = Xt+1   Var(β t+1 |y1:t , θ)Xt+1
                                                            t+1
                                                                + E(r(zt+1 ) |y1:t )
                                  (z   )′           (z    )
                                 t+1
                            = Xt+1             t+1
                                     Ft,t+1 Xt+1   + r(zt+1 )                                       (19b)

where

                             ft,t+1 = A(zt+1 ) ftf
                             Ft,t+1 = Σ(zt+1 ) + A(zt+1 ) Ftf A(zt+1 )′ .

Note that (19a)-(19b) are analogous to the moments of the one-step-ahead
predictive distribution of the Section 2.1.1. The terms ftf , Ftf correspond to the
mean vector and the variance matrix, respectively, of the ﬁltering distribution
p(β t |y1:t , θ) (see Appendix Appendix A for details).
   The Kalman ﬁlter allows to compute the predictive and ﬁltering distributions
recursively, for t = 1, 2, . . . , T :

   1. Compute the one-step-head predictive distribution for β t given {y1:t−1 , θ},
      based on the ﬁltering distribution p(β t−1 |y1:t−1 , θ).
   2. Compute the one-step-head predictive distribution p(yt |y1:t−1 , θ).
   3. Compute the ﬁltering distribution p(β t |y1:t , θ) with p(β t |y1:t−1 , θ) as the
      prior distribution and the likelihood p(yt |β t , ).

   We propose using the predictive distribution p(yt |y1:t−1 , θ) directly in inference
about the mode sequence. As described in Section 2.4, we use a truncated
approximation of the sticky HDP, and then sample forwards in time each zt from

             p(zt |zt−1 , y1:T , π, θ) ∝ p(zt |πzt−1 )p(yt |y1:t−1 , zt , θ)mt+1,t (zt ),

where,
                          {∑
                                zt p(zt |πzt−1 )p(yt |y1:t−1 , zt , θ)mt+1,t (zt )     t≤T
     mt,t−1 (zt−1 ) ∝
                            1                                                          t = T + 1.

Conditioned on the mode sequence z1:T , the observations y1:T , and the dynamic
parameters θ, we recursively sample each β t as in Fox et al. (2011a) from

  p(β t |β t−1 , z1:T , y1:T , θ) ∝ p(β t |β t−1 , zt , θ)p(yt |β t , zt , θ)p(yt+1:T |β t , zt+1:T , θ).

                   Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

244                Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


The zt and β t conditional distributions are based on the conditional independence
assumption of the model.         Explicit details on deriving these conditional
distributions are given in appendices Appendix B.1 and Appendix B.2. Another
sample scheme based on marginalizing the state sequence is proposed by Fox et al.
(2011a). This sampler is implemented by sequentially sampling z1:T . Although this
sampler is computationally intensive, periodically interleaving it with the blocked
sampler improve mixing.
                                       (k)
   Finally, we sample γj using the variable selection method of Kuo & Mallick
(1998). Before describing the sampling scheme, we have to make the following
precisions:

         (k)
  1. γj        is determined by the measurements whose mode is k.

  2. The index k speciﬁes that the inclusion of the jth predictor is mode-speciﬁc.
         (k)
  3. γj , j = 1, . . . , p, are chosen independently, each with Bernoulli prior
     distribution, Be(pj ), where p + 1 is the size of state vector, and pj is the
     probability to include the jth predictor.

  4. We let the intercept term be always included, such that there are 2p possible
                       (k)
     submodels, and γ0 = 1 for all k.

      Additionally, we use the following notation:
                 (z )              (z )
               ϑtj t = βtj γj t ,                j = 0, 1, . . . , p;     t = 1, . . . , T,
               ϑt t = (ϑt0t , ϑt1t , . . . , ϑtpt )′ = (βt0 , βt1 γ1 t , . . . , βtp γp(zt ) )′ .
                (z )    (z )   (z )           (z )                 (z )



      The equation (18d) can then be written as:

                                                  yt = Xt′ ϑt t + wt t .
                                                                (z )          (z )


                                                                                              (k)
      Based on Kuo & Mallick (1998), we sample variates γj , j = 1, . . . , p, in
                                       (k)                (k)      (k)         (k)      (k)
random order from Be(p̃j ), with p̃j                            = cj /(cj            + dj ), where

                                      1      {
                                             ∑                         }
                    (k)          (k)                        ′ (zt )∗ 2
                   cj     = pj exp               − (y t − X  ϑ
                                                            t t     )    ,                                 (20a)
                                    2r(k) t : z =k
                                               t
                                     {        1     ∑                        }
                                                          (yt − Xt′ ϑt t )2 ,
                    (k)       (k)                                     (z )∗∗
                   dj = (1 − pj ) exp − (k)                                                                (20b)
                                          2r t : z =k
                                                                          t


           (z )∗          (z )               (z )                       (z )∗∗         (z )         (z )
where ϑt t is ϑt t with γj t = 1, and ϑt t            is ϑt t with γj t = 0. When
{t : zt = k} = {∅}, the update is given by the prior distribution. The sampling
                                              (k)                  (z )
algorithm uses the vector Xt to update γj , and it uses Xt t to update β t .
Given an initial set {π, λ, θ, z1:T } and after initialization of the parameters, our
Algorithm alternates through the following steps:

                        Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                                      245

  1. For each t = {T, . . . , 1}, sequentially sample zt as in Fox et al. (2011a).
                                            (z )′      (z )                                    (z )′
  2. Starting with FTb = r(z1T ) XT T XT T and fTb = r(z1T ) XT T yT , for each
     t = {T − 1, . . . , 1}, compute Ftb , ftb as follows:
                                       1    (z )′ (z )    −1
                               Ftb =       X t Xt t + Ft+1,t
                                     r(zt ) t
                                       1    (z )′      −1
                                ftb = (z ) Xt t yt + Ft+1,t ft+1,t ,
                                     r t
     where
                        ′       −1                      ′           −1              −1                 −1
         −1
        Ft,t−1 = A(zt ) Σ(zt ) A(zt ) − A(zt ) Σ(zt ) (Σ(zt )                            + Ftb )−1 Σ(zt ) A(zt )
                                   −1                         ′          −1
         ft,t−1 = Ft,t−1 (Σ(zt )         + Ftb )−1 A(zt ) Σ(zt ) ftb .

  3. For each t = {1, . . . , T }, sample β t :
                                       (            )
                               β t ∼ N µ β t , Σβ t
                                     (     −1         )−1
                             Σβt = Σ(zt ) + Ftb
                                         (      −1
                                                                )
                             µβt = Σβt Σ(zt ) A(zt ) β t−1 + ftb .

  4. Starting with with f0f = 0 and F0f = I, for each t = 1, . . . , T compute:
                                             f
                            ft−1,t = A(zt ) ft−1
                                                      f
                            Ft−1,t = Σ(zt ) + A(zt ) Ft−1 A(zt )′
                                        ( 1                              )
                                                (z )′        −1
                               ftf = Ftf zt Xt t yt + Ft−1,t      ft−1,t
                                           r
                                     ( 1                            )−1
                                 f            (z )′ (z )        −1
                               Ft = (z ) Xt t Xt t + Ft−1,t              .
                                       r t

  5. Backward. For each t in {T, . . . , 1} and each k in {1, . . . , K}, compute
     mt,t−1 (k) starting with mT +1,T (k) = 1 for all k:

                                             ∑
                                             K
                                                                  (j)         (j)
                        mt,t−1 (k) =               πkj N (ãt , Q̃t )mt+1,t (j),
                                             j=1

     where
                                     (j)        (j)′
                                   ãt     = Xt        ft−1,t
                                   (j)  (j)′      (j)
                                 Q̃t = Xt Ft−1,t Xt + r(j) .

  6. Forward. For each t in {1, . . . , T }:
       a) Compute for each k in {1, . . . , K}:
                                                            (k)         (k)
                                     fk (yt ) = N (ãt , Q̃t )mt+1,t (k).

                Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

246          Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


       b) Sample zt from:
                                           ∑
                                           K
                                    zt ∼         πzt−1 (k)fk (yt )δ(zt , k).
                                           k=1

  7. Update {λ, π} as in Fox et al. (2011b), and θ as in Fox et al. (2011a).
  8. For each k in {1, . . . , K} and j = 1, . . . , p, if {t : zt = k} = {∅}, then sample
      (k)
     γj from B(pj ), with pj the prior belief about the jth predictor. Else,
                (k)           (k)            (k)        (k)    (k)     (k)     (k)        (k)
      sample γj from B(p̃j ), with pj = cj /(cj + dj ), where cj                     and dj
      are computed as in equation (20a) and (20b), respectively.


4. Simulation
    In this section we analyze three synthetic datasets to highlight the versatility
of the model proposed in the previous section. Each dataset is used to evaluate
one of three scenarios. For the ﬁrst and second scenarios, T = 500 data were
generated from a two-mode SLDS with the following parameters:

  1. The evolution matrices A(k) , k = 1, 2, were set as
                                                                
                          0.85 0 0                  0.85  0    0
                 A(1) =  0    1 0 ; A(2) =  0         0.65  0 
                            0  0 1                    0   0   0.65

  2. The covariance matrices Σ(k) , k = 1, 2, were drawn from the prior
                           (k)                     (1)           (2)
     distribution IW(n0 , S0 ), where n0 = p + 2, S0 = Ip , and S0 = 2Ip .
  3. The measurement noise precision 1/r(k) was drawn from a Gam(ar , br ) prior,
     with ar = 1 (shape parameter) and br = 2 (scale parameter).
  4. The ﬁrst scenario has the same number of observations per mode; each
     mode is observed in 2 non-adjacent subintervals of the same size. The mode
     sequence z1:T was set as
                       {
                         1    for t ∈ [1, 125] and t ∈ [251, 375]
                  zt =
                         2    for t ∈ [126, 250] and t ∈ [376, 500].

      The second scenario has diﬀerent number of observations per mode. The
      mode sequence z1:T was drawn randomly from the prior distribution with
      large probability of self-transition. That is to say, zt ∼ π zt−1 , t = 1, . . . , T ,
      where π j = [πj1 πj2 ], j = 1, 2, with πjj = 0.95.
  5. The vectors of indicator variables were set as
                                           γ (1) = (1, 0, 1)
                                           γ (2) = (1, 1, 0),


                Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                   247

     where the ﬁrst element of each vector is associated with the intercept, and
     the other elements are associated with explanatory variables.

   For the third scenario, T = 600 data were generated from a three-mode SLDS
with the following parameters:

  1. The evolution matrices A(k) , k = 1, 2, 3, were set as
                   [        ]        [             ]        [             ]
           (1)     0.85 0        (2)   0.85    0        (3)   0.85    0
       A         =            ; A =                  ; A =                  ;
                    0   1I3             0   0.65I3             0   0.85I3


  2. The covariance matrices Σ(k) , k = 1, 2, were drawn from the prior
                           (k)                   (1)  (3)            (2)
     distribution IW(n0 , S0 ), where n0 = p+2, S0 = S0 = 2Ip , and S0 = Ip .

  3. The measurement noise precision 1/r(k) was drawn from a Gam(ar , br ) prior,
     with ar = 1 (shape parameter) and br = 2 (scale parameter).

  4. Each mode has the same number of observations, and is observed in one
     subinterval on the whole series.
                 (k)
  5. Each γj , k = 1, 2, 3; j = 1, 2, 3, was drawn from a Be(1, p), with
     p ∼ U (0, 1). The resulting vectors of indicator variables are

                                              γ (1) = (1, 0, 1, 1)
                                              γ (2) = (1, 0, 0, 1)
                                              γ (3) = (1, 1, 1, 0)

   The measurements for the three scenarios were simulated as follows:

  1. The design matrix is build such that, for each t = 1, . . . , T and j = 1, . . . , p:

                                  xtj = υxt−1,j + htj ,      htj ∼ N(0, 1)
                                  x0j = 0 ∀j,

     where υ = 1 for scenario 1, and υ = 0.9 for scenarios 2 and 3. This choice
     of predictors as correlated adjacent points is due to the dynamic nature of
     the time series exhibiting dependence or time correlations between adjacent
     points in time.

  2. For each t = 1, . . . , T , β t and yt satisfy the following set of equations:

                  β t = A(zt ) β t−1 + et ,                   et ∼ N(0, Σ(zt ) ), β 0 = 0
                         ∑
                         p
                                   (z )
                  yt =         βtj γj t xtj + wt ,           wt ∼ N(0, r(zt ) ), xt0 = 1.
                         j=0


                   Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

248          Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


    We employ the algorithm described in the previous section to investigate the
accuracy of the model (18a)-(18d) in its ability to infer the simulated segmentation
and model ﬁtting. We use a truncation level of K = 30, an ARD prior distribution
on A(k) , IW prior on Σ(k) , and IG prior on r(k) , with the following initial values
for the hyperparameters for each k = 1, . . . , K:

                                          (k)
   1. We place independent N (0, 1/αj Ip ) priors on the columns of the matrix
                     (k)                                   (k)
      A(k) , where αj      ∼ Gam(1, 0.01), such that E(αj ) = 100.


   2. We place a IW(p + 2, 0.1Ip ) prior on Σ(k) .

   3. We place a Gam(1, 0.1) prior on precision 1/r(k) , such that E(1/r(k) ) = 10.

                                                                            (k)
The vectors of indicator variables are initialized with the full model γj = 1 for all
j, and an equal probability of transition, 1/K, to each mode. The hyperparameters
{α, κ, γ} were set as in Fox et al. (2011b). All results are based on 15,000 iterations,
obtained after a burn-in period of 5,000 samples.



4.1. Scenario 1

    In Figure 1(a)-1(b) we show the slope components of the state vector ﬁtted
by our model (dash lines) along with the simulated points (continuous lines). As
expected, the estimated sequences closely approximate the simulated ones in the
intervals in which the explanatory variable is signiﬁcant. This fact is clearer in
Figure 1(c)-1(d), in which we show the simulated slope components (continuous
                                                              (z )
lines) along with the corresponding posterior components of ϑt t (dash lines). We
see that the VS-SLDS is able to correctly identify the signiﬁcant variables.
    We display in Figure 2(a) the simulated data sequence (continuous line) and
the ﬁtted curve (dash line). Although it is well-known that a model that overﬁts
the data typically leads to poor prediction performance, currently we are mainly
interested in inferring about the number of dynamical modes and verifying if it
correctly identiﬁes the membership of the observations in each mode. However, we
have to face the issue of summarizing the results from the posterior distribution
over modes. The so-called label switching problem, used by Redner & Walker
(1984) to describe the invariance of the likelihood under relabelling of the mixture
components, makes it diﬃcult to estimate quantities of interest by their posterior
mean (see Stephens, 2000 for more details about this issue). In order to show the
capability of the model to identify the correct grouping of observations, we display
the posterior probability of a mode switching for each t in Figure 2(b). We can
see that the higher probabilities match with sequence changes. Additionally, we
display the number of modes to which at least 30% of observations are assigned
(Figure 3); we can see that the observations are mainly clustered into 2 groups.

                Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                                                                                                                                                                                                                                                                                                                                                                                                        249




                       6




                                                                                                                                                                                                                                                                                        16
                                                                       simulated sequence
                                                                       fitted sequence                                                                                                                                                                                                                                                                                               simulated sequence
                                                                                                                                                                                                                                                                                                                                                                                     fitted sequence




                                                                                                                                                                                                                                                                                        13
                       3




                                                                                                                                                                                                                                                                                        10
                       0




                                                                                                                                                                                                                                                                                        7
       β1




                                                                                                                                                                                                                                                                                        4
                                                                                                                                                                                                                                                                        β2
                       -3




                                                                                                                                                                                                                                                                                        1
                       -6




                                                                                                                                                                                                                                                                                        -2
                                                                                                                                                                                                                                                                                        -5
                       -9




                                                                                                                                                                                                                                                                                        -8
                                 0
                                     20
                                              40
                                                    60
                                                             80
                                                                   100
                                                                             120
                                                                                     140
                                                                                               160
                                                                                                       180
                                                                                                                 200
                                                                                                                         220
                                                                                                                                   240
                                                                                                                                           260
                                                                                                                                                     280
                                                                                                                                                             300
                                                                                                                                                                       320
                                                                                                                                                                               340
                                                                                                                                                                                         360
                                                                                                                                                                                                 380
                                                                                                                                                                                                           400
                                                                                                                                                                                                                   420
                                                                                                                                                                                                                             440
                                                                                                                                                                                                                                     460
                                                                                                                                                                                                                                               480
                                                                                                                                                                                                                                                       500




                                                                                                                                                                                                                                                                                                 0
                                                                                                                                                                                                                                                                                                       20
                                                                                                                                                                                                                                                                                                             40
                                                                                                                                                                                                                                                                                                                   60
                                                                                                                                                                                                                                                                                                                         80
                                                                                                                                                                                                                                                                                                                               100
                                                                                                                                                                                                                                                                                                                                      120
                                                                                                                                                                                                                                                                                                                                             140
                                                                                                                                                                                                                                                                                                                                                    160
                                                                                                                                                                                                                                                                                                                                                           180
                                                                                                                                                                                                                                                                                                                                                                  200
                                                                                                                                                                                                                                                                                                                                                                         220
                                                                                                                                                                                                                                                                                                                                                                                240
                                                                                                                                                                                                                                                                                                                                                                                       260
                                                                                                                                                                                                                                                                                                                                                                                              280
                                                                                                                                                                                                                                                                                                                                                                                                     300
                                                                                                                                                                                                                                                                                                                                                                                                            320
                                                                                                                                                                                                                                                                                                                                                                                                                   340
                                                                                                                                                                                                                                                                                                                                                                                                                          360
                                                                                                                                                                                                                                                                                                                                                                                                                                 380
                                                                                                                                                                                                                                                                                                                                                                                                                                        400
                                                                                                                                                                                                                                                                                                                                                                                                                                               420
                                                                                                                                                                                                                                                                                                                                                                                                                                                      440
                                                                                                                                                                                                                                                                                                                                                                                                                                                             460
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    480
                                                                                                                                                                                                                                                                                                                                                                                                                                                                           500
                                                                                                                               Time
                                                                                                                                                                                                                                                                                                                                                                               Time


                                                                                                                 (a)                                                                                                                                                                                                                                        (b)




                                                                                                                                                                                                                                                                                  16
                            6




                                                                                                                                                                                                                                                                                                                                                                              secuencia simulada
                                                                             secuencia simulada                                                                                                                                                                                                                                                                               secuencia ajustada




                                                                                                                                                                                                                                                                                  13
                                                                             secuencia ajustada
                            3




                                                                                                                                                                                                                                                                                  10
                                                                                                                                                                                                                                                                                  7
                            0




                                                                                                                                                                                                                                                                                  4
                                                                                                                                                                                                                                                                   β2
            β1


                            -3




                                                                                                                                                                                                                                                                                  1
                            -6




                                                                                                                                                                                                                                                                                  -2
                                                                                                                                                                                                                                                                                  -5
                            -9




                                                                                                                                                                                                                                                                                  -8


                                                                                                                                                                                                                                                                                             0
                                                                                                                                                                                                                                                                                                 20
                                                                                                                                                                                                                                                                                                      40
                                                                                                                                                                                                                                                                                                            60
                                                                                                                                                                                                                                                                                                                  80
                                                                                                                                                                                                                                                                                                                        100
                                                                                                                                                                                                                                                                                                                               120
                                                                                                                                                                                                                                                                                                                                      140
                                                                                                                                                                                                                                                                                                                                             160
                                                                                                                                                                                                                                                                                                                                                    180
                                                                                                                                                                                                                                                                                                                                                           200
                                                                                                                                                                                                                                                                                                                                                                  220
                                                                                                                                                                                                                                                                                                                                                                         240
                                                                                                                                                                                                                                                                                                                                                                                260
                                                                                                                                                                                                                                                                                                                                                                                       280
                                                                                                                                                                                                                                                                                                                                                                                              300
                                                                                                                                                                                                                                                                                                                                                                                                     320
                                                                                                                                                                                                                                                                                                                                                                                                            340
                                                                                                                                                                                                                                                                                                                                                                                                                   360
                                                                                                                                                                                                                                                                                                                                                                                                                          380
                                                                                                                                                                                                                                                                                                                                                                                                                                 400
                                                                                                                                                                                                                                                                                                                                                                                                                                        420
                                                                                                                                                                                                                                                                                                                                                                                                                                               440
                                                                                                                                                                                                                                                                                                                                                                                                                                                      460
                                                                                                                                                                                                                                                                                                                                                                                                                                                             480
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    500
                                     0
                                          20
                                                   40
                                                         60
                                                                  80
                                                                         100
                                                                                   120
                                                                                           140
                                                                                                     160
                                                                                                             180
                                                                                                                       200
                                                                                                                               220
                                                                                                                                         240
                                                                                                                                                 260
                                                                                                                                                           280
                                                                                                                                                                   300
                                                                                                                                                                             320
                                                                                                                                                                                     340
                                                                                                                                                                                               360
                                                                                                                                                                                                       380
                                                                                                                                                                                                                 400
                                                                                                                                                                                                                         420
                                                                                                                                                                                                                                   440
                                                                                                                                                                                                                                           460
                                                                                                                                                                                                                                                     480
                                                                                                                                                                                                                                                             500




                                                                                                                                     Time                                                                                                                                                                                                                               Time


                                                                                                                 (c)                                                                                                                                                                                                                                     (d)
                                                                                                                                                                                                                                                                                                                                                                              (z )                                                                                  (z )
      Figure 1: Scenario 1. (a) βt1 , β̂t1 ; (b) βt2 , β̂t2 ; (c) βt1 , ϑ̂t1t ; (d) βt2 , ϑ̂t2t .
                                                                                                                                                                                                                                                                                       1.0
                        70




                                                                                                                                                                                                                                                                                                                                                           estimated probability of a change point
                                                                                           y
                                                                                                                                                                                                                                                                                                                                                           mode sequence
                                                                                           y^
                                                                                                                                                                                                                                                                                       0.9
                                                                                                                                                                                                                                                                                       0.8
                        30




                                                                                                                                                                                                                                                                                       0.7
                        -10




                                                                                                                                                                                                                                                                                       0.6
        Observations




                                                                                                                                                                                                                                                                    Probability

                                                                                                                                                                                                                                                                                       0.5
                        -50




                                                                                                                                                                                                                                                                                       0.4
                                                                                                                                                                                                                                                                                       0.3
                        -90




                                                                                                                                                                                                                                                                                       0.2
                                                                                                                                                                                                                                                                                       0.1
                        -130




                                                                                                                                                                                                                                                                                       0.0
                                 0
                                         20
                                               40
                                                        60
                                                              80
                                                                       100
                                                                               120
                                                                                         140
                                                                                                 160
                                                                                                           180
                                                                                                                   200
                                                                                                                             220
                                                                                                                                     240
                                                                                                                                               260
                                                                                                                                                       280
                                                                                                                                                                 300
                                                                                                                                                                         320
                                                                                                                                                                                   340
                                                                                                                                                                                           360
                                                                                                                                                                                                     380
                                                                                                                                                                                                             400
                                                                                                                                                                                                                       420
                                                                                                                                                                                                                               440
                                                                                                                                                                                                                                         460
                                                                                                                                                                                                                                                 480
                                                                                                                                                                                                                                                           500




                                                                                                                                                                                                                                                                                                 0
                                                                                                                                                                                                                                                                                                      20
                                                                                                                                                                                                                                                                                                            40
                                                                                                                                                                                                                                                                                                                  60
                                                                                                                                                                                                                                                                                                                        80
                                                                                                                                                                                                                                                                                                                              100
                                                                                                                                                                                                                                                                                                                                     120
                                                                                                                                                                                                                                                                                                                                            140
                                                                                                                                                                                                                                                                                                                                                   160
                                                                                                                                                                                                                                                                                                                                                          180
                                                                                                                                                                                                                                                                                                                                                                 200
                                                                                                                                                                                                                                                                                                                                                                        220
                                                                                                                                                                                                                                                                                                                                                                               240
                                                                                                                                                                                                                                                                                                                                                                                      260
                                                                                                                                                                                                                                                                                                                                                                                             280
                                                                                                                                                                                                                                                                                                                                                                                                    300
                                                                                                                                                                                                                                                                                                                                                                                                           320
                                                                                                                                                                                                                                                                                                                                                                                                                  340
                                                                                                                                                                                                                                                                                                                                                                                                                         360
                                                                                                                                                                                                                                                                                                                                                                                                                                380
                                                                                                                                                                                                                                                                                                                                                                                                                                       400
                                                                                                                                                                                                                                                                                                                                                                                                                                              420
                                                                                                                                                                                                                                                                                                                                                                                                                                                     440
                                                                                                                                                                                                                                                                                                                                                                                                                                                            460
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   480
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          500




                                                                                                                                   Time                                                                                                                                                                                                                                       Time


                                                                                                             (a)                                                                                                                                                                                                                                         (b)

Figure 2: Scenario 1. (a) Simulated and ﬁtted sequences (ŷt = Xt′ ϑ̂t , t = 1, . . . , 500);
          (b) mode sequence and estimated probability of a change point for each t.




                                                        Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

250         Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado




                          3
                          2
                  Modes

                          1
                          0


                              5001
                                     5500
                                            6000
                                                   6500
                                                          7000
                                                                 7500
                                                                        8000
                                                                               8500
                                                                                      9000
                                                                                             9500
                                                                                                    10000
                                                                                                            10500
                                                                                                                    11000
                                                                                                                            11500
                                                                                                                                    12000
                                                                                                                                            12500
                                                                                                                                                    13000
                                                                                                                                                            13500
                                                                                                                                                                    14000
                                                                                                                                                                            14500
                                                                                                                                                                                    15000
                                                                                                                                                                                            15500
                                                                                                                                                                                                    16000
                                                                                                                                                                                                            16500
                                                                                                                                                                                                                    17000
                                                                                                                                                                                                                            17500
                                                                                                                                                                                                                                    18000
                                                                                                                                                                                                                                            18500
                                                                                                                                                                                                                                                    19000
                                                                                                                                                                                                                                                            19500
                                                                                                                                                                                                                                                                    20000
                                                                                                                              Iteration

                          Figure 3: Scenario 1. Signiﬁcant modes.



4.2. Scenario 2
    The plots of Figure 4 show that the model is able to identify the relevant
variables on each mode even if the mode has few data. We include the simulated
mode sequence (dotted black line) in Figures 4(c) and 4(d) in order to provide
a better understanding. We can see that the model has a good performance to
identify the correct explanatory variables for each mode even with lower temporal
mode persistence (Figures 4(c)-4(d)). This result is due to that the higher
probabilities of a change point match with the true changes in the mode sequence
(Figure 5(a)). Consequently, the data are mainly clustered into two modes (Figure
6), and the ﬁtted values are accurate (Figure 5(b)).


4.3. Scenario 3
    The results depicted in Figure 7 conﬁrm good performance of the VS-SLDS
to identify the signiﬁcant variables on data generated from a model with three
modes. The simulated slope components of the state vector are compared with
                                                                              (z )
the ﬁtted ones (left panel), and with the corresponding ﬁtted components ϑ̂tj t
(right panel), which is zero in the interval where the predictor is simulated not
signiﬁcant.
    We display in Figure 8 the number of modes to which at least 25% of
observations are assigned. Around 82% of iterations the data are clustered into
three groups. We show in Figure 9(b) the estimated probability of a change point
for each t. We notice that two change points with high probability divide the
sequence into three sections. In real data without a priori knowledge of the number
of modes, the probability of a change point does not give complete information
by itself. By looking at the number of modes to which a signiﬁcant number of

               Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                                                                                                                                                                                                                                                          251

observations are assigned, the estimated sequence of z1:T , and the change point
probabilities, we are able to infer the number of modes and where the mode changes
originate. In Figure 9(b) we include the mode sequence of the iteration 161003
to have an idea about the estimated sequence. We display in Figure 9(a) the
simulated and ﬁtted data sequences.
        12




                                                                                       simulated sequence
                                                                                       fitted sequence                                                                                                            simulated sequence
        10




                                                                                                                                                                        6
                                                                                                                                                                                                                  fitted sequence
        8




                                                                                                                                                                        4
        6
        4




                                                                                                                                                                        2
   β1




                                                                                                                                                                   β2
        2
        0




                                                                                                                                                                        0
        -2
        -4




                                                                                                                                                                        -2
        -6
        -8




                                                                                                                                                                        -4
             0
                 20
                      40
                           60
                                80
                                     100
                                           120
                                                 140
                                                       160
                                                             180
                                                                   200
                                                                         220
                                                                               240
                                                                                     260
                                                                                           280
                                                                                                 300
                                                                                                       320
                                                                                                             340
                                                                                                                   360
                                                                                                                         380
                                                                                                                               400
                                                                                                                                     420
                                                                                                                                           440
                                                                                                                                                 460
                                                                                                                                                       480
                                                                                                                                                             500




                                                                                                                                                                             0
                                                                                                                                                                                 20
                                                                                                                                                                                      40
                                                                                                                                                                                           60
                                                                                                                                                                                                80
                                                                                                                                                                                                     100
                                                                                                                                                                                                           120
                                                                                                                                                                                                                 140
                                                                                                                                                                                                                       160
                                                                                                                                                                                                                             180
                                                                                                                                                                                                                                   200
                                                                                                                                                                                                                                         220
                                                                                                                                                                                                                                               240
                                                                                                                                                                                                                                                     260
                                                                                                                                                                                                                                                           280
                                                                                                                                                                                                                                                                 300
                                                                                                                                                                                                                                                                       320
                                                                                                                                                                                                                                                                             340
                                                                                                                                                                                                                                                                                   360
                                                                                                                                                                                                                                                                                         380
                                                                                                                                                                                                                                                                                               400
                                                                                                                                                                                                                                                                                                     420
                                                                                                                                                                                                                                                                                                           440
                                                                                                                                                                                                                                                                                                                 460
                                                                                                                                                                                                                                                                                                                       480
                                                                                                                                                                                                                                                                                                                             500
                                                                               Time                                                                                                                                                            Time


                                                               (a)                                                                                                                                                             (b)
        12




                                                                                      simulated sequence                                                                                                          simulated sequence
                                                                                                                                                                        6




                                                                                      fitted sequence                                                                                                             fitted sequence
        10
        8




                                                                                                                                                                        4
        6
        4




                                                                                                                                                                        2
                                                                                                                                                                   β2
   β1


        2
        0




                                                                                                                                                                        0
        -2
        -4




                                                                                                                                                                        -2
        -6




                                                                                                                                                                        -4
        -8




                                                                                                                                                                             0
                                                                                                                                                                                 20
                                                                                                                                                                                      40
                                                                                                                                                                                           60
                                                                                                                                                                                                80
                                                                                                                                                                                                     100
                                                                                                                                                                                                           120
                                                                                                                                                                                                                 140
                                                                                                                                                                                                                       160
                                                                                                                                                                                                                             180
                                                                                                                                                                                                                                   200
                                                                                                                                                                                                                                         220
                                                                                                                                                                                                                                               240
                                                                                                                                                                                                                                                     260
                                                                                                                                                                                                                                                           280
                                                                                                                                                                                                                                                                 300
                                                                                                                                                                                                                                                                       320
                                                                                                                                                                                                                                                                             340
                                                                                                                                                                                                                                                                                   360
                                                                                                                                                                                                                                                                                         380
                                                                                                                                                                                                                                                                                               400
                                                                                                                                                                                                                                                                                                     420
                                                                                                                                                                                                                                                                                                           440
                                                                                                                                                                                                                                                                                                                 460
                                                                                                                                                                                                                                                                                                                       480
                                                                                                                                                                                                                                                                                                                             500
             0
                 20
                      40
                           60
                                80
                                     100
                                           120
                                                 140
                                                       160
                                                             180
                                                                   200
                                                                         220
                                                                               240
                                                                                     260
                                                                                           280
                                                                                                 300
                                                                                                       320
                                                                                                             340
                                                                                                                   360
                                                                                                                         380
                                                                                                                               400
                                                                                                                                     420
                                                                                                                                           440
                                                                                                                                                 460
                                                                                                                                                       480
                                                                                                                                                             500




                                                                               Time                                                                                                                                                            Time


                                                               (c)                                                                                                                                                                 (d)
                                                                                                                                                                                                                                     (z )                                                             (z )
        Figure 4: Scenario 2. (a) βt1 , β̂t1 ; (b) βt2 , β̂t2 ; (c) βt1 , ϑ̂t1t ; (d) βt2 , ϑ̂t2t .




  3 We randomly chosen a mode sequence after of the iteration 5000.




                                           Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

252                                          Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado




               140




                                                                                                                                                                                                                                1.0
                                              y
                                              y^
               120



                                                                                                                                                                                                                                                                                                                                        estimated probability of a change point




                                                                                                                                                                                                                                0.9
                                                                                                                                                                                                                                                                                                                                        mode sequence
               100




                                                                                                                                                                                                                                0.8
               80




                                                                                                                                                                                                                                0.7
               60




                                                                                                                                                                                                                                0.6
Observations




                                                                                                                                                                                                         Probability
               40




                                                                                                                                                                                                                                0.5
               20




                                                                                                                                                                                                                                0.4
               0




                                                                                                                                                                                                                                0.3
               -20




                                                                                                                                                                                                                                0.2
               -40




                                                                                                                                                                                                                                0.1
               -60
               -80




                                                                                                                                                                                                                                0.0
                     0
                         20
                              40
                                   60
                                        80
                                             100
                                                   120
                                                         140
                                                               160
                                                                       180
                                                                             200
                                                                                   220
                                                                                         240
                                                                                               260
                                                                                                     280
                                                                                                           300
                                                                                                                  320
                                                                                                                         340
                                                                                                                                360
                                                                                                                                       380
                                                                                                                                              400
                                                                                                                                                     420
                                                                                                                                                            440
                                                                                                                                                                   460
                                                                                                                                                                          480
                                                                                                                                                                                 500




                                                                                                                                                                                                                                                0
                                                                                                                                                                                                                                                        20
                                                                                                                                                                                                                                                               40
                                                                                                                                                                                                                                                                       60
                                                                                                                                                                                                                                                                               80
                                                                                                                                                                                                                                                                                       100
                                                                                                                                                                                                                                                                                               120
                                                                                                                                                                                                                                                                                                       140
                                                                                                                                                                                                                                                                                                               160
                                                                                                                                                                                                                                                                                                                       180
                                                                                                                                                                                                                                                                                                                               200
                                                                                                                                                                                                                                                                                                                                       220
                                                                                                                                                                                                                                                                                                                                               240
                                                                                                                                                                                                                                                                                                                                                       260
                                                                                                                                                                                                                                                                                                                                                             280
                                                                                                                                                                                                                                                                                                                                                                   300
                                                                                                                                                                                                                                                                                                                                                                         320
                                                                                                                                                                                                                                                                                                                                                                               340
                                                                                                                                                                                                                                                                                                                                                                                     360
                                                                                                                                                                                                                                                                                                                                                                                           380
                                                                                                                                                                                                                                                                                                                                                                                                 400
                                                                                                                                                                                                                                                                                                                                                                                                       420
                                                                                                                                                                                                                                                                                                                                                                                                             440
                                                                                                                                                                                                                                                                                                                                                                                                                   460
                                                                                                                                                                                                                                                                                                                                                                                                                         480
                                                                                                                                                                                                                                                                                                                                                                                                                               500
                                                                                         Time                                                                                                                                                                                                                                                Time

                                                                         (a)                                                                                                                                                                                                                                            (b)

Figure 5: Scenario 2. (a) Simulated and ﬁtted sequences (ŷt = Xt′ ϑ̂t , t = 1, . . . , 500);
          (b) mode sequences and estimated probability of a change point for each t.
                                                                                   3
                                                                                   2
                                                               Modes

                                                                                   1
                                                                                   0


                                                                                                 5001
                                                                                                        5500
                                                                                                                 6000
                                                                                                                        6500
                                                                                                                               7000
                                                                                                                                      7500
                                                                                                                                             8000
                                                                                                                                                    8500
                                                                                                                                                           9000
                                                                                                                                                                  9500
                                                                                                                                                                         10000
                                                                                                                                                                                 10500
                                                                                                                                                                                         11000
                                                                                                                                                                                                 11500
                                                                                                                                                                                                            12000
                                                                                                                                                                                                                       12500
                                                                                                                                                                                                                               13000
                                                                                                                                                                                                                                       13500
                                                                                                                                                                                                                                               14000
                                                                                                                                                                                                                                                       14500
                                                                                                                                                                                                                                                               15000
                                                                                                                                                                                                                                                                       15500
                                                                                                                                                                                                                                                                               16000
                                                                                                                                                                                                                                                                                       16500
                                                                                                                                                                                                                                                                                               17000
                                                                                                                                                                                                                                                                                                       17500
                                                                                                                                                                                                                                                                                                               18000
                                                                                                                                                                                                                                                                                                                       18500
                                                                                                                                                                                                                                                                                                                               19000
                                                                                                                                                                                                                                                                                                                                       19500
                                                                                                                                                                                                                                                                                                                                               20000




                                                                                                                                                                                                   Iteration

                                                                                         Figure 6: Scenario 2. Signiﬁcant modes.




                                                         Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

                                                                                                                                                                                                           β3                                                                              β2                                                                           β1


                                                                                                                                                                                            -6   -4   -2   0    2   4                        6                      -6   -4   -2   0   2        4   6   8   10                    12                      -6   4   14   24   34   44                        54



                                                                                                                                                                                        0                                                                       0                                                                                     0
                                                                                                                                                                                       20                                                                      20                                                                                    20
                                                                                                                                                                                       40                                                                      40                                                                                    40
                                                                                                                                                                                       60                                                                      60                                                                                    60
                                                                                                                                                                                       80                                                                      80                                                                                    80
                                                                                                                                                                                      100                                                                     100                                                                                   100
                                                                                                                                                                                      120                                                                     120                                                                                   120
                                                                                                                                                                                      140                                                                     140                                                                                   140
                                                                                                                                                                                      160                                                                     160                                                                                   160
                                                                                                                                                                                      180                                                                     180                                                                                   180
                                                                                                                                                                                      200                                                                     200                                                                                   200
                                                                                                                                                                                      220                                                                     220                                                                                   220
                                                                                                                                                                                      240                                                                     240                                                                                   240
                                                                                                                                                                                      260                                                                     260                                                                                   260




                                                                                                                                                                                                                                                                                                                                       (a)




                                                                                                                                                                         (e)
                                                                                                                                                                                                                                                 (c)
                                                                                                                                                                                      280                                                                     280                                                                                   280
                                                                                                                                                                                      300                                                                     300                                                                                   300




                                                                                                                                                                                                                                                                                                                                             Time




                                                                                                                                                                                                                                                       Time




                                                                                                                                                                               Time
                                                                                                                                                                                      320                                                                     320                                                                                   320




                                                                                                                                                                                                                        fitted sequence
                                                                                                                                                                                      340                                                                     340                                                                                   340




                                                                                                                                                                                                                        simulated sequence
                                                                                                                                                                                      360                                                                     360                                                                                   360
                                                                                                                                                                                      380                                                                     380                                                                                   380
                                                                                                                                                                                                                                                                                                                                                    400
                                                                                                                                                                                                                                                                                                                                                                                       fitted sequence




                                                                                                                                                                                      400                                                                     400




                                                                                                                                                                                                                                                                                                             fitted sequence
                                                                                                                                                                                      420                                                                     420                                                                                   420
                                                                                                                                                                                                                                                                                                                                                                                       simulated sequence




                                                                                                                                                                                                                                                                                                             simulated sequence
                                                                                                                                                                                      440                                                                     440                                                                                   440
                                                                                                                                                                                      460                                                                     460                                                                                   460
                                                                                                                                                                                      480                                                                     480                                                                                   480
                                                                                                                                                                                      500                                                                     500                                                                                   500
                                                                                                                                                                                      520                                                                     520                                                                                   520
                                                                                                                                                                                      540                                                                     540                                                                                   540
                                                                                                                                                                                      560                                                                     560                                                                                   560
                                                                                                                                                                                      580                                                                     580                                                                                   580
                                                                                                                                                                                      600                                                                     600                                                                                   600




                                                                                                                       (z )
                                                                                                                                                                                                           β3                                                                              β2                                                                           β1


                                                                                                                                                                                            -6   -4   -2   0    2   4                        6                      -6   -4   -2   0   2        4   6   8   10                    12                      -6   4   14   24   34   44                        54


                                                                                                                                                                                        0                                                                       0                                                                                     0
                                                                                                                                                                                       20                                                                      20                                                                                    20
                                                                                                                                                                                       40                                                                      40                                                                                    40
                                                                                                                                                                                       60                                                                      60                                                                                    60
                                                                                                                                                                                       80                                                                      80                                                                                    80
                                                                                                                                                                                      100                                                                     100                                                                                   100
                                                                                                                                                                                      120                                                                     120                                                                                   120
                                                                                                                                                                                      140                                                                     140                                                                                   140
                                                                                                                                                                                      160                                                                     160                                                                                   160
                                                                                                                                                                                                                                                                                                                                                                                                                 Variable Selection in Switching Dynamic Regression Models




                                                                                                                                                                                      180                                                                     180                                                                                   180
                                                                                                                                                                                      200                                                                     200                                                                                   200
                                                                                                                                                                                      220                                                                     220                                                                                   220
                                                                                                                                                                                      240                                                                     240                                                                                   240
                                                                                                                                                                                      260                                                                     260                                                                                   260




                                                                                                                                                                         (f)
                                                                                                                                                                                                                                                 (d)
                                                                                                                                                                                                                                                                                                                                       (b)




                                                                                                                                                                                      280                                                                     280                                                                                   280
                                                                                                                                                                                      300                                                                     300                                                                                   300
                                                                                                                                                                                                                                                                                                                                             Time




                                                                                                                                                                               Time
                                                                                                                                                                                                                                                       Time
                                                                                                                                                                                      320                                                                     320                                                                                   320




                                                                                                                                                                                                                        fitted sequence
                                                                                                                                                                                      340                                                                     340                                                                                   340




                                                                                                                                                                                                                        simulated sequence
                                                                                                                                                                                      360                                                                     360                                                                                   360




                                                                                         (left panel) and components ϑ̂tj t (right panel), j = 1, 2, 3.
                                                                                                                                                                                      380                                                                     380                                                                                   380
                                                                                                                                                                                      400                                                                     400                                                                                   400
                                                                                                                                                                                                                                                                                                                                                                                       fitted sequence




                                                                                                                                                                                                                                                                                                             fitted sequence




                                                                                                                                                                                      420                                                                     420                                                                                   420
                                                                                                                                                                                                                                                                                                                                                                                       simulated sequence




                                                                                                                                                                                                                                                                                                             simulated sequence




                                                                                                                                                                                      440                                                                     440                                                                                   440
                                                                                                                                                                                      460                                                                     460                                                                                   460
                                                                                                                                                                                      480                                                                     480                                                                                   480
                                                                                                                                                                                      500                                                                     500                                                                                   500
                                                                                                                                                                                      520                                                                     520                                                                                   520
                                                                                                                                                                                      540                                                                     540                                                                                   540
                                                                                                                                                                                      560                                                                     560                                                                                   560
                                                                                                                                                                                      580                                                                     580                                                                                   580
                                                                                                                                                                                      600                                                                     600                                                                                   600




Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263
                                                                               Figure 7: Scenario 3. Simulated slope components of the state vector vs. ﬁtted sequence
                                                                                                                                                                                                                                                                                                                                                                                                                 253

254          Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


5. Applications
    The proposed method is on the real dataset of meteorological series of
Barranquilla, Colombia, reported by the weather station Ernesto Cortissoz.
The dataset can be downloaded from the National Centers for Environmental
Information (2021). We have selected ﬁve series in all, including relative humidity,
atmospheric pressure, visibility, wind speed and temperature. All the data are
monthly average value ranging from January 1995 to December 2020, resulting in
295 months totally (there are 17 missing values).
    In the ﬁrst instance, we consider the temperature as observations yt and all of
the rest of variables in the design matrix Xt . In other example we consider the
visibility as observations yt and all of the rest of variables in the design matrix
Xt . We assumed the hierarchical model in equations (18a)-(18d) to describe
the dynamical behavior of both observations series by employing the algorithm
described in Section 3. We use a truncation level of K = 30 and the following
settings for each k = 1, . . . , K: independent N (0, 1/α(k) Ip ) priors on the columns
of the matrix A(k) , where α(k) ∼ Gam(1, 0.01); a IW(p + 2, 0.1Ip ) prior on Σ(k) ;
a Gam(1, 0.1) prior on precision 1/r(k) . The vectors of indicator variables are
                                      (k)
initialized with the full model γj = 1 for all j, and an equal probability of
transition, 1/K, to each mode. The hyperparameters {α, κ, γ} were set as in Fox
et al. (2011b). All results are based on 30,000 iterations, obtained after a burn-in
period of 5,000 samples.
                         3
                         2
                 Modes

                         1
                         0


                              5001
                                     5500
                                            6000
                                                   6500
                                                          7000
                                                                 7500
                                                                        8000
                                                                               8500
                                                                                      9000
                                                                                             9500
                                                                                                    10000
                                                                                                            10500
                                                                                                                    11000
                                                                                                                            11500
                                                                                                                                    12000
                                                                                                                                            12500
                                                                                                                                                    13000
                                                                                                                                                            13500
                                                                                                                                                                    14000
                                                                                                                                                                            14500
                                                                                                                                                                                    15000
                                                                                                                                                                                            15500
                                                                                                                                                                                                    16000
                                                                                                                                                                                                            16500
                                                                                                                                                                                                                    17000
                                                                                                                                                                                                                            17500
                                                                                                                                                                                                                                    18000
                                                                                                                                                                                                                                            18500
                                                                                                                                                                                                                                                    19000
                                                                                                                                                                                                                                                            19500
                                                                                                                                                                                                                                                                    20000




                                                                                                                              Iteration


                             Figure 8: Scenario 3. Signiﬁcant modes.




                Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                                                                                                                                                                                                                                                                                                                      255




                                                                                                                                                                                      1.0
                                                                                                                                  1.0
                      60
                                                                    y                                                                                                                                                                                                                        estimated probability of a change point




                                                                                                                                                                                      0.9
                                                                                                                                  0.9
                      50
                                                                    y^                                                                                                                                                                                                                       mode sequence
                                                                    estimated probability of a change point                                                                                                                                                                                  mode sequence of the iteration 16100




                                                                                                                                                                                      0.8
                                                                                                                                  0.8
                      40




                                                                                                                                                                                      0.7
                                                                                                                                  0.7
                      30




                                                                                                                                                                                      0.6
                                                                                                                                  0.6
                      20
       Observations




                                                                                                                                                            Probability
                                                                                                                                        Probability




                                                                                                                                                                                      0.5
                                                                                                                                  0.5
                      10




                                                                                                                                                                                      0.4
                                                                                                                                  0.4
                      0




                                                                                                                                                                                      0.3
                      -10




                                                                                                                                  0.3




                                                                                                                                                                                      0.2
                      -20




                                                                                                                                  0.2




                                                                                                                                                                                      0.1
                      -30




                                                                                                                                  0.1




                                                                                                                                                                                      0.0
                      -40




                                                                                                                                  0.0




                                                                                                                                                                                                         0
                                                                                                                                                                                                             20
                                                                                                                                                                                                                  40
                                                                                                                                                                                                                       60
                                                                                                                                                                                                                            80
                                                                                                                                                                                                                                 100
                                                                                                                                                                                                                                       120
                                                                                                                                                                                                                                             140
                                                                                                                                                                                                                                                   160
                                                                                                                                                                                                                                                         180
                                                                                                                                                                                                                                                               200
                                                                                                                                                                                                                                                                     220
                                                                                                                                                                                                                                                                           240
                                                                                                                                                                                                                                                                                 260
                                                                                                                                                                                                                                                                                       280
                                                                                                                                                                                                                                                                                             300
                                                                                                                                                                                                                                                                                                   320
                                                                                                                                                                                                                                                                                                         340
                                                                                                                                                                                                                                                                                                               360
                                                                                                                                                                                                                                                                                                                     380
                                                                                                                                                                                                                                                                                                                            400
                                                                                                                                                                                                                                                                                                                                  420
                                                                                                                                                                                                                                                                                                                                        440
                                                                                                                                                                                                                                                                                                                                               460
                                                                                                                                                                                                                                                                                                                                                     480
                                                                                                                                                                                                                                                                                                                                                           500
                                                                                                                                                                                                                                                                                                                                                                 520
                                                                                                                                                                                                                                                                                                                                                                       540
                                                                                                                                                                                                                                                                                                                                                                             560
                                                                                                                                                                                                                                                                                                                                                                                   580
                                                                                                                                                                                                                                                                                                                                                                                         600
                              0
                             20
                             40
                             60
                             80
                            100
                            120
                            140
                            160
                            180
                            200
                            220
                            240
                            260
                            280
                            300
                            320
                            340
                            360
                            380
                            400
                            420
                            440
                            460
                            480
                            500
                            520
                            540
                            560
                            580
                            600
                                                                Time                                                                                                                                                                                                                     Time


                                                               (a)                                                                                                                                                                                                   (b)

Figure 9: Scenario 3. (a) Simulated and ﬁtted sequences (ŷt = Xt′ ϑ̂t , t = 1, . . . , 500);
          (b) mode sequences and the estimated probability of a change point for each
          t.


5.1. Temperature Data
    Temperature data are frequently related to meteorological parameters such as
relative humidity, precipitation, wind speed, insolation, atmospheric pressure and
so on (Han et al., 2015). In this instance, the design matrix is build such that
x1 = humidity , x2 = atmospheric pressure, x3 = visibility and x4 = wind speed.
The Figures 10(b) and 10(c) show that the model identiﬁes two relevant variables
for the temperature data: atmospheric pressure and visibility, which is described
by the posterior of ϑtj , t = 1, . . . , 295, j = 2, 3. On the other hand, in Figures
10(a) and 10(d) the ﬁtted sequence of ϑtj , t = 1, . . . , 295, j = 1, 4, is almost zero,
which means that the variable j is absent.
                                               0.5




                                                                                                                                                                                                                                                                ^
                                                                                                                                                                                        0.5




                                                                                            ^                                                                                                                                                                   β2
                                                                                            β1
                                                                                            ^                                                                                                                                                                   ^
                                               0.3




                                                                                                                                                                                                                                                                ϑ
                                                                                                                                                                    Fitted sequence




                                                                                            ϑ
                            Fitted sequence




                                                                                              1                                                                                                                                                                   2
                                                                                                                                                                                        0.3
                                               0.1




                                                                                                                                                                                        0.1
                                               −0.1




                                                                                                                                                                                        −0.5 −0.3 −0.1
                                               −0.3
                                               −0.5




                                                                                                                                                                                                         0

                                                                                                                                                                                                                  20

                                                                                                                                                                                                                       40

                                                                                                                                                                                                                                 60

                                                                                                                                                                                                                                       80

                                                                                                                                                                                                                                               100

                                                                                                                                                                                                                                                         120

                                                                                                                                                                                                                                                                 140

                                                                                                                                                                                                                                                                           160

                                                                                                                                                                                                                                                                                   180

                                                                                                                                                                                                                                                                                             200

                                                                                                                                                                                                                                                                                                    220

                                                                                                                                                                                                                                                                                                               240

                                                                                                                                                                                                                                                                                                                      260

                                                                                                                                                                                                                                                                                                                                  280

                                                                                                                                                                                                                                                                                                                                         300
                                                      0

                                                          20

                                                               40

                                                                      60

                                                                           80

                                                                                100

                                                                                      120

                                                                                             140

                                                                                                   160

                                                                                                         180

                                                                                                               200

                                                                                                                     220

                                                                                                                           240

                                                                                                                                 260

                                                                                                                                        280

                                                                                                                                                      300




                                                                                            Time                                                                                                                                                                Time


                                                                                (a)                                                                                                                                                            (b)
                                               0.5




                                                                                                   ^                                                                                                                                                            ^
                                                                                                                                                                                        0.5




                                                                                                   β3                                                                                                                                                           β4
                                                                                                   ^                                                                                                                                                            ^
                                               0.3




                                                                                                   ϑ                                                                                                                                                            ϑ
                            Fitted sequence




                                                                                                                                                                    Fitted sequence




                                                                                                    3                                                                                                                                                                4
                                                                                                                                                                                        0.3
                                               0.1




                                                                                                                                                                                        0.1
                                               −0.1




                                                                                                                                                                                        −0.5 −0.3 −0.1
                                               −0.3
                                               −0.5


                                                      0

                                                          20

                                                               40

                                                                      60

                                                                           80

                                                                                100

                                                                                      120

                                                                                             140

                                                                                                   160

                                                                                                         180

                                                                                                               200

                                                                                                                     220

                                                                                                                           240

                                                                                                                                 260

                                                                                                                                        280

                                                                                                                                                      300




                                                                                                                                                                                                         0

                                                                                                                                                                                                                  20

                                                                                                                                                                                                                       40

                                                                                                                                                                                                                                 60

                                                                                                                                                                                                                                       80

                                                                                                                                                                                                                                               100

                                                                                                                                                                                                                                                         120

                                                                                                                                                                                                                                                                 140

                                                                                                                                                                                                                                                                           160

                                                                                                                                                                                                                                                                                   180

                                                                                                                                                                                                                                                                                             200

                                                                                                                                                                                                                                                                                                    220

                                                                                                                                                                                                                                                                                                               240

                                                                                                                                                                                                                                                                                                                      260

                                                                                                                                                                                                                                                                                                                                  280

                                                                                                                                                                                                                                                                                                                                         300




                                                                                            Time                                                                                                                                                                Time


                                                                                (c)                                                                                                                                                            (d)
Figure 10: Fitted sequences of the state vectors β j and ϑj = β j γj for the temperature
           data.


                                              Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

256                                          Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


5.2. Visibility Data
    The study of visibility (the horizontal distance an object can be seen and
identiﬁed) is of interest in a variety of ﬁelds including aeronautics (Watson et al.,
2009), environment (Du et al., 2013; Tsai et al., 2007) and human health ((Huang
et al., 2009; Thach et al., 2010; Majewski et al., 2015). Visibility is typically
related to meteorological parameters and air pollution. In this instance, the
design matrix is build such that x1 = humidity, x2 = atmospheric pressure,
x3 = temperature and x4 = wind speed. The Figure 11 show that the model
identiﬁes the atmospheric pressure as the only relevant variable for the visibility
data, which is described by the posterior of ϑt2 , t = 1, . . . , 295. In Figures 11(a),
11(c) and 11(d) the ﬁtted sequence of ϑtj , t = 1, . . . , 295, j = 1, 3, 4, shows that
the variable j is absent. Inﬂuence of the atmospheric pressure on the visibility has
been shown in the literature (see for example Tsai et al. 2007 and Majewski et al.
2011).



                                                                                                                                                            0.5
                                                                                  ^                                                                                                                           ^
                            0.5




                                                                                  β4                                                                                                                          β2
                                                                                  ^                                                                                                                           ^


                                                                                                                                                            0.3
                                                                                  ϑ                                                                                                                           ϑ
       Fitted sequence




                                                                                                                                          Fitted sequence
                                                                                   4                                                                                                                           2
                            0.3




                                                                                                                                                            0.1
                            0.1




                                                                                                                                                            −0.1
                            −0.5 −0.3 −0.1




                                                                                                                                                            −0.3
                                                                                                                                                            −0.5
                                             0

                                                 20

                                                       40

                                                            60

                                                                 80

                                                                      100

                                                                            120

                                                                                  140

                                                                                         160

                                                                                               180

                                                                                                     200

                                                                                                           220

                                                                                                                 240

                                                                                                                       260

                                                                                                                             280

                                                                                                                                   300




                                                                                                                                                                   0

                                                                                                                                                                       20

                                                                                                                                                                            40

                                                                                                                                                                                 60

                                                                                                                                                                                      80

                                                                                                                                                                                           100

                                                                                                                                                                                                 120

                                                                                                                                                                                                        140

                                                                                                                                                                                                              160

                                                                                                                                                                                                                    180

                                                                                                                                                                                                                          200

                                                                                                                                                                                                                                220

                                                                                                                                                                                                                                      240

                                                                                                                                                                                                                                            260

                                                                                                                                                                                                                                                  280

                                                                                                                                                                                                                                                        300
                                                                                  Time                                                                                                                 Time

                                                                        (a)                                                                                                                 (b)
                                                                                                                                                            0.8
                                1.0




                                                                                         ^                                                                                                             ^
                                                                                         β3                                                                                                            β4
                                                                                         ^                                                                                                             ^
                                                                                                                                                                                                       ϑ
                                                                                         ϑ
          Fitted sequence




                                                                                                                                         Fitted sequence




                                                                                          3                                                                                                             4
                                                                                                                                                            0.4
                                0.4
                                −0.2




                                                                                                                                                            0.0
                                                                                                                                                            −0.4
                                −0.8
                                −1.4




                                                                                                                                                            −0.8
                                             0

                                                 20

                                                       40

                                                            60

                                                                 80

                                                                      100

                                                                            120

                                                                                   140

                                                                                         160

                                                                                               180

                                                                                                     200

                                                                                                           220

                                                                                                                 240

                                                                                                                       260

                                                                                                                             280

                                                                                                                                   300




                                                                                                                                                                   0

                                                                                                                                                                       20

                                                                                                                                                                            40

                                                                                                                                                                                 60

                                                                                                                                                                                      80

                                                                                                                                                                                           100

                                                                                                                                                                                                 120

                                                                                                                                                                                                       140

                                                                                                                                                                                                              160

                                                                                                                                                                                                                    180

                                                                                                                                                                                                                          200

                                                                                                                                                                                                                                220

                                                                                                                                                                                                                                      240

                                                                                                                                                                                                                                            260

                                                                                                                                                                                                                                                  280

                                                                                                                                                                                                                                                        300




                                                                                  Time                                                                                                                 Time

                                                                       (c)                                                                                                                  (d)
Figure 11: Fitted sequences of the state vectors β j and ϑj = β j γj for the visibility
           data.




6. Discussion
    In this paper, we propose an extension of the SLDS. We make the measurement
noise and mean mode-speciﬁc. The extension uses the predictive distribution of
the observations, which involves integration over the latent states, and a method to
select relevant explanatory variables among modes. By allowing the measurement
noise be mode-speciﬁc we obtained a ﬂexible model for complex time series where
the stationarity assumption is not valid. Additionally, by selecting a mode-
speciﬁc set of explanatory variables allows us to describe changing relationships

                                                      Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                 257

between variables as time evolves. Our proposed model is a ﬂexible dynamic
regression model for learning about the number of modes, that is to say, it
accurately helps ﬁnding out the appropriate number of distributions in a mixture of
distributions. Since the modes divide the time series into non-overlapping groups,
the proposed method helps ﬁnding the location of the modes, and within each
mode, it identiﬁes the signiﬁcant explanatory variables and accurately estimate
the regression coeﬃcients. We judge the capability of the proposed model by
examining three synthetic datasets. We note that the model performs well even
with lower temporal mode persistence. We present two applications using a real
dataset of meteorological data from Barranquilla, Colombia. The results are
consistent with the literature. We conclude by addressing two avenues for further
research: (1) to extend the model to include a penalty term to prevent overﬁtting,
as proposed by West & Harrison (1997) for LDS, and as a consequence of it, (2)
study the model’s ability for predictions.
             [                                                               ]
                 Received: February 2020 — Accepted: December 2021


References
Antoniak, C. (1974), ‘Mixtures of dirichlet processes with applications to bayesian nonparametric problems’, The Annals of Statistics 2(6), 1152–1174.
Barber, D. (2012), Bayesian Reasoning and Machine Learning, Cambridge University Press.
Bishop, C. (2006), Pattern Recognition and Machine Learning, Springer.
Blackwell, D. & MacQueen, J. (1973), ‘Ferguson distributions via Polya urn schemes’, The Annals of Statistics 1(2), 353–355.
Bregler, C. (1997, June), Learning and recognizing human dynamics in video sequences, in ‘Proceedings of IEEE Computer Society Conference on Computer Vision and Pattern Recognition’, pp. 568–574.
Carvalho, C. & Lopes, H. (2007), ‘Simulation based sequential analysis of markov switching stochastic volatility models’, Computational Statistics and Data Analysis 51, 4526–4542.
Du, K., Mu, C., Deng, J. & Yuan, F. (2013), ‘Study on atmospheric visibility variations and the impacts of meteorological parameters using high temporal resolution data: an application of environmental internet of things in china’, International Journal of Sustainable Development and World Ecology 20(3), 238–247.
Escobar, M. (1988), Estimating the Means of Several Normal Populations by Nonparametric Estimation of the Distribution of the Means, PhD thesis, Yale University.
Escobar, M. & West, M. (1995), ‘Bayesian density estimation and inference using mixtures’, Journal of the American Statistical Association 90(430), 577–588.
Ferguson, T. (1973), ‘A bayesian analysis of some nonparametric problems’, The Annals of Statistics 1(2), 209–230.
Fox, E., Sudderth, E., Jordan, M. & Willsky, A. (2011a), ‘Bayesian nonparametric inference of switching dynamic linear models’, IEEE Transactions on signal processing 59(4), 1569–1585.
Fox, E., Sudderth, E., Jordan, M. & Willsky, A. (2011b), ‘A sticky hdp-hmm with application to speaker diarization’, The Annals of Applied Statistics 5(2A), 1020–1056.
Han, M., Ren, W. & Liu, X. (2015), ‘Joint mutual information-based input variable selection for multivariate time series modeling’, Engineering Applications of Artiﬁcial Intelligence 37, 250–257.
Huang, W., Tan, J., Kan, H., Zhao, N., Song, W., Song, G., Chen, G., Jiang, L., Jiang, C., Chen, R. & Chen, B. (2009), ‘Visibility, air quality and daily mortality in shanghai, china’, Science of The Total Environment 407(10), 3295–3300.
Huerta, G., Sansó, B. & Stroud, J. R. (2004), ‘A spatiotemporal model for mexico city ozone levels’, Journal of the Royal Statistical Society 53(2), 231–248.
Ishwaran, H. & James, L. (2001), ‘Gibbs sampling methods for stick-breaking Journal of the American Statistical Association 96(453), 161–173.
Ishwaran, H. & James, L. (2002), ‘Approximate dirichlet process computing in ﬁnite normal mixtures: Smoothing and prior information’, Journal of Computational and Graphical Statistics 11(3), 1–26.
Ishwaran, H. & Zarepour, M. (2000), ‘Markov chain monte carlo in approximate dirichlet and beta two-parameter process hierarchical models’, Biometrika 87(2), 371–390.
Ishwaran, H. & Zarepour, M. (2002a), ‘Dirichlet prior sieves in ﬁnite normal mixtures’, Statistica Sinica 12(3), 941–963.
Ishwaran, H. & Zarepour, M. (2002b), ‘Exact and approximate sum representations for the dirichlet process’, The Canadian Journal of Statistics 30(2), 269–283.
Kalman, R. (1960), ‘A new approach to linear ﬁltering and prediction problems’, Journal of Basic Engineering 82, 35–45.
Kalman, R. (1963), ‘Mathematical description of linear dynamical systems’, Journal of the Society for Industrial and Applied Mathematics 1(2), 152–192.
Kim, C. (1994), ‘Dynamic linear models with markov switching’, Journal of Econometrics 60(1-2), 1–22.
Kuo, L. & Mallick, B. (1998), ‘Variable selection for regression models’, The Indian Journal of Statistics. Special Issue on Bayesian Analysis 60(1), 65–81.
Lamon III, E., Carpenter, S. & Stow, C. (1998), ‘Forecasting PCB concentrations in Lake Michigan salmonids: a dynamic linear model approach’, Ecological Applications 8(3), 659–668.
MacEachern, S. N. (1994), ‘Estimating normal means with a conjugate style dirichlet process prior’, Communications in Statistics-Simulation and Computation 23(3), 727–741.
Majewski, G., Kleniewska, M. & Brandyk, A. (2011), ‘Seasonal variation of particulate matter mass concentration and content of metals’, Polish Journal of Environmental Studies 20(2), 417–427.
Majewski, G., Rogula-Kozłowska, W., Czechowski, P. O., Badyda, A. & Brandyk, A. (2015), ‘he impact of selected parameters on visibility: First results from a long-term campaign in warsaw, poland’, Atmosphere 6, 1154–1174.
McAlinn, K. & West, M. (2016), Dynamic bayesian predictive synthesis in time series forecasting, Technical report, Duke University.
Meinhold, R. & Singpurwalla, N. (1983), ‘Understanding the kalman ﬁlter’, The American Statistician 37(2), 123–127.
National Centers for Environmental Information (2021), ‘Local climatological data’. https://www.ncei.noaa.gov/data/local-climatological-data/
Pavlović, V., Rehg, J. & MacCormick, J. (2001), Learning switching linear models of human motion., in ‘Advances in Neural Information Processing Systems’, Vol. 13, Neural Information Processing Systems (NIPS) 2000.
Petris, G., Petrone, S. & Campagnoli, P. (2009), Dynamic Linear Models with R, Springer-Verlag.
Rauch, H., Striebel, C. & Tung, F. (1965), ‘Maximum likelihood estimates of linear dynamic systems’, AIAA Journal 3(8), 1445–1450.
Redner, R. & Walker, H. (1984), ‘Mixture densities, maximum likelihood and the em algorithm’, SIAM Review 26(2), 195–239.
Rodríguez, A. (2007), Some Advances in Bayesian Nonparametric Modeling, PhD thesis, Duke University.
Sethuraman, J. (1994), ‘A constructive deﬁnition of dirichlet priors’, Statistica Sinica 4, 639–650.
Stephens, M. (2000), ‘Dealing with label switching in mixture models’, Journal of the Royal Statistical Society 62(4), 795–809.
Teh, Y. W., Jordan, M. I., Beal, M. J. & Blei, D. M. (2006), ‘Hierarchical dirichlet processes’, Journal of the American Statistical Association 101, 1566–1581.
Thach, T.-Q., Wong, C.-M., Chan, K.-P., Chau, Y.-K., Chung, Y.-N., Ou, C.-Q., Yang, L. & Hedley, A. J. (2010), ‘Daily visibility and mortality: Assessment of health beneﬁts from improved visibility in hong kong’, Environmental Research 110(6), 617–623.
Tsai, Y., Kuo, S.-C., Lee, W.-J., Chen, C.-L. & Chen, P.-T. (2007), ‘Long-term visibility trends in one highly urbanized, one highly industrialized, and two rural areas of taiwan’, Science of The Total Environment 382(2-3), 324–341.
Velasco-Cruz, C., Leman, S. C., Hudy, M. & Smith, E. P. (2012), ‘Assessing the risk of rising temperature on brook trout: a spatial dynamic linear risk model’, Journal of Agricultural, Biological, and Environmental Statistics 17(2), 246–264.
Wang, L. & Wang, X. (2013), ‘Hierarchical dirichlet process model for gene expression clustering’, EURASIP Journal on Bioinformatics and Systems Biology 1(5).
Watson, A., Ramirez, C. & Salud, E. (2009), ‘Predicting visibility of aircraft’, PLOS ONE 5(7), 1–16.
West, M. (2013), Bayesian Dynamic Modelling, Oxford University Press, chapter 8.
West, M. & Harrison, J. (1997), Bayesian Forecasting and Dynamic Models, 2 edn, Springer.
Zeng, Y. & Wu, S., eds (2013), State-space models. Applications in Economics and Finance, Springer.


Appendix A. Filtering Distribution p(β t |y1:T , θ)


         p(β t |y1:t , θ) ∝ p(yt |β t , θ)p(β t |y1:t−1 , θ)
                                { 1 ( 1                                 )
                          ∝ exp − β ′t (z ) Xt t Xt t + Ft−1,t      −1
                                                       (z )′ (z )
                                                                          βt +
                                        2     r t
                                                    ( 1                           )}
                                                β ′t (z ) Xt t yt + Ft−1,t
                                                                     −1
                                                             (z )′
                                                                           ft−1,t
                                                     r t
                                  f     f
                          ∝ N (ft , Ft ),

where
                                 ( 1                         )
                                       (z )′    −1
                        ftf = Ftf zt Xt t yt + Ft−1,t ft−1,t
                                  r
                              ( 1                       )−1
                                     (z )′ (z )   −1
                        Ftf = (z ) Xt t Xt t + Ft−1,t        .
                                r t

                Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                                      261

Appendix B. Forward-Backward Procedure for Sam-
            pling the Mode and State Sequences
   We provide the derivations of the expressions to jointly sample the dynamic
modes z1:T as well as the state sequence β 1:T . The expressions apply for both
                                                                            (z )
the SLDS (15a)-(15c) and VS-SLDS (18a)-(18d), we simply replace Xt with Xt t .
For compactness, we omit the dependency of dynamic parameters θ and design
matrix Xt on zt .


Appendix B.1. Sampling z1:T
   The joint distribution of z1:T , given the observation sequence, can be
decomposed as follows:
           p(z1:T |y1:T , π, θ) =p(zT |zT −1 , y1:T , π, θ) p(zT −1 |zT −2 , y1:T , π, θ)
                                          · · · p(z2 |z1 , y1:T , π, θ) p(z1 |y1:T , π, θ).
We can use a forward-backward procedure for jointly sample the mode sequence,
as in Section 2.1. We ﬁrst sample z1 from p(z1 |y1:T , π, θ), then we sample z2
conditioning on z1 from p(z2 |z1 , y1:T , π, θ), and so on. For each t, the conditional
distribution is given by:
     p(zt |zt−1 , y1:T , π, θ)
           ∝ p(zt |πzt−1 )p(y1 |zt , π, θ)p(y2 |y1 , zt , π, θ)p(y3 |y1:2 , zt , π, θ)
              · · · p(yt |y1:t−1 , zt , π, θ)p(yt+1 |y1:t , zt , π, θ) · · · p(yT |y1:T −1 , zt , π, θ)
                             ∏
                             t                                         ∏
                                                                       T
           ∝ p(zt |πzt−1 )         p(yi |y1:i−1 , zt , zi , π, θ) ·           p(yj |y1:j−1 , zt , zj , π, θ)
                             i=1                                      j=t+1

           ∝ p(y1 , . . . , yt , zt |z1:t−1 , π, θ) · p(yt+1 , . . . , yT |zt , zt+1:T , π, θ).

    If t = 1, then:
p(z1 |y1:T , π, θ) ∝ p(y1 , z1 |π, θ) · p(y2 , . . . , yT |z1 , z2:T , π, θ)
                                               ∑
                   ∝ p(z1 )p(y1 |z1 , π, θ) ·         p(z2 |πz1 )p(y2 |y1 , z2 , π, θ)p(y3:T |z3:T , π, θ)
                                                    z2

                   ∝ p(z1 )p(y1 |z1 , θ)m2,1 (z1 ).

    When t = 2:
          p(z2 |z1 , y1:T , π, θ)
                 ∝ p(y1 , y2 , z2 |z1 , π, θ) · p(y3 , . . . , yT |z2 , z3:T , π, θ)
                 ∝ p(z2 |πz1 )p(y1 |z2 , π, θ)p(y2 |y1 , z2 , π, θ)
                                ∑
                              ·     p(z3 |πz2 )p(y3 |y1:2 , z3 , π, θ)p(y4:T |z4:T , π, θ)
                                    z3

                 ∝ p(z2 |πz1 )p(y2 |y1 , z2 , θ)m3,2 (z2 ).


                   Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

262           Dayna P. Saldaña-Zepeda, Ciro Velasco-Cruz & Víctor H. Torres-Preciado


    In general, the conditional distribution of zt , for all t, can be decomposed as
follows:
            p(zt |zt−1 , y1:T , π, θ) ∝ p(zt |πzt−1 )p(yt |y1:t−1 , zt , θ)mt+1,t (zt ),
where,
                            {∑
                                   zt p(zt |πzt−1 )p(yt |y1:t−1 , zt , θ)mt+1,t (zt )          t≤T
      mt,t−1 (zt−1 ) ∝
                               1                                                               t = T + 1.
The term mt,t−1 (zt−1 ) is known as backward message passed from zt to zt−1 in
the machine learning literature (see e.g. Bishop, 2006).


Appendix B.2. Sampling β t
   A similar forward-backward procedure can be used to sample the latent state
sequence β 1:T . We begin by considering
                     ∫
    mt,t−1 (β t−1 ) ∝ p(β t |β t−1 , zt , θ)p(yt:T |β t , zt:T , θ)dβ t
                     ∫
                    ∝ p(β t |β t−1 , zt , θ)p(yt |β t , zt , θ)p(yt+1:T |β t , zt+1:T , θ)dβ t
                     ∫
                    ∝ p(β t |β t−1 , zt , θ)p(yt |β t , zt , θ)mt+1,t (β t )dβ t ,

where it is assumed that mt+1,t (β t ) ∝ N (ft+1,t , Ft+1,t ). Then,

                      ∫
  mt,t−1 (β t−1 ) ∝       p(β t |β t−1 , zt , θ)p(yt |β t , zt , θ)mt+1,t (β t )dβ t

                      ∫        { [     ]′ [                      ][       ]}
                               1 β t−1      A′ Σ−1 A −A′ Σ−1 β t−1
                 ∝     exp −
                               2   βt       −Σ−1 A        Σ−1         βt
                         {     [     ]′ [             ][       ] [        ]′ [        ]}
                             1 β t−1      0      0       β t−1      β t−1        0
                   · exp −                                       +
                             2   βt       0 r1 Xt′ Xt     βt          βt       1 ′
                                                                                 X y
                                                                               r t t
                         {     [     ]′ [           ][       ] [         ]′ [               ]}
                             1 β t−1      0     0      β t−1       β t−1           0
                   · exp −                      −1
                                                                +               −1
                                                                                               dβ t
                             2   βt       0 Ft+1,t       βt         βt        Ft+1,t ft+1,t
                    ∫      {     [     ]′ [                        ]([         ]
                               1 β t−1      A′ Σ−1 A    −A′ Σ−1          β t−1
                 ∝     exp −
                               2   βt       −Σ−1 A Σ−1 + Ftb              βt
                                   [                             ]−1 [         ] )}
                                       A′ Σ−1 A      −A′ Σ−1             0
                              −2                                                      dβ t ,
                                       −Σ−1 A       Σ−1 + Ftb            ftb

where,
                                             1 ′         −1
                                       Ftb =   X Xt + Ft+1,t
                                             r t
                                             1          −1
                                        ftb = Xt′ yt + Ft+1,t ft+1,t .
                                             r

                  Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

Variable Selection in Switching Dynamic Regression Models                                    263

It is easy to see that mt,t−1 (β t−1 ) ∝ N (ft,t−1 , Ft,t−1 ), where

                  ft,t−1 = Ft,t−1 (Σ−1 + Ftb )−1 A′ Σ−1 ftb
                  Ft,t−1 = [A′ Σ−1 A − A′ Σ−1 (Σ−1 + Ftb )−1 Σ−1 A]−1 .

The conditional distribution of β t is then computed as:

p(β t |β t−1 , z1:T , y1:T , θ) ∝ p(β t |β t−1 , zt , θ)p(yt |β t , zt , θ)mt+1,t (β t )
                                       { 1                                               }
                                ∝ exp − (β t − Aβ t−1 )′ Σ−1 (β t − Aβ t−1 )
                                             2
                                         {       1                                 }
                                   · exp − (yt − Xt β t )′ (yt − Xt β t )
                                                2r
                                         { 1                                                }
                                                                        −1
                                   · exp − (β t − ft+1,t )′ Ft+1,t          (β t − ft+1,t )
                                                2
                                       { 1[                                     (             )]}
                                ∝ exp − β ′t (Ftb + Σ−1 )β t − 2β ′t Σ−1 Aβ t−1 + ftb
                                             2
                                ∝ N (µβt , Σβt ),

where,

                              Σβt = (Ftb + Σ−1 )−1
                                        (               )
                              µβt = Σβt Σ−1 Aβ t−1 + ftb .

We ﬁrst compute the messages mt+1,t (β t ) backward in time, by initializing it with
FTb = 1r XT′ XT , fTb = 1r XT′ yT , and we then sample the state sequence β 1:T forwards
in time.




                 Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 231–263

