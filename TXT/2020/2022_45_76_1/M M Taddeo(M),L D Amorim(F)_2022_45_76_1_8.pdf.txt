                         Revista Colombiana de EstadÃ­stica - Applied Statistics
                                      January 2022, volume 45, issue 1, pp. 161â€“191
                                           http://doi.org/10.15446/rce.v45n1.94553




 Causal Mediation for Survival Data: A Unifying
              Approach via GLM
MediaciÃ³n causal para datos de supervivencia: un enfoque uniï¬cador a
                          travÃ©s de GLM

                   Marcelo M. Taddeo a , Leila D. Amorim b

 Departmento de EstatÃ­stica, Instituto de MatemÃ¡tica e EstatÃ­stica, Universidade
                      Federal da Bahia, Salvador, Brazil




                                      Abstract
         Mediation analysis has been receiving much attention from the scientiï¬c
     community in the last years, mainly due to its ability to disentangle causal
     pathways from exposures to outcomes. Particularly, causal mediation
     analysis for time-to-event outcomes has been widely discussed using
     accelerated failures times, Cox and Aalen models, with continuous or binary
     mediator. We derive general expressions for the Natural Direct Eï¬€ect and
     Natural Indirect Eï¬€ect for the time-to-event outcome when the mediator is
     modeled using generalized linear models, which includes existing procedures
     as particular cases. We also deï¬ne a responsiveness measure to assess the
     variations in continuous exposures in the presence of mediation. We consider
     a community-based prospective cohort study that investigates the mediation
     of hepatitis B in the relationship between hepatitis C and liver cancer.
     We ï¬t diï¬€erent models as well as distinct distributions and link functions
     associated to the mediator. We also notice that estimation of NDE and NIE
     using diï¬€erent models leads to non-contradictory conclusions despite their
     eï¬€ect scales. The survival models provide a compelling framework that is
     appropriate to answer many research questions involving causal mediation
     analysis. The extensions through GLMs for the mediator may encompass
     a broad ï¬eld of medical research, allowing the often necessary control for
     confounding.
     Key words: causal inference; generalized linear models; mediation; survival
     analysis.

                                      Resumen
  a Ph.D. E-mail: marcelo.magalhaes@ufba.br
  b Ph.D. E-mail: leiladen@ufba.br




                                          161

162                                              Marcelo M. Taddeo & Leila D. Amorim


          El anÃ¡lisis de mediaciÃ³n ha recibido mucha atenciÃ³n en los Ãºltimos aÃ±os,
      principalmente debido a su capacidad para desenredar las vÃ­as causales.
      Particularmente, mediaciÃ³n causal para el tiempo hasta el evento se ha
      discutido ampliamente utilizando tiempos de falla acelerados, modelos de
      Cox y Aalen, con mediador continuo o binario. Derivamos expresiones
      generales para el efecto directo natural y el efecto indirecto natural para el
      el tiempo hasta el evento cuando el mediador se modela utilizando modelos
      lineales generalizados, que incluyen procedimientos existentes como casos
      particulares. Deï¬nimos una medida para evaluar variaciones en exposiciones
      continuas en presencia de mediaciÃ³n. Consideramos un estudio de cohorte
      prospectivo que investiga la mediaciÃ³n de la hepatitis B en la relaciÃ³n entre
      la hepatitis C y el cÃ¡ncer de hÃ­gado. Encajamos diferentes modelos, asÃ­
      como distintas distribuciones y funciones de enlace. Todos los enfoques
      dan como resultado evaluaciones consistentes de los eï¬€ectos considerando
      sus correspondientes escalas. Los modelos de supervivencia proporcionan
      un marco convincente apropiado para responder a muchas preguntas de
      investigaciÃ³n que involucran mediaciÃ³n causal. Las extensiones a travÃ©s de
      GLM para el mediador pueden abarcar un amplio campo de investigaciÃ³n
      mÃ©dica, lo que permite el control necesario para los factores de confusiÃ³n.
      Palabras clave: anÃ¡lisis de supervivencia; inferencia causal; mediaciÃ³n;
      modelos lineales generalizados.




1. Introduction

    Mediation analysis in the context of causal inference has been receiving
much attention from the scientiï¬c community in the last years, especially in
Epidemiology and Social Sciences, see Imai et al. (2010) and VanderWeele (2016).
This is due to its ability to disentangle causal pathways from exposures/treatments
to outcomes of interest, which results in a greater understanding of the underlying
mechanism. In short, a mediator may be deï¬ned as a variable M â€œbetweenâ€
the exposure A and the outcome T , so that the eï¬€ect of A on T splits into two
parts: one transmitted directly from the exposure to the outcome and another
transmitted indirectly through the mediator. Mediation models were initially
proposed for continuous outcomes and mediators in cross sectional studies, see
Baron & Kenny (1986) and MacKinnon (2008). Particularly, in the speciï¬c
context of causal inference, formal deï¬nitions of decomposed eï¬€ects into direct
(without mediation) and indirect (with mediation) eï¬€ects are found in Pearl
(2001) and their estimation is discussed in Tchetgen Tchetgen & Shpitser (2012)
among others. However, more recent advances have extended them to more
complex models including survival outcomes, see Fulcher et al. (2017), Iacobucci
(2012), Lange & Hansen (2011), Loyes et al. (2013), VanderWeele & Vansteelandt
(2010), VanderWeele (2011) Vansteelandt et al. (2019); and allowing, among other
features, multiple mediators, see Daniel et al. (2015), Fasanelli et al. (2019), Huang
& Yang (2017); or time-dependent treatments and/or mediators, see Aalen et al.
(2012), Aalen et al. (2020), Didelez (2019) and Lin et al. (2017).

                   Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                     163

    Causal mediation analysis for survival outcomes has been widely discussed
under accelerated failure times (AFT), Cox proportional hazards and Aalen
additive hazards models, with or without an interaction between exposure and
mediator, see Lange & Hansen (2011) and VanderWeele (2015). The usual
approach assumes a binary exposure A and a linear or logistic regression model
for the mediator M , see VanderWeele (2011) and VanderWeele (2015). Thus,
there are still limitations when M does not follow linear or logistic models. In
this paper, M is assumed to follow a generalized linear model (GLM), which
includes the linear and logistic approaches as particular cases. We illustrate the
proposed methodology by considering a community-based prospective cohort study
to investigate the mediation of hepatitis B in the relatioship between hepatitis C
and liver cancer. A mediation model for this data, based on the standard linear
model, was proposed by Huang & Yang (2017) based on the existing scientiï¬c
evidence. We reevaluate the mediation model considering distinct distributions
and link functions for the mediator, jointly with varying models for the survival
outcome (AFT, Cox and Aalen).
    The article is organized as follows: in section 2 we present a brief review of
causal mediation analysis for survival data. In section 3, we formally show general
expressions for the Natural Direct Eï¬€ect (NDE) and Natural Indirect Eï¬€ect (NIE)
for survival outcomes using AFT, Cox and Aalen models. We also specify the
expressions for NDE and NIE for particular distributions. In section 4, we deï¬ne
responsiveness measures for the promptness of the outcome for changes in the
continuous treatment levels. We apply this methodology for the mediation analysis
of the liver cancer data to illustrate model speciï¬cation and causal interpretation
in section 5. Finally, methodology challenges and advances are discussed in section
6.


2. Mediation for Survival Data
2.1. Framework and Notation
    Let T be the time to event and denote by Ta the potential response
corresponding to treatment a, i.e. the time to event it would be observed if
the treatment had been set at level a (regardless of the actual value of A). For
binary treatments, we have T (the actual outcome), Ta and Taâˆ— (the potential
outcomes had A been set equal to a and aâˆ— , respectively). At the unit level,
the causal eï¬€ect would ideally be assessed, for each unit u, by the diï¬€erence
Ta (u) âˆ’ Taâˆ— (u). Since one of them is necessarily counterfactual, it is impossible
to evaluate the causal eï¬€ect by such diï¬€erence. The solution usually adopted
considers the expected diï¬€erences E[Ta âˆ’ Taâˆ— ] or E[Ta âˆ’ Taâˆ— |x], where x is a vector
of covariates representing the confounding between A and T .
    In mediation analysis, the idea is to decompose the treatment eï¬€ect into two
parts corresponding to the paths A âˆ’â†’ T and A âˆ’â†’ M âˆ’â†’ T . In doing so,
it is usual to consider the potential responses TaMaâˆ— , where possibly diï¬€erent
treatments (a and aâˆ— ) are allowed to directly aï¬€ect the response and the mediator.

                   Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

164                                              Marcelo M. Taddeo & Leila D. Amorim


The eï¬€ect associated to the ï¬rst path is called Natural Direct Eï¬€ect and the one
associated to the second path, Natural Indirect Eï¬€ect. In the diï¬€erence scale, they
are respectively deï¬ned as

            NDE = E[TaMaâˆ— âˆ’ Taâˆ— Maâˆ— ]      and NIE = E[TaMa âˆ’ TaMaâˆ— ].                 (1)

Assuming the so-called composition assumption (VanderWeele & Vansteelandt,
2009): Ta = TaMa , referred to as (A0), we can write the Total Eï¬€ect as
TE â‰¡ E[Ta âˆ’ Taâˆ— ] = E[TaMa âˆ’ Taâˆ— Maâˆ— ] = NIE + NDE, regardless of the functional
relation between the variables involved. Historically, before this counterfactual
notation, there were two traditional approaches to estimate indirect eï¬€ects known
as â€œdiï¬€erence methodâ€ (considering two models for the outcome: with and without
the mediator) and â€œproduct methodâ€ (deï¬ned by the product of the modelsâ€™
coeï¬ƒcients). They converge for the same results when the outcome and the
mediator are continuous and a linear model is used, see Baron & Kenny (1986)
and MacKinnon & Dwyer (1993). However, they diverge in many other situations,
such as when analyzing binary outcomes or using the Cox model, see MacKinnon
(2008) and VanderWeele (2015). Therefore, the validity of such approach (not
based in counterfactual arguments) depends on the chosen model (MacKinnon
et al., 1995). Unlike them, the counterfactual approach is a solution to the problem
of establishing consistent deï¬nitions for direct, indirect and total eï¬€ects.


2.2. Survival Models
    For time-to-event data, the total eï¬€ect can be decomposed in terms of natural
direct and indirect eï¬€ects through diï¬€erent scales depending on the chosen model,
see VanderWeele (2011) and VanderWeele (2015). Throughout this paper we will
focus on the following three models (Kalbï¬‚eisch & Prentice, 2002):

  1. the accelerated failure time (AFT) model, in which

                      log T = Î²0 + Î²1 a + Î²2 m + Î²3 am + Î²4âŠ¤ x + Î³Îµ,

      with Îµ following an extreme value distribution and Î³ > 0, the scale
      parameter for the Weibull distribution. In this case, the natural direct and
      indirect eï¬€ects are given by NDEaft = log E[TaMaâˆ— |x] âˆ’ log E[Taâˆ— Maâˆ— |x] and
      NIEaft = log E[TaMa |x] âˆ’ log E[TaMaâˆ— |x].

  2. the Aalen additive hazards model (Aalen et al., 2008), in which

             Î»T (t|a, m, x) = Î²0 (t) + Î²1 (t)a + Î²2 (t)m + Î²3 (t)am + Î²4 (t)âŠ¤ x,       (2)

      whose coeï¬ƒcients are typically time-dependent. In this case,

                      NDEAalen (t|x) = Î»TaMaâˆ— (t|x) âˆ’ Î»Taâˆ— Maâˆ— (t|x)

      and
                       NIEAalen (t|x) = Î»TaMa (t|x) âˆ’ Î»TaMaâˆ— (t|x).

                   Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                       165

      Another way to report these (time-dependent) eï¬€ects is through their cumu-
                                                        Rt
      lative versions, which are given by CIEAalen (t) = 0 NIEAalen (s)ds , CDEAalen (t) =
      Rt                                        Rt
       0
         NDEAalen (s)ds and CEAalen (t) = 0 TEAalen (s)ds = CIEAalen (t) +
      CDEAalen (t).

   3. the Cox proportional hazards model, where
                                           
                Î»T (t|a, m, x) = Î»o (t) exp Î²1 a + Î²2 m + Î²3 am + Î²4âŠ¤ x ,

      and Î»o (Â·) is an unspeciï¬ed baseline hazard function. Here,

                     NDECox (t|x) = log Î»TaMaâˆ— (t|x) âˆ’ log Î»Taâˆ— Maâˆ— (t|x)

      and
                      NIECox (t|x) = log Î»TaMa (t|x) âˆ’ log Î»TaMaâˆ— (t|x).

    Accordingly, the exponentiated NDE and NIE stand for the ratio of expected
counterfactual survival times in the AFT model and the counterfactual hazard
ratio in the Cox model. Choosing any model is always related to diï¬€erent issues.
For instance, the results of the Cox model are very easily interpreted. The Aalen
model is particularly useful when the assumption of the proportionality of risks is
not met. In addition, its coeï¬ƒcients may be time varying, which makes it more
ï¬‚exible than the standard Cox model. On the other hand, fully parametric models,
such as the AFT model, are more eï¬ƒcient than semiparametric approaches when
correctly speciï¬ed.
   An important aspect of causal inference is the determination of the necessary
assumptions for identiï¬cation of the eï¬€ects of interest as well as their expressions in
terms of the parameters of the models. It is well known that such assumptions are
more stringent in the presence of mediators. Following Lange & Hansen (2011), we
have the assumptions of no unmeasured counfounding between (A1) exposure and
outcome: A âŠ¥ âŠ¥ Tam |x, (A2) mediator and outcome: M âŠ¥            âŠ¥ Tam |a, x, (A3) exposure
and mediator: A âŠ¥  âŠ¥ Ma |x; and the identiï¬ability condition (A4) Maâˆ— âŠ¥             âŠ¥ Tam |x.
Under these conditions and the composition assumption (A0) together with the
Aalen additive model (without the interaction term) and a Normal mediator,
we have TEAalen = [Î²2 (t)Î¶1 (a âˆ’ aâˆ— )] + Î²1 (t)(a âˆ’ aâˆ— ) = NIEAalen + NDEAalen .
Similarly, but allowing interaction (Î²3 am), VanderWeele (2011) determined the
identiï¬cation formulas for the AFT and Cox models. For instance, NDECox =
exp{(Î²1 + Î²3 (Î¶0 + Î¶1 aâˆ— + Î¶2âŠ¤ x + Î²2 Ïƒ 2 ))(a âˆ’ aâˆ— ) + 0.5Î²32 Ïƒ 2 (a2 âˆ’ aâˆ—2 )} and NIECox =
exp{(Î²2 + Î²3 a)Î¶1 (a âˆ’ aâˆ— )}. Similar expressions are found for the AFT model
even when M is dichotomous. We refer the interested reader to VanderWeele &
Vansteelandt (2010) or VanderWeele (2015) for more details.
    In any case, the mediator is usually assumed to be either conditionally Normal
with mean E[M |a, x] = Î¶0 + Î¶1 a + Î¶2âŠ¤ x and variance Var(M |a, x) = Ïƒ 2 , or binary
and described by a logistic model. The aim of this article is to unify these
approaches and, in addition, to allow the mediator to follow other distributions
from the Exponential family, such as Poisson (if M is a count) and Gamma (if M
is asymmetric, nonnegative and continuous).

                    Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

166                                                        Marcelo M. Taddeo & Leila D. Amorim


3. Generalized Linear Models for Mediators
3.1. Notation for GLM
    To represent the NDE and NIE for a wider class of mediators, assume that the
mediator M takes value on M and let Î½ be a sigma-ï¬nite measure over A, a Ïƒ-ï¬eld
over M, such that M âˆ¼ PM (Â·|a, x), with PM â‰ª Î½, and let its density be given by
              dÎ½ (m|a, x) = exp {[Î¸m âˆ’ b(Î¸)]/Ï• + c(m; Ï•)}, so that, conditionally on
f (m|a, x) = dP
a and x, the distribution of M belongs to the Exponential family. Here, Ï• stands
for the scale parameter and Î¸ = Î¸(a, x). The conditional mean of M given a and x,
denoted by Âµ = Âµ(a, x), can be written as Âµ = g âˆ’1 (Î·) = g âˆ’1 (Î¶0 +Î¶1 a+Î¶2âŠ¤ x), where
g is a suitable link function. In particular, Î¸(a, x) = (g â—¦ bâ€² )âˆ’1 (Î¶0 + Î¶1 a + Î¶2âŠ¤ x) and,
when using canonical links, Î¸(a, x) = Î·. In the next three subsections, we describe
the formulas of NDE and NIE under these conditions and assuming the time to
event (T ) to follow the AFT, Aalen and Cox models, respectively. We assume a
binary treatment such that A = a or A = aâˆ— and, for the sake of simplicity, we
simply write Î¸(x) â‰¡ Î¸(a, x) and Î¸(aâˆ— , x) â‰¡ Î¸âˆ— (x).


3.2. Causal Eï¬€ects in the Accelerated Failure Time Model
      Under conditions (A0) â€“ (A4) and the accelerated failure time model, we have
                                                                                             
                                                     b [Î¸ âˆ— (x) + (Î²2 + Î²3 a)Ï•] âˆ’ b (Î¸ âˆ— (x))
      E[TaMaâˆ— |x] = E [eÎ³Îµ ] exp Î²0 + Î²1 a + Î²4âŠ¤ x +                                            .     (3)
                                                                        Ï•

The proof is in the appendix A1. Now, it follows directly from (3) that
                  b [Î¸(x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸ âˆ— (x) + (Î²2 + Î²3 a)Ï•] âˆ’ [b (Î¸(x)) âˆ’ b (Î¸ âˆ— (x))]
      NIEAFT =
                                                        Ï•
                                                                                                  ,   (4)

and
                                   1
       NDEAFT = Î²1 (a âˆ’ aâˆ— ) +       {b [Î¸ âˆ— (x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸ âˆ— (x) + (Î²2 + Î²3 aâˆ— )Ï•]}.     (5)
                                   Ï•

Dependence on x can be removed by considering E[TaMaâˆ— ] = EX [E[TaMaâˆ— |X]].
However, the expressions of the NIE and NDE become complicated, as terms in
(3) do not cancel out.
                                                            2             2
    Using the Normal distribution with g(Âµ) = Âµ,    Ï• = Ïƒ and b(Î¸) = Î¸ /2, we get
NIEAFT = (Î²2 +Î²3 a)Î¶1 (aâˆ’aâˆ— ) and NDEAFT = Î²1 + Î²3 (Î²2 Ïƒ 2 + Î¸âˆ— (x)) (aâˆ’aâˆ— )+
0.5Ïƒ 2 Î²32 (a2 âˆ’ aâˆ—2 ), as in VanderWeele (2015). Using the Gamma distribution with
parameterization f (m) = (Î½/Âµ)Î½ mÎ½âˆ’1 eâˆ’Î½m/Âµ /Î“(Î½), the most usual link functions
are (i) the reciprocal link g(Âµ) = 1/Âµ, for which Î¸(a, x) = âˆ’Î¶0 âˆ’Î¶1 aâˆ’Î¶2âŠ¤ x; (ii) the
logarithmic link g(Âµ) = log Âµ, for which Î¸(a, x) = âˆ’ exp(âˆ’Î¶0 âˆ’Î¶1 aâˆ’Î¶2âŠ¤ x) and (iii)
the identity link g(Âµ) = Âµ, for which Î¸(a, x) = âˆ’(Î¶0 + Î¶1 a + Î¶2âŠ¤ x)âˆ’1 . In any case,
Ï• = Î½ âˆ’1 and b(Î¸) = âˆ’ log(âˆ’Î¸), so that NIEAFT = Î½{log[(Î²2 + Î²3 a)/Î¸âˆ— (x) + Î½] âˆ’
log[(Î²2 + Î²3 a)/Î¸(x) + Î½]} and NDEAFT = Î²1 (a âˆ’ aâˆ— ) + Î½{log[(Î²2 + Î²3 aâˆ— )/Î¸âˆ— (x) +
Î½]âˆ’log[(Î²2 +Î²3 a)/Î¸âˆ— (x)+Î½]}. Expressions for Binomial and Poisson distributions
are in the Web Appendix B.

                        Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                                    167

3.3. Causal Eï¬€ects in the Additive Aalen Model
   From the Aalenâ€™s framework and assumptions (A0) â€“ (A4),
                                              âŠ¤
                                                                                 
 Î»TaMaâˆ— (t) = Î²0 (t) + Î²1 (t)a + EX
                                  t,a,aâˆ— Î²4 (t) X + (Î²2 (t) + Î²3 (t)a)Âµt,a,aâˆ— (X) , (6)


where Âµt,a,aâˆ— (x) = EÏ•(B2 (t)+B3 (t)a)+Î¸âˆ— (x) M and EX  t,a,aâˆ— [h(X)] is the expectation
of h(X) with respect to
                                                                                
                            âŠ¤      b [Î¸âˆ— (x) + (B2 (t) + B3 (t)a)Ï•] âˆ’ b [Î¸âˆ— (x)]
    qt,a,aâˆ— (x) âˆ exp B4 (t) x +                                                   , (7)
                                                         Ï•

where qt,a,aâˆ— = dQt,a,aâˆ— /dPX and âˆ means equality except for a proportionality
constant. Proofs are found in Appendix A2. Notice that in the absence of
interaction the measure Qt,a,aâˆ— does not depend on a, so that dQt,a,aâˆ— (x) â‰¡
dQt,aâˆ— (x). From (6), we have

                                              t,a,aâˆ— [Âµt,a,a (X) âˆ’ Âµt,a,aâˆ— (X)],
                NIEAalen = (Î²2 (t) + Î²3 (t)a)EX                                                       (8)

and
                     NDEAalen = Î²1 (t)(a âˆ’ aâˆ— ) + E(t; a, aâˆ— ) âˆ’ E(t; aâˆ— , aâˆ— ).                      (9)
                 âˆ—                 âŠ¤
with E(t; a, a ) = EXt,a,aâˆ— [Î²4 (t) X + (Î²2 (t) + Î²3 (t)a)Âµt,a,aâˆ— (X)]. In particular, if
there is no interaction, then NDEAalen = Î²1 (t)(a âˆ’ aâˆ— ), regardless of the mediator
type.
   For the sake of illustration we will ignore the interaction term between A
and M just to keep formulas simpler. Using the Normal distribution, we get
from (8) the standard formula NIEAalen = Î²2 (t)Î¶1 (a âˆ’ aâˆ— ), whereas using the
                                                                             âˆ—   âˆ’1
Gamma distribution, it follows that NIEAalen = Î²2 (t)EX      âˆ— [(B2 (t)/Î½+Î¸ (X))    âˆ’
                                        h      âˆ—
                                                         iÎ½
                                                       t,a,a
                                                                       âŠ¤
                 âˆ’1                           Î¸ (x)
(B2 (t)/Î½ + Î¸(X)) ], where qt,a,aâˆ— (x) âˆ B2 (t)/Î½+Î¸âˆ— (x) e    B  4 (t)   x
                                                                           .


3.4. Causal Eï¬€ects in the Proportional Hazard Rate (Cox)
     Model
   If the conditions (A0)-(A4) hold and the event is relatively rare, so that the
cummulative baseline hazard Î›o (t) is approximatelly equal to zero for all t â‰¥ 0,
as pointed out in VanderWeele (2011), then
                                                                                         
                                                 b [Î¸ âˆ— (x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸ âˆ— (x)]
        Î»TaM âˆ— (t|x) â‰ˆ Î»o (t) exp Î²1 a + Î²4âŠ¤ x +                                            .        (10)
            a                                                       Ï•

The proof is in the Appendix A3. Hence,
                 b [Î¸(x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸ âˆ— (x) + (Î²2 + Î²3 a)Ï•] âˆ’ (b [Î¸(x)] âˆ’ b [Î¸ âˆ— (x)])
   NIECox â‰ˆ
                                                       Ï•
                                                                                                 ,   (11)

and
                                  1 âˆ—
      NDECox â‰ˆ Î²1 (a âˆ’ aâˆ— ) +       b [Î¸ (x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸ âˆ— (x) + (Î²2 + Î²3 aâˆ— )Ï•] .        (12)
                                  Ï•


                         Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

168                                                          Marcelo M. Taddeo & Leila D. Amorim


Though in diï¬€erent scales, the mathematical expressions for NDECox and NIECox
are very similar to the corresponding expressions for NDEaft and NIEaft for
rare events, no matter what is the mediator distribution in the Exponential
Family. If there is no interaction between A and M , then NDECox = Î²1 (a âˆ’ aâˆ— )
regardless of the mediator type. For settings with common outcomes and with
Normal/binary mediator, a weighting approach using the proportional hazards
model was described by Lange et al. (2012) and VanderWeele (2015).


3.5. Variance Assessment of the Direct and Indirect Eï¬€ects
    Let Î¶ = (Î¶0 , Î¶1 , Î¶2 )âŠ¤ and Zi = (Ai , X âŠ¤    âŠ¤
                                                i ) , where i = 1, ..., n denotes the
sample units. If Î¶b is the maximum likelihood estimator (MLE) of Î¶ and assuming
independence among units, then it is well known that Î¶b is asymptotically Normal
with mean Î¶ and variance Î£Î¶ = Ï•(Z âŠ¤ W Z)âˆ’1 , where Z is the design matrix
whose ith column is Z i and W = diag(w1 , . . . , wn ), with wi = 1/[bâ€²â€² (Î¸i )Î·i2 ] and
Î¸i = Î¸(ai , xi ). We also let Î£Ï• be the (asymptotic) variance of the estimator Ï•b
of Ï•. On the other hand, under the AFT and Cox models, Î²b is asymptotically
Normal with mean Î² and variance Î£Î² = nâˆ’1 Î£(Î², Ï„ ). Here Î²b is the estimator of
Î² = (Î²0 , Î²1 , Î²2 , Î²3 , Î²4 )âŠ¤ obtained by maximum likelihood in the AFT model and
maximum partial likelihood in the Cox model. The elements Ï„ and Î£(Î², Ï„ ) denote,
respectively, the monitoring period and asymptotic variance. For details on Î£, we
refer the reader to Kalbï¬‚eisch & Prentice (2002), pages 172 to 181. Following
the arguments in VanderWeele (2015), p. 467, and using the facts that the above
estimators are (i) asymptotically unbiased and (ii) Î¶b and Ï•b are orthogonal, we
have for large n that the covariance matrix associated to Î², Î¶ and Ï• is given by
                                            ï£«                     ï£¶
                                          Î£Î²            0       0
                                      Î£=ï£­ 0             Î£Î¶      0 ï£¸.
                                           0                   Î£Ï•

Hence, using the Delta method we are able to ï¬nd the corresponding (asymptotic)
variance of each eï¬€ect. For example, for NIEAFT , the variance is given by
(âˆ‡NIEAFT )âŠ¤ Î£âˆ‡NIEAFT , where âˆ‡NIEAFT stands for the gradient of NIEAFT with
respect to (Î², Î¶, Ï•), which is given by

  âˆ‡NIEAFT
      ï£®                                                                                                       ï£¹
                                                         0
    ï£¯                                                                                                         ï£º
    ï£¯                                                    0                                                    ï£º
    ï£¯                                                                                                         ï£º
    ï£¯                        â€²                                 â€²   âˆ—                                          ï£º
    ï£¯                  Ï• (b [Î¸(x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸ (x) + (Î²2 + Î²3 a)Ï•])                                 ï£º
    ï£¯                                                                                                         ï£º
    ï£¯                      â€²                                 â€²    âˆ—
                      Ï• (b [Î¸(x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸ (x) + (Î²2 + Î²3 a)Ï•]) a                                ï£º
    ï£¯                                                                                                         ï£º
   1ï£¯                                                                                                         ï£º
  = ï£¯                                                    0                                                    ï£º
   Ï•ï£¯
    ï£¯
                                                                                                              ï£º
                                                                                                              ï£º
    ï£¯     b â€² [Î¸(x) + (Î²    +  Î²   a)Ï•] âˆ’ b â€² [Î¸ âˆ— (x) + (Î²      +  Î²   a)Ï•] âˆ’ [b â€² (Î¸(x)) âˆ’ b â€² (Î¸ âˆ— (x))]   ï£º
    ï£¯                    2       3                          2         3                                       ï£º
    ï£¯ â€²                                 â€²   âˆ—                              âˆ—      â€²               â€²   âˆ—     âˆ— ï£º
    ï£¯ b [Î¸(x) + (Î²2 + Î²3 a)Ï•]a âˆ’ b [Î¸ (x) + (Î²2 + Î²3 a)Ï•]a âˆ’ [b (Î¸(x))a âˆ’ b (Î¸ (x))a ] ï£º
    ï£¯                                                                                                         ï£º
    ï£¯ {bâ€² [Î¸(x) + (Î² + Î² a)Ï•] âˆ’ bâ€² [Î¸ âˆ— (x) + (Î² + Î² a)Ï•] âˆ’ [bâ€² (Î¸(x)) âˆ’ bâ€² (Î¸ âˆ— (x))]} x ï£º
    ï£°                  2       3                           2        3                                         ï£»
         âˆ’NIEAFT + {bâ€² [Î¸(x) + (Î²2 + Î²3 a)Ï•] âˆ’ bâ€² [Î¸ âˆ— (x) + (Î²2 + Î²3 a)Ï•]} (Î²2 + Î²3 a)


                        Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                     169

when considering canonical links. The gradients associated to the other direct and
indirect eï¬€ects for the AFT and Cox models are similarly evaluated.
   Finally, we note that the Delta method will deliver good estimates only if the
sample size is large enough. Otherwise, one can use the bootstrap approach as
done in the application section. Particularly, such approach is also feasible for the
Aalen model.


3.6. Simulation Study
    We conducted a simulation study to assess the eï¬€ect of misspeciï¬cation in
the mediation model (wrong choice of the GLM for M ) on the NIE estimation.
For each subject, i, we generated data relative to (Ti , Mi , Ai ), where T denotes
the survival time generated by the Cox-exponential model as in Bender et al.
(2005), such that Î»(t) = Î»0 (t) exp(Î²1 A + Î²2 M ), A âˆ¼ Bernoulli(0.5) and the linear
                                                          â€²
predictor for M is given by Î¶0 + Î¶1 A, with Î¶ = (Î¶0 , Î¶1 ) varying according to the
underlying mediator distribution used in the data generation process. Speciï¬cally,
we assumed the distributions Normal, Gamma, Poisson and Bernoulli. Finally, we
considered sample sizes equal to n = 200 and n = 500 and percentages of censoring
equal to 0% and 25%. To assess the eï¬€ect of model misspeciï¬cation, we estimated
the NIE and NDE using AFT, Cox and Aalen survival models always assuming a
GLM with Normal distribution for the mediation model as the standard approach
(regardless the true distribution). To perform this assessment we generated 2,000
samples under each conï¬guration.
    In Table 1, we present average and standard errors (in parentheses) for the NIE
estimates for the settings aforementioned. The true NIE is given by NIEDistribution
as deï¬ned in Sections 3.2, 3.3 and 3.4, respectively, for AFT, Aalen and Cox
models. Notice that the by ï¬tting a Normal GLM for the mediator, we are
misspecifying it when the true underlying distributions for M are Gamma, Poisson
and Bernoulli. The results show that the estimates when using the correctly
speciï¬ed Normal-GLM are quite close to the true NIE, with improved results for
larger sample sizes (n = 500) and no censoring. The estimates deviate from the
true NIE values when using other GLMs in all survival models. For instance, the
estimates for the AFT model and underlying Gamma distribution are 1.56 and
1.57, respectively, for the settings with 25% censoring and sample sizes 200 and
500, while the true NIE should be 0.90.
    The departures are also veriï¬ed under the Bernoulli distribution for the
mediator, particularly for smaller sample size (n = 200) and using the Aalen
model, when the estimates varied betwen -0.11 and -0.12, but the true estimate
should be -0,08. Due to the small NIE estimates when using the Poisson model
(and moreover the use of three decimals for presenting them), the results are hard
to interpret for all survival models.
    To help us to assess the departures from the true NIE under misspeciï¬cation of
the GLM for the mediator, we present relative bias (%) for the NIE in Table 2. The
results were remarkably interesting, clearly pointing out the increased magnitude
of the biases when ignoring the proper GLM for the mediator. We can verify in

                   Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

170                                                    Marcelo M. Taddeo & Leila D. Amorim

Table 1: Average NIE estimates and standard errors (in parentheses) using the GLM-
         Normal for modeling the mediator under diï¬€erent survival and underlying
         (true) mediator models.
   Underlying                                         Survival Models
   Mediator                       AFT                        Cox                     Aalen
   Model                    n = 200 n = 500           n = 200   n = 500         n = 200  n = 500
   Normal
   (Î¶o = 100, Î¶1 = 10)
   0% censoring               0.51            0.50     -0.52            -0.50    -0.024      -0.023
                             (0.73)          (0.45)   (0.75)           (0.45)   (0.035)     (0.021)
   25% censoring              0.52            0.48     -0.55            -0.51    -0.020      -0.020
                             (0.79)          (0.48)   (0.85)           (0.51)   (0.034)     (0.020)
   NIEGauss                           0,50                     -0,50                   -0.022
   Gamma
   (Î¶o = 0.5, Î¶1 = 3.0)
   0% censoring               1.56            1.57     -1.58            -1.58    -0.37            -0.22
                             (0.19)          (0.12)   (0.26)           (0.16)   (0.27)           (0.16)
   25% censoring              1.56            1.57     -1.68            -1.66    -0.34            -0.19
                             (0.20)          (0.13)   (0.31)           (0.18)   (0.24)           (0.14)
   NIEGamma                           0.90                     -0.90                     -4.46
   Poisson
   (Î¶o = 0.02, Î¶1 = 0.06)
   0% censoring               0.003      0.0030        -0.003      -0.0030       -0.02       -0.026
                             (0.013)    (0.0069)      (0.013)     (0.0069)      (0.11)      (0.058)
   25% censoring              0.002      0.0031        -0.002      -0.0033       -0.02       -0.024
                             (0.014)    (0.0070)      (0.015)     (0.0074)      (0.11)      (0.054)
   NIEPoisson                       0.003                    -0.003                    -0.024
   Bernoulli
   (Î¶o = 0.02, Î¶1 = 0.90)
   0% censoring                0.012       0.011     -0.012      -0.011     -0.12        -0.10
                              (0.034)     (0.020)   (0.035)     (0.021)    (0.33)       (0.20)
   25% censoring               0.012       0.010     -0.013      -0.010     -0.11        -0.08
                              (0.037)     (0.023)   (0.039)     (0.024)    (0.32)       (0.19)
   NIEBernoulli                      0.011                 -0.011                 -0.08
   (NIEDistribution : true natural indirect eï¬€ect when considering the actual underlying
   distribution for the mediator.)




our settings that the relative bias varies from 15.02% to over 87.17% when the
underlying mediator is, respectively, Poisson and Gamma for the analyses using
Cox models with n = 200. There is a substantial reduction on the relative bias for
NIE estimation when sample size increases to 500, particularly for the Poisson and
Bernoulli mediator distributions. For the Gamma GLM mediator, on the other
hand, the relative bias does not change substantially with the increase in sample
size for all survival models.
   We also compared the AIC for the two models ï¬tted for the mediator: the
GLM for the underlying mediator model (TRUE) and the Gaussian model, i.e.,
under misspeciï¬cation of the mediation model. In all cases, the AIC for the
correct (TRUE underlying model) was lower than that obtained by ï¬tting the
Gaussian GLM, indicating that the criterion correctly indicates the proper model

                     Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                         171

Table 2: Relative bias for NIE using the GLM-Normal to model the mediator under
         diï¬€erent survival and underlying (true) mediator models
   Underlying                                    Survival Models
   Mediator                       AFT                  Cox                   Aalen
   Model                    n = 200 n = 500      n = 200  n = 500      n = 200   n = 500
   Normal
   (Î¶o = 100, Î¶1 = 10)
   0% censoring             2.49%      -0.74%     -3.37%    0.21%      -11.26%    -6.15%
   25% censoring            4.06%      -3.04%    -10.82%    -2.28%      -0.71%     6.94%
   Gamma
   (Î¶o = 0.5, Î¶1 = 3.0)
   0% censoring             73.68%    74.74%     -76.07%    -76.30%      91.61%   95.10%
   25% censoring            74.32%    75.03%     -87.17%    -85.16%      92.32%   95.67%
   Poisson
   (Î¶o = 0.02, Î¶1 = 0.06)
   0% censoring             -16.29%    -1.74%    15.02%     -0.56%       13.70%   -8.09%
   25% censoring            -20.07%   0.0079%    15.58%     -6.53%       26.77%    1.25%
   Bernoulli
   (Î¶o = 0.02, Î¶1 = 0.90)
   0% censoring             14.21%     3.90%     -16.65%    -3.80%     -44.61%    -25.20%
   25% censoring            13.57%     -6.05%    -20.61%     2.29%     -27.89%     -1.07%




for the mediator (Table 3). For instance, the AIC was equal to 649.06 and 682.85,
respectively, for the GLMs with Bernoulli and Normal distributed mediator when
its underlying (TRUE) distribution was Bernoulli.



         Table 3: Average AIC for the mediator models using diï¬€erent GLMs
                     Underlying                       Sample Size
                     Mediator Model               n = 200     n = 500
                     Gamma
                     True Gamma GLM              1,192.27       2,988.86
                     Misspeciï¬ed Normal GLM      1,741.38       4,439.75
                     Poisson
                     True Poisson GLM             536,60        1,336.03
                     Misspeciï¬ed Normal GLM       581.24        1,446.77
                     Bernoulli
                     True Bernoulli GLM           261.75        649.06
                     Misspeciï¬ed Normal GLM       276.38        682.85




    In summary, we showed that there might be substancial bias when ignoring the
proper GLM for the mediator whatever the survival model (Aalen, Cox or AFT
model) for NIE estimation is. Though not presented here, the impact on the NDE
estimation is much smaller when using the GLM-Normal mediator model since its
estimation does not depend on the GLM parameters associated to the mediator.

                     Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

172                                                            Marcelo M. Taddeo & Leila D. Amorim


4. Responsiveness Measure for Continuous
   Treatments
     Although it is usual to consider binary exposures and their causal contrast,
it might be interesting to consider an alternative metric to describe the eï¬€ect of
small changes in a continuous exposure in the presence of mediation. Therefore, in
this section we propose a measure that captures the responsiveness of the outcome,
in diï¬€erent scales, to changes in the underlying (continuous) exposure level when
mediation is present. More precisely, we look at the responsiveness, or derivative,
of the potential responses due to small changes in the treatment level. It is worth
mentioning that this is a local measure and, therefore, as will become clearer later,
it is related to some pre-speciï¬ed level of treatment. Although we consider, as in
Section 3, three diï¬€erent scales, we will state the main deï¬nitions by using the
expected time to event. Modiï¬cations to other scales should be trivial. Therefore,
we deï¬ne the total responsiveness at aâˆ— (TR) as
             âˆ‚                                           E[T(aâˆ— +h)Maâˆ— +h |x] âˆ’ E[Taâˆ— Maâˆ— |x]
   TR =         {E[TaMa |x] âˆ’ E[Taâˆ— Maâˆ— |x]}       = lim                                      ,
             âˆ‚a                              a=a âˆ—   hâ†’0                  h

and the natural direct responsiveness at aâˆ— (NDR) as
              âˆ‚                                            E[T(aâˆ— +h)Maâˆ— |x] âˆ’ E[Taâˆ— Maâˆ— |x]
   NDR =         {E[TaMaâˆ— |x] âˆ’ E[Taâˆ— Maâˆ— |x]}       = lim                                   .
              âˆ‚a                               a=a âˆ—   hâ†’0                 h

Note that for the direct responsiveness, the treatment assigned to the mediator
remains ï¬xed at its â€œnaturalâ€ level aâˆ— . The natural indirect responsiveness at aâˆ—
(NIR), in turn, is simply deï¬ned in terms of TR and NDR as NIR = TR âˆ’ NDR,
i.e. the natural indirect responsiveness is the part of the total responsiveness that
is not explained by the natural direct eï¬€ect. However, if TR and NDR exist, then
NIR = limhâ†’0 {E[T(aâˆ— +h)Maâˆ— +h |x] âˆ’ E[T(aâˆ— +h)Maâˆ— |x]}/h, so that

                                            âˆ‚
                             NIR =             {E[TaMa |x] âˆ’ E[TaMaâˆ— |x]}      .
                                            âˆ‚a                            a=aâˆ—

As before, our goal is to study the identiï¬cation of these measures in cases where
the mediatorâ€™s conditional distribution belongs to the Exponential Family.


4.1. Responsiveness Measures in the Accelerated Failure
     Rate Model
   We already know that if (A0)â€“(A4) are satisï¬ed, then E[TaMa |x] is identiï¬ed
by formula (3). Based on it and taking derivatives with respect to a, we get
                   "                                                                                   #
                            (Î¸ â€² (aâˆ— , x) + Î²3 Ï•)EÎ¸(aâˆ— ,x)+(Î²2 +Î²3 aâˆ— )Ï• M âˆ’ Î¸ â€² (aâˆ— , x)EÎ¸(aâˆ— ,x) M
      TRAFT = Î²1 +
                                                               Ï•                                           (13)
                   Ã— E[T   a âˆ— Maâˆ—   |x],
         â€²     âˆ—
where Î¸ (a , x) = âˆ‚a Î¸(aâˆ— , x). One particular issue that arises when using the
identiï¬cation formula (3) is the calculation of the expectation EeÎ³Îµ , which depends

                           Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                       173

on the particular distribution associated to log T . It is usual to choose Îµ so that
it follows an extreme value distribution. This is done by assuming T to follow the
Weibull distribution, see Kalbï¬‚eisch & Prentice (2002), p. 33. In this particular
case, EeÎ³Îµ = Î“(1 + Î³). Similarly, we get
                                                         
              NDRAFT = Î²1 + Î²3 EÎ¸(aâˆ— ,x)+(Î²2 +Î²3 aâˆ— )Ï• M E[Taâˆ— Maâˆ— |x],

and hence
                                                                      
      NIRAFT = Ï•âˆ’1 Î¸â€² (aâˆ— , x) EÎ¸(aâˆ— ,x)+(Î²2 +Î²3 aâˆ— )Ï• M âˆ’ EÎ¸(aâˆ— ,x) M E[Taâˆ— Maâˆ— |x].

In particular, if there is no interaction between A and M in the survival model,
then the direct responsiveness simpliï¬es to Î²1 E[Taâˆ— Maâˆ— |x]. The same arguments
would lead us to the responsiveness formulas associated to the Cox model, whose
results are quite similar, except for the scale. In fact, by comparing the expressions
(3) and (10), respectively, associated to E[TaMaâˆ— |x] and Î»aMaâˆ— (t), we see that both
share the same structure (just with E[eÎ³Îµ ] in place of Î»o (t) and vice versa). Hence,
by mimicking the argument in the lines above, we get
                                                                                          
                    (Î¸â€² (aâˆ— , x) + Î²3 Ï•)EÎ¸(aâˆ— ,x)+(Î²2 +Î²3 aâˆ— )Ï• M âˆ’ Î¸â€² (aâˆ— , x)EÎ¸(aâˆ— ,x) M
  TRCox = Î²1 +
                                                      Ï•
              Ã— Î»aâˆ— Maâˆ— (t).

Notice that, in addition to the diï¬€erence in scale, the responsiveness under the
Cox model is also time dependent, i.e. TRCox = TRCox (t). The corresponding
direct and indirect responsiveness follow the same steps.
   For the sake of illustration we only consider models without the interaction
term. If M is Gaussian, then
                                 
        NDRAFT = E [eÎ³Îµ ] Î²1 exp Î²0 + Î²1 aâˆ— + Î²2 Î¸âˆ— (x) + Î²4âŠ¤ x + 0.5Ïƒ 2 Î²22

and NIRAFT = Î¸â€² (aâˆ— , x)[(Î²2 Î¸(aâˆ— , x) + 0.5Ïƒ 2 Î²22 )/Î²1 ]NDRAFT . On the other hand,
if M follows a Gamma distribution, then
                                                                               
                                                                   Î¸(aâˆ— , x)
      NDRAFT = Î²1 E [eÎ³Îµ ] exp Î²0 + Î²1 aâˆ— + Î²4âŠ¤ x + Î½ log
                                                              Î²2 /Î½ + Î¸(aâˆ— , x)
and
                 NIRAFT = Î»â€² (aâˆ— , x)Î²2 /{Î²1 [Î²2 /Î½ + Î¸(aâˆ— , x)]}NDRaft ,
with Î»(aâˆ— , x) = log Î¸(aâˆ— , x). For speciï¬c links we have: Î»â€² (aâˆ— , x) = âˆ’Î¶1 for the log
link, Î»â€² (aâˆ— , x) = âˆ’Î¶1 /Î¸(aâˆ— , x) for the reciprocal link, and Î»â€² (aâˆ— , x) = Î¶1 Î¸(aâˆ— , x)
for the identity link function.


4.2. Responsiveness Measures in the Additive Aalen Model
   By deï¬nition, the responsiveness associated with the Aalen model is deï¬ned in
terms of the potential hazard functions Î»TaMa and Î»TaMaâˆ— . Unfortunately, in this
particular case, the general expressions of total, direct and indirect sensitivities are

                     Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

174                                             Marcelo M. Taddeo & Leila D. Amorim


cumbersome and can be found in the Appendix C, formulas (A2), (A3) and (A4).
In the following lines, however, we present the respective formulas for the simpler
case in which there is no interaction between exposure and mediator in the survival
model. As usual, the absence of interaction between A and M dramatically
simpliï¬es the direct responsiveness, which is given simply by NDRAalen = Î²1 (t).
The total responsiveness, in turn, is given by T RAalen = Î²1 (t) + Î2 + Î3 , with

  â€¢ Î2 = Ï•âˆ’1 Î²2 (t)EX      â€² âˆ—
                     t,aâˆ— Î¸ (a , X)VarÏ•B2 (t)+Î¸(aâˆ— ,X) M ;
                                                          
  â€¢ Î3 = Ï•âˆ’1 EX            âŠ¤                                   âˆ—
              t,aâˆ— Î²4 (t) X + Î²2 (t)EÏ•B2 (t)+Î¸(aâˆ— ,X) M Ïˆ1,t (a , X);

and Ïˆ1,t as deï¬ned in Appendix B. Finally, the indirect responsiveness is derived
from NDRAalen and T RAalen , so that NIRAalen = Î2 +Î3 (with Î2 and Î3 as given
above).
    For the sake of illustration, we consider once again the Normal and Gamma
distributed mediator without interaction between A and M in the survival (Aalen)
                                                  â€² âˆ—
model. In the Gaussian case, Î2 = Î²2 (t)EX  t,aâˆ— Î¸ (a , X) and
                     h                                                         i
    Î3 = B2 (t)EX
                t,aâˆ—   Î²4 (t)âŠ¤ X + Î²2 (t)Î¸(aâˆ— , X) Î¸â€² (aâˆ— , X) âˆ’ EX     â€² âˆ—
                                                                  t,aâˆ— Î¸ (a , X)


More speciï¬cally, if Î¸(a, x) = Î¶0 + Î¶1 a + Î¶2âŠ¤ x, then NIRAalen = Î¶1 Î²2 (t) and
T RAalen = Î²1 (t) + Î¶1 Î²2 (t). For a Gamma mediator and no confounding, on the
other hand, we have NIRAalen = [Î¸â€² (aâˆ— )/(B2 (t)/Î½ + Î¸(aâˆ— ))2 ]Î²2 (t), which can be
specialized for diï¬€erent link functions by changing the function Î¸.


4.3. Simulation Study
    As in Section 3.6, we conducted a simulation study to assess the eï¬€ect of
misspeciï¬cation in the mediation model (wrong choice of the GLM for M ), but
now regarding the NDR and NIR estimation. We adopted the same procedure,
so that, for each subject we sampled (Ti , Mi , Ai ), with T denoting the survival
time generated by the Cox-exponential model as in Bender et al. (2005) and
Î»(t) = Î»0 (t) exp(Î²1 A + Î²2 M ), with Î²1 = 3.5, Î²2 = âˆ’0.09 and Î»(t) â‰¡ 11. The
treatment A was sampled from a Bernoulli(0.5) and the linear predictor for M
was assumed to be Î¶0 + Î¶1 A, with Î¶0 = 0, Î¶1 = âˆ’1 and scale parameter equal
to 1, associated to the Gamma distribution. The resulting direct and indirect
responsiveness are illustrated in Figures 1 and 2 (dashed lines). They represent
a situation in which an increase in treatment levels implies a direct decrease in
the response variable, particularly in the vicinity of zero (i.e. small increases in
treatment levels starting from zero result in greater changes than small increases
in these levels in already treated individuals). On the other hand, the treatment
has an indirect positive eï¬€ect on the response, though such impact is reduced for
higher doses. To illustrate the method, we estimated both NDR and NIR using
the AFT model by assuming the Gamma (correctly speciï¬ed) and the Gaussian
(misspeciï¬ed) distributions for the mediator as well as sample sizes 200 and 500
and percentages of censoring equal to 0% and 25%. To perform this assessment
we generated 2,000 samples under each conï¬guration.

                  Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                                                                                    175




                                                                                                2.5
                   0
                   âˆ’60 âˆ’50 âˆ’40 âˆ’30 âˆ’20 âˆ’10




                                                                                                1.5
                                                                                         NIR
     NDR




                                                                                                0.5
                                                                                                âˆ’0.5
                                                                                                        0.0    0.2     0.4        0.6    0.8    1.0
                                                                                                                      Treatment level
                                             0.0   0.2    0.4        0.6   0.8   1.0
                                                         Treatment level
                                                                                               (b) NIR, n = 200, 0% censoring
          (a) NDR, n = 200, 0% censoring
           0
           âˆ’60 âˆ’50 âˆ’40 âˆ’30 âˆ’20 âˆ’10




                                                                                             2.5
    NDR




                                                                                             1.5
                                                                                       NIR
                                                                                             0.5
                                                                                             âˆ’0.5
                                             0.0   0.2   0.4        0.6    0.8   1.0
                                                                                                       0.0    0.2    0.4        0.6     0.8    1.0
                                                         Treatment level
                                                                                                                     Treatment level

     (c) NDR, n = 200, 25% censoring
                                                                                             (d) NIR, n = 200, 25% censoring
Figure 1: NDR and NIR estimates based on the AFT model with Gamma mediators
          (log link). The dashed lines stand for the true (rescaled) eï¬€ects, the middle
          solid lines stand for the median responsivenesses and the lower and upper
          solid lines for the 2.5% and 97.5% quantiles.




    Figure 1 presents the estimates of the direct and indirect responsiveness by
assuming the true underlying GLM Gamma model and samples of size 200. Figures
1a and 1b stand for estimates based on samples with no censoring, while Figures
1c and 1d are about the samples with 25% censoring. Simulations indicate that
estimates under no censoring are unbiased, though estimates based on censored
samples may present some bias. Indeed, by looking at Figures 1a and 1b, it is
almost impossible to identify the true curve (dashed lines in all ï¬gures). However,
in all cases, the true curve is between the lower and upper bands based on the 2.5%
and 97.5% quantiles of the simulated estimates at each point of the grid. Similar
results were found for sample size 500, with smaller variability, as expected.

    We also considered the cases where estimation was based on the (misspeciï¬ed)
Gaussian distribution with its canonical link (identity). The results are in Figure
2 (n = 500). As noted in Figures 2a and 2c, the direct responsiveness does not
seem to be very aï¬€ected. In fact the estimates here are not very diï¬€erent as
those obtained by using the true Gamma distribution. This is quite reasonable
for the NDR, since it is less dependent on the mediator than the NIR. On the
other hand, regardless of sample size, NIR estimates are highly biased (Figures
2b and 2d). Such estimates may even go towards to the wrong direction. In
fact, at any treatment level, NIR estimates based on the Gaussian distribution
are negative (indicating a decrease in the response variable as the treatment level

                                                         Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

176                                                                              Marcelo M. Taddeo & Leila D. Amorim




            0




                                                                                       2
            âˆ’60 âˆ’50 âˆ’40 âˆ’30 âˆ’20 âˆ’10




                                                                                       1
                                                                                       0
                                                                                       âˆ’1
      NDR




                                                                                 NIR
                                                                                       âˆ’2
                                                                                       âˆ’3
                                                                                       âˆ’4
                                                                                       âˆ’5
                                      0.0   0.2   0.4        0.6    0.8   1.0               0.0   0.2   0.4        0.6    0.8   1.0
                                                  Treatment level                                       Treatment level


            (a) NDR, n = 500, 0% censoring                                             (b) NIR, n = 500, 0% censoring
            0




                                                                                       2
            âˆ’60 âˆ’50 âˆ’40 âˆ’30 âˆ’20 âˆ’10




                                                                                       1
                                                                                       0
                                                                                       âˆ’1
      NDR




                                                                                 NIR
                                                                                       âˆ’2
                                                                                       âˆ’3
                                                                                       âˆ’4
                                                                                       âˆ’5
                                      0.0   0.2   0.4        0.6    0.8   1.0               0.0   0.2   0.4        0.6    0.8   1.0
                                                  Treatment level                                       Treatment level


            (c) NDR, n = 500, 25% censoring                                            (d) NIR, n = 500, 25% censoring
Figure 2: NDR and NIR estimates based on the AFT model with Gaussian mediators
          (identity link) and sample size 500. The dashed lines stand for the true
          (rescaled) eï¬€ects, the middle solid lines stand for the median responsivenesses
          and the lower and upper solid lines for the 2.5% and 97.5% quantiles.



increases), while the true values are positive (which means an increase in response
by increasing the level of treatment in that neighborhood).


5. Application
    To illustrate the new approaches, we reexamine the mediation model for the
incidence of liver cancer (Figure 3), which was proposed by Huang & Yang (2017).
We use data from a subset of individuals (n = 2, 878) who participated in a
community-based prospective cohort study in Taiwan conducted from 1991 to
1992, see Huang et al. (2011), in which the viral load of hepatitis C (HCV) was
measured at baseline, the viral load of hepatitis B (HBV) was measured during
the follow-up, and the incidence of liver cancer (T ) was recorded prospectively.
We are interested in assessing the eï¬€ect of HCV (A) directly on the liver incidence
(hepatocellular carcinoma) and its eï¬€ect mediated through HBV (M ). The
analyses were adjusted by measured confounders (X): age group (30-39, 40-49, 50-
59, â‰¥ 60 years), gender (female/male), alcohol consumption and cigarette smoking
(no/yes). Viral loads of HBV and HCV were natural log transformed prior to
analyses. For the initial analyses, we dichotomize HCV (detected if > 0/non
detected otherwise).

                                                   Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                      177

                                            X



                                          HBV

                                                               Liver
                      HCV
                                                              cancer

Figure 3: Causal mediation diagram for the relationship between HCV viral load and
          occurrence of liver cancer


    We used total time scale for the survival analyses, such that the entry time was
deï¬ned as the time of measuring HCV (at baseline) and the occurrence of liver
cancer was assessed by data linkage of the national cancer registry and national
death certiï¬cation proï¬les from study entry to December 31, 2008 (end of the
study). The event was also veriï¬ed by medical records. Individuals who were
not diagnosed of liver cancer until the end of the study or those who died from
other causes were censored. The number of patients with liver cancer diagnosis
was 188 (6.53%). Hence, the event is rare and suitable to be evaluated using Cox
proportional hazards model. We compare the results for ï¬tting AFT, Cox and
Aalen models using GLMs, considering diï¬€erent link functions, for the mediator
(HBV) at follow-up. To model the mediator HBV viral load, we considered the
Normal distribution with identity link function and the Gamma distribution with
the logarithm and reciprocal link functions. Conï¬dence intervals for causal eï¬€ects
are obtained via bootstrap method for all survival models. We assumed that there
were no unmeasured confounders of the relationship between HCV and time to
liver cancer (A1), HBV and time to liver cancer (A2), and HCV and HBV (A3).
The composition (A0) and identiï¬ability assumptions (A4) are also required for
any causal claims based on these analyses. All analyses were conducted in R
(version 3.5.3).


5.1. Causal Eï¬€ects for HCV
   Results using the three mediation models revealed similar patterns under
diï¬€erent eï¬€ect scales. As indicated in Table 4, the NDE estimate by using the Cox
model suggest that the detection of HCV viral load at baseline directly increases
the risk of liver cancer (HR = 3.26, 95%CI = [1.75, 6.06])

Table 4: Estimated Natural Direct Eï¬€ect (NDE) of hepatitis C detection on liver cancer
         incidence using diï¬€erent models. Taiwan.1991-2008.
          Models                  Estimate                    95%CI
          AFT (â‹†)                   -0.58                  (-0.90; -0.27)
          Cox model (HR)(â‹†â‹†)        3.26                    (1.75; 6.06)
          Aalen model (â‹†â‹†â‹†)         7.39                   (1.42; 13.29)
          (â‹†) Scale: Diï¬€erence in mean survival time, (â‹†â‹†) Scale: HR=hazard ratio,
          (â‹†â‹†â‹†) Scale: Diï¬€erence in hazard (per 1000 person-year)




                    Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

178                                                 Marcelo M. Taddeo & Leila D. Amorim


   On the other hand, NDE estimates by using the AFT and Aalen models
indicate, respectively, a reduction of 56% (exp(âˆ’0.58)) in the expected time to
diagnosis and a diï¬€erence in the hazard of 7.39 (per 1000 person-years) of liver
cancer for those with detected HBC viral load at baseline compared to non detects.

Table 5: Estimated Natural Indirect Eï¬€ects (NIE) of hepatitis C detection on liver
         cancer incidence mediated through follow-up hepatitis B viral load using
         distinct models. Taiwan.1991-2008.
                                 GLM for Mediator (distribution / link function)
                             Normal                            Gamma(a) ,(b)
      Time-to-event          Identity                   Log                  Inverse
      model            Estimate (95% CI)        Estimate (95%CI)      Estimate (95%CI)
      AFT (â‹†)            0.23 (0.12; 0.35)        0.21 (0.12; 0.29)     0.22 (0.13; 0.31)
      Cox (HR)(â‹†â‹†)       0.63 (0.49; 0.79)        0.47 (0.33; 0.64)     0.45 (0.32; 0.63)
      Aalen(â‹†â‹†â‹†)        -2.03 (-3.14;-1.02)     -2.07 (-2.97; -1.20)  -2.11 (-2.99; -1.19)
      (â‹†) Scale: Diï¬€erence in mean survival time, (â‹†â‹†) Scale: HR=hazard ratio
      (â‹†â‹†â‹†) Scale: Diï¬€erence in hazard (per 1000 person-year)
      (a) AFT, Cox and Aalen estimates conditional on X, here computed for X = 0,
      (b) NIE in Aalen model is time-dependent, approximation is shown.



    Table 5 presents estimates of NIE using diï¬€erent models for the mediator
(varying both distribution of the mediator and link function). All models indicate
a statistically signiï¬cant mediation through follow-up HBV viral load, such that
the NIE points out that the HCV viral load increases the mean time of liver cancer
diagnosis, decreasing the hazard ratio and the diï¬€erence in hazard, according to
the distinct scales of the corresponding models. Residual analysis using the linear
mediator model shows a poor ï¬t (see Figure 1 in the Appendix D). Smallest AIC
was obtained using the Gamma distribution with almost no diï¬€erence between
the link functions. It is important to highlight that the estimates for NIE under
AFT, Cox and Aalen models are conditional on the covariates (X) when using the
Gamma distribution. To illustrate these results, we present the NIE estimates for
30-39 females, no smokers and no drinkers (reference groups for all covariates) in
Table 5. We can compute these estimates for any covariate pattern of our interest.
For instance, the NIE estimates using AFT model and the Gamma distribution are
0.18 (log link) and 0.17 (inverse link) for â‰¥ 60 years, males, smokers and drinkers.
The estimates for the corresponding Cox models are 0.55 and 0.58.
    The NIE for the Aalen model using the Gamma distribution, on the other hand,
is time-dependent. However, for our current application |Î¸(Â·)| is much larger than
B2 (t). We have that max(BÌ‚2 (t)) â‰ˆ 0.15, with Î¸Ì‚(a, x = 0) varying between -0.28
and -0.22 and Î½Ì‚ = 6.11, so that the NIE can be approximated by
                                                                       
                                       1                     1
             NIE = Î²2 Et x
                                                  âˆ’
                             Î¸(aâˆ— , x) + B2 (t)/Î½    Î¸(a, x) + B2 (t)/Î½
                                                
                                1            1
                  â‰ˆ Î²2 Ex              âˆ’           ,
                             Î¸(aâˆ— , x) Î¸(a, x)

which does not depend on time. The NIE estimates using Aalen model and
Gamma distribution indicate a diï¬€erence in hazard (per 1000 person-year) of

                     Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                                           179

âˆ’2.07 (CI0.95 = [âˆ’2.97, âˆ’1.20]) and âˆ’2.11 (CI0.95 = [âˆ’2.99, âˆ’1.19]) for 30-39
females, no smokers and no drinkers (reference groups for all covariates) using,
respectively, log and inverse link functions. Results can be obtained for diï¬€erent
covariate patterns.
    Alternatively, we also considered the log HCV viral load in its original scale
as described in Huang & Yang (2017), so that it is a continuous variable instead
of a binary one as before. The estimated eï¬€ects have the same direction as those
shown in Tables 4 and 5. In short, by increasing the log HCV viral level in one
unit, the estimated natural direct eï¬€ect on the mean survival time is NDEAFT =
âˆ’0.09 (95%CI = [âˆ’0.14, âˆ’0.04]); on the hazard ratio is exp(NDECox ) = 1.20
(95%CI = [1.08, 1.33]); and on the diï¬€erence in the hazard is NDEAalen = 1.20
(per 1000 person-years) 95%CI = [0.17, 1.33]. On the other hand, NIE does
not change substantially when considering diï¬€erent mediator models (varying
distribution and link functions). For instance, the largest diï¬€erence was veriï¬ed
for the Cox model, with NIE varying from HR = 0.85, 95%CI = [0.76, 0.92] to
HR = 0.93, 95%CI = [0.89, 0.96] under, respectively, the Gamma (inverse link)
and Gaussian distributions. Residual analysis for these mediator models were very
similar as those presented in Appendix D.


5.2. Responsiveness Measures for HCV
    To illustrate the responsiveness measure for continuous exposure, we consider
the natural log transformed viral load of HCV. Figure 4 presents the natural
direct and indirect responsiveness for the AFT model using diï¬€erent mediator
models. Though the NDRaft is not very sensitive to the mediation modeling, the
                                                               8
         âˆ’6




                                                               6
         âˆ’8
         âˆ’10
   NDS




                                                         NIS
                                                               4
         âˆ’12




                                                               2
         âˆ’14




                                                               0




               0   5            10             15   20             0   5            10             15   20
                       log of HCV viral load                               log of HCV viral load



         (a) Natural direct responsiveness               (b) Natural indirect responsiveness
Figure 4: Responsiveness measures of the liver cancer in terms of the log HCV viral
          load using AFT model with Normal (dotted line) and Gamma distributions
          (logarithm link: solid line; inverse link: dashed line) for the mediator.


NIRaft estimates indicate a larger responsiveness to treatment when considering
the Gamma distribution. Small increases in the hepatitis C viral load directly
imply a greater reduction in the expected time until the diagnosis of liver cancer
when the viral load is relatively low. On the other hand, it is noted that, indirectly,
the hepatitis B viral load (mediator) behaves in a protective way. However, such

                          Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

180                                              Marcelo M. Taddeo & Leila D. Amorim


a protective eï¬€ect becomes less relevant as the viral load of hepatitis C increases.
The responsiveness measures associated to the Aalen model depend both on HCV
values and time (Figure 5). However, the eï¬€ect of time on the hazard function
is not as relevant as the eï¬€ect of the HCV, as depicted in Figures 3(a) and 3(b).
Regarding the log HCV viral load, the higher its value the faster the indirect eï¬€ect
on the hazard of diagnosis of liver cancer. Since we are assuming the coeï¬ƒcients
in the Aaalen model are constant in time, NDRAalen is invariant with respect to
time and HCV viral load, so that NDRAalen = NDEAalen .




         (a) Gamma with log link                 (b) Gamma model with inverse link

Figure 5: Responsiveness measures of liver cancer hazard in terms of the log HCV viral
          load using Aalen model and a Gamma mediator with diï¬€erent link functions




6. Conclusions
    This article presents formulas for GLM mediation when a time-to-event
outcome is of interest and the AFT, Cox or Aalen models are used. Under the
Aalen additive and Cox models, the eï¬€ects are characterized, respectively, on the
hazard diï¬€erence and on the log hazard ratio scales. At the same time, AFT
examine the eï¬€ect on the mean survival time diï¬€erence. Therefore, the eï¬€ects
estimated using AFT models are in the opposite direction compared to the other
two models (Cox and Aalen), conveying complementary information when both
are properly applied. We derive general expressions to the direct and indirect
eï¬€ects when the mediation process can be described by a GLM. Particularly, we
allow interaction between exposure and mediator in all models. For concreteness,
we focused on particular distributions for the mediator: Gaussian, Gamma,
Binomial and Poisson, but related formulas can be readily extended to other
distributions. Even though causal mediation estimators for survival models are
available when the mediator is continuous (Normal distributed) or binary, to
our knowledge, not much has been proposed for mediators of diï¬€erent nature
to handle time-to-event data. For instance, Albert & Nelson (2011) consider

                   Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                    181

in another context, not including censored data, the use of GLM for mediation
analysis. Tchetgen Tchetgen (2013), on the other hand, describes a inverse odds
ratio-weighted approach for eï¬€ect decomposition in GLMs with a nonlinear link
function, including mediation analysis using the Cox proportional hazards model.
    We successfully illustrate our approach by analyzing the incidence of liver
cancer in a community-based prospective cohort study in Taiwan. The analysis
showed that the HCV viral load directly aï¬€ects liver cancer increasing its risk, but
indirectly, via HBV viral load, has an opposite eï¬€ect. The use of diï¬€erent eï¬€ect
scales to investigate the impact of HCV viral load (continuous or categorized)
on liver cancer and mediator models for HBV viral load yielded consistent
assessments. The data are fully anonymised and were made publicly available
by Huang & Yang (2017), so that the interested reader may follow the link therein
to download the data. This empirical example demonstrates the ï¬‚exibility of
our framework and its potential for studying mediation eï¬€ects, linking theoretical
knowledge and empirical evidence to reï¬ne the scientiï¬c theories for complex
relationships. In fact, mediation models oï¬€er a more detailed view of the
underlying mechanism and, hence, a more comprehensive understanding of the
phenomena. Further reï¬nements related to the application by considering diï¬€erent
mediation arrangements are topics for subsequent research. Indeed, our data
analysis using deviance residuals indicates the need for more sensitive models in
order to capture asymmetry and heteroskedastic errors. For example, the modeling
of the dispersion parameter, as in Smyth (1989), though not related to mediation
analysis, could be considered as an alternative to be developed in this framework.
    The proposed approach has a number of strenghts. Survival models provide a
compelling framework for many research questions, and extensions via inclusion of
GLMs for the mediator may encompass a broad ï¬eld of applied research, allowing
the often necessary control for confounding. In fact, a major limitation related
to existing statistical theory and software tools for causal mediation analysis
with survival outcomes is the conï¬nement to continuous or binary mediators, see
Huang & Yang (2017), Pratschke et al. (2016) and VanderWeele (2015). We
provided a rigorous methodological justiï¬cation of our approach, focusing on the
identiï¬cation of the direct and indirect natural eï¬€ects and oï¬€ering analytical
expressions under the presence of GLM mediation. In particular, it is worth
noticing that the additive hazard model naturally embodies the possible time
dependence of the corresponding coeï¬ƒcients, yielding additional ï¬‚exibility. We
also have proposed responsiveness measures capable of assessing the local impact
of small changes in the level of (continuous) treatment by both direct and indirect
pathways. In particular, this allows us to assess the most critical levels of
treatment (in terms of impact on the outcome) in the sense of identifying the
regions in which small changes in exposure imply larger variations in the outcome.
Estimation of the modelâ€™s parameters for our approach may be performed using
standard statistical packages. We use R (version 3.5.3) to conduct the simulation
studies and the data analyses. The R code for our data analysis is provided at
https://github.com/lamorim-br/Mediation_survival-HBV.git.
   Nevertheless, it is important to mention some limitations to the proposed
analytical framework. Firstly, assumptions regarding the survival part must

                  Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

182                                                Marcelo M. Taddeo & Leila D. Amorim


be carefully assessed according to the chosen survival model. For instance,
the proportionality of the hazards under the Cox model should be evaluated.
Besides that, the expressions for Cox models only apply under the rare-outcome
assumption. Nevertheless, a weighting approach to handle common outcomes
is described by VanderWeele (2015) and might be likewise extended to this
general framework. Lange et al. (2012) also consider weighting each observation
using a generalized marginal structural model, allowing the use of diï¬€erent link
functions for the outcome (e.g., logistic model), and extended this framework
for Cox and Aalen models. The assumptions for the GLM part should also be
adressed accordingly. Secondly, the identiï¬cation of the estimators are valid
under stringent assumptions (A0)â€“(A4), which should be addressed to make
causal claims. It is essential to highlight that we assumed the usual conditions
of no unmeasured confoundness between exposure and outcome (A1), mediator
and outcome (A2), and exposure and mediator (A3). The identiï¬cation and
measurement of confounders are required to draw defensible causal claims from
non-experimental data, which depends on previous empirical evidence and solid
knowledge of the theoretical mechanism. The theoretical and computational
assessment of the eï¬ƒciency and statistical consistency regarding the estimators
of the natural direct and indirect eï¬€ects is still a subject for future studies.
    The development of approaches for causal mediation analysis for time-to-event
outcomes is an active area of methodological research. We have discussed in
this paper a particular case for mediation analysis for survival data when the
mediator is measured somewhere between the exposure and outcome and may be
described by means of a GLM model. Future extensions of our approach include
mediation analysis for time-to-event data with multiple GLM mediators, which
could allow estimation of path-speciï¬c eï¬€ects through diï¬€erent mediators. Indeed,
Miles et al. (2020) proposed a semiparametric procedure to assess path-speciï¬c
eï¬€ects in a diï¬€erent context, which points to further developments in the survival
framework. We assumed no missing data and accurately measured variables, so
that further developments may account for missing data and measurement errors.
Additionaly, in many settings mediation analysis involves multiple mediators, time-
varying causal eï¬€ects, and time-varying exposures and mediators, see Didelez
(2019), Fasanelli et al. (2019), Robins et al. (2000) and Vansteelandt et al. (2019).
Extensions of our approach to circumstances involving multiple and time-varying
mediators/confounders could be considered as well.




Acknowledgements

      LDA was partly supported by a FIOTEC Fellowship (IGM-009-FEX-17).


                                                                          
                   Received: March 2021 â€” Accepted: December 2021

                     Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                     183

References
Aalen, O. O., Borgan, O. & Gjessing, H. K. (2008), Survival and Event History
 Analysis: A Process Point of View, Springer, New York.
Aalen, O., RÃ¸ysland, K. & Gran, J. (2012), â€˜Causality, mediation and time:
 a dynamic viewpointâ€™, Journal of the Royal Statistical Society - Series A
 175(4), 831â€“861.
Aalen, O., Stensrud, M., Didelez, V., Daniel, R., RÃ¸ysland, K. & Strohmaier, S.
 (2020), â€˜Time-dependent mediators in survival analysis: Modeling direct and
 indirect eï¬€ects with the additive hazards modelâ€™, Biometrical Journal 62, 532â€“
 549.
Albert, J. & Nelson, S. (2011), â€˜Generalized Causal Mediation Analysisâ€™,
  Biometrics 67, 1028â€“1038.
Baron, R. M. & Kenny, D. A. (1986), â€˜The moderatorâ€“mediator variable
  distinction in social psychological research: Conceptual, strategic and statistical
  considerationsâ€™, Journal of Personality and Social Psychology 51, 1173â€“1182.
Bender, R., Augustin, T. & Blettner, M. (2005), â€˜Generating survival times to
  simulate Cox proportional hazards modelsâ€™, Statistics in Medicine 24, 1713â€“
  1723.
Daniel, R., Stavola, B., Cousens, S. & Vansteelandt, S. (2015), â€˜Causal mediation
 analysis with multiple mediatorsâ€™, Biometrics 71, 13â€“14.
Didelez, V. (2019), â€˜Deï¬ning causal mediation with a longitudinal mediator and a
  survival outcomeâ€™, Lifetime Data Analysis 25, 593â€“610.
Fasanelli, F., Giraudo, M., Ricceri, F., Valeri, L. & Zugna, D. (2019), â€˜Marginal
  Time-Dependent Causal Eï¬€ects in Mediation Analysis With Survival Dataâ€™,
  American Journal of Epidemiology 188(5), 967â€“974.
Fulcher, I., Tchetgen Tchetgen, E. & Williams, P. (2017), â€˜Mediation Analysis
  for Censored Survival Data Under an Accelerated Failure Time Modelâ€™,
  Epidemiology 28(5), 660â€“666.
Huang, Y.-T., Jen, C.-L., Yang, H.-I., Lee, M.-H., Lu, S.-N., Iloeje, U. &
 Chen, C.-J. (2011), â€˜Lifetime risk and sex diï¬€erence of hepatocellular carcinoma
 among patients with chronic hepatitis B and Câ€™, Journal of Clinical Oncology
 29(27), 3643â€“3650.
Huang, Y.-T. & Yang, H.-I. (2017), â€˜Causal mediation analysis of survival
 outcomes with multiple mediatorsâ€™, Epidemiology 28(3), 370â€“378.
Iacobucci, D. (2012), â€˜Mediation analysis and categorical variables: the ï¬nal
  frontierâ€™, Journal of Consumer Psychology 22, 582â€“594.
Imai, K., Keele, L. & Tingley, D. (2010), â€˜A general approach to causal mediation
  analysisâ€™, Psychological Methods 15, 309â€“334.

                   Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

184                                             Marcelo M. Taddeo & Leila D. Amorim


Kalbï¬‚eisch, J. D. & Prentice, R. L. (2002), The Statistical Analysis of Failure
 Time Data, 2 edn, Wiley, Hoboken, N.J.

Lange, T. & Hansen, J. (2011), â€˜Direct and indirect eï¬€ects in a survival contexâ€™,
  Epidemiology 22, 575â€“581.

Lange, T., Vansteelandt, S. & Bekaert, M. (2012), â€˜A simple uniï¬ed approach
  for estimating natural direct and indirect eï¬€ectsâ€™, American Journal of
  Epidemiology 176, 190â€“195.

Lin, S.-H., Young, J., Logan, R. & VanderWeele, T. (2017), â€˜Mediation
  analysis with a survival outcome with time-varying exposures, mediators and
  confoundersâ€™, Statistics in Medicine 36, 4153â€“4166.

Loyes, T., Moerkerke, B., De Smet, O., Byusse, A., S. & J. Vansteelandt, S. (2013),
  â€˜Flexible mediation analysis in the presence of nonlinear relations: beyond the
  mediation formulaâ€™, Multivariate Behavioral Research 48(6), 871â€“894.

MacKinnon, D. (2008), Introduction to statistical mediation analysis, Taylor and
 Francis, New York.

MacKinnon, D. P. & Dwyer, J. H. (1993), â€˜Estimating mediated eï¬€ects in
 prevention studiesâ€™, Evaluation Review 17, 144â€“158.

MacKinnon, D., Warsi, G. & Dwyer, J. (1995), â€˜A simulation study of mediated
 eï¬€ect measuresâ€™, Multivariate Behavioral Research 30, 41â€“62.

Miles, C., Shpitser, I., Kanki, P., Meloni, S. & Tchetgen Tchetgen, E. (2020), â€˜On
 semiparametric estimation of apath-speciï¬c eï¬€ect in the presence of mediator-
 outcome confoundingâ€™, Biometrika 107(1), 159â€“172.

Pearl, J. (2001), â€˜Direct and indirect eï¬€ectsâ€™, Proceedings of the 17th Annual
  Conference on Uncertainty in Artiï¬cial Intelligence (UAI-01) pp. 411â€“442.

Pratschke, J., Haase, T., Comber, H., Sharp, L., Cancela, M. & Johnson, H.
  (2016), â€˜Mechanisms and mediation in survival analysis: towards an integrated
  analytical frameworkâ€™, BMC Medical Research Methodology pp. 16â€“27.

Robins, J., HernÃ¡n, M. & Brumback, B. (2000), â€˜Marginal structural models and
  causal inference in epidemiologyâ€™, Epidemiology 11, 550â€“560.

Smyth, G. (1989), â€˜Generalized linear models with varying dispersionâ€™, Journal of
  the Royal Statistical Society: Series B 51(1), 47â€“60.

Tchetgen Tchetgen, E. (2013), â€˜Inverse odds ratio-weighted estimation for causal
  mediation analysisâ€™, Statistics in Medicine 32, 4567â€“4580.

Tchetgen Tchetgen, E. & Shpitser, I. (2012), â€˜Semiparametric theory for causal
  mediation analysis: eï¬ƒciency bounds, multiple robustness and sensitivity
  analysisâ€™, Annals of statistics 40(3), 1816â€“1845.

                  Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                    185

VanderWeele, T. (2011), â€˜Causal mediation analysis with survival dataâ€™,
  Epidemiology 22(4), 582â€“585.
VanderWeele, T. (2015), Explanation in Causal Inference: Methods for Mediation
  and Interaction, Oxford University Press, New York.
VanderWeele, T. (2016), â€˜Mediation Analysis: a Practitionerâ€™s Guideâ€™, Annual
  Review of Public Health 37, 17â€“32.
VanderWeele, T. & Vansteelandt, S. (2009), â€˜Conceptual issues concerning
  mediation, interventions and compositionâ€™, Statistics and its Interface 2, 457â€“
  468.
VanderWeele, T. & Vansteelandt, S. (2010), â€˜Odds ratios for mediation analysis
  with a dichotomous outcomeâ€™, American Journal of Epidemiology 172, 1339â€“
  1348.
Vansteelandt, S., Linder, M., Vandenberghe, S., Steen, J. & Madsen, J.
  (2019), â€˜Mediation analysis of time-to-event endpoints accounting for repeatedly
  measured mediators subject to time-varying confoundingâ€™, Statistics in Medicine
  38, 4828â€“4840.



Appendix A.
Appendix A.1. Proof of formula (3) â€“ Accelerated Failure
              Rate Model
   Notice that
                                               Z
  E[TaMaâˆ— |x] = EMaâˆ— E[TaMaâˆ— |Maâˆ— , x] =           E[TaMaâˆ— |Maâˆ— = m, x]dPMaâˆ— (m|x).

From (A3) and then (A1),
             Z                              Z
E[TaMaâˆ— |x] = E[Tam |m, x]dPMaâˆ— (m|aâˆ— , x) = E[Tam |a, m, x]dPMaâˆ— (m|aâˆ— , x),

so that                              Z
                   E[TaMaâˆ— |x] =         E[T |a, m, x]dPM (m|aâˆ— , x).

Using the fact that the time to evento follows the accelerated failure rate model,
                                               Z
                                   âŠ¤
          E[TaMaâˆ— |x] = eÎ²0 +Î²1 a+Î²4 x E [eÎ³Îµ ] e(Î²2 +Î²3 a)m dPM (m|aâˆ— , x).

On the other hand, it is known that the moment generating function of M (given
aâˆ— and x) is equal to
                                                                        
                                   b [Î¸(aâˆ— , x) + Ï„ Ï•] âˆ’ b [Î¸(aâˆ— , x)]
             EM eÏ„ M |aâˆ— , x = exp                                         , (A1)
                                                      Ï•

                  Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

186                                                       Marcelo M. Taddeo & Leila D. Amorim


so that,
                                                                                                   
                               âŠ¤                     b [Î¸(aâˆ— , x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸(aâˆ— , x)]
E[TaMaâˆ— |x] = eÎ²0 +Î²1 a+Î²4 x E [eÎ³Îµ ] exp                                                                 .
                                                                          Ï•


Appendix A.2. Proof of formula (6 â€“ Aalen Model)
   From the proof of Proposition 4.7, Appendix A.4.4 (p. 502), VanderWeele
(2015), if (A1)-(A4) hold, then, for Î´ > 0,

       P(TaMaâˆ— âˆˆ (t, t + Î´]|TaMaâˆ— â‰¥ t, x)
             Z
                                              P(Tam â‰¥ t|x) M
           = P(T âˆˆ (t, t + Î´]|T â‰¥ t, a, m, x)                  dP (m|aâˆ— , x),
                                              I1 (t|a, aâˆ— , x)
                        R
where I1 (t|a, aâˆ— , x) = P(Tamâ€² â‰¥ t|x)dP(mâ€² |aâˆ— , x). Now,

      P{Tamâ€² â‰¥ t|x} = P{T â‰¥ t|a, mâ€² , x}
                         
                    = exp B0 (t) + B1 (t)a + B2 (t)mâ€² + B3 (t)amâ€² + B4 (t)âŠ¤ x ,
                 Rt
where Bj (t) =    0
                       Î²j (s)ds, so that

 I1 (t|a, aâˆ— , x)
        Z
                
     = exp B0 (t) + B1 (t)a + B2 (t)mâ€² + B3 (t)amâ€² + B4 (t)âŠ¤ x dPM (mâ€² |aâˆ— , x)

and hence
                      
I1 (t|a, aâˆ— , x) = exp B0 (t) + B1 (t)a + B4 (t)âŠ¤ x E [exp {(B2 (t) + B3 (t)a)M |aâˆ— , x}] .

Using the fact that Î»TaMaâˆ— (t) = limÎ´â†’0 P(t < TaMaâˆ— â‰¤ t + Î´|TaMaâˆ— â‰¥ t)/Î´ can be
written as
                          Z
                                 1
             Î»TaMaâˆ— (t) =    lim P(t < TaMaâˆ— â‰¤ t + Î´|TaMaâˆ— â‰¥ t, x)
                             Î´â†’0 Î´

and then applying the bounded convergence theorem, we have
                 Z Z
                        Î»(t|a, m, x) exp {(B2 (t) + B3 (t)a)m} M
  Î»TaM âˆ— (t) =                                                 dP (m|aâˆ— , x)dPX (x|TaMaâˆ— â‰¥ t).
         a               E [exp {(B2 (t) + B3 (t)a)M |aâˆ— , x}]

Hence,
                                   Z
 Î»TaM âˆ— (t) = Î²0 (t) + Î²1 (t)a +       Î²4 (t)âŠ¤ xdPX (x|TaMaâˆ— â‰¥ t) + (Î²2 (t) + Î²3 (t)a)I2 (t|a, aâˆ— , x),
        a



where
                        Z
                            E [M exp {(B2 (t) + B3 (t)a)M } |aâˆ— , x] X
   I2 (t|a, aâˆ— , x) =                                               dP (x|TaMaâˆ— â‰¥ t).
                             E [exp {(B2 (t) + B3 (t)a)M |aâˆ— , x}]

                        Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                                187

Now, using the fact that the distribution of M is a member of the Exponential
family (given aâˆ— and x),
                                                              
          Ï„M âˆ—
                           b [Î¸(aâˆ— , x) + Ï„ Ï•] âˆ’ b [Î¸(aâˆ— , x)] â€²
   E M e |a , x = exp                                            b [Î¸(aâˆ— , x) + Ï„ Ï•] ,
                                             Ï•
so that                                      
                            E M eÏ„ M |aâˆ— , x
                                                = bâ€² [Î¸(aâˆ— , x) + Ï„ Ï•] ,
                             E [eÏ„ M |aâˆ— , x]
and
                            Z
       I2 (t|a, aâˆ— , x) =       bâ€² [Î¸(aâˆ— , x) + (B2 (t) + B3 (t)a)Ï•] dPX (x|TaMaâˆ— â‰¥ t).

On the one hand, using assumptions (A1)-(A4),
                           Z
         P(TaMaâˆ— â‰¥ t|x) = P(TaMaâˆ— â‰¥ t|Maâˆ— = m, x)dP Maâˆ— (m|x),

so that                                    Z
                 P(TaMaâˆ— â‰¥ t|x) =              P(Tam â‰¥ t|m, x)dP M (m|aâˆ— , x).

Therefore,
                        P(TaMaâˆ— â‰¥ t|x) = E [ST (t|a, M, x)|aâˆ— , x] ,
where ST (t|a, m, x) is the survival function of T . Besides that,
                       Z Z
     P(TaMaâˆ— â‰¥ t) =          P(TaMaâˆ— â‰¥ t|Maâˆ— = m, xâ€² )dP Maâˆ— (m|xâ€² )dPX (xâ€² )

so that                                Z
                 P(TaMaâˆ— â‰¥ t) =            E [ST (t|a, M, xâ€² )|aâˆ— , xâ€² ] dPX (xâ€² ).

Hence,
                                               E [ST (t|a, M, x)|aâˆ— , x] dPX (x)
              dPX (x|TaMaâˆ— â‰¥ t) = R                                                    .
                                               E [ST (t|a, M, xâ€² )|aâˆ— , xâ€² ] dPX (xâ€² )
From (2),
      E [ST (t|a, M, x)|aâˆ— , x]
                
        = exp B0 (t) + B1 (t)a + B4 (t)âŠ¤ x E [exp {(B2 (t) + B3 (t)a)M } |aâˆ— , x]
and then using (A1),
E [ST (t|a, M, x)|aâˆ— , x]
                                                                                    
                                       b [Î¸âˆ— (x) + (B2 (t) + B3 (t)a)Ï•] âˆ’ b [Î¸âˆ— (x)]
  = exp B0 (t) + B1 (t)a + B4 (t)âŠ¤ x +                                                 ,
                                                             Ï•
so that
                                                                                  
                                          b[Î¸ âˆ— (x)+(B2 (t)+B3 (t)a)Ï•]âˆ’b[Î¸ âˆ— (x)]
                         exp B4 (t)âŠ¤ x +                      Ï•
                                                                                      dPX (x)
   dPX (x|TaMaâˆ— â‰¥ t) = R    n                                                         o           .
                                          b[Î¸ âˆ— (xâ€² )+(B2 (t)+B3 (t)a)Ï•]âˆ’b[Î¸ âˆ— (xâ€² )]
                         exp B4 (t)âŠ¤ xâ€² +                      Ï•
                                                                                        dPX (xâ€² )


                      Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

188                                                        Marcelo M. Taddeo & Leila D. Amorim


Therefore, if we write for notational convenience dPX (x|TaMaâˆ— â‰¥ t) â‰¡
dQt (x|a, aâˆ— ), then
                           Z
                    âˆ—
          I2 (t|a, a , x) = bâ€² [Î¸(aâˆ— , x) + (B2 (t) + B3 (t)a)Ï•] dQt (x|a, aâˆ— ).

and
                                     Z
Î»TaMaâˆ— (t) = Î²0 (t) + Î²1 (t)a +          Î²4 (t)âŠ¤ xdQt (x|a, aâˆ— ) + (Î²2 (t) + Î²3 (t)a)I2 (t|a, aâˆ— , x),

or
Î»TaMaâˆ— (t) =Î²0 (t) + Î²1 (t)a
                          âŠ¤                                                       âˆ—
                                                                                     
            + EX t Î²4 (t) X + (Î²2 (t) + Î²3 (t)a)EÎ¸(aâˆ— ,X)+(B2 (t)+B3 (t)a)Ï• M |a, a .


Appendix A.3. Proof of formula (10 â€“ Cox Model)
      Assuming the Cox model, we know that
                                           
                 Î»Ta Maâˆ— (t|x) = Î»o (t) exp Î²1 a + Î²4âŠ¤ x r(t|a, aâˆ— , x),

where
                        R                   n              âŠ¤
                                                                          o
                            e(Î²2 +Î²3 a)m exp âˆ’Î›o (t)eÎ²1 a+Î²4 x+(Î²2 +Î²3 a)m dP (m|aâˆ— , x)
     r(t|a, aâˆ— , x) =            R                  âŠ¤                                   ,
                                   exp âˆ’Î›o (t)eÎ²1 a+Î²4 x+(Î²2 +Î²3 a)m dP (m|aâˆ— , x)

see VanderWeele (2015), Proposition 4.4, p. 496. Now, if the events are rare, i.e.
Î›o (t) â‰ˆ 0, and using (A1), then
                        h                    i                                                    
                                                      b [Î¸(aâˆ— , x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸(aâˆ— , x)]
      r(t|a, aâˆ— , x) â‰ˆ E e(Î²2 +Î²3 a)M |aâˆ— , x = exp                                                  .
                                                                           Ï•

Hence,
                                                                                      
                                          b [Î¸(aâˆ— , x) + (Î²2 + Î²3 a)Ï•] âˆ’ b [Î¸(aâˆ— , x)]
Î»Ta Maâˆ— (t|x) â‰ˆ Î»o (t) exp Î²1 a + Î²4âŠ¤ x +                                                .
                                                               Ï•


Appendix B. Binomial and Poisson Distributions
            for M
Binomial Mediator

    Writing g(Ï€) = log{Ï€/(1 âˆ’ Ï€)}, Ï• = 1 and b(Î¸) = m log(1 + eÎ¸ ), we have the
following cases:

     â€¢ AFT and Cox Models: using (4) and (5) (or (11) and (12)), it follows that

                                                     (1 + eÎ¸(a,x)+Î²2 +Î²3 a )/(1 + eÎ¸(a,x) )
                NIECox â‰ˆ NIEAFT = m log                                                        ,
                                                    (1 + eÎ¸(aâˆ— ,x)+Î²2 +Î²3 a )/(1 + eÎ¸(aâˆ— ,x) )

                        Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                                             189

     and
                                                                                   âˆ—
                                                  1 + eÎ¸(a ,x)+Î²2 +Î²3 a
                                                        âˆ—
            NDECox â‰ˆ NDEAFT = Î²1 (a âˆ’ a ) + m log                         .
                                                  1 + eÎ¸(aâˆ— ,x)+Î²2 +Î²3 aâˆ—

  â€¢ Aalen Model: using (8) and (9), we get
                                                                                                              
                     X            m(Î²2 (t) + Î²3 (t)a)                   m(Î²2 (t) + Î²3 (t)a)                âˆ—
        NIEAalen = Et                                         âˆ’                        âˆ—            a, a
                             eâˆ’(B2 (t)+B3 (t)a)+Î¸(a,X)) + 1       eâˆ’(B2 (t)+B3 (t)a)+Î¸(a ,X)) + 1

     and NDEAalen = Î²1 (t)(a âˆ’ aâˆ— ) + E(t; a, aâˆ— ) âˆ’ E(t; aâˆ— , aâˆ— ), with
                                                                                    
                                                  m(Î²2 (t) + Î²3 (t)a)
          E(t; a, aâˆ— ) = EX    Î² 4 (t) âŠ¤
                                         X +                                  a, a âˆ—
                           t
                                             eâˆ’(B2 (t)+B3 (t)a+Î¸(aâˆ— ,X)) + 1
                                            h                          i
                                                 Î¸(aâˆ— ,x)+B2 (t)+B3 (t)a m
     and dQt (x|a, aâˆ— ) âˆ exp B4 (t)âŠ¤ x 1+e 1+eÎ¸(aâˆ— ,x)                    dPX (x).


Poisson Mediator

   Writing g(Âµ) = log Âµ, Ï• = 1 and b(Î¸) = eÎ¸ , we have the following cases:

  â€¢ AFT and Cox Models: using (4) and (5) (or (11) and (12)), it follows that
                                                          âˆ—
                                                                 
            NIECox â‰ˆ NIEAFT = eÎ²2 +Î²3 a âˆ’ 1 eÎ¸(a,x) âˆ’ eÎ¸(a ,x) ,

     and
                                                     âˆ—
                                                                      âˆ—
                                                                         
            NDECox â‰ˆ NDEAFT = Î²1 (a âˆ’ aâˆ— ) + eÎ²2 +Î¸(a ,x) eÎ²3 a âˆ’ eÎ²3 a .

  â€¢ Aalen Model: from (8) and (9), we have
                                                         h                               i
                                                                        Î¸(aâˆ— ,X)       âˆ—
         NIEAalen = (Î²2 (t) + Î²3 (t)a)eB2 (t)+B3 (t)a EX
                                                       t   e Î¸(a,X)
                                                                    âˆ’ e          |a, a

     and NDEAalen = Î²1 (t)(a âˆ’ aâˆ— ) + E(t; a, aâˆ— ) âˆ’ E(t; aâˆ— , aâˆ— ), with
                         h                                                                     i
                                                               B2 (t)+B3 (t)a+Î¸(aâˆ— ,X)
       E(t; a, aâˆ— ) = EX
                       t   Î² 4 (t) âŠ¤
                                     X + (Î² 2 (t) + Î² 3 (t)a)e                         |a, a âˆ—


                                             âˆ—                       
     and dQt (x|a, aâˆ— ) âˆ exp B4 (t)âŠ¤ x + eÎ¸(a ,x) eB2 (t)+B3 (t)a âˆ’ 1 dPX (x).


Appendix C. Responsiveness Measures for the
            Aalenâ€™s Model
   Write the density in (7) as qt,a,aâˆ— (x) = Ï†t,a,aâˆ— (x)/Î¦t,a,aâˆ— , where
                                                                                    
                                 b [Î¸(aâˆ— , x) + (B2 (t) + B3 (t)a)Ï•] âˆ’ b [Î¸(aâˆ— , x)]
   Ï†t,a,aâˆ— (x) = exp B4 (t)âŠ¤ x +
                                                          Ï•

                    Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

190                                                          Marcelo M. Taddeo & Leila D. Amorim

                   R
and Î¦t,a,aâˆ— =           Ï†t,a,aâˆ— (xâ€² )dPX (x). Then, âˆ‚a Ï†t,a,a (x) = Ï•âˆ’1 ÏˆÌƒ1,t (a, x)Ï†t,a,a (x),
where

        ÏˆÌƒ1,t (a, x) = (Î¸â€² (a, x) + B3 (t)Ï•)EÏ•(B2 +B3 a)+Î¸(a,x) M âˆ’ Î¸â€² (a, x)EÎ¸(a,x) M
                             R
and âˆ‚a Î¦t,a,a = Ï•âˆ’1              Ïˆ0,t (a, xâ€² )Ï†t,a,a (xâ€² )dPX (xâ€² ), so that

                                       âˆ‚a Î¦t,a,a  1
                                                 = EX   ÏˆÌƒ1,t (a, X),
                                        Î¦t,a,a    Ï• t,a
                                              âˆ’1
with EX      X
      t,a = Et,a,a . Hence, âˆ‚a qt,a,a (x) = Ï•    Ïˆ1,t (a, x)qt,a,a (x), with

                                 Ïˆ1,t (a, x) = ÏˆÌƒ1,t (a, x) âˆ’ EX
                                                               t,a ÏˆÌƒ1,t (a, X).

From (6), we have

                   TRAalen = âˆ‚a Î»TaMa (t)|a=aâˆ— = Î²1 (t) + Î1 + Î2 + Î3 ,                            (A2)

where Î1 = Î²3 (t)EX
                  t,aâˆ— EÏ•(B2 (t)+B3 (t)aâˆ— )+Î¸(aâˆ— ,X) M ,

       Î2 = Ï•âˆ’1 (Î²2 (t) + Î²3 (t)aâˆ— )EX                â€² âˆ—
                                     t,aâˆ— (Ï•B3 (t) + Î¸ (a , X))VarÏ•(B2 (t)+B3 (t)aâˆ— )+Î¸(aâˆ— ,X) M,


and
                 h                                                             i
   Î3 = Ï•âˆ’1 EX          âŠ¤                     âˆ—                                        âˆ—
             t,aâˆ— Î²4 (t) X + (Î²2 (t) + Î²3 (t)a )EÏ•(B2 (t)+B3 (t)aâˆ— )+Î¸(aâˆ— ,X) M Ïˆ1,t (a , X).



      Similarly, âˆ‚a Ï†t,a,aâˆ— (x) = ÏˆÌƒ2,t (a, x)Ï†t,a,aâˆ— (x), where

                                 ÏˆÌƒ2,t (a, x) = B3 (t)EÎ¸(aâˆ— ,x)+(B2 +B3 a)Ï• M
                        R
and âˆ‚a Î¦t,a,aâˆ— =            ÏˆÌƒ2,t (a, xâ€² )Ï†t,a,aâˆ— (xâ€² )dPX (xâ€² ). Hence,

                                        âˆ‚a Î¦t,a,aâˆ—
                                                   = EX
                                                      t,a ÏˆÌƒ2,t (a, X),
                                         Î¦t,a,aâˆ—

so that âˆ‚a qt,a,aâˆ— (x) = Ïˆ2,t (a, x)qt,a,a (x), where

                                 Ïˆ2,t (a, x) = ÏˆÌƒ2,t (a, x) âˆ’ EX
                                                               t,a ÏˆÌƒ2,t (a, X)

and, using (6) again,

                NDRAalen = âˆ‚a Î»TaMaâˆ— (t|x)|a=aâˆ— = Î²1 (t) + Î1 + Îâ€²2 + Îâ€²3 ,                         (A3)

where

   â€¢ Îâ€²2 = (Î²2 (t) + Î²3 (t)aâˆ— )B3 (t)EX
                                      t,a VarÏ•(B2 (t)+B3 (t)aâˆ— )+Î¸(aâˆ— ,X) M ;
                                                                                  
   â€¢ Îâ€²3 = EX          âŠ¤                     âˆ—                                        âˆ—
            t,aâˆ— Î²4 (t) X + (Î²2 (t) + Î²3 (t)a )EÏ•(B2 (t)+B3 (t)aâˆ— )+Î¸(aâˆ— ,X) M Ïˆ2,t (a , X).



                            Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

Causal Mediation for Survival Data                                                           191

Finally,

              NIRAalen = TRAalen âˆ’ NDRAalen = (Î2 âˆ’ Îâ€²2 ) + (Î3 âˆ’ Îâ€²3 ),                   (A4)

where

      Î2 âˆ’ Îâ€²2 = Ï•âˆ’1 (Î²2 (t) + Î²3 (t)aâˆ— )EX    â€² âˆ—
                                          t,a Î¸ (a , X)VarÏ•(B2 (t)+B3 (t)aâˆ— )+Î¸(aâˆ— ,X) M

and
                   h                                                             i
   Î3 âˆ’ Îâ€²3 = EX          âŠ¤                     âˆ—                                        âˆ—
               t,aâˆ— Î²4 (t) X + (Î²2 (t) + Î²3 (t)a )EÏ•(B2 (t)+B3 (t)aâˆ— )+Î¸(aâˆ— ,X) M Ïˆ3,t (a , X)


with Ïˆ3,t (aâˆ— , x) = Ï•âˆ’1 Ïˆ1,t (aâˆ— , x) âˆ’ Ïˆ2,t (aâˆ— , x).


Appendix D. Additional results for causal
            mediation analysis




Figure 6: Deviance residual analysis when assuming (a) Normal, (b) Gamma with log
          link and (c) Gamma with inverse link distributions.




                     Revista Colombiana de EstadÃ­stica - Applied Statistics 45 (2022) 161â€“191

