Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors. Modelos mixtos para estudios pretest-posttest en poblaciones ﬁnitas con error en la respuesta
Universidad Nacional de Colombia, Bogotá, Colombia. Universidade de São Paulo, São Paulo, Brazil. University of Massachusetts, Amherst, USA
Abstract
We consider a ﬁnite population mixed model that accommodates response errors and show how to obtain optimal estimators of the ﬁnite population parameters in a pretest-posttest context. We illustrate the method with the estimation of the diﬀerence in gain between two interventions and consider a simulation study to compare the empirical version of the proposed estimator (obtained by replacing variance components with estimates) with the estimator obtained via covariance analysis usually employed in such settings. The results indicate that in many instances, the proposed estimator has a smaller mean squared error than that obtained from the standard analysis of covariance model.
Key words: analysis of covariance; BLUP; optimal estimator; random permutation model, .
Resumen
Se considera un modelo mixto para población ﬁnita que tiene en cuenta el error de respuesta y que arroja estimadores óptimos de los parámetros de la población ﬁnita, para analizar datos de estudios con estructura del tipo pretest-posttest. Se ilustra el método estimando la diferencia en ganancia entre dos intervenciones y se considera un estudio de simulación para comparar la versión empírica del estimador propuesto (obtenido al reemplazar las componentes de varianza con sus estimativas) con el estimador obtenido vía análisis de covarianza, que es usualmente empleado en este tipo de estudios. Los resultados indican que en muchas circunstancias, el estimador propuesto tiene menor error cuadrático medio que el obtenido del análisis estándar usando el modelo de covarianza.
Palabras clave: análisis de covarianza; BLUP; estimador óptimo; modelo de permutación aleatoria.




1. Introduction

    Pretest-posttest studies are frequently used in areas such as Biology, Medicine,
Psychology etc. The objective, in general, is to assess the eﬀects of some
kind of intervention (a treatment, for example) on some response distribution.
The procedure consists of measuring the response variable before and after an
intervention. We motivate our proposal via a study conducted at the Faculty
of Medicine of the University of São Paulo, Brazil, designed to evaluate the
homogeneous resistance of the respiratory system (HRRS) of mice under two
experimental conditions. Each of 29 mice exposed to synthetic air (pretest) had
the HRRS measured. A group of 15 mice was selected at random from the 29 and
again submitted to synthetic air in the posttest period [control group (C)]. The
remaining 14 mice were exposed to a mixture of Helium-Oxygen [treatment group
(T )] in the posttest period. All mice had posttest HRRS measured. A proﬁle plot
of the data is shown in Figure 1.


                                                                         Synth. Air
                                               0.13
                                                                         He and O2
                                               0.12
                                               0.11
                                               0.10
                      Homogeneous resistance




                                               0.09
                                               0.08
                                               0.07
                                               0.06
                                               0.05
                                               0.04
                                               0.03
                                               0.02
                                               0.01
                                               0.00

                                                      Pre-test           Post-test
Figure 1: Proﬁle plot of homogeneous resistance of the respiratory system (HRRS) of
          mice.


                Revista Colombiana de Estadística
                                          1       - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 127


   Statistical analyses of pretest-posttest studies have been addressed by
numerous authors, among which we mention Brogan & Kutner (1980), Laird
(1983), Stanek III (1988), Knoke (1991), Singer & Andrade (1997), Bonate (2000),
Yang & Tsiatis (2001), Leon, Tsiatis & Davidian (2003), Aoki, Achcar, Bolfarine
& Singer (2003) and Alencar, Singer & Rocha (2012).
    In particular, the analysis of covariance model considered in Laird (1983) is
suited for the setup described above. It assumes that the pretest HRRS, Yi1∗ ,
i = 1, . . . , n, are ﬁxed and that

           Yi2h∗ = µ2 + τh + β(Yi1∗ − Y 1 ) + ehi , i = 1, . . . , nh , h = C, T ,           (1)

                         P
                         n
where Y 1 = n−1                  Yi1∗ , τC + τT = 0, eC i and eT i are uncorrelated random
                                                  E                    E           V     V
                        i=1
measurement errors such that (eC i ) = (eT i ) = 0, (eC i ) = (eT i ) = σe2 .
The term µ2 corresponds to the average posttest HRRS, β represents the common
linear regression coeﬃcient relating the posttest HRRS (Yi2h∗ ) to the pretest HRRS
(Yi1∗ ) and τC (τT ) corresponds to the eﬀect of the ventilation with C (T ) on the
average posttest HRRS.
   A scatterplot of the HRRS along with the corresponding least squares
                E
regression line, \                     b ∗ − Y 1 ), h = C, T , is displayed in Figure 2.
                            b2 + τbh + β(Y
                 (Yi2h∗ ) = µ              i1




                                             Synth. Air (......)
                               0.12




                                             He and O2 (- - -)
                  Pós−Teste
                               0.08
                   Post-test
                               0.04
                               0.00




                                      0.00            0.04                 0.08   0.12
                                          Pre-test
                                         Pré−Teste
Figure 2: Scatter plot for the pretest and posttest measurements and expected curves
          under model (1).


    In many practical situations, the assumptions underlying model (1) may not
hold or may be diﬃcult to verify as in Figure 2, where the straight lines generated
by model (1) do not ﬁt the data appropriately. To bypass this problem, we follow
the ideas of Stanek III & Singer (2004) and propose an alternative model stemming
directly from ﬁnite population sampling without additional assumptions and thus

                Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148




                                                                   1

128                          Luz Mery González, Julio M. Singer & Edward J. Stanek III


is design-based. We assume that response error may be present in the observed
values.
    In Section 2 we describe the ﬁnite population mixed model for the analysis
of pretest-posttest designs. In Section 3 we present a simulation study designed
to compare the performance of the proposed estimators to that of the standard
analysis of covariance estimators. Section 4 is dedicated to the analysis of the
motivating example. We conclude with a brief discussion in Section 5.



2. The Finite Population Mixed Model for Pretest-
   Posttest Designs With Response Error
    We deﬁne a ﬁnite population as a collection of N identiﬁable units, labeled
s, s = 1, . . . , N , using a notation similar to that employed in Stanek III, Singer
& Lencina (2004). In particular, we assume the existence of three quantities
associated to unit s, namely, the pretest response ys1 , the posttest response for
                                                 C
unit s exposed to the control treatment, ys2       and the posttest response for unit
                                       T
s exposed to active treatment, ys2 . Also, we assume that if any unit could be
submitted to both treatments, the three values would be observed (possibly) with
response error. In practice, unit s is randomly submitted to one treatment, C or
                       C       T
T , and therefore ys2    and ys2 are regarded as the potential responses of unit s in the
posttest. The potential response approach (or potential observation approach) has
been considered by diﬀerent authors such as Leon, Tsiatis & Davidian (2003) under
a pretest-posttest context, Rubin (2005) under a diﬀerent design of experiments
context and Pfeﬀermann (2017) under an observational study context.
    We formalize the process of simple random sampling without replacement
by introducing a ﬁnite population model according to which any permutation
of units in the population can be selected with equal probability (N !)−1 . We
assign a new label, i = 1, . . . , N , to each unit according to its position in the
permutation and represent the pretest and the potential posttest responses by
a N × 3 random matrix [Y 1 , Y C2 , Y T2 ] where Y 1 = (Y11 , . . . , Yi1 , . . . , YN 1 )⊤ and
Y h2 = (Y12
          h
            , . . . , Yi2h , . . . , YNh2 )⊤ , h = C, T .
    To associate the values y 1 = (y11 , . . . , ys1 , . . . , yN 1 )⊤ and            y h2    =
                              h ⊤                           C       T
                                2 ) , h = C, T , to Y 1 , Y 2 and Y 2 , we consider
  h             h
(y12 , . . . , ys2 , . . . , yN

                             [Y 1 Y C2 Y T2 ] = U [y 1 y C2 y T2 ]                           (2)

where U = [U 1 , . . . , U N ]⊤ is a N × N matrix with U i = (Ui1 , . . . , UiN )⊤ and
Uis is an indicator random variable that takes on a value 1 if unit s is selected in
position i in the permutation and zero otherwise. Letting the subscript S indicate
                                                                     E
expectation with respect to permutation of units, we have S (U ) = N −1 J N and
V S (vec(U )) = (N − 1)
                           −1
                              (P N ⊗ P N ) where J a = 1a 1⊤
                                                           a , 1a is an a × 1 column
vector with all elements equal to 1, P a,b = I a − b−1 J a , P a = P a,a , I a is an
a × a identity matrix, and vec and ⊗ respectively denote the vec operator and the
Kronecker product [see Harville (1997), for example].

                 Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 129


   To include response error both in the pretest and in the posttest response we
consider the model

                   [Y ∗1 Y C∗
                           2  Y T2 ∗ ] = U [(y 1 y C2 y T2 ) + (E 1 E C2 E T2 )]                           (3)

where Y ∗1 = (Y11   ∗
                      , . . . , Yi1∗ , . . . , YN∗ 1 )⊤ , Y h∗      h∗           h∗            h∗ ⊤
                                                            2 = (Y12 , . . . , Yi2 , . . . , YN 2 ) , h =
                   C      T
C, T and [E 1 E 2 E 2 ] is a random matrix with E 1 = (E11 , . . . , Es1 , . . . , EN 1 )⊤
and E h2 = (E12
              h
                 , . . . Es2h
                               , . . . , EN h ⊤
                                               2 ) , h = C, T for which  E  R (Es1 ) =      E      h
                                                                                              R (Es2 ) = 0,
V             2
  R (Es1 ) = σs1 ,     V        h              h 2
                         R (Es2 ) = (σs2 ) . We also assume that the variables Es1 , Es2 ,
                                                                                                        C
  T
Es2 and Uis , s = 1, . . . , N , are uncorrelated. The subscript R denotes expectation
with respect to the response error distribution.
    In particular, for position i in a permutation,

                               X
                               N                                       X
                                                                       N
                      Yi1∗ =         Uis (ys1 + Es1 ) = µ1 + di1 +            Uis Es1 ,
                               s=1                                     s=1
                                                                                                           (4)
                               X
                               N                                       X
                                                                       N
                     Yi2h∗ =               h
                                     Uis (ys2    h
                                              + Es2 ) = µh2 + dhi2 +               h
                                                                              Uis Es2 ,
                               s=1                                      s=1


                 P
                 N                                                        P
                                                                          N                     P
                                                                                                N
where di1 =           Uis δs1 , with δs1 = ys1 − µ1 , µ1 = N −1                ys1 , dhi2 =                h
                                                                                                      Uis δs2 ,
                s=1                                                      s=1                    s=1
                                                     P
                                                     N
      h
with δs2    h
         = ys2 − µh2 and µh2 = N −1                        h
                                                          ys2 ,   h = C, T .       Note that µh2 can
                                                    s=1
                                                                                   P
                                                                                   N
be reparametrized as µh2 = µ1 + γ + αh where γ = (2N )−1                                    C
                                                                                          (ys2    T
                                                                                               + ys2 ) and
                                                                                   s=1
αh = µh2 − µ1 − γ.
   Then, the mixed model for ﬁnite populations pretest-posttest designs with
response error may be expressed as

                   Z ∗ = vec[(Y ∗1 Y 2C∗ Y T2 ∗ )] = (I 3 ⊗ 1N )µ + d + E ∗                                (5)

where µ = (µ1 µC2 µT2 )⊤ corresponds to a vector of populational (ﬁxed eﬀects)
pretest and posttest means, µ1 , µC2 and µT2 , d = [d⊤                 1      (dC2 )⊤ (dT2 )⊤ ]⊤ , with
                                        ⊤
d1 = (d11 , . . . , di1 , . . . , dN 1 ) and d2 = (di2 , . . . , di2 , . . . , dhN 2 )⊤ , h = C, T , is a
                                              h     h             h

vector of random eﬀects, and E ∗ = [E ⊤              C ⊤
                                                1 (E 2 )      (E T2 )⊤ ]⊤ , with E 1 = Y ∗1 − Y 1
and E 2 = Y 2 − Y 2 , h = C, T , denoting the vector of the permuted response
        h        h∗         h

errors.
   The vector of populational means and covariance matrix of Z ∗ are given
respectively by
                                       ESR (Z ∗ ) = (I 3 ⊗ 1N )µ,
and
                 VSR (Z ∗ ) = diag{σ21 I N , σ2C2 I N , σ2T 2 I N } + Σ ⊗ P N ,
                    Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

130                              Luz Mery González, Julio M. Singer & Edward J. Stanek III


where P a is deﬁned in the sequence to expression (2) and
                            "N          #
                              X                  X
                                                 N
                     2
                   σ1 = S        E
                                 σs1 Uis = N −1
                                  2                   2
                                                    σs1 ,
                                       s=1                             s=1
                                      "N                    #                                             (6)
                                       X                                 X
                                                                         N
                                                                                  
                     σ h2
                       2 =       ES            h 2
                                             (σs2 ) Uis = N −1                   h 2
                                                                               σs2      ,
                                       s=1                               s=1
                                                         C         T 
                                           σ11          σ21       σ21
                                      Σ = σ21
                                            C            CC
                                                        σ22        CT 
                                                                  σ22                                     (7)
                                            T            CT        TT
                                           σ21          σ22       σ22
                             P
                             N                                                  P
                                                                                N
with σ11 = (N − 1)−1               (ys1 − µ1 )2 , σ21
                                                   h
                                                      = (N − 1)−1                       h
                                                                                      (ys2 − µh2 )(ys1 − µ1 ),
                             s=1                                                s=1
      ′              P
                     N                        ′     ′
 hh
σ22 = (N − 1)−1              h
                           (ys2 − µh2 )(ys2
                                         h
                                            − µh2 ), h = C, T , h′ = C, T .
                     s=1
      Target random variables and optimal predictors.
      In general, our interest is to estimate (predict) linear combinations of the form

                           X
                           N
                                                       XN
                                                                                
                   T =            cCi1 Yi1 + cCi2 Yi2C +   cTi1 Yi1 + cTi2 Yi2T                           (8)
                           i=1                                  i=1

where the cCi1 , cCi2 , cTi1 , and cTi2 are known constants attached to position i in
the permutation. Depending on the choice of cCi1 , cCi2 , cTi1 and cTi2 the quantity
T may represent a parameter or a random eﬀect. Here we are concerned with
the estimation of linear combinations of the parameters of model (5), i.e., of the
elements of the vector µ.
    To specify the average response diﬀerence (posttest minus pretest) for the C
intervention,
                                      X
                                      N
                                                    
                            TC = N −1     Yi2C − Yi1 ,
                                                  i=1

we use cCi2 = N −1 , cCi1 = −N −1 and cTi2 = cTi1 = 0, i = 1, . . . , N .
    To specify the average response diﬀerence (posttest minus pretest) for the T
intervention,
                                      XN
                                                    
                           TT = N −1      Yi2T − Yi1 ,
                                                  i=1

we use cTi2 = N −1 , cTi1 = −N −1 and cCi2 = cCi1 = 0, i = 1, . . . , N .
      To specify the average response diﬀerence between the interventions C and T ,

                                     X
                                     N
                                                                      X
                                                                       N
                                                                                       
                              −1
                   TD = N                  Yi2C − Yi1       −N    −1
                                                                             Yi2T − Yi1 ,                 (9)
                                     i=1                               i=1

we use cTi1 = cCi2 = N −1 and cTi2 = cCi1 = −N −1 , i = 1, . . . , N .


                  Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 131


   To estimate/predict T in expression (8), under the ﬁnite population mixed
model (5) based on a simple random sample obtained without replacement, we
assume, without loss of generality, that

 i) the ﬁrst n positions in the random permutation, i.e., i = 1, . . . , n, correspond
    to the selected units in a simple random sample of size n from the ﬁnite
    population,

 ii) for the ﬁrst nC selected units, i.e., for i = 1, . . . , nC (< n), we observe Yi1
     and Yi2C directly or indirectly (when there is response error), but we do not
     observe Yi2T , because we suppose that the ﬁrst nC units are only exposed to
     the C intervention

iii) for the remaining n − nC (= nT ) selected units, i.e., for i = nC + 1, . . . , n, we
     observe Yi1 and Yi2T directly or indirectly (when there is response error), but
     we do not observe Yi2C , because we assume that the last nT selected units are
     only exposed to the T intervention.

As a result, T in expression (8) can be rewritten as

                                            T = T (1) + T (2)                                              (10)

with
                           X
                           nC
                                                         X
                                                          n
                                                                                                
                T (1) =            cCi1 Yi1 + cCi2 Yi2C +                cTi1 Yi1 + cTi2 Yi2T
                           i=1                                 i=nC +1

and

           X
           N
                                         XnC
                                                                    X
                                                                     N
                                                                                                               
T (2) =             cCi1 Yi1 + cCi2 Yi2C +    cTi1 Yi1 + cTi2 Yi2T +                       cTi1 Yi1 + cTi2 Yi2T .
          i=nC +1                               i=1                            i=nC +1


Given that T (1) is observed, to estimate T in expression (8), we must predict T (2)
and this may be accomplished via standard methods to obtain minimum variance
unbiased linear predictors.
   In the ﬁrst step, we partition Z ∗ in expression (5) into the sample and the
remainder via the pre-multiplication of Z ∗ by
                                                                   
                                                             KI
                                                K=                                                         (11)
                                                             K II

where
                                                                                     
                           1   0    0       ⊗         I nC + nT 0(nC +nT )×(N −nC −nT )
                                                                                     
                                                                                        
              KI =  0         1    0       ⊗                 I nC 0nC ×(N −nC )         
                                                                                    
                      0        0    1       ⊗          0nT ×nC I nT 0nT ×(N −nC −nT )


                    Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

132                                    Luz Mery González, Julio M. Singer & Edward J. Stanek III


and
                                                                                               
                            I3                     ⊗       0(N −nC −nT )×(nC +nT ) I N −nC −nT
                                                                                             
                       
                K II =  0 1 0                     ⊗        0nT ×nC I nT 0nT ×(N −nC −nT )  .
                                                                                               
                          0 0 1                     ⊗                I nC 0nC ×(N −nC )

 In the case where N = nC + nT , the matrices K I and K II can be written as
                                                                                                 
                                                1       0       0           ⊗           IN
                                                                                              
                                                                                                 
                               K I,N =  0              1       0           ⊗       I nC 0nC ×nT 
                                                                                              
                                          0             0       1           ⊗       0nT ×nC I nT

and
                                                                                                
                                                0       1       0           ⊗       0nT ×nC I nT
                             K II,N =                                                            .
                                                0       0       1           ⊗       I nC 0nC ×nT

 Letting                                                                          
                                                   Z ∗I                     KI Z∗
                                                                =                      ,
                                                   Z ∗II                    K II Z ∗
it follows that
           ∗
 Z ∗I = [Y1,1             ∗
              , . . . , Y(n C +nT ),1
                                          C∗
                                      , Y1,2 , . . . , YnC∗
                                                          C ,2
                                                                   T∗
                                                               , Y(n C +1),2
                                                                                         T∗
                                                                             , . . . , Y(n C +nT ),2
                                                                                                     ]⊤

and

           ∗
Z ∗II = [Y(n C +nT +1),1
                                    ∗
                         , . . . , YN,1     C∗
                                        , Y(n C +nT +1),2
                                                                     C∗
                                                          , . . . , YN,2     T∗
                                                                         , Y(n C +nT +1),2
                                                                                                      T∗
                                                                                           , . . . , YN,2
                                                     C∗                    C∗              T∗
                                                   Y(n C +1),2
                                                               , . . . , Y(n C +nT ),2
                                                                                       , Y1,2 , . . . , YnTC∗,2 ]⊤ .
                                                                                                                           (12)

 For the sake of simplicity and without loss of generality, we assume nC = nT = n0
      2
                
              C 2
                          
                        T 2
and σs1  = σs2     = σs2    , s = 1, . . . , N , under model (5). Then

            E (Z ∗I ) = [H 0 ⊗ 1n ]µ,
                SR                             0

           E (Z ∗II ) = H 1 µ,
              SR

           V (Z ∗I ) = V I∗ = σ21 I 4n + (Σa ⊗ I n ) − N −1 (I 4 ⊗ 1n )Σb (I 4 ⊗ 1n )⊤ ,
                SR                                  0                           0                         0            0

           V (Z ∗II ) = V ∗II = σ21 I 3N −4n + n−1
              SR
                                                    ⊤
                                                0 H 2 (I 4 ⊗ 1n )Σ (I 4 ⊗ 1n ) H 2
                                                                0
                                                                   a            ⊤
                                                                                               0                  0
                                                       CC         
                                                        σ22     0
                                + diag{Σ ⊗ P N −2n0 ,           TT   ⊗ P n0 } − N −1 H 1 ΣH ⊤
                                                                                            1
                                                          0   σ22
                                                              
                                                 I 3 ⊗ 1N −2n0
                                + (N − 2n0 )−1                   Σ(I 3 ⊗ 1⊤
                                                                          N −2n0 |03×2n0 ),
                                                     02n0 ×3
CovSR (Z ∗I , Z ∗II ) = V ∗I,II = (Σa ⊗ I n )H 3 − N −1 (I 4 ⊗ 1n )H 0 ΣH ⊤1
                                                                    0                               0

                                                                                                                       (13)


                       Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 133


with
                                                                                         
                                1 0                                                 1 0
                  1   0     0                  1                          0    0
   Σa =                                    ⊤
                               Σ 0 1 ⊗ e1 e1 +                                      Σ 0 0  ⊗ e 2 e ⊤
                                                                                                     2,
                  0   1     0                    0                          0    1
                                  0 0                                                   0 1
   Σb = H 0 ΣH ⊤
               0,
                 
          1 0 0
        1 0 0
   H0 = 
        0 1 0 ,
                  

          0 0 1
                                                                                                                         (14)
              I3                       ⊗     1N −2n0
                  
   H1 =  0 1 0                                          ,
                                       ⊗        1n0
            0 0 1
                                      
                            0 0
                         0 0        
   H2 =                             
        04n0 ×3(N −2n0 ) 1 0 ⊗ I n0  ,
                            0 1
        nh                 i      o
               −1
   H 3 = (Σa ) Σb − I 4 ⊗ I n0 H 2 ,

ei denotes the i-th column of the matrix I 2 , and P a , µ, σ̄12 and Σ are deﬁned in
expressions (2), (5), (6) and (7), respectively.
   An illustrative example designed to indicate the required elements for the model
speciﬁcation in a simple setup is presented in the Appendix.
   Finally, we minimize the expected mean squared error of the linear predictor
subject to an unbiased restriction, resulting in

         Tb∗ = [D ⊤ (H ⊤
                       4)
                          −1
                             H⊤   a −1
                              0 (Σ )   (I 4 ⊗ 1n0 )⊤ + g ⊤     ⊤    ⊤
                                                         I + g II H 3 ]A
                                                                         −1 ∗
                                                                           ZI                                              (15)

where

       g I = [(cC11 + cT11 ), . . . , (cC2n0 ,1 + cT2n0 ,1 ), cC12 , . . . , cCn0 ,2 , cTn0 +1,2 , . . . , cT2n0 ,2 ]⊤ ,


   g II = [(cC2n0 +1,1 + cT2n0 +1,1 ), . . . ,(cCN 1 + cTN 1 ), cC2n0 +1,2 , . . . , cCN 2 , cT2n0 +1,2 , . . . ,
                                                      cTN 2 , cCn0 +1,2 , . . . , cC2n0 ,2 , cT12 , . . . , cTn0 2 ]⊤ ,

    A = [I 4 + σ 21 (Σa )−1 ] ⊗ I n0 , with σ 21 [= σ̄2C2 = σ̄2T 2 ], deﬁned in expression (6),
   H4 = H⊤   a −1
         0 (Σ )   GH 0 ,
   G = (I 4 ⊗ 1n0 )⊤ A−1 (I 4 ⊗ 1n0 ),
   D = H⊤             ⊤
        0 (I 4 ⊗ 1n0 ) [(I 4n0 − A
                                   −1
                                      )g I − A−1 H 3 g II ] + H ⊤
                                                                1 g II ,
   Z ∗I deﬁned in expression (12) and Σa , H 0 , H 1 and H 3 deﬁned in expression
(14).

                       Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

134                                   Luz Mery González, Julio M. Singer & Edward J. Stanek III


      The variance of the predictor Tb∗ is

 VSR (Tb∗ − T ) = D⊤ (H ⊤4 )−1 D + g⊤I (Σa ⊗ I n )(I 4n − A−1 )gI       0           0
                            ⊤ −1
                    − g⊤
                       II H 3 A    (Σa ⊗ I n0 ) H 3 g II
                                                  −1
                                                      
                    + 2g ⊤
                         I (Σ ⊗ I n0 ) I 4n0 − A
                              a
                                                        H 3 g II
                                                CC                  
                                                 σ22       0
                    + g⊤
                       II diag   Σ ⊗ P N −2n0 ,           TT     ⊗ P n0 g II
                                                   0     σ22
                                                        
                                 −1 ⊤    I 3 ⊗ 1N −2n0                ⊤
                                                                                    
                    + (N − 2n0 ) g II                      Σ I 3 ⊗ 1N   −2n0 |03×2n0 g II
                                             02n0 ×3
                                ⊤                                                       ⊤
                    + n−1  ⊤
                       0 g II H 2 (I 4 ⊗ 1n0 ) Σ (I 4 ⊗ 1n0 ) H 2 g II
                                                a

                                                                                                                                 (16)

                                                                      hh
with P a and H 2 respectively deﬁned in expressions (2) and (14) and σ22 , h = C, T ,
and Σ, in expression (7). Details are presented in the Appendix.
    Given that Σ, and σ 21 [deﬁned in expression (6)] are unknown, expressions (15)
                                                  CT
and (16) cannot be computed. Moreover, σ22            cannot be estimated since a unit
only receives one of the treatments, C or T . To bypass this problem, we propose
to use an empirical version Tbe∗ of Tb∗ , where Σ and σ 21 are replaced by the following
estimates                                     C       T 
                                       b11 σ
                                       σ     b21     b21
                                                     σ
                              b = σ
                              Σ        b21C    CC
                                             b22
                                             σ         CT 
                                                     b22
                                                     σ                              (17)
                                          T   CT      TT
                                       b21 σ
                                       σ     b22 σ   b22
with
                     X
                     n
                              ∗          ∗         ∗              X
                                                                  n
                                                                            ∗      ∗                X
                                                                                                    mi
  b11 = (n − 1)−1
  σ                        (Y i1 − Y 1 )2 , Y 1 = n−1                   Y i1 , Y i1 = m−1
                                                                                       i
                                                                                                              ∗
                                                                                                            Yij1 ,
                     i=1                                          i=1                               j=1

    CC              −1
                       X
                       n0
                                  C∗         C∗         C∗         −1
                                                                      X
                                                                      n0
                                                                                  C∗        C∗               X
                                                                                                             mi
  b22
  σ    = (n0 − 1)           (Y i2 − Y 2 )2 , Y 2 = n0                           Y i2 , Y i2 = m−1
                                                                                               i
                                                                                                                       C∗
                                                                                                                     Yij2 ,
                      i=1                                               i=1                                  j=1

   TT
                       X
                       n
                                       T∗         T∗         T∗                  X
                                                                                 n
                                                                                             T∗        T∗                X
                                                                                                                         mi
 b22
 σ    = (n0 − 1)−1                (Y i2 − Y 2 )2 , Y 2            = n−1
                                                                     0                    Y i2 , Y i2 = m−1
                                                                                                         i
                                                                                                                                 T∗
                                                                                                                               Yij2 ,
                      i=n0 +1                                                   i=n0 +1                                  j=1

    C               −1
                       X
                       n0
                                  ∗          C∗    C∗         C∗         C∗            −1
                                                                                          X
                                                                                          n0
                                                                                                   ∗
  b21
  σ   = (n0 − 1)            (Y i1 − Y 1 )(Y i2 − Y 2 ), Y 1 = n0                                 Y i1 ,
                      i=1                                                                 i=1

    T
                        X
                        n
                                     ∗      T∗    T∗     T∗     T∗                                  X
                                                                                                    n
                                                                                                                ∗
  b21
  σ   = (n0 − 1)−1                (Y i1 − Y 1 )(Y i2 − Y 2 ), Y 1 = n−1
                                                                     0                                        Y i1 ,
                      i=n0 +1                                                                     i=n0 +1

   ∗                   C∗        T∗
 Yij1 (respectively, Yij2  and Yij2  ), j = 1, 2, . . . , mi , denoting a set of pretest
(respectively, posttest under intervention C and posttest under intervention T )
                                                                           CT
response measurements on the unit selected in position i. Here, σ        b22  = 0 and
                                                                         !
                 2            Xn         Xn0
                                                 2        X n
                                                                      2
               b1 = (2n)
               σ          −1
                                  bi1 +
                                  σ 2          C
                                             bi2 +
                                             σ                      T
                                                                  bi2
                                                                  σ        ,
                                            i=1          i=1                      i=n0 +1


                  Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 135

                             P
                             mi                  ∗                           P
                                                                             mi                 C∗
     bi1 = (mi − 1)−1
with σ                                ∗
                                   (Yij1 − Y i1 )2 , (b C 2
                                                      σi2 ) = (mi − 1)−1              C∗
                                                                                   (Yij2 − Y i2 )2 and
                             j=1                                             j=1
   T
       2                   P
                            mi                 T∗
 bi2
 σ          = (mi − 1)−1            T∗
                                 (Yij2 − Y i2 )2 .
                           j=1




3. Simulation Study

   To compare the performance of the proposed estimator Tb∗ in expression (15)
and its empirical version, Tbe∗ , with the estimator based on the analysis of covariance
model (2bτC ), we conducted simulation studies.
    First we generated ﬁnite populations of size N = 300 from each of 17 underlying
distributions, namely

  A) trivariate normal distributions of variables X (pretest), Y (posttest under
     C treatment) and Z (posttest under T treatment) such that (X) = 2,                 E
        E               E
       (Y ) = 5, (Z) = 10, V ar(X) = (Y ) = (Z) = 1,          V         V
                                                                        (X, Y ) =     Cov
     −0.3, 0.2 or 0.5,       Cov
                           (X, Z) = −0.4, 0.2 or 0.4 and       (Y, Z) = 0.2,Cov
  B) trivariate Poisson distributions of variables X (pretest), Y (posttest under
     C treatment) and Z (posttest under T treatment) such that (X) = 1,             E
        E                E              V
       (Y ) = 0.9, (Z) = 1.1, (X) = (Y ) = (Z) = 1,       V         V          Cov
                                                                       (X, Y ) = ρC21 ,
        Cov             T
          (X, Z) = ρ21 and             Cov
                                      (X, Y ) = −0.3, 0.2 or 0.5,                 Cov
                                                                           (X, Z) =
     −0.6, 0.2 or 0.4 and           Cov
                                 (Y, Z) = 0.2, where ρC21 is the correlation between
     the pretest latent values and the posttest control latent values, and ρT21 is
     the correlation between the pretest latent values and the posttest treatment
     latent values. In this case, the correlation is equal to covariance because the
     variances are equal to one. We do not consider the pair                       Cov
                                                                        (X, Y ) = 0.5
     and       Cov
               (X, Z) = −0.6 because for the sake of simplicity, the algorithm was
     not designed to simulate trivariate distributions.

   For each of the 17 generated ﬁnite populations, we set the values X, Y and Z,
                                                      C         T
respectively, as the latent (potential) values ys1 , ys2 , and ys2 , s = 1, . . . , 300 and
computed the ﬁnite population parameters

                                  X
                                  N                                                   X
                                                                                      N
             σ11 = (N − 1)−1            (yi1 − y 1 )2 ,                 y 1 = N −1          yi1 ,
                                  i=1                                                 i=1
                                  X
                                  N                                                   X
                                                                                      N
             σ22 = (N − 1)−1            (yi2 − y 2 )2 ,                 y 2 = N −1          yi2 ,
                                  i=1                                                 i=1
                                  X
                                  N
             σ21 = (N − 1)−1            (yi1 − y 1 )(yi2 − y 2 ),
                                  i=1



                     Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

136                              Luz Mery González, Julio M. Singer & Edward J. Stanek III


letting

                 ρC21 = −0.3, 0.2 or 0.5,
                 ρT21 = −0.4, 0.2 or 0.4 (trivariate normal distribution),
                 ρT21 = −0.6, 0.2 or 0.4 (trivariate Poisson distribution).

We then selected 15, 000 simple random samples without replacement with size
n = 20 from each ﬁnite population so that for each sample we obtained 20 vectors
        C     T ⊤
(yi1 , yi2 , yi2 ) , i = 1, . . . , n (= 20), letting yi1 , i = 1, . . . , n, denote the 20 pretest
                     C
latent values, yi2     , i = 1, . . . , n0 (= 10) denote the 10 posttest control latent values
        T
and yi2   , i = n0 + 1, . . . , n, as the 10 posttest treatment latent values.
                                     C                                         T
    To each yi1 , i = 1, . . . , n, yi2 , i = 1, . . . , n0 (= 10) and yi2       , i = n0 + 1, . . . , n we
added homoskedastic response errors, generated from a normal distribution with
mean zero and variance σ 1 = κV , where V = σ11 + σ22 − 2σ12 with κ denoting a
                                                        ∗                         C∗
constant, obtaining the observed values Yij1               , i = 1, . . . , n, Yij2  , i = 1, . . . , n0 and
  T∗
Yij2  , i = n0 + 1, . . . , n, j = 1, . . . , 10, i.e., mi = 10. We repeated this setup with
κ = 0.0, 0.05, 0.10, 0.15, 0.20.
    For each sample, the estimator in expression (15) and its empirical version, Tbe∗
of expression (9), as well as the estimator based on the analysis of covariance
model (2b  τC ) were computed along with their means, the corresponding mean
squared errors (MSE) and mean absolute error (MAE). We also evaluated the
corresponding relative contribution of the bias to the MSE as [= 100×(estimate-
T )2 /MSE]. On the other hand, for each of the eight scenarios considered under
the trivariate Poisson distribution, we used 100 simple random samples without
replacement with size n = 20 to evaluate the coverage of the non-parametric
conﬁdence intervals (applied to Tbe∗ and to 2b            τC ), based on the BCa (bias corrected
and accelerated) method with α = 0.05 and 2000 bootstrap samples proposed by
Efron & Tibshirani (1993).
    All the simulations and the example were implemented using R Software, (R
Core Team, 2021). The results are displayed in Figures 3, 4, 5, 6 and 7 and show
that the empirical estimator Tbe∗ is a good competitor to the analysis of covariance
estimator, 2τ̂C , especially for non normal distributions. In general, the MSE and
the MAE increase as σ̄1 increases, except when ρT21 = −0.6 under the trivariate
Poisson distribution. Coverage was shorter for α = 0.05 and neither Tbe∗ nor 2b   τC
had better performance with respect to the each other. Also, the MSE decreases
as the sample size increases and the relative contribution of the bias to the MSE
was less than 1% for all the simulations.




                    Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 137

                                                                              ρT21
                              −0.4                                              0.20                                     0.40


        3




                                                                                                                                            −0.3
        2



        1


        3
 MSE




                                                                                                                                            0.20
        2
                                                                                                                                                   ρC21


        1


        3




                                                                                                                                            0.50
        2



        1
              0          1                2          0                   1                   2              0      1             2
                                                                             Mean EMU
                                                                                    2ˆ1
                                                                                     σ̄
                                                                   ∗                      ∗ E.     2τ̂C
                                                               T̂
                                                              Estimator                T̂e
                                                                                     Estimator     Tau


Figure 3: MSE of Tb∗ , Tbe∗ and 2b
                                 τC . Data generated from a trivariate normal distribution
          and n0 = 10.


                                                                              ρT21
                                   −0.6                                           0.20                                   0.40


            0.22

            0.20




                                                                                                                                            −0.3
            0.18

            0.16

            0.14


            0.22

            0.20
  MSE




                                                                                                                                            0.20




            0.18
                                                                                                                                                   ρC21
            0.16

            0.14


            0.22

            0.20
                                                                                                                                            0.50




            0.18

            0.16

            0.14
                   0.0       0.2              0.4   0.6 0.0   1           0.2                0.4         0.6 0.0   0.2          0.4   0.6
                                                                              Mean EMU
                                                                                    2  ˆ1
                                                                                       σ̄
                                                                      ∗                     ∗ E.         2τ̂C
                                                                    T̂
                                                                  Estimator               T̂e
                                                                                       Estimator     Tau


Figure 4: MSE of T̂ ∗ , T̂e∗ and 2τ̂C . Data generated from a trivariate Poisson distribution
          and n0 = 10.




                               Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

138                                                Luz Mery González, Julio M. Singer & Edward J. Stanek III

                                                                               ρT21
                                 −0.4                                            0.20                                           0.40


       1.4




                                                                                                                                               −0.3
       1.2


       1.0




       1.4
 MAE




                                                                                                                                               0.20
       1.2
                                                                                                                                                          ρC21
       1.0




       1.4




                                                                                                                                               0.50
       1.2


       1.0


             0         1                  2            0                   1                  2                    0      1            2
                                                                               Mean EMU
                                                                                      ˆ1
                                                                                      2
                                                                                      σ̄
                                                                   ∗                       ∗ E.            2τ̂
                                                                T̂
                                                               Estimator                T̂e
                                                                                      Estimator            Tau
                                                                                                               C


Figure 5: MAE of T                      b∗   , Tbe∗ and 2b
                                                         τC . Data generated from a trivariate normal distribution
          and n0 = 10.



                                                                               ρT21
                                   −0.6                                           0.20                                          0.40

       0.375

       0.350



                                                                                                                                                   −0.3
       0.325

       0.300

       0.375

       0.350
                                                                                                                                                   0.20
 MAE




                                                                                                                                                          ρC21
       0.325

       0.300

       0.375

       0.350
                                                                                                                                                   0.50




       0.325

       0.300
                 0.0       0.2               0.4     0.6 0.0               0.2                0.4            0.6 0.0      0.2          0.4   0.6
                                                               1                Mean EMU
                                                                                      ˆ12
                                                                                      σ̄
                                                                T̂  ∗
                                                               Estimator                      T̂e∗
                                                                                            Estimator E.           2τ̂
                                                                                                                    Tau
                                                                                                                      C

Figure 6: MAE of T̂ ∗ , T̂e∗ and 2τ̂C . Data generated from a trivariate Poisson distribution
          and n0 = 10.




                             Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 139

                                                                           ρT21
                                             −0.6                                0.20                                         0.40
                      0.90

                      0.85




                                                                                                                                             −0.3
                      0.80

                      0.75
 Estimated coverage




                      0.90

                      0.85




                                                                                                                                             0.20
                      0.80                                                                                                                          ρC21
                      0.75


                      0.90

                      0.85




                                                                                                                                             0.50
                      0.80

                      0.75


                             0.0      0.2           0.4   0.6 0.0        0.2              0.4             0.6 0.0       0.2          0.4   0.6
                                                                           Mean EMU
                                                                                 2   ˆ1
                                                                                     σ̄
                                                                                ∗ E.             2τ̂C
                                                                               T̂e
                                                                           Estimator            Tau


Figure 7: Estimated coverage of T̂e∗ and 2τ̂C . Data generated from a trivariate Poisson
                                   distribution and n0 = 10.




4. Example
    Turning back to the example described in Section 1, we have nC = 15 and
nT = 14. Since, for simplicity, we assumed that nC = nT = n0 in Section 2, we
deleted the last observation of the control group (C). The simplicity of expression
(15) depends on nC = nT = n0 . The proposed estimator, Tb∗ , could be obtained
when nC ̸= nT but require extensive modiﬁcation to the notation and to the
computations.
   In this example, we are interested in the estimation of the diﬀerence between
the average HRRS for interventions C and T . We have a sample of n = 28
animals and assume two values, namely N = 100 and N = 500 for the size of the
corresponding ﬁnite population. We let

                                                                         X
                                                                         n
                                                                                                      ∗
                                                                    −1
                                                    b11 = (n − 1)
                                                    σ                            (Yi1∗ − Y 1 )2
                                                                         i=1
                                                                    1
                                                                         X
                                                                         n
                                                                                                      ∗
                                                    b22 = (n − 1)−1
                                                    σ                            (Yi2∗ − Y 2 )2
                                                                         i=1
                                                                         X
                                                                         n
                                                                                                      ∗             ∗
                                                    b21 = (n − 1)−1
                                                    σ                            (Yi1∗ − Y 1 )(Yi2∗ − Y 2 )
                                                                         i=1



                                            Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

140                             Luz Mery González, Julio M. Singer & Edward J. Stanek III

        ∗             P
                      n                ∗           P
                                                   n
with Y 1 = n−1              Yi1∗ and Y 2 = n−1           Yi2∗ .   We assume that the response
                   i=1                             i=1
error variance σ 21 = (σ C2 )2 = (σ T2 )2 = κV , where κ = 0.0 or κ = 0.10 and
V =σ b11 + σb22 − 2b
                   σ12 . Note that if there is no response error, κ = 0. Also, mi = 1
for all i because we have one response measurement per unit.
    The proposed estimator Tbe∗ and the covariance analysis model estimator in
model (1), namely 2b    τC along with their respective non-parametric conﬁdence
intervals based on the BCa (bias-corrected and accelerated) method with α = 0.05
proposed by Efron & Tibshirani (1993) are shown in Table 1. The R code is
available from https://github.com/LuzM-GitHub/Pretest-Posttest.

Table 1: Diﬀerence (×10−3 ) in average HRRS between the interventions C and T along
         with their respective non-parametric conﬁdence intervals (×10−3 ).
                                                   Conﬁdence interval limits
                                       Estimate    Lower             Upper     Length
             Tbe∗ (N = 100, κ = 0)         -12.2    -26.1             4.7        30.9
                       τC
                      2b                   -10.5    -24.8             5.0        29.8
             Tbe∗ (N = 500, κ = 0)         -12.2    -25.9             5.2        31.1
                       τC
                      2b                   -10.5    -24.9             5.8        30.7
            Tbe∗ (N = 100, κ = 0.10)       -12.2    -26.7             6.0        32.7
            Tb∗ (N = 500, κ = 0.10)
             e                             -12.2    -26.4             5.0        31.4


    From Table 1, we observe that as N increases, the estimate Tbe∗ remains the
approximately the same, indicating that the size of the population exerts small
eﬀect on the corresponding conﬁdence intervals. We also note that the conﬁdence
                                                         τC ) is slightly shorter, but
interval for the analysis of covariance model estimate (2b
at the price of a less general model.


5. Conclusion
     Although the only assumption required by the proposed ﬁnite population
estimators is that the data be obtained by a possibly conceptual simple random
sampling scheme, their performance is comparable to that of estimators based on
the usual normal analysis of covariance model for a variety of problems where a
ﬁnite population is exposed to two kinds of intervention. Target quantities may
correspond to the average gain for the ﬁnite population units expressed as the
linear combinations of their individual latent values. In fact, for asymmetrically
distributed data and n = 20, the proposed estimator, Tbe∗ , has a smaller MSE than
2τ̂C , the estimator stemming from a standard analysis of covariance model.




                   Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 141


   In particular, when Σ in expression (7) is unknown, we can estimate Tb∗ with
diﬀerent pretest sample variances separately for each group (C or T ), i.e., taking
                   C                     C          
                   b11
                   σ               0    b21
                                        σ         0
                a  0               T
                                  b11
                                  σ      0      σ T 
                                                b21
              b =
              Σ                                            b b = H 0 ΣH
                                                      and Σ         b ⊤
                  σ C
                   b21             0      CC
                                        b22
                                        σ         0                    0
                                    T             TT
                    0             b21
                                  σ      0      b22
                                                σ

        C
                             P
                             n0     ∗          C∗                       P
                                                                        n          ∗      T∗
      b11
where σ   = (n0 − 1)−1            (Y i1 − Y 1 )2 , σ T
                                                   b11 = (n0 − 1)−1             (Y i1 − Y 1 )2 ,
                            i=1                                       i=n0 +1
       ∗     C∗    T∗    C
                       b21
and Y i1 , Y 1 , Y 1 , σ      T
                            b21
                           ,σ      CC
                                 b22
                                ,σ     b22
                                      ,σ TT     b are deﬁned in expression (17). In
                                            and Σ
this case, when there is no response error, the estimator Tb∗ in expression (15) is
equal to the estimator obtained via standard analysis of covariance.
    If the interest lies on the diﬀerence between the posttest latent value, ysC (or
 T
ys ) and the pretest latent value ys for the s-th unit in the population, the model
can be extended, but this requires the extended variable approach proposed in
Stanek III & Singer (2004) and Stanek III, Singer & Lencina (2004).


Funding
   This work was developed with ﬁnancial support from Conselho Nacional de
Desenvolvimento Cientíﬁco e Tecnológico (CNPq, grant 304841/2019-6), Brazil,
Universidad Nacional de Colombia, Colombia, and National Institute of Health
(NIH-PHS-R01-HD36848, R01-HL071828-02), USA.
                                                                            
                  Received: January 2021 — Accepted: November 2021


References
Alencar, A., Singer, J. M. & Rocha, F. (2012), ‘Competing regression models for longitudinal data’, Biometrical Journal 54, 214–229.
Aoki, R., Achcar, J. A., Bolfarine, H. & Singer, J. M. (2003), ‘Bayesian analysis of null intercept errors-in-variables regression for pretest-posttest data’, Journal of Applied Statistics 30, 3–12.
Bonate, P. L. (2000), Analysis of pretest-posttest designs, Chapmann & Hall/CRC, Boca Raton.
Brogan, D. R. & Kutner, M. H. (1980), ‘Comparative analysis of pretest-posttest research designs’, The American Statistician 34, 229–232.
Efron, B. & Tibshirani, R. (1993), An Introduction to the Bootstrap, Chapman & Hall, New York.
Harville, D. A. (1997), Matrix Algebra from a Statistician’s Perspective, Springer, New York.
Knoke, J. (1991), ‘Nonparametric analysis of covariance for comparing change in randomized studies with baseline values subject to error’, Biometrics 47, 523–533.
Laird, N. (1983), ‘Further comparative analyses of pretest-posttest research designs’, The American Statistician 37, 329–330.
Leon, S., Tsiatis, A. & Davidian, M. (2003), ‘Semiparametric estimation of treatment eﬀect in a pretest-posttest study’, Biometrics 59, 1046–1055.
Pfeﬀermann, D. (2017), ‘Bayes-based non-bayesian inference on ﬁnite populations from non-representative samples: A uniﬁed approach’, Calcutta Statistical Association Bulletin 69, 35–63.
R Core Team (2021), R: A Language and Environment for Statistical Computing, R Foundation for Statistical Computing, Vienna, Austria. https://www.R- project.org/
Rubin, D. (2005), ‘Causal inference using potential outcomes: Design, modeling, decisions’, Journal of the American Statistical Association 100, 322–331.
Singer, J. & Andrade, D. (1997), ‘Regression models for the analysis of pretest/posttest data’, Biometrics 53, 729–735.
Stanek III, E. (1988), ‘Choosing a pretest-posttest analysis’, The American Statistician 42, 178–183.
Stanek III, E. J. & Singer, J. M. (2004), ‘Predicting random eﬀects from ﬁnite population clustered samples with response error’, Journal of the American Statistical Association 99, 1119–1130.
Stanek III, E. J., Singer, J. M. & Lencina, V. B. (2004), ‘A uniﬁed approach estimation and predition under simple random sampling’, Journal of Statistical Planning and Inference 121, 325–338.
Yang, L. & Tsiatis, A. (2001), ‘Eﬃciency study of estimators for a treatment eﬀect in a pretest-posttest trial’, The American Statistician 55, 314–321.



Appendix. Illustrative Example with a Finite
Population of Size 7
   For illustrative purpose, we consider a hypothetical population of size N = 7
and assume that the response error in the pretest and posttest for unit s can take
                                                                        C      T
only two possible equally likely values given by plus or minus σs1 (= σs2  = σs2 ),
with σ11 = 1, σ21 = 3, σ31 = 10, σ41 = 7, σ51 = 6, σ61 = 5 and σ71 = 0.05.

               Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 143


We consider the selection of a simple random sample of size n = 6 without
replacement, letting the ﬁrst n0 = 3 selected units be exposed to intervention
C and the remaining n0 = n − n0 = 3 units be exposed to intervention T .
                                       ⊤
   Let y 1 = 3.5 7 1.5 4 6 5.5 9 ,
                                                   ⊤
   y C2 = 12.25 13.5 7.75 10.5 15 12.25 18.5 ,
                                                ⊤
   y T2 = 6.75 9.5 8.25 9.5 13 10.25 18.5 ,
                                                ⊤
   E 1 = E11 E21 E31 E41 E51 E61 E71 ,
                                                
                                              C ⊤,
   E C2 = E12
            C     C
                E22     C
                      E32     C
                            E42   C
                                 E52    C
                                      E62   E72
                                                 
                                              T ⊤.
   E T2 = E12T     T
                 E22    T
                       E32    T
                            E42    T
                                 E52     T
                                       E62   E72
     It follows that µ1 = 5.214, µC2 = 12.821, µT2 = 10.821, σ 21 = 31.429[= σ 2C2 =
σ 2T 2 ] and
                                                   
                                6.071 7.815 7.732
                           Σ = 7.815 11.536 11.036 .
                                7.732 11.036 15.119

Then we have,

                                                                        
                             5.214                                   5.214
 E        ∗                
  SR (Z I ) = [H 0 ⊗ 13 ] 12.821 ,
                                            E  SR
                                                   (Z ∗II ) = H 1 12.821 ,
                             10.821                                 10.821
                                     1                            ⊤
 V ∗I = 31.429I 12 + (Σa ⊗ I 3 ) − (I 4 ⊗ 13 ) Σb (I 4 ⊗ 13 ) ,
                                     7
                       1                                ⊤
 V ∗II = 31.429I 9 + H ⊤     (I 4 ⊗ 13 ) Σa (I 4 ⊗ 13 ) H 2
                       3 2
                                                                                      
                           6.071 7.815 7.732
                          1 
                                                                                       
                                                                 11.536      0
         + diag      1−          7.815 11.536 11.036 ,                             ⊗ P3
                         1                                         0      15.119        
                                 7.732 11.036 15.119
                                             
                    6.071 7.815        7.732
            1
         − H 1 7.815 11.536 11.036 H ⊤            1
            7
                    7.732 11.036 15.119
                                                
                   6.071 7.815 7.732
               I3 
         +              7.815 11.536 11.036 (I 3 |03×6 ) ,
              06×3
                        7.732 11.036 15.119
                                                                           
                                                  6.071 7.815 7.732
                              1
 V ∗I,II = (Σa ⊗ I 3 ) H 3 − (I 4 ⊗ 13 ) H 0 7.815 11.536 11.036 H ⊤            1
                              7
                                                  7.732 11.036 15.119


                 Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

144                         Luz Mery González, Julio M. Singer & Edward J. Stanek III


with
                                     
          6.071     0    7.815    0                                               
         0                                                              I3
                  6.071    0    7.732                                     
   Σa = 
        7.815
                                      ,                H1 =  0        1 0        ,
                    0   11.536    0                                          ⊗ 13
                                                                    0   0 1
            0     7.732    0   15.119
                                                                                    
             6.071 6.071 7.815     7.732                              0         0
           6.071 6.071 7.815      7.732                          0          0       
     Σb = 7.815 7.815 11.536 11.036 ,
                                                       H2 =       
                                                             012×3 1
                                                                                   ⊗ I3 
                                                                                        
                                                                                0
             7.732 7.732 11.036 15.119                                0         1
           nh                i    o
                   −1
 and H 3 = (Σa ) Σb − I 4 ⊗ I 3 H 2 .

If a realization of the random matrix U in expression (2) is
                                                    
                                 0 0 0 0 1 0 0
                               0 0 0 0 0 0 1 
                                                    
                               0 1 0 0 0 0 0 
                                                    
                                                    
                           u = 0 0 1 0 0 0 0  ,
                                                    
                               1 0 0 0 0 0 0 
                                                    
                               0 0 0 0 0 1 0 
                                 0 0 0 1 0 0 0
i.e., the selected units are s = 5, s = 7 and s = 2 for the C treatment, s = 3, s = 1
and s = 6 for the T treatment so that s = 4 is not selected, we have
                                                                                         ⊤
Y ∗1{U =u} = (6 + E51 , 9 + E71 , 7 + E21 , 1.5 + E31 , 3.5 + E11 , 5.5 + E61 , 4 + E41 ) ,
Y C∗                C             C          C            C             C
  2 {U =u} = 15 + E52 , 18.5 + E72 , 13.5 + E22 , 7.75 + E32 , 12.25 + E12 ,
                        C
                                       
                                     C ⊤
             12.25 + E62  , 10.5 + E42    ,
     ∗
Y T2 {U              T           T           T            T            T             T
        =u} = 13 + E52 , 18.5 + E72 , 9.5 + E22 , 8.25 + E32 , 6.75 + E12 , 10.25 + E62 ,
                     T ⊤
                        
              9.5 + E42    ,
Z ∗I{U =u} = 6 + E51 , 9 + E71 , 7 + E21 , 1.5 + E31 , 3.5 + E11 , 5.5 + E61 , 15 + E52
                                                                                      C
                                                                                        ,
                       C            C            T            T               T
                                                                                 ⊤
             18.5 + E72  , 13.5 + E22 , 8.25 + E32 , 6.75 + E12  , 10.25 + E62      ,
Z ∗II{U =u} = 4 + E41 , 10.5 + E42
                                 C            T
                                    , 9.5 + E42            C
                                                 , 7.75 + E32            C
                                                              , 12.25 + E12            C
                                                                            , 12.25 + E62 ,
                    T             T            T
                                                   ⊤
              13 + E52 , 18.5 + E72  , 9.5 + E22      .


Derivation of ESR (Z ∗ ) and VSR (Z ∗ ) in Expression (5)
   Given that    ES (U ) = N −1 J N and VS [vec(U )] = (N − 1)−1 (P N ⊗ P N ) we
have
                                                           n                        o
       ESR (Z ∗ ) = ES vec U (y1 yC2 yT2 ) + ESR vec[U (E 1 E C2 E T2 )]
                                             ⊤
                 = (I 3 ⊗ 1N ) µ1 µC2 µT2         ,


                 Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 145

                                                                   
               E                            E
because  SR (Uis Es1 ) = S (Uis ) R (Es1 ) = 0,     E
                                                       SR
                                                                C
                                                           Uis Es2         E
                                                                     = S (Uis ) ×                    E
E R  E C
       s2 =  0 and    SR U   E T
                           is s2  = E S (U is ) R E T
                                                    s2 E = 0,  whereE µ1 , µC2 e µT2
are deﬁned in expression (4), and

                              VSR (Z ∗ ) = ES VR|S (Z ∗ ) + VS ER|S (Z ∗ )
where

               ER|S (Z ∗ ) = vec U y1 yC2 yT2 
and
                                                        n     h                   io
               VR|S (Z ∗ ) = (I 3 ⊗ U ) VR|S vec                   E 1 E C2 E T2
                                                                                                  ⊤
                                                                                         (I 3 ⊗ U ) ,

with
                                                           (" N         # " N         # " N         #)
          n         h                      io              M             M            M      
V   R|S
              vec        E 1 E C2 E T2            = diag             2
                                                                    σs1  ,     C
                                                                              σs2
                                                                                    2
                                                                                       ,     T
                                                                                            σs2
                                                                                                  2
                                                                                                       .
                                                              s=1           s=1                s=1

Then
                                                
                          V   SR
                                   (Z ∗ ) = diag σ 21 I N , σ 2C2 I N , σ 2T 2 I N + Σ ⊗ P N

with P a = I a − a−1 J a , Σ deﬁned in expression (7), and σ 21 , σ 2C2 and σ 2T 2 deﬁned
in expression (6).


Development of the Linear Predictor of T in Expression (8)
and its Variance Under Model (5)
In order to obtain the best linear predictor of

                                     X
                                     N
                                                                XN
                                                                                        
                              T =          cCi1 Yi1 + cCi2 Yi2C +   cTi1 Yi1 + cTi2 Yi2T ,
                                     i=1                        i=1

under model (5), we consider the following three conditions:

a) it must be a linear function of the sample random variables, i.e.,

                                                   Tb∗ = (g ⊤    ⊤   ∗
                                                            I + a )Z I

    where Z ∗I and g I are deﬁned in expressions (12) and (15), respectively,

b) it must be unbiased, i.e.,

                                   ESR  g⊤I + a⊤  Z ∗I  = ES g⊤I Z I + g⊤II Z II 

                           Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

146                                  Luz Mery González, Julio M. Singer & Edward J. Stanek III


   where
                                                                                                     ⊤
                                             C
           Z I = Y11 , . . . , Y2n0 ,1 , Y12   , . . . , YnC0 2 , Y(n  T
                                                                          0 +1),2
                                                                                  ,  . . . , Y  T
                                                                                               2n0 ,2       ,
                
                                                     C
          Z II = Y(2n0 +1),1 , . . . , YN 1 , Y(2n       0 +1),2
                                                                    , . . . , YNC 2 , Y(2nT
                                                                                              0 +1),2
                                                                                                                 T
                                                                                                      , . . . , YN,2 ,
                                                                              ⊤
                    C                       C           T
                  Y(n 0 +1),2
                                , . . . , Y2n 0 ,2
                                                   , Y12   , . . . , YnT0 2 ,

   with g II deﬁned in expression (15) [recall that                                 ESR [Z ∗I ] = ES [Z I ] and
   E      ∗
    SR [Z II ] =      E
                 S [Z II ]].

c) it must minimize           VSR (Tb∗ − T ), i.e.,

       VSR (Tb∗ − T ) = VSR  g⊤I + a⊤  Z ∗I − g⊤I Z I − g⊤II Z II                                                     (A1)
                                                                                                               
          = g⊤
             I +a
                  ⊤
                    V ∗I (g I + a) + g ⊤              ⊤
                                       I V I g I + g II V II g II − 2                             g⊤
                                                                                                   I +a
                                                                                                        ⊤
                                                                                                                    V I gI
                       
           − 2 g⊤
                I +a
                     ⊤
                         V I,II g II − 2g ⊤
                                          I V I,II g II .

   where

         VI =   VS (Z I ) = (Σa ⊗ I n ) − N −1 (I 4 ⊗ 1n )Σb (I 4 ⊗ 1n )⊤ ,
                                                   0                           0                     0

       V I,II = CovS (Z I , Z II ) = CovSR (Z ∗I , Z II ) = CovSR (Z ∗I , Z ∗II ) = V ∗I,II ,

   subject to the constraint
                         
                g⊤I +a
                       ⊤           ∗
                                      E    ⊤
                             SR [Z I ] − g I                  ES (Z I ) − g⊤II ES (Z II ) =                              (A2)
                                                                              II ES (Z II ) = 0.
                                                           a⊤ ESR [Z ∗I ] − g ⊤

    Using Lagrangian multipliers along with expressions (A1) and (A2) we must
solve the system

                         b + (V ∗I − V I )g I − V I,II g II ] = [H 0 ⊗ 1n0 ]λ3×1
                  2[V ∗I a                                                                                               (A3)
                                    [H 0 ⊗ 1n0 ]       ⊤
                                                           b − H⊤
                                                           a    1 g II = 0,                                              (A4)

where V ∗I and V ∗I,II are deﬁned in expression (13), g I and g II are deﬁned in
expression (15), Σa , Σb , H 0 and H 1 are deﬁned in expression (14) and λ is the
Lagrangian multiplier. The result is

           b =(V ∗I )−1 [V I,II g II − (V ∗I − V I )g I ]−
           a                                                                                                             (A5)
                 (V ∗I )−1 (H 0 ⊗ 1n0 ){(H 0 ⊗ 1n0 )⊤ (V ∗I )−1 (H 0 ⊗ 1n0 )}−1 ×
                 {(H 0 ⊗ 1n0 )⊤ (V ∗I )−1 [V I,II g II − (V ∗I − V I )g I ] − H ⊤
                                                                                1 g II }.

Now, observing that

   i) (V ∗I )−1 = [(Σa )−1 ⊗ I n0 ]×
       [A−1 +N −1 A−1 (I 4 ⊗1n0 )H 0 Σ(I 3 −N −1 H 4 Σ)−1 H ⊤   a −1
                                                            0 (Σ )   (I 4 ⊗1⊤
                                                                            n0 )A
                                                                                  −1
                                                                                     ]

                     Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

Finite Population Mixed Models for Pretest-Posttest Designs with Response Errors 147


  ii) [(H 0 ⊗ 1n0 )⊤ (V ∗I )−1 (H 0 ⊗ 1n0 )]−1 = H −1
                                                   4 (I 3 − N
                                                              −1
                                                                 H 4 Σ)

 iii) [(Σa )−1 ⊗ I n ]A−1 (V ∗I − V I ) = (I 4n0 − A−1 ),

  iv) [(Σa )−1 ⊗ I n ]A−1 [Σa ⊗ I n ] = [Σa ⊗ I n ]A−1 [(Σa )−1 ⊗ I n ] = A−1 , where Σ
      is deﬁned in expression (7), Σa and H 0 are deﬁned in expression (14) and
      A and H 4 are deﬁned in expression (15).

it follows that the expression (A5) simpliﬁes to

         b = A−1 [(Σa )−1 H 0 H −1
         a                      4 D ⊗ 1n0 ] − [I 4n0 − A
                                                         −1
                                                            ]g I + A−1 H 3 g II

   We proceed to compute the variance of the proposed estimator, which may be
expressed as

VarSR (Tb∗ − T ) =b
                  a⊤ V ∗I a
                          b + g⊤    ∗
                                                    a⊤ (V ∗I − V I )g I − 2b
                               I (V I − V I )g I + 2b                      a⊤ V I,II g II +
                     g⊤
                      II V II g II

where

   i)

            V II =   VS (Z II ) = +n−1  ⊤                         ⊤
                                    0 H 2 (I 4 ⊗ 1n )Σ (I 4 ⊗ 1n ) H 2
                                                      a
                                                      0               0
                                            CC         
                                             σ22     0
                     + diag{Σ ⊗ P N −2n0 ,           TT   ⊗ P n0 } − N −1 H 1 ΣH ⊤
                                                                                 1
                                               0   σ22
                                                   
                                      I 3 ⊗ 1N −2n0
                     + (N − 2n0 )−1                   Σ(I 3 ⊗ 1⊤
                                                               N −2n0 |03×2n0 ),
                                          02n0 ×3

  ii)
                              ⊤                                                        
        â⊤ V ∗I a
                 b = D ′ H −1
                           4    D + g⊤    ∗                 ⊤
                                     I (V I − V I ) g I − g I (Σ ⊗ I n0 ) I 4n0 − A
                                                                a                   −1
                                                                                         gI
                            ⊤               ⊤ −1
        − N −1 g ⊤                    ⊤
                 II H 1 ΣH 1 g II + g II H 3 A    (Σa ⊗ I n0 ) H 3 g II
                      −1
                                    a −1             ⊤
        − 2D ⊤ H ⊤   4     H⊤ 0 (Σ )     (I 4 ⊗ 1n0 ) A−1 (V ∗I − V I ) g I
                h      i−1
                                           ⊤
        + 2D ⊤ H ⊤  4      H⊤0 [I 4 ⊗ 1n0 ] A
                                               −1
                                                  H 3 g II − 2g ⊤    ∗
                                                                I [V I − V I ] A
                                                                                 −1
                                                                                    H 3 g II
                             −1                   −1
        − 2g ⊤
             I (Σ ⊗ I n0 ) A
                 a
                                H 3 g II + 2g ⊤
                                              I A    (Σa ⊗ I n0 ) H 3 g II ,

 iii)
                                   h    i−1
                                                 a −1             ⊤
        b ⊤ (V ∗I − V I ) g I = D ⊤ H ⊤
        a                             4     H⊤
                                             0 [Σ ]   [I 4 ⊗ 1n0 ] A−1 [V ∗I − V I ] g I
                                        ∗                 ⊤ −1
                                − g⊤
                                   I (V I − V I ) g I + g I A  (V ∗I − V I ) g I
                                        ⊤ −1
                                + g⊤
                                   II H 3 A  (V ∗I − V I ) g I ,


                  Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

148                           Luz Mery González, Julio M. Singer & Edward J. Stanek III


 iv)
                                 −1
                                                     ⊤
        b ⊤ V I,II g II = D ⊤ H ⊤
        a                       4     H⊤
                                       0 (I 4 ⊗ 1n0 ) A
                                                        −1
                                                           H 3 g II
                                          ⊤
                       − N −1 g ⊤                    ⊤
                                II H 1 ΣH 1 g II − g I (Σ ⊗ I n0 ) H 3 g II
                                                         a

                              −1                                ⊤ −1
                       + g⊤
                          I A    (Σa ⊗ I n0 ) H 3 g II + g ⊤
                                                           II H 3 A  (Σa ⊗ I n0 ) H 3 g II ,

  v)
                                                      CC                     
                                                       σ      0
        g⊤                ⊤
         II V II g II = g II diag       Σ ⊗ P N −2n0 , 22     TT       ⊗ P n0       g II
                                                        0    σ22
                                        ⊤
                     − N −1 g ⊤
                              II H 1 ΣH 1 g II
                                                        
                                   −1 ⊤    I 3 ⊗ 1N −2n0            ⊤
                                                                                  
                     + (N − 2n0 ) g II                     Σ I 3 ⊗ 1N −2n0 |03×2n0 g II
                                               02n0 ×3
                                 ⊤                                 ⊤
                     + n−1  ⊤
                        0 g II H 2 (I 4 ⊗ 1n0 ) Σ (I 4 ⊗ 1n0 ) H 2 g II ,
                                                 a


                CC      TT
        where σ22  and σ22 are deﬁned in expression (7) and H 2 , in expression (14),
        respectively.

      The resulting expression is given in expression (16).




                  Revista Colombiana de Estadística - Theoretical Statistics 45 (2022) 125–148

