Method to Obtain a Vector of Hyperparameters: Application in Bernoulli Trials. Método para obtener un vector de hiperparámetros: aplicación en ensayos Bernoulli
Universidad del Valle, Cali, Colombia
Abstract
The main diﬃculties when using the Bayesian approach are obtaining information from the specialist and obtaining hyperparameters values of the assumed probability distribution as representative of knowledge external to the data. In addition to the fact that a large part of the literature on this subject is characterized by considering prior conjugated distributions for the parameter of interest. An method is proposed to ﬁnd the hyperparameters of a nonconjugated prior distribution. The following scenarios were considered for Bernoulli trials: four prior distributions (Beta, Kumaraswamy, Truncated Gamma and Truncated Weibull) and four scenarios for the generating process. Two necessary, but not suﬃcient conditions were identiﬁed to ensure the existence of a vector of values for the hyperparameter. The Truncated Weibull prior distribution performed the worst. The methodology was used to estimate the prevalence of two transmitted sexually infections in an Colombian indigenous community.
Key words: Laplace’s method; Bayesian inference; System of nonlinear equations.
Resumen
Las principales diﬁcultades cuando se utiliza el enfoque Bayesiano son la obtención de información del especialista y la obtención de valores de los hiperparámetros de la distribución de probabilidad asumida como representante del conocimiento a priori. Adicionalmente, gran parte de la literatura sobre este tema considera distribuciones a priori conjugadas para el parámetro de interés. Un método es propuesto para encontrar los valores de los hiperparámetros de una distribución a priori no conjugada. Los siguientes escenarios son considerados para ensayos Bernoulli: cuatro distribuciones a priori (Beta, Kumaraswamy, Gamma Truncada y Weibull Truncada) y cuatro escenarios para el proceso generador. Dos condiciones necesarias, pero no suﬁcientes fueron identiﬁcadas para asegurar la existencia de un vector de valores para los hiperparámetros. La distribución a priori Weibull Truncada fue la que peor desempeño presentó. La metodología fue utilizada para estimar la prevalencia de dos infecciones de transmisión sexual en una comunidad indígena de Colombia.
Palabras clave: Método de Laplace; Inferencia bayesiana; Sistema de ecuaciones no lineales.



1. Introduction
    When Bayesian inference methods are used for obtaining information about
a phenomenon of interest, the elicitation of the prior probability distribution
is a key process. According to Garthwaite, Kadane & O’Hagan (2005), the
statistician or facilitator establishes contact with an individual considered to be
a specialist (expert) on the research topic. The expert has valuable subjective
information about the data-generating process, having acquired experience from
repeated exposure to the phenomenon. In order to incorporate the information
about the data-generating process provided by the expert in the statistical model
proposed for the study, the statistician has to “express” such information as a
probability distribution (prior distribution) to establish “communication” with
the information contained in the data, which is expressed as a likelihood function.
   Expressing the prior information as a probability distribution implies two
challenges for the facilitator: to establish a theoretical model of probability
that best represents the natural behavior of the indicator assumed to be an
expression of the data-generating process conditions in the statistical model and to
determine the numerical values of the parameters associated with the theoretical
model of probability (hyperparameters), to ensure that this model is an adequate
representation of the conditions under which the data-generating process occurs
(phenomenon of interest).
    Diﬀerent authors have studied the conditions considered in an elicitation
process. Some authors such as Tversky & Kahneman (1973), Tversky &
Kahneman (1974), Hogarth (1975) and Hogarth (1987), have studied the cognitive
and psychological processes present in the individual who performs the experts
functions when responding to interrogations by the facilitator related to the
generating process. Winkler (1967) and Fowler & Floyd (1995) have studied the
problem of how to formulate questions and what to ask the expert concerning the
given issue. From a more probabilistic and statistical point of view, Murphy &
Winkler (1974), Winkler (1967) and Kadane & Winkler (1988) have developed
mathematical methods for obtaining diﬀerent types of probability distributions
that serve as representations of the level of presence-absence of prior information
in the generating process. Likewise, Chaloner & Duncan (1983), Sindhu, Feroze &
Aslam (2013), Tovar (2012), Penha (2014) and Flórez & Correa (2015) have worked
on the development of mathematical procedures for obtaining the hyperparameter

                   Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                           185

values that best represent the conditions of the data-generating process in the
prior theoretical distribution model. On the other hand Moala & Penha (2016),
have proposed a simulation methodology for evaluating the eﬀectiveness of these
procedures.
    One of the most used method to obtain the vector of hyperparameters ϕ of prior
distribution π, is to evaluate a quantiles interval from the specialist and calculate
from this its midpoint α and a fraction β of its rank. Using this, information and
the moments of the prior distribution π, the system of equations is constructed
                                
                                 E[θ | ϕ]     = α
                                V ar[θ | ϕ] =       β

The vector ϕ∗ that satisﬁes the system deﬁnes a single prior distribution π(θ | ϕ∗ )
as representative of the beliefs of the specialist. Given that the assumed values for
the mean and variance of the subjective distribution are ﬁxed, this method ends
up forcing the specialist to accept the prior distribution obtained or provide a new
quantiles interval that generates a diﬀerent vector ϕ∗ .
    To avoid these diﬃculties, some authors have used Prior Predictive Distribution
(PPD) to obtain the hyperparameter vector. Chaloner & Duncan (1983), considers
Bernoulli trials, the prior Beta distribution, a quantile interval evaluated by the
specialist and the PPD. On the other hand, survival times modeled with the
Weibull distribution are used by Penha (2014), who assumes the bivariate Gamma
distribution as a prior (nonconjugated) and constructs a system of equations with
PPD approximations.
    Except for Penha (2014), the methods of elicitation proposed by the
aforementioned authors are characterized by assuming the conjugate of the
likelihood function as prior distribution and obtaining information about the
moments or percentiles of said distribution from the specialist to form a system
of equations that provides the value of the hyperparameters. In this article
this subject is addressed and a method to obtain hyperparameter values of
nonconjugated prior distributions is proposed. Using the Laplace (1773) method,
we developed asymptotic approximations of the PPD obtaining a system of
nonlinear equations, which is solved using some numerical approximation as the
Newton-Raphson method. The Laplace Method (LM), which has been studied
extensively by Tierney & Kadane (1986), Azevedo-Filho & Shachter (1994) and
Vidal (2014) in order to approximate posterior moments, marginal distributions
and the Bayes factor, among others. In our literature review, we found one work
that implemented the LM to obtain values of the hyperparameters of a prior
distribution, (Penha 2014).
   To illustrate the proposed method, a realization of a random sample of
independent variables with a Bernoulli distribution is considered and four priors
(Beta, Kumaraswamy, Truncated Gamma, Truncated Weibull) were assumed. A
simulation study using four diﬀerent values of the parameter to be estimated was
carried out and the statistical performance of the Bayesian estimates was compared
with those obtained using the classical approach. Data obtained from a study

                   Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

186                                             Llerzy Torres & José Rafael Tovar Cuevas


carried to estimate the prevalence of HIV and Syphilis infection in a Colombian
indigenous community, were used to illustrate the performance of the proposed
method.


2. Methodological Proposal to Obtaining
   Hyperparameter Values
    In general the Figure 1 presents the steps of the method described in this
section.




                Figure 1: Short representation of the proposed procedure.


   The procedure used to approximate integrals is that developed by Laplace
(1773) and formalized by authors such as Erdélyi (1956) and Bruijn (1961). The
Laplace method formally indicates: Let h(.) and b(.) be analytical and smooth
functions inﬁnitely diﬀerentiable over a domain Ω, so that their Taylor series
expansion around the local minimum θb of the convex function h(.) in Ω exists.
Then, for a considerably high value of n, the integral
                                Z
                          In =     b(θ) exp{−nh(θ)}dθ
                                     Ω

      has the following result
                                                      b
                                   b | Σ |1/2 exp{−nh(θ)}{1
            Ibn = (2π)1/2 n−1/2 b(θ)                        + O(n−1 )}
                        !−1
                     b
               ∂ 2 h(θ)
where, Σ =                  and O(n−1 ) is the Landau notation and indicates that
                 ∂θ2
the following is fulﬁlled for a function g(n) = O(n−1 ); namely,
                   (∃n0 ∈ N )(∀n ≥ n0 )(∃ϵ > 0)(| g(n) |≤ ϵ | n−1 |)


2.1. Obtaining the Hyperparameter Values
   Consider that an experiment has been performed n times (in a heuristic
way, with a computational simulation algorithm, through real realizations) so

                     Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                           187

x(n) = {x1 , . . . , xn } which is assumed at least exchangeable, i.e. each observation
having distribution f (x | θ), where θ is an unknown scalar or vector of parameters
that represents the conditions under which a generating process occurs. The
information about θ contained in the sample of observations can be incorporated
into the model through the likelihood function L(θ | x(n) ), which has the following
form,
                                                 Y
                                                 n
                                  L(θ | x(n) ) =   f (xi | θ)                       (1)
                                               i=1

    In addition to the sample information, it is possible to consider in the
construction of the statistical model that represents the situation under study,
information “external” to the sample that has been obtained from the predictions
of Expert A in the area of research and from the parametric space Ω that contains
all the values of θ. Thus a probability distribution function, π(θ | ϕ) is sought,
where ϕ is a hyperparameter vector of l components, whose values will have to
be found to represent A’s predictions. On some occasions, the Ω domain can
be restrictive in selecting the prior; but it can be ignored by using truncated
distributions or re-parameterizations.
   The information represented in the likelihood function can be combined
with the expression through π(θ | ϕ), using Bayes’ formula, thereby obtaining the
posterior distribution (2).
                                 L(θ | x(n) )π(θ | ϕ)     L(θ | x(n) )π(θ | ϕ)
            π(θ | x(n) ) = R                            =                              (2)
                               Ω
                                 L(θ | x(n) )π(θ | ϕ)dθ      L(x(n) | ϕ)

    The denominator of (2) represents the marginal likelihood of (1), also called the
PPD. Finding an analytical expression for (2) depends on the prior distribution
used. To avoid this constraint, the asymptotic approximation provided by LM
was used. The asymptotic approximation of the denominator in (2) is denoted
as IbL (x(n) | ϕ), where n represents the sampling size and allows determining
the approximation accuracy; while ϕ is the constant vector that represents the
hyperparameters of the prior distribution.
    To implement the LM, the functions b(θ) and h(θ), which represent the PPD,
must be chosen; thus b(θ) exp{−nh(θ)} = L(θ | x(n) )π(θ | ϕ). According to the
literature, two parameterizations can be considered (selections of b and h). The
ﬁrst parameterization (3) is based on classical techniques, given that maximizing
−nh(θ) is equivalent to maximizing the logarithm of the likelihood function.
However, Kass & Raftery (1995) indicated that the approximation error increases
when the prior distribution is informative.
                  −nh(θ) = log L(θ | x(n) );            b(θ) = π(θ | ϕ)                (3)

   On the other hand, in the second parameterization (4), the maximum value
of −nh(θ) is called the posterior mode because it is the result of maximizing
the logarithm of the product between the likelihood and the prior distribution;
that is, the logarithm of the non-normalized posterior distribution. The latter
parameterization is the one implemented in the proposed method.

                   Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

188                                              Llerzy Torres & José Rafael Tovar Cuevas


              −nh(θ) = log L(θ | x(n) ) + log π(θ | ϕ);               b(θ) = 1         (4)

Once the prior distribution has been chosen and IbL (x(n) | ϕ) has been obtained,
the information from Expert “A” is extracted as follows:

 i) A value m is selected for the number of elements that a hypothetical sample
    contains.

 ii) Using m, characteristics of the expert’s subjective distribution are evaluated,
     as: quantiles x(m),j , probabilities αj , correlation or association coeﬃcient ρj ,
     mean, among other descriptive measures. The number of characteristics that
     must be evaluated coincides with the number l of components of ϕ.

iii) Trial samples are generated that satisfy each evaluated characteristic and
     the following system of l equations with l unknowns (components of ϕ) is
     constructed.
                               IbL (x(m),1 | ϕ) − α1 = 0
                               IbL (x(m),2 | ϕ) − α2 = 0
                                             ..
                                              .
                                b
                                IL (x(m),l | ϕ) − αl = 0

For example, consider a sample size (hypothetical) m and a vector of
hyperparameters of l = 2 components. Two quantiles have been evaluated from
the expert, x(m),1 and x(m),2 , with the probabilities α1 and α2 , respectively. Using
this information, the specialist’s Prior Predictive Pseudo-Distribution (PPPD) is
deﬁned, as:
                                          Z
                 L(x(m),j | ϕ = (a, b)) =    L(θ | x(m),j )π(θ | ϕ)dθ
                                             Ω

where L(θ | x(m),j ) is the likelihood function deﬁned by the trial sample of size m
containing the quantile x(m),j . With this fact, the PPPD depends on the vector
of hyperparameters ϕ. Thus, the method of obtaining hyperparameters consists
of ﬁnding a vector of constants ϕ∗ that satisﬁes the following equation:

                       IbL (x(m),j | ϕ∗ ) = αj         for j = 1, 2

   The vector ϕ∗ representing the beliefs of the expert is obtained as the solution
of system (5). Several methods may be used to determine such solutions,
such as successive approximations, Newton-Raphson and variants (such as ﬁnite
diﬀerences, Jacobi, Gauss-Sediel, and Quasi-Newton, among others). The Newton-
Raphson method will be used as it exhibits quadratic convergence and other
properties that were studied in detail by Dennis-Jr & Schnabel (1996).

                               IbL (x(m),1 | ϕ) − α1 = 0
                                                                                       (5)
                               IbL (x(m),2 | ϕ) − α2 = 0

                   Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                                                    189

3. n Bernoulli Observations
    Let y1 , . . . , yn be a sample of n observations obtained when performing n
independent Bernoulli experiments, each with a θ ∈ [0, 1] probability of Psuccess
                                                                            n
(the sample can be only exchangeable). The suﬃcient statistic x =           i=1 yi
is deﬁned. Given the characteristics of the experiment, it is known that X ∼
Binomial(n, θ); thus the likelihood function of the parameter θ related to the
suﬃcient statistic x will be
                                           
                                           n x
                               L(θ | x) =     θ (1 − θ)n−x                    (6)
                                           x

   Thus for any prior distribution π(θ | ϕ), the PPD will be
                              Z  
                                  n x
                  L(x | ϕ) =          θ (1 − θ)(n−x) π(θ | ϕ)dθ                                                 (7)
                               Ω   x

   To approximate L(x | ϕ), the LM is used, which requires the selection of
functions −nh(.) and b(.), the calculation of the minimum value of h(.) and the
second derivative of h(.). For the Bernoulli distribution, the parameterization (4)
generates
                          
                           n
          −nh(θ) = log        + x log θ + (n − x) log(1 − θ) + log π(θ | ϕ)     (8)
                           x

    If parameterization (3) is used, expression (8) would be obtained without the
term log π(θ | ϕ) –that is, only the logarithm of the binomial density–; thus the
maximum of −nh(.) coincides with the maximum likelihood estimator, θb = x/n.
Determining an analytical expression for the maximum or posterior mode of (8)
θb depends on the shape of the selected prior distribution. In some cases, it is
impossible to obtain it. Therefore, it is necessary to apply the numerical approach
method called Bisection to ﬁnd the roots of the following expression:
                                                   x n − x π ′ (θ | ϕ)
                                  −nh′ (θ) =         −     +                                                    (9)
                                                   θ   1−θ   π(θ | ϕ)

   Likewise, the asymptotic approximation of (7) by LM depends on n, x = x(n)
and ϕ: Its analytical expression is:

  IbL (x(n) | ϕ) ≈
                                                                       −1/2
                                                                               
            x     n−x      π ′′ (θb | ϕ)π(θb | ϕ) − [π ′ (θb | ϕ)]2             n
 (2π)
     1/2
               +         −                                                                 b (n−x) π(θb | ϕ)
                                                                                θbx (1 − θ)                  (10)
           θb2        b2
                 (1 − θ)                 [π(θb | ϕ)]2                           x
           |                        {z                             }          |            {z              }
                                    h′′ (θ)
                                         b
                                                                                              b
                                                                                      exp{−nh(θ)}



    Four families of probability distribution are considered to model the prior
information about the natural behavior of the parameter of interest. The ﬁrst two

                          Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

190                                            Llerzy Torres & José Rafael Tovar Cuevas


(Beta, Kumaraswamy) are characterized by modelling the natural behavior of the
random variables whose domain is the interval Ω = [0, 1]. The Beta distribution is
the conjugate prior when a Binomial model is assumed for the likelihood function
and its density function (11) is characterized by two form parameters, a, b > 0.
If θ is a random amount of interest such that θ ∈ Ω, it can be assumed that
θ ∼ Beta(a, b) so that ϕ = (a, b), then:

                                  1                            θ ∈ [0, 1]
                  π(θ | ϕ) =            θa−1 (1 − θ)b−1                                (11)
                               Be(a, b)                         a, b > 0

      When using (11) in (7), the PPD is obtained:
                                      Z
                            n      1
               L(x | ϕ) =                  θx+a−1 (1 − θ)(n+b−x−1) dθ                  (12)
                            x Be(a, b) Ω
                          |     {z    }
                                 ∆Bet


   The integrand of (12) may be a Beta distribution, and the closed form (13)
can be obtained.
                    L(x | a, b) = ∆Bet Be(x + a, b + n − x)              (13)

   Other prior distribution assumed is the Kumaraswamy (Kum), with density
function π(θ | a, b) = abθa−1 (1 − θa )b−1 , with a, b > 0 form parameters. It has the
advantage of having a probability distribution that is analytically more treatable
than Beta. This distribution is applicable to model phenomena, whose results
have lower and higher limits, such as the weight of individuals, scores obtained
from tests (Sindhu et al. 2013).
    Besides of Kum and Beta distributions, we used as prior distributions, the
truncated Gamma and the truncated Weibull. Given that, both correspond
to theoretical models constructed for random variables that take non-negative
values, for eﬀects of the elicitation method when using Bernoulli trials, each one
was truncated in the interval Ω = [0, 1] considering the process associated to
probability of success θ ∈ Ω. The Gamma distribution, is characterized by having
two parameters: one of form a > 0 and the other of inverse scale b > 0, also
called a rate parameter or event rate. The expression of the Truncated Gamma
(TG) distribution (14) contains a normalization constant (K), which depends of
the values of the hyperparameters ϕ = (a, b).
                                                          Z 1
         T r(θ | a, b) = K −1 (a, b)θa−1 e−bθ ; K(a, b) =     θa−1 e−bθ dθ    (14)
                                                                    0

    The last prior probability distribution considered is the Weibull, which has
two parameters: one of form a > 0 and the other of scale b > 0. The Truncated
Weibull (TW) distribution, involves a normalization constant (K) that depends
of the hyperparameters ϕ = (a, b).
                                                        Z 1
   T r(θ | a, b) = K −1 (a, b)θa−1 e−(θ/b) ;                θa−1 e−(θ/b) dθ (15)
                                          a                             a
                                              K(a, b) =
                                                                0


                    Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                            191

    The last two distributions were considered under the assumption that specialist
thinks the probability of success takes values closed to zero in most of times.
    With each of these prior distributions, the LM is implemented to determine
an analytical approximation of the PPD (10). These expressions are presented
in Table 2 and generate a surface of prior predictive probabilities that can be
plotted on a region D ⊆ R2 . For example, consider 10 successes obtained in 50
independent repetitions of a Bernoulli experiment, with D = [0, 100]2 and the
prior Beta as representative of a specialist’s beliefs. On the left side of Figure 2,
the approximation of the PPD (10) appears in blue and its closed form in red (13);
while on the right side the approximation of the PPD (10) is presented, assuming
the prior Kumaraswamy. These approximations are implemented to form the
system of nonlinear equations (5).




Figure 2: Surface of the PPD for 10 successes in 50 repetitions of independent Bernoulli
          experiments with Beta (left) and Kumaraswamy (right) prior distribution.


    To obtain information through an individual who is an expert in the matter of
interest, the following sentences can be posed:

a) Suppose that there is a hypothetical sample of m elements. Indicate two
   values: a minimum and a maximum (x(m),1 , x(m),2 ) that represent the number
   of elements with the characteristic of interest. (Example: For a sample of size
   m = 50, the expert has indicated that it would be expected to obtain a minimum
   of x(m),1 = 5 and a maximum of x(m),2 = 10 elements, respectively with the
   characteristic of interest)
b) Now consider that there are 100 groups, each one with m elements. In how
   many groups would you expect to have exactly x(m),1 and x(m),2 elements with
   the characteristic of interest, respectively? (Example: Each of the 100 groups
   has 50 elements. The expert expects to have 8 groups with x(m),1 = 5 elements
   that present the characteristic of interest, resulting in a probability of occurrence
   α1 = 8/100 for x(m),1 . Likewise, α2 = 9/100 indicates that the expert would
   expect to have x(m),2 = 10 elements with the characteristic of interest in 9 of
   the 100 groups)

                    Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

192                                               Llerzy Torres & José Rafael Tovar Cuevas


c) What is the number of elements x(m),mod that you consider would present
   the characteristic of interest with more frequency? This last question is
   related to the mode value in order to verify the consistency of the experts
   responses; therefore, x(n),mod has to remain in the interval [x(m),j , x(m),j ′ ] for
   j < j ′ . (Example: The expert indicates that the number of elements with the
   characteristic of interest that will occur with higher frequency is x(m),mod = 8.
   Then, with the information obtained from the previous items a) and b), this is
   veriﬁed that 8 ∈ [5, 10]. Thus the expert’s information is coherent)


    Using the data presented in items (a) and (b), the system of nonlinear equations
is deﬁned (5), dependent on the vector ϕ = (a, b).

                         IbL (x(50),1 = 5 | ϕ = (a, b)) − 8/100 = 0
                        b                                                                       (16)
                        IL (x(50),2 = 10 | ϕ = (a, b)) − 9/100 = 0


    The expression IbL (x(50),j | ϕ) represents the PPPD given by (10) for prior
distribution and a pair of hyperparameter values ϕ. To determine the solution
vector ϕ∗ , the Newton-Raphson method is used, and the initial point is obtained
graphically through the system-level curves. Table 1 provides the most relevant
results, such as the number of iterations, error vector and solution vector (value
of hyperparameters). The results of the prior TW distribution are not presented
because the PPPD was lower than the one provided by the specialist.

Table 1: Summary of the Newton-Raphson method for hyperparameters obtained
         considering three prior distributions.

                    Initial    N◦          (IbL (x(m),1 | ϕ∗ ) − α1 ,          Vector Solution
        Prior
                    Point      Iter.       IbL (x(m),2 | ϕ∗ ) − α2 )                (ϕ∗ )
        Beta        (8, 36)     5      (−3.9 × 10−10 , −2.2 × 10−9 )            (8.26, 39.08)
 Kumaraswamy        (3, 90)    14      (−1.2 × 10−10 ,   −8.1 × 10−13 )        (3.35, 257.98)
         TG         (14, 78)    7      (−5.3 × 10−11 , 3.5 × 10−11 )           (10.39, 59.39)


    In the process of obtaining the vector solution ϕ∗ of the system of nonlinear
equations (16), two necessary conditions were identiﬁed but were not suﬃcient to
guarantee the existence of the solution. The ﬁrst indicates that IbL (x(m),j | ϕ)
must not be exceeded by the specialist’s probabilities αj , j = 1, 2; and the second
is that the amplitude of the interval evaluated (x(m),1 , x(m),2 ) should not be too
width.
      In this table the following expressions are used:

        c1   c2               c1      c2                                  (a − 1)(1 − θa ) + aθa
k1 =       −            k2 = − 2 −                       k3 = c3 aθa−2
        θ 1−θ                 θ    (1 − θ)2                                     (1 − θa )2

with c1 = x + a − 1, c2 = n − x, c3 = b − 1 y ϕ = (a, b).

                     Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

                                                                                                                Table 2: Approximation of prior predictive distributions.

                                                                           Prior         L(x | ϕ)                                                                                           IbL (x | ϕ)
                                                                                               Z
                                                                                                    c         c
                                                                                         ∆Bet      θ 1 (1 − θ) 2 dθ     ∆Bet      =                     b−1
                                                                                                 Ω                                     −nh′ (θ) = k1 −                                                 c   c
                                                                                                                                                      1−θ                             | c1 c2 |1/2 c11 c22
                                                                           Beta                                                                           b−1                 (2π)1/2                            ∆Bet
                                                                                         n                                           −nh′′ (θ) = k2 −                                 (c1 + c2   )3/2+c1 +c2
                                                                                              1                                                       (1 − θ)2
                                                                                          
                                                                                           Be(a, b)
                                                                                          x
                                                                                              Z
                                                                                                  c         c        a c
                                                                                         ∆Kum    θ 1 (1 − θ) 2 (1 − θ ) 3 dθ
                                                                                               Ω                                                       c3 aθ a−1            θbc1 (1 − θ)                       b |−1/2
                                                                                                                                                                                      b c2 (1 − θba )c3 | h′′ (θ)
                                                                                                                                     −nh′ (θ) = k1 −
                                                                           Kumaraswamy                                                                   1 − θa
                                                                                                      n                                                                            (2πn−1 )−1/2 ∆−1
                                                                                                                                                                                                   Kum
                                                                                                                                     −nh′′ (θ) = k2 − k3
                                                                                         ∆Kum = ab  
                                                                                                       
                                                                                                       x
                                                                                                                                                                                                                         Method to Obtain a Vector of Hyperparameters




                                                                                              Z
                                                                                                   c1      c    −bθ
                                                                                         ∆T G     θ (1 − θ) 2 e     dθ ∆T G       =
                                                                                                Ω                                                                                        b c2 e−bθb | h′′ (θ)
                                                                                                                                                                               θbc1 (1 − θ)                b |−1/2
                                                                           Truncated                                                 −nh′ (θ) = k1 − b
                                                                           Gamma                                                       −nh′′ (θ) = k2                                 (2πn−1 )−1/2 ∆−1
                                                                                                      n                                                                                           GT
                                                                                                      
                                                                                         K −1 (a, b)  
                                                                                                      
                                                                                                       x
                                                                                               Z
                                                                                                     c        c    −(θ/b)a                                 
                                                                                         ∆T W      θ 1 (1 − θ) 2 e         dθ ∆T W =                    a θ a−1
                                                                                                                                       −nh′ (θ) = k1 −                                         b   a
                                                                                                 Ω                                                                                     b c2 e−(θ/b)
                                                                                                                                                                             θbc1 (1 − θ)                   b |−1/2
                                                                                                                                                                                                     | h′′ (θ)
                                                                           Truncated                                                                  b b
                                                                                                                                                                  
                                                                           Weibull                                                                       a(a − 1) θ a−2               (2πn−1 )−1/2 ∆−1
                                                                                                          n                          −nh′′ (θ) = k2 −                                             WT
                                                                                             −1                                                           b 2   b
                                                                                         K        (a, b)  
                                                                                                          
                                                                                                           x




Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209
                                                                                                                                                                                                                         193

194                                               Llerzy Torres & José Rafael Tovar Cuevas


   Given that the hypothetical sample size (m) delivered to the expert can aﬀect
the process to obtain hyperparameters, four scenarios of the generating process
expressed as probabilities of success were established, and three hypothetical
sample values were assumed for each one. These data were presented for the
specialist and in the Table 3 presents some of these results, as the maximum
values generated by each prior distribution on the surface of the PPPD. For these
cases, a mesh D = [0, 100]2 was used initially. These surface limited the mesh
(Table 4). For example, on the right side of Figure 2, the surface of the PPPD
generated by the prior Kumaraswamy was presented in the scenario of θ = 0.15
and mesh D = [0, 100]2 ; however, the region where the surface is far away from
the ab plane is [0, 15] × [0, 100]. Other aspects that can be evidenced from Table
3 are:

Table 3: Scenario of the generating process and the three sizes of hypothetical samples
         presented to the specialist.
                         Specialist’s Beliefs                             max IbL (x(m),j | ϕ)
 Scenario θ   Case                              L(θj | x(m),j )       (a,b)∈D
                       m     x(m),j      θj                       Beta      Kum      TG      TW
                               10      0.100        0.132         0.100     0.064   0.090    0.014
                1     100      20      0.200        0.099         0.074     0.048   0.066    0.013
                                5      0.100        0.185         0.154     0.114   0.147    0.028
      0.150     2      50
                               10      0.200        0.140         0.118     0.086   0.110    0.025
                                1      0.100        0.387         0.371     0.350   0.365    0.122
                3      10
                                2      0.200        0.302         0.292     0.269   0.284    0.118
                               45      0.450        0.080         0.064     0.041   0.048    0.012
                4     100      55      0.550        0.080         0.064     0.044   0.045    0.013
                               23      0.460        0.113         0.100     0.072   0.081    0.023
      0.500     5      50
                               28      0.560        0.113         0.100     0.077   0.078    0.025
                                4      0.400        0.251         0.245     0.219   0.232    0.102
                6      10
                                6      0.600        0.251         0.245     0.225   0.225    0.123
                               80      0.800        0.099         0.074     0.069   0.042    0.023
                7     100      90      0.900        0.132         0.100     0.100   0.049    0.042
                               40      0.800        0.140         0.118     0.110   0.078    0.045
      0.850     8      50
                               45      0.900        0.185         0.153     0.158   0.093    0.079
                                8      0.800        0.302         0.292     0.274   0.254    0.186
                9      10
                                9      0.900        0.387         0.371     0.354   0.331    0.283
                               85      0.850        0.111         0.082     0.082   0.043    0.030
                10    100      95      0.950        0.180         0.129     0.153   0.074    0.077
                               43      0.860        0.161         0.135     0.133   0.082    0.060
      0.900     11     50
                               48      0.960        0.276         0.225     0.243   0.155    0.162
                                8      0.800        0.302         0.292     0.274   0.254    0.186
                12     10
                               10      1.000        1.000         0.769     0.776   0.757        Inf
 L(θj | x(m),j ) is the function of likelihood that now depends of parameter θj and x(m),j is a
 j-th hypothetical sample of size m.




                     Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                                              195

          Table 4: Regions D for approximating the PPPD based on the LM.
                 0.150                         0.500                     0.850               0.900
    Prior
            1    2       3       4         5               6         7    8      9   10       11     12
    Beta                                       [0, 100] × [0, 100]
    Kum     [0, 15] × [0, 100]   [0, 30] × [0, 100]     [0, 100]2                [0, 100]2
     TG                                        [0, 100] × [0, 100]
     TW     [0, 10] × [0, 100]   [0, 25] × [0, 100]     [0, 100]2             [0, 100]2              -



• The maximum PPPD values increase as the size of the hypothetical sample
  decreases so that the values obtained from this distribution generate an upper
  limit for the specialist’s αj .

• The information provided by the specialist generates a likelihood of beliefs,
  L(θj | x(m)j ), which approximates the maximum PPPD values when the size of
  the hypothetical sample decreases.

• The prior distribution Beta and TW generated, respectively, the highest and
  lowest PPPD.

• When the parameter to be estimated had central values (that is, around
  0.5) in its domain and the sum of the extremes of the interval evaluated by
  the specialist coincided with the size of the hypothetical sample considered
  (x(m),1 + x(m),1 = m), the components of each of the following vectors were
  equal: the probability of the specialist (α1 = α2 ) and maximum prior predictive
  probabilities, these last amounts appear by pairs of rows from the seventh to
  the tenth column of Table 3.


4. Simulation Study
    Consider from the previous section the probabilities for item (b) ﬁxed for each
scenario of the parameter in Table 3. Figure 3 presents the form of the prior
densities elicited and Table 5 the respective hyperparameters, descriptive measures
and case from which the specialist’s information was obtained. For example, in
the scenario where θ takes a value in the middle of its domain (θ = 0.5), based on
the prior Beta, the case was considered where the specialist was evaluated based
on a hypothetical sample of m = 50 (Case 5). With the Kumaraswamy and TG
the hypothetical sample was m = 10 elements (Case 6); whereas with the TW, no
solution to system 16 was found in any of the cases.
    Assuming that the specialist agrees with the probability contained in the
interval [θ1 , θ2 ], which was obtained from the prior distribution proposed, It was
developed one simulation procedure. Bernoulli samples (s = 1, . . . , 10000) were
generated assuming diﬀerent θ and sample size nk (simulation’s scenarios). In each
of these scenarios, the probability of success was estimated. The mean, maximum,
minimum and MSE (Mean Square Error) of the estimates were computed. The
procedure was carried out 56 times, because four prior distributions, four values of

                     Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

196                                                 Llerzy Torres & José Rafael Tovar Cuevas


θ and four sample sizes nk = {20, 50, 125, 312} were considered. The sample sizes
were associated with the ﬁrst four elements of a geometric serie, whose common
ratio was 2.5 and ﬁrst term, 20. The algebraic expressions of the mean and
posterior variance were obtained by approximating the r−th posterior moment
using the Laplace Method. See Appendix A.

Table 5: Descriptive measures of prior distributions elicited for the scenarios of the
         generating process. P r represents P [θ ∈ (θ1 , θ2 )].
                                               Measures of Central
                             ϕ∗
      θ    Prior                                   Tendency            Var      Pr     Case
                     a              b       Mean    Median    Mode
           Beta      8.264         39.078   0.175    0.170    0.160   0.003    0.630
           Kum       3.354        257.978   0.171    0.171    0.172   0.003    0.582    2
  0.150
           TG       10.392         59.388   0.175    0.169    0.158   0.003    0.645
           TW        1.225          3.212   0.531    0.540    NaN     0.077    0.088    3
           Beta    149.993        140.290   0.517    0.517    0.517   0.0009   0.904    5
  0.500    Kum       1.071          0.770   0.581    0.615    NaN     0.086    0.091
                                                                                        6
           TG        2.640          2.250   0.613    0.629    0.729   0.056    0.126
           Beta     31.571          6.230   0.835    0.841    0.854   0.004    0.610
           Kum      16.695         12.051   0.832    0.841    0.859   0.004    0.643    8
  0.850
           TG      195.800        231.444   0.845    0.844    0.842   0.003    0.594
           TW        0.881        498.329   0.468    0.455    0.881   0.086    0.090    9
           Beta     17.400          2.488   0.875    0.888    0.917   0.005    0.552
  0.900    Kum      13.055          2.908   0.874    0.888    0.918   0.005    0.566   11
           TG      102.490        112.656   0.883    0.889    0.901   0.005    0.503




      Figure 3: Densities elicited for the four scenarios of the generating process.




                    Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

                                                                                                                                                                                                                   Method to Obtain a Vector of Hyperparameters




                                                                           Figure 4: Precision and accuracy of estimates using the Maximum Likelihood and Bayesian approach through prior distributions obtained
                                                                                     by the proposed method.




Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209
                                                                                                                                                                                                                   197

198                                           Llerzy Torres & José Rafael Tovar Cuevas


    The results are shown in Figure 4, which is complemented in Appendix B.
The precision-deﬁned as the amplitude of the interval formed by the minimum
and maximum values of the estimates-was greater in the ﬁrst, third and fourth
scenarios of the subjective approach when considering the Beta, Kumaraswamy
and TG distributions obtained by the proposed elicitation method rather than from
the classical approach. In the second scenario, the Beta distribution was the only
one that generated considerably greater precision than the classical approach and
other prior distributions obtained. This was due to the fact that its variabilities
were greater, and the probability contained in the specialist’s interval was less than
12.6%. The same was true for the reason why the prior TW had poor precision
and accuracy (average of estimates) in the ﬁrst and third scenarios. As expected,
in all scenarios and for both approaches, the increase in sample size generated
better precision and accuracy. The MSE was calculated and represented with a
symbol on each vertical line of Figure 4 in order to compare the dispersion of the
estimates generated by the prior distribution obtained and the classical approach.
  The Beta distribution obtained the lowest MSE in all scenarios, followed by
Kumarswamy and TG in the ﬁrst and third scenarios, respectively (Table 5).


5. Aplication: Prevalences in an Indogenous
   Community
    An epidemiological study to estimate the prevalence of three sexually
transmitted infections in a Colombian indigenous community was conducted by the
University of Antioquia in the eastern region of Colombian. The study enrolled
295 individuals and three HIV infection and eight Syphilis infection cases were
observed. The objective of this study was to estimate the prevalence of each
disease. This data were used before by Tovar (2012) to obtain the hyperparameter
values for a prior Beta distribution using the ﬁxed interval and the Chebyshev
inequality. For HIV infection, the author used information presented by the
Ministerio de la Protección Social (2010) supported by the criterion of a specialist
in the subject, who indicated that the prevalence of this infection should not
exceed 1%. According to the Ministerio de la Protección Social, the prevalence
of HIV in the population with age between 14 and 49 years was 0.22% and
for the entire Colombian population was 0.59%. To illustrate the proposed
method, we expressed the prevalences as quotients generating a range of quantiles
(0.0022 = 2.2/1000 ≈ 2/1000) and (0.0059 = 5.9/1000 ≈ 6/1000) for the number
of individuals infected with HIV in a hypothetical sample of 1000. With this
information, it is possible to deﬁne a system of non-linear equations whose roots
are the hyperparameter values of a selected prior distribution.

              IbL (x(1000),1 = 2 | ϕ = (a, b)) − L(0.0022 | x(1000),1 ) = 0
                                                                                      (17)
              IbL (x(1000),2 = 6 | ϕ = (a, b)) − L(0.0059 | x(1000),2 ) = 0

   For the infection of Syphilis, the specialist provided an interval of values for the
prevalence (0.01, 0.03) and the system of non-linear equations for this case was:

                   Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                              199



                 IbL (x(100),1 = 1 | ϕ = (a, b)) − L(0.01 | x(100),1 ) = 0
                                                                                         (18)
                 IbL (x(100),2 = 3 | ϕ = (a, b)) − L(0.03 | x(100),2 ) = 0

We did not obtain prior distribution for HIV infection, because the prior interval
obtained for this infection was in the limits of the parametric space (very close
to zero) and the amplitude was too small, which made diﬃcult to ﬁnd a region
D from the plane ab containing at least one point of intersection between the
surfaces of the system (17) and the plane ab. For the Syphilis case, we obtained
the prior distributions. In Table 6 the characteristics of these prior distributions
are showed and the obtained hyperparameter values are compared with those
obtained using the method proposed by Tovar (2012). The Beta prior distribution
obtained with the proposed method showed the highest density and the highest
contained probability within the interval suggested by the specialist. See the upper
part of Figure 5. The posterior densities were obtained with the help of the LM.
The posterior densities and the binomial likelihood of the observed data set are
showed in Figure 5.

Table 6: Descriptive measures of elicited prior distributions for syphilis infection. P r
         represents P [θ ∈ (θ1 , θ2 )].
                                           Measures of Central
                         ϕ∗
       Prior                                   Tendency              Var       Pr
                  a             b       Mean    Median    Mode
       Beta    122.244     5976.849     0.020    0.020    0.020   3 × 10−6    0.999
       Kum      2.194      5563.686     0.017    0.017    0.015   7 × 10−5    0.717
        TG      49.117     2263.062     0.029    0.022    0.021   9 × 10−5    0.993
       Beta*    3.900         191.100   0.020    0.018    0.015   1 × 10−4    0.704




                Figure 5: Densities for prevalence of syphilis infection.


                      Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

200                                           Llerzy Torres & José Rafael Tovar Cuevas


    In the infection by Syphilis, we obtained the estimates of the prevalence
parameter, using the maximum likelihood and the Bayes estimates, assuming as
prior distributions those obtained applying the proposed method and a Beta prior
distribution obtained using the Tovar (2012) method (Beta*). Some important
indexes as standard deviation, the prior predictive probability and the Bayes
Factor to select among prior models and 95% credibility intervals were computed
too. See Table 7.
   Table 7: Posterior estimates obtained using classical and subjective approaches
   Method     i           E[θ]     V [θ]     IbL (x | ϕ∗ )   BFij           CI(95%)
   Classic        MLE     0.027
              1   Beta    0.020  3 × 10−6       0.099      BF12 =1.518    (0.017, 0.024)
              2   Kum     0.023 4 × 10−5        0.065      BF23 =0.589    (0.012, 0.038)
   Bayesian
              3    TG     0.022  1 × 10−5       0.111      BF34 =1.587    (0.017, 0.028)
              4   Beta*   0.024 5 × 10−5        0.070      BF41 =0.704    (0.013, 0.039)
                              BF13 = 0.895, BF24 = 0.935




6. Discussion
    The proposed method of elicitation in the same way that those developed
by Chaloner & Duncan (1983), Tovar (2012), Sindhu et al. (2013) and Flórez
& Correa (2015), to assume any prior distribution that has the same domain
of the parameter of interest and that is adequate for expressing the specialist’s
information. In the model this fact makes possible to reﬂect the natural behavior
of the random quantity, θ, complying with the coherence principle; otherwise it
will not be possible to obtain the values of the hyperparameters. This result allow
us to conclude that Truncated Weibull is not a good choice for a prior distribution
when we have a Binomial likelihood. An interesting feature of the method is that
the resulting prior distribution elicited is not unique. Therefore the specialist can
choose from a wide variety of prior distribution.
    The proposed method is similar that developed by Penha (2014). She used the
Laplace Method to obtain the hyperparameters of a bivariate Gamma distribution
used as prior for a Weibull likelihood. She considers only four observations (one
for parameter) but our approach works with a sample of n observations using
a nonlinear system equations. This fact improves the error of approximation
O(n−1 ). The initial point for the Newton-Raphson method was identiﬁed through
the contour lines associated with the surfaces of the nonlinear equations system
(5). Questions were asked using hypothetical samples to evaluate information
from the specialist, who was allowed to select the prior distribution based on the
probability contained in the evaluated interval and the asymmetry of the density
obtained. Several scenarios for the specialist’s beliefs were considered. This made
it possible to determine the behavior of the precision and accuracy of the posterior
estimates generated by each family of prior distributions.
   The elicitation methods described by Flórez & Correa (2015) used only
the prior distribution characteristics involved; i.e., its moments, quantils and

                   Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                           201

probabilities. This allows simulation procedures such as those used by Moala &
Penha (2016), which are adequate to evaluate the eﬀectiveness of the foregoing
methods but not for the one developed herein. This is due to the fact
that the method used by Moala considers the known hyperparameters of the
prior distribution that accurately reﬂects the specialist’s knowledge. Then the
aforementioned elicitation methods were used, assuming that the evaluated mean
and probabilities by the specialist have known errors. As expected, the elicitation
methods turn out to be quite precise. Moala reports three speciﬁc methods. While
the proposed method uses information regarding the likelihood function and the
prior distribution considered representative of the specialist’s knowledge.


7. Conclusions
    Two necessary, but not suﬃcient conditions were found for the existence of a
solution point of the system of nonlinear equations (5). The ﬁrst is that according
to the prior distribution chosen and the hypothetical sample used to evaluate
the specialist’s information, the probabilities αj assigned by the expert must not
exceed the prior predictive pseudo-probabilities that would be obtained using the
prior chosen. If this occurs, the surfaces of the system move away from the ab
plane and prevent ﬁnding a solution point; that is, a vector of hyperparameters
that represents the specialist’s behavior. The second condition is that the interval
proposed by the specialist should not be too width, because the surfaces of the
system will be too far apart and could not be intercepted on plane ab.
    Of the four prior distributions considered, the TW was the one that had the
lowest prior predictive pseudo-probability, which prevented obtaining values for
the hyperparameters in two of the scenarios and consequently, posterior estimates.
In general there was no greater diﬀerence between the averages of the posterior
estimates generated from the prior distributions obtained for each scenario.
    With the proposed methodology is possible to obtain a region D in the plane
ab where the surfaces of the system of equations is deﬁned using the specialist’s
information. The obtained level curves are plotted on D and with the Newton-
Raphson’s method to obtain a vector ϕ∗ that represents the additional beliefs
about the generating process.
    For the case applied to the Colombian indigenous community the prior
distribution for the prevalence of HIV infection was not obtained due to the
computational cost of ﬁnding a D region that contain roots for the system of
equations. One way to address this problem is to ﬁnd a maximum point of each
surface and build the region D around these points.




                   Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

202                                                                                         Llerzy Torres & José Rafael Tovar Cuevas


Appendix A. Approximation of the Posterior
            Expressions

Table A1: Approximation of distribution and r-th posterior moment, considering
          Bernoulli trials and Beta prior distribution.
Posterior
                              Expre.




                                            θx+a−1 (1 − θ)n+b−x−1
                                       R
  Distribution




                                              x+a−1 (1 − θ)n+b−x−1 dθ
                                           Ωθ
   π(θ | x(n) )




                                                                                        c01 = x + a − 1
                              Appro.




                                                         0
                                                       θc1 (1 − θ)c2                    c2 = n + b − x − 1
                                                           0   c0                       c03 = n + a + b − 2
                                       (2π)1/2 | c03 |c4 c01 1 cc22 | c01 c2 |1/2
                                                                                        c04 = 1/2 − a − b − n

                                       R
                              Expre.




                                             θ   r+x+a−1 (1 − θ)n+b−x−1 dθ
                                           R
  r-th moment centered




                                           Ω
   on zero E[θr | x(n) ]




                                                  x+a−1 (1 − θ)n+b−x−1 dθ
                                            Ωθ




                                                      cr                    cr1 = r + x + a − 1
                              Appro.




                                                  r
                                       | cr3 |c4 cr1 1 cc22 | cr1 c2 |1/2
                                                      c0
                                                                            cr3 = r + n + a + b − 2
                                                  0
                                       | c03 |c4 c01 1 cc22 | c01 c2 |1/2   cr4 = 1/2 − r − a − b − n


                                        R x+a
                              Expre.




                                            θ   (1 − θ)n+b−x−1 dθ
                                       R Ω
     Mean E[θ | x(n) ]




                                          θ x+a−1 (1 − θ)n+b−x−1 dθ
                                        Ω



                                                      c1                    c11 = x + a
                              Appro.




                                                  1
                                       | c13 |c4 c11 1 cc22 | c11 c2 |1/2
                                                      c0
                                                                            c13 = n + a + b − 1
                                                  0
                                       | c03 |c4 c01 1 cc22 | c01 c2 |1/2   c14 = −1/2 − a − b − n


                                       R                                              R x+a                      !2
                              Expre.




                                            θ1+x+a (1 − θ)n+b−x−1 dθ                     θ   (1 − θ)n+b−x−1 dθ
                                       RΩ                                     −      R Ω
     Variance V [θ | x(n) ]




                                                 x+a−1 (1 − θ)n+b−x−1 dθ                 x+a−1 (1 − θ)n+b−x−1 dθ
                                           Ωθ                                         Ωθ



                                                                                                                     2
                                                      c2                                      c1                           c21 = 1 + x + a
                              Appro.




                                                  2                                     1
                                       | c23 |c4 c21 1 cc22 | c21 c2 |1/2        | c13 |c4 c11 1 cc22 | c11 c2 |1/2
                                                                            −                                            c23 = n + a + b
                                                  0   c0                                0     c0
                                       | c03 |c4 c01 1 cc22 | c01 c2 |1/2        | c03 |c4 c01 1 cc22 | c01 c2 |1/2        c24 = −3/2 − a − b − n




                                                      Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                                                                          203




Table A2: Approximation of distribution and r-th posterior moment, considering
          Bernoulli trials and Kumaraswamy prior distribution.
Posterior
                              Expre.




                                            θx+a−1 (1 − θ)n−x (1 − θa )b−1
                                       R
                                              x+a−1 (1 − θ)n−x (1 − θ a )b−1 dθ
                                           Ωθ
  Distribution
   π(θ | x(n) )




                                                                              0
                                                                            θc1 (1 − θ)c2 (1 − θa )c3
                                                                                        b a   ba        −1/2     0
                                                     c0                   ba−2 (a−1)(1−θD ) +aθD               θbD1 (1 − θbD )c2 (1 − θbD
                                                             c2                                                  c                      a )c3
                                       (2π)1/2         1
                              Appro.




                                                     b2 + (1−θ
                                                     θ        bD )2 + c3 aθD        (1−θba )2
                                                      D                                  D


                                                                                           c01 = x + a − 1
                                                          c0   c2   c3 aθa−1
                                       θbD is the root of 1 −     −                        c2 = n − x
                                                          θ   1−θ    1 − θa
                                                                                           c3 = b − 1

                                       R
                              Expre.




                                             θ   r+x+a−1 (1 − θ)n−x (1 − θ a )b−1 dθ
                                           R
                                           Ω
  r-th moment centered
   on zero E[θr | x(n) ]




                                                  x+a−1 (1 − θ)n−x (1 − θ a )b−1 dθ
                                            Ωθ


                                           cr                                         ba −1/2 cr
                                                                              bN )a +aθ
                                           b
                                             1
                                               +    c2
                                                     b    + c3 aθbN
                                                                  a−2 (a−1)(1−θ
                                                                              b
                                                                                       N
                                                                                             θbN1 (1 − θbN )c2 (1 − θbN
                                                                                                                      a )c3
                              Appro.




                                            2
                                           θN    (1−θN )2                       a
                                                                           (1−θN )2

                                                                             b a    ba       −1/2       0
                                           c0                   ba−2 (a−1)(1−θD ) +aθD              θbD1 (1 − θbD )c2 (1 − θbD
                                             1     c2                                                 c                      a )c3
                                           b2 + (1−θ
                                           θ        bD )2 + c3 aθD           ba )2
                                                                          (1−θ
                                             D                                 D

                                                                     cr    c2   c3 aθa−1
                                       θbN is the root of −nh′r (θ) = 1 −     −                                cr1 = r + x + a − 1
                                                                      θ   1−θ    1 − θa
     Mean E[θ | x(n) ]

                              Appro.




                                       Using the approximated of the r-th posterior moment with r = 1, the
                                       approximation of the posterior mean is obtained with c11 = x + a and θbN
                                       as the root of −nh′1 (θ).
     Variance V [θ | x(n) ]

                              Appro.




                                       It is enough know the approximation of the second posterior moment.




                                                     Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

204                                                                                       Llerzy Torres & José Rafael Tovar Cuevas




Table A3: Approximation of distribution and r-th posterior moment, considering
          Bernoulli trials and Truncated Gamma prior distribution.
Posterior
                              Expre.




                                            θx+a−1 (1 − θ)n−x e−bθ
                                       R
                                              x+a−1 (1 − θ)n−x e−bθ dθ
                                           Ωθ
  Distribution
   π(θ | x(n) )




                                                                   0                                               c01       =   x+a−1
                                                                 θc1 (1 − θ)c2 e−bθ
                                                                           −1/2
                                                                                                                   c2        =   n−x
                                                      c0                              0
                                                                                  θbD1 (1 − θbD )c2 e−bθbD
                                                                                    c
                                       (2π)1/2                c2                                                   c03       =   n+a+b−1
                              Appro.




                                                        1
                                                      b2 + (1−θ
                                                      θ        bD )2
                                                        D

                                                                                              q
                                                                                      c03 ±    (c03 )2 − 4bc01
                                                                              θbD =
                                                                                                  2b
                                       R         r+x+a−1 (1 − θ)n−x e−bθ dθ
                              Expre.




                                             θ
                                           R
                                           Ω
  r-th moment centered




                                                  x+a−1 (1 − θ)n−x e−bθ dθ
   on zero E[θr | x(n) ]




                                            Ωθ

                                                                 −1/2     r
                                           cr
                                                                        θbN1 (1 − θbN )c2
                                             1     c2                     c
                                           b2 + (1−θbN )2                                                        cr1     =       r+x+a−1
                                           θ                                                      b    b
                                             N
                                                                 −1/2
                                                                                              e−b(θN +θD )
                                                                                                                                 r+n+a+b−1
                              Appro.




                                           c0                            c0                                      cr3     =
                                           b2
                                             1
                                                 +      c2
                                                         bD )2          θbD (1 − θbD )c2
                                                                          1
                                           θ D
                                                     (1−θ

                                                                                              p r
                                                                                   c ±    r    (c3 )2 − 4bcr1
                                                                              θbN
                                                                                r = 3
                                                                                                2b
     Mean E[θ | x(n) ]




                                       Using the approximated of the r-th posterior moment with r = 1, the
                              Appro.




                                       approximation of the posterior mean is obtained with c11 = x+a, c13 = n+a+b
                                       y θbN
                                           1 as the root of −nh′ (θ).
                                                               1
     Variance V [θ | x(n) ]


                              Appro.




                                       It is enough know the approximation of the second posterior moment.




                                                 Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                                                                       205




Table A4: Approximation of distribution and r-th posterior moment, considering
          Bernoulli trials and Truncated Weibull prior distribution.
 Posterior

                                                                            a
                               Expre.


                                             θx+a−1 (1 − θ)n−x e−(θ/b)
                                        R
                                               x+a−1 (1 − θ)n−x e−(θ/b)a dθ
                                            Ωθ
   Distribution
    π(θ | x(n) )




                                                                        0                     a
                                                                      θc1 (1 − θ)c2 e−(θ/b)
                                                                                          −1/2
                                                      c0               a(a − 1)θba−2                0
                                                                                                  θbD1 (1 − θbD )c2 e−(θbD /b)
                                                              c2                                    c                         a
                               Appro.




                                        (2π)1/2         1
                                                      b2 + (1−θbD )2 +
                                                      θ D                   ba

                                                                          a            a−1
                                                                c0   c2                  θ                  c01       =    x+a−1
                                             θbD is the root of 1 −     −                      ;
                                                                θ   1−θ    b             b                  c2        =    n−x

                                        R         r+x+a−1 (1 − θ)n−x e−(θ/b)a dθ
                               Expre.




                                              θ
                                            R
                                            Ω
   r-th moment centered




                                                   x+a−1 (1 − θ)n−x e−(θ/b)a dθ
    on zero E[θr | x(n) ]




                                             Ωθ



                                            cr               a(a − 1)θ  ba−2 −1/2        r
                                                                                       θbN1 (1 − θbN )c2
                                              1     c2                                   c
                                            b2 + (1−θbN )2 +
                                            θN                    ba                                             −a        ba )
                                                                                                                       ba +θ
                                                                                −1/2
                                                                                                           e−b        (θ N   D

                                            c0                  a(a − 1)θba−2           c0
                               Appro.




                                            b2
                                              1
                                                  +    c2
                                                        bD )2 +                        θbD (1 − θbD )c2
                                                                                         1
                                            θ D
                                                    (1−θ             ba

                                        θbN is the root of
                                                     cr     c2    a   θ a−1
                                        −nh′r (θ) = 1 −        −                ;                 cr1   =    r+x+a−1
                                                     θ     1−θ     b     b
      Mean E[θ | x(n) ]




                                        From the approximation of the r-th posterior moment, with r = 1, the
                               Appro.




                                        approximation of the posterior mean is obtained with c11 = x + a y θbN the
                                        root of −nh′1 (θ).
      Variance V [θ | x(n) ]


                               Appro.




                                        It is enough know the approximation of the second posterior moment.




                                                  Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

206                                                                        Llerzy Torres & José Rafael Tovar Cuevas


Appendix B. Results Simulation
                                                                                            k
    The notation used is the following: θbpt,s k
                                                    and σc2
                                                            pt,s are respectively the s-th
estimation of the mean and variance posterior; the prior predictive probability for
the s-th sample of size nk is denoted as Ibsk ; the s-th maximum likelihood estimation
for sample nk is denoted as θbM,s
                                k
                                   .

                 Table B1: Scenario of the generating process θ = 0.1500 for four sample sizes.
         Prior




                                                    d  k      d
                       bk (min θ
                               bk           bk                 2k          d2k           k
                                                                                       Ib (min Ibs
                                                                                                 k , max Ibk )   bk (min θ
                                                                                                                         bk         bk
                 nk




θ                      θ                             2
                         pt      pt,s , max θpt,s ) σ pt (min σ pt,s , max σ pt,s )                        s     θ M      M,s , max θM,s )


                 20     0.1690 (0.1377, 0.2861)        0.0020 (0.0017, 0.0030)        0.1627 (0.0012, 0.2016)     0.1554 (0.0500, 0.5500)

                 50     0.1624 (0.0953, 0.2595)        0.0014 (0.0009, 0.0020)        0.0883 (0.0077, 0.1060)     0.1509 (0.0200, 0.3400)
         Beta




                 125    0.1566 (0.0712, 0.2510)        0.0008 (0.0004, 0.0011)        0.0447 (0.0015, 0.0505)     0.1498 (0.0320, 0.2800)

                 312    0.1532 (0.0842, 0.2206)        0.0004 (0.0002, 0.0005)        0.0205 (0.0041, 0.0221)     0.1499 (0.0705, 0.2276)

                 20     0.1663 (0.1285, 0.2546)        0.0022 (0.0018, 0.0023)        0.1666 (0.0030, 0.2024)     0.1551 (0.0500, 0.5000)

                 50     0.1610 (0.0760, 0.2507)        0.0015 (0.0011, 0.0015)        0.0870 (0.0116, 0.1032)     0.1495 (0.0200, 0.3400)
         Kum




                 125    0.1571 (0.0564, 0.2572)        0.0008 (0.0004, 0.0009)        0.0424 (0.0043, 0.0477)     0.1498 (0.0320, 0.2960)
0.1500




                 312    0.1535 (0.0919, 0.2211)        0.0004 (0.0003, 0.0005)        0.0188 (0.0082, 0.0206)     0.1497 (0.0833, 0.2276)

                 20     0.1688 (0.1394, 0.2952)        0.0020 (0.0016, 0.0038)        0.1625 (0.0013, 0.2010)     0.1543 (0.0500, 0.5500)

                 50     0.1620 (0.0997, 0.2728)        0.0013 (0.0008, 0.0022)        0.0880 (0.0068, 0.1070)     0.1499 (0.0200, 0.3600)
         TG




                 125    0.1565 (0.0915, 0.2943)        0.0007 (0.0004, 0.0013)        0.0454 (0.0033, 0.0515)     0.1497 (0.0560, 0.3360)

                 312    0.1530 (0.0966, 0.2259)        0.0004 (0.0002, 0.0005)        0.0211 (0.0065, 0.0228)     0.1498 (0.0833, 0.2340)

                 20     0.1951 (0.1021, 0.5015)        0.0065 (0.0038, 0.0107)        0.0428 (0.0355, 0.0522)     0.1561 (0.0500, 0.5000)

                 50     0.1673 (0.0437, 0.3670)        0.0026 (0.0008, 0.0044)        0.0173 (0.0118, 0.0203)     0.1507 (0.0200, 0.3600)
         TW




                 125    0.1568 (0.0568, 0.3001)        0.1568 (0.0568, 0.3001)        0.0010 (0.0004, 0.0016)     0.0070 (0.0056, 0.0079)

                 312    0.1529 (0.0898, 0.2361)        0.0004 (0.0003, 0.0006)        0.0028 (0.0025, 0.0031)     0.1502 (0.0865, 0.2340)




                                       Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

Method to Obtain a Vector of Hyperparameters                                                                                          207

Table B2: Scenario of the generating process, θ = 0.5000 and θ = 0.8500, for four
          sample sizes.
         Prior                                         k
                       bk (min θ
                               bk           bk      d         d2k          d2k           k                       bk (min θ
                                                                                                                         bk          bk
                                                                                                 k , max Ibk )
                                                                                       Ib (min Ibs
                 nk
θ                      θ                             2
                         pt      pt,s , max θpt,s ) σ pt (min σ pt,s , max σ pt,s )                        s     θ M       M,s , max θM,s )


                 20     0.5157 (0.4899, 0.5414)        0.0008 (0.0008, 0.0008)        0.1231 (0.0002, 0.1690)     0.5015 (0.1000, 0.9000)

                 50     0.5142 (0.4731, 0.5554)        0.0007 (0.0007, 0.0007)        0.0754 (0.0000, 0.1039)     0.4999 (0.2200, 0.7800)
         Beta




                 125    0.5116 (0.4551, 0.5586)        0.0006 (0.0006, 0.0006)        0.0444 (0.0000, 0.0596)     0.4997 (0.3120, 0.6560)

                 312    0.5081 (0.4533, 0.5612)        0.0004 (0.0004, 0.0004)        0.0243 (0.0003, 0.0314)     0.5002 (0.3942, 0.6026)

                 20     0.5078 (0.1870, 0.8712)        0.0105 (0.0050, 0.0109)        0.0455 (0.0368, 0.0635)     0.5021 (0.1500, 0.9000)
0.5000




                 50     0.5029 (0.2521, 0.7532)        0.0046 (0.0036, 0.0047)        0.0182 (0.0157, 0.0220)     0.5002 (0.2400, 0.7600)
Kum




                 125    0.5012 (0.3238, 0.6706)        0.0019 (0.0017, 0.0020)        0.0073 (0.0066, 0.0082)     0.5001 (0.3200, 0.6720)

                 312    0.5004 (0.4017, 0.5992)        0.0008 (0.0008, 0.0008)        0.0029 (0.0028, 0.0031)     0.4999 (0.4006, 0.5994)

                 20     0.5126 (0.2232, 0.8153)        0.0098 (0.0065, 0.0101)        0.0580 (0.0233, 0.0670)     0.5007 (0.1500, 0.8500)

                 50     0.5048 (0.2832, 0.7497)        0.0045 (0.0035, 0.0046)        0.0242 (0.0148, 0.0273)     0.4997 (0.2600, 0.7600)
         TG




                 125    0.5015 (0.3276, 0.6775)        0.0019 (0.0017, 0.0019)        0.0098 (0.0072, 0.0109)     0.4994 (0.3200, 0.6800)

                 312    0.5005 (0.3932, 0.6023)        0.0008 (0.0008, 0.0008)        0.0040 (0.0034, 0.0043)     0.4997 (0.3910, 0.6026)

                 20     0.8381 (0.7017, 0.8747)        0.0023 (0.0019, 0.0036)        0.1633 (0.0013, 0.1973)     0.8443 (0.4500, 0.9500)

                 50     0.8434 (0.7126, 0.9175)        0.0015 (0.0009, 0.0023)        0.0872 (0.0049, 0.1035)     0.8497 (0.6200, 0.9800)
         Beta




                 125    0.8467 (0.7467, 0.9187)        0.0008 (0.0005, 0.0012)        0.0434 (0.0109, 0.0480)     0.8502 (0.7200, 0.9440)

                 312    0.8483 (0.7706, 0.9079)        0.0004 (0.0002, 0.0005)        0.0197 (0.0089, 0.0207)     0.8499 (0.7628, 0.9167)

                 20     0.8370 (0.6995, 0.8708)        0.0024 (0.0016, 0.0048)        0.1596 (0.0041, 0.1953)     0.8430 (0.5000, 0.9500)

                 50     0.8431 (0.6869, 0.9067)        0.0014 (0.0005, 0.0030)        0.0875 (0.0038, 0.1059)     0.8493 (0.6000, 0.9800)
         Kum




                 125    0.8476 (0.7314, 0.9172)        0.0008 (0.0004, 0.0013)        0.0450 (0.0067, 0.0506)     0.8508 (0.7040, 0.9520)
0.8500




                 312    0.8488 (0.7825, 0.9081)        0.0004 (0.0002, 0.0005)        0.0208 (0.0089, 0.0222)     0.8499 (0.7756, 0.9199)

                 20     0.8432 (0.7524, 0.8854)        0.0022 (0.0018, 0.0024)        0.1655 (0.0021, 0.1991)     0.8448 (0.5000, 0.9500)

                 50     0.8446 (0.7472, 0.9379)        0.0014 (0.0012, 0.0015)        0.0869 (0.0048, 0.1025)     0.8498 (0.6400, 0.9800)
         TG




                 125    0.8459 (0.7562, 0.9345)        0.0008 (0.0005, 0.0009)        0.0427 (0.0089, 0.0470)     0.8501 (0.7200, 0.9520)

                 312    0.8475 (0.7808, 0.9128)        0.0004 (0.0002, 0.0004)        0.0192 (0.0103, 0.0202)     0.8499 (0.7724, 0.9199)

                 20     0.8104 (0.4964, 0.9065)        0.0065 (0.0038, 0.0109)        0.0436 (0.0410, 0.0474)     0.8445 (0.5000, 0.9500)

                 50     0.8367 (0.6335, 0.9611)        0.0025 (0.0007, 0.0044)        0.0177 (0.0163, 0.0185)     0.8509 (0.6400, 0.9800)
         TW




                 125    0.8446 (0.7162, 0.9605)        0.0010 (0.0003, 0.0016)        0.0072 (0.0069, 0.0073)     0.8503 (0.7200, 0.9680)

                 312    0.8478 (0.7738, 0.9172)        0.0004 (0.0002, 0.0006)        0.0029 (0.0028, 0.0029)     0.8501 (0.7756, 0.9199)




                                         Revista Colombiana de Estadística - Applied statistics 43 (2020) 183–209

208                                                                     Llerzy Torres & José Rafael Tovar Cuevas

            Table B3: Scenario of the generating process θ = 0.9000 for four sample sizes.


    Prior
                                               d  k      d
                  bk (min θ
                          bk           bk                 2k          d2k           k
                                                                                  Ib (min Ibs
                                                                                            k , max Ibk )   bk (min θ
                                                                                                                    bk          bk


            nk
θ                 θ                             2
                    pt      pt,s , max θpt,s ) σ pt (min σ pt,s , max σ pt,s )                        s     θ M       M,s , max θM,s )


            20     0.8798 (0.7366, 0.9120)        0.0026 (0.0020, 0.0047)        0.1795 (0.0125, 0.2134)     0.8858 (0.6000, 0.9500)

            50     0.8919 (0.7639, 0.9499)        0.0013 (0.0007, 0.0025)        0.0901 (0.0180, 0.1030)     0.8990 (0.7200, 0.9800)
    Beta




            125    0.8964 (0.8033, 0.9690)        0.0006 (0.0002, 0.0011)        0.0417 (0.0175, 0.0453)     0.8999 (0.7920, 0.9840)

            312    0.8985 (0.8388, 0.9503)        0.0003 (0.0001, 0.0004)        0.0180 (0.0117, 0.0190)     0.9000 (0.8365, 0.9551)

            20     0.8808 (0.7021, 0.9121)        0.0025 (0.0019, 0.0058)        0.1790 (0.0066, 0.2125)     0.8864 (0.5500, 0.9500)
 0.9000




            50     0.8925 (0.7623, 0.9483)        0.0013 (0.0007, 0.0027)        0.0910 (0.0178, 0.1047)     0.8992 (0.7200, 0.9800)
Kum




            125    0.8967 (0.8035, 0.9609)        0.0006 (0.0002, 0.0011)        0.0426 (0.0169, 0.0467)     0.8999 (0.7920, 0.9760)

            312    0.8985 (0.8300, 0.9559)        0.0003 (0.0001, 0.0004)        0.0184 (0.0103, 0.0196)     0.8998 (0.8269, 0.9615)

            20     0.8794 (0.7509, 0.9118)        0.0024 (0.0021, 0.0027)        0.1839 (0.0039, 0.2268)     0.8856 (0.5500, 0.9500)

            50     0.8916 (0.7247, 0.9562)        0.0013 (0.0005, 0.0019)        0.0876 (0.0020, 0.0964)     0.9003 (0.6200, 0.9800)
    TG




            125    0.8955 (0.7986, 0.9838)        0.0007 (0.0002, 0.0010)        0.0388 (0.0166, 0.0405)     0.9003 (0.7840, 0.9920)

            312    0.8978 (0.8177, 0.9546)        0.0003 (0.0001, 0.0004)        0.0163 (0.0100, 0.0166)     0.9000 (0.8141, 0.9583)



                                                                               
                               Recibido: junio de 2019 — Aceptado: mayo de 2020


References
Azevedo-Filho, A. & Shachter, R. D. (1994), Laplace’s method approximations for probabilistic inference in belief networks with continuous variables, in R. Lopez & D. Poole, eds, ‘Uncertainty in Artiﬁcial Intelligence : Proceedings of the Tenth Conference’, Morgan Kaufmann Publishers Inc., San Francisco, CA, pp. 28–36.
Bruijn, N. G. D. (1961), Asymptotic Methods in Analysis, 2 edn, Courier Corporation, Ámsterdam.
Chaloner, K. M. & Duncan, G. T. (1983), ‘Assessment of a beta prior distribution: PM elicitation’, Journal of the Royal Statistical Society: Series D (The Statistician) 32(1-2), 174–180.
Dennis-Jr, J. E. & Schnabel, R. B. (1996), Numerical Methods for Unconstrained Optimization and Nonlinear Equations, Siam.
Erdélyi, A. (1956), Asymptotic expansions, number 3, Courier Corporation.
Flórez, A. & Correa, J. (2015), Elicitación de una distribución subjetiva del vector de parámetros π de la distribución multinomial, Tesis de maestría, Universidad Nacional de Colombia, Colombia.
Fowler & Floyd, J. (1995), Improving Survey Questions: Design and Evaluation, Vol. 38, Sage.
Garthwaite, P. H., Kadane, J. B. & O’Hagan, A. (2005), ‘Statistical methods for eliciting probability distributions’, Journal of the American Statistical Association 100(470), 680–701.
Hogarth, R. M. (1975), ‘Cognitive processes and the assessment of subjective probability distributions’, Journal of the American Statistical Association 70(350), 271–289.
Hogarth, R. M. (1987), Judgement and choice: The psychology of decision, 2 edn.
Kadane, J. B. & Winkler, R. L. (1988), ‘Separating probability elicitation from utilities’, Journal of the American Statistical Association 83(402), 357–363.
Kass, R. E. & Raftery, A. E. (1995), ‘Bayes factors’, Journal of the american statistical association 90(430), 773–795.
Laplace, P. S. (1773), ‘Memoir on the probability of the causes of events’, Statistical Science 1(3), 364–378.
Moala, F. A. & Penha, D. L. (2016), ‘Elicitation methods for beta prior distribution’, Revista Brasileira de Biometria 34(1), 49–62.
Murphy, A. H. & Winkler, R. L. (1974), ‘Credible interval temperature forecasting: some experimental results’, Monthly Weather Review 102(11), 784–794.
Penha, D. L. (2014), Inferência bayesiana não-paramétrica para elicitação da função de contabilidade. Universidade Estadual Paulista (UNESP).
Sindhu, T. N., Feroze, N. & Aslam, M. (2013), ‘Bayesian analysis of the kumaraswamy distribution under failure censoring sampling scheme’, International Journal of Advanced Science and Technology 51, 39–58.
Tierney, L. & Kadane, J. B. (1986), ‘Accurate approximations for posterior moments and marginal densities’, Journal of the American Statistical Association 81(393), 82–86.
Tovar, J. R. (2012), ‘Eliciting beta prior distributions for binomial sampling’, Revista Brasileira de Biometria 30(1), 159–172.
Tversky, A. & Kahneman, D. (1973), ‘Availability: A heuristic for judging frequency and probability’, Cognitive Psychology 2(5), 207–232.
Tversky, A. & Kahneman, D. (1974), ‘Judgment under uncertainty: Heuristics and biases’, Science 185(4157), 1124–1131.
Vidal, I. (2014), ‘A bayesian analysis of the gumbel distribution: an application to extreme rainfall data’, Stochastic Environmental Research and Risk Assessment 28(3), 571–582.
Winkler, R. L. (1967), ‘The assessment of prior distributions in bayesian analysis’, Journal of the American Statistical Association 62(319), 776–800.
