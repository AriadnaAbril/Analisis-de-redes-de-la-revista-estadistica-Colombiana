On Some Statistical Properties of the Spatio-Temporal Product Density. Sobre algunas propiedades estad√≠sticas de la densidad producto espacio-temporal
Universidad de Antioquia, Medell√≠n, Colombia.  Universidad Nacional de Colombia, Medell√≠n, Colombia. Escuela Superior de Tecnolog√≠a y Ciencias Experimentales, Universitat Jaume I, Castell√≥n, Espa√±a. Universit√† degli Studi di Palermo, Palermo, Italy
Abstract
We present an extension of the non-parametric edge-corrected Ohser-type kernel estimator for the spatio-temporal product density function. We derive the mean and variance of the estimator and give a closed-form approximation for a spatio-temporal Poisson point process. Asymptotic properties of this second-order characteristic are derived, using an approach based on martingale theory. Taking advantage of the convergence to normality, conÔ¨Ådence surfaces under the homogeneous Poisson process are built. A simulation study is presented to compare our approximation for the variance with Monte Carlo estimated values. Finally, we apply the resulting estimator and its properties to analyse the spatio-temporal distribution of the invasive meningococcal disease in the Rhineland Regional Council in Germany.
Key words: Envelope; Invasive meningococcal disease; Lindeberg condition; Ohser-type estimator; Second-order product density.
Resumen
En este art√≠culo, presentamos un estimador para la funci√≥n de densidad producto de un patr√≥n de puntos en espacio-tiempo. Este estimador es una extensi√≥n del estimador no param√©trico de Ohser, el cu√°l est√° basado en una funci√≥n Kernel y ponderado por un corrector de borde. Deducimos la media y la varianza del estimador y, a su vez, damos una aproximaci√≥n anal√≠tica para el caso de un patr√≥n Poisson (completamente aleatorio). Adicionalmente, estudiamos ciertas propiedades asint√≥ticas de nuestro estimador utilizando un enfoque basado en la teor√≠a de martingalas y construimos superÔ¨Åcies de conÔ¨Åanza para el caso de aleatoriedad completa. Presentamos un estudio de simulaci√≥n para comparar nuestra aproximaci√≥n de la varianza con los valores estimados a trav√©s del m√©todo Monte Carlo. Finalmente, utilizamos nuestro estimador para analizar la distribuci√≥n espacio-temporal de los registros de una enfermedad meningoc√≥cica invasiva en la provincia del Rin en Alemania.
Palabras clave: Condici√≥n de Lindeberg; Densidad de producto de segundo orden; Envoltura; Enfermedad meningoc√≥cica invasiva; Estimador de tipo Ohser.


1. Introduction
    A large amount of point pattern data sets are collected in a wide range
of scientiÔ¨Åc settings, such as environmental sciences, climate prediction and
meteorology, epidemiology, image analysis, agriculture, and astronomy. While the
statistical methodology for analysing point pattern data sets in time (Cox & Isham
1980, Daley & Vere-Jones 2003) and space (Diggle 2013, M√∏ller & Waagepetersen
2004, Illian et al. 2008, Chiu et al. 2013) is rather well developed, today the focus
is on spatio-temporal point processes (Diggle 2013, Gonz√°lez et al. 2016), where
each point represents the location and time of an event. Thus we have data of the
form (ui , si ) ‚àà W √ó T ‚äÇ R2 √ó R, i = 1, . . . , n. We consider here processes that
are temporally and spatially continuous on a suÔ¨Éciently large support to justify
formulating explicitly second-order spatio-temporal tools for the data.
    Second-order functions play an essential role in the practical analysis of point
patterns, regarding both exploratory and modelling strategies. Usually, the K-
function and the pair correlation function are used for model checking (M√∏ller
& Ghorbani 2015), and parameter estimation (M√∏ller & Ghorbani 2012). The
second-order product density function (hereafter product density) is also useful
for both exploratory and explanatory statistical analysis (Siino et al. 2018). The
size and shape of these functions help to Ô¨Ågure out the type of interaction within
the point pattern data to further propose suitable point process models.
    Gabriel & Diggle (2009) extended the inhomogeneous K-function (Baddeley
et al. 2000) to the spatio-temporal setting for second-order intensity-reweighted
stationary point processes. The spatio-temporal inhomogeneous K-function
(STIK-function) or equivalently the spatio-temporal pair correlation function are
thus utilised to analyse spatio-temporal correlations (Gabriel & Diggle 2009,
Gabriel et al. 2010, 2013, Gabriel 2014). (M√∏ller & Ghorbani 2012) studied
the assumption of spatio-temporal separability of the STIK-function. These two

                     Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

On Some Statistical Properties of the Spatio-Temporal Product Density                   25

functions rely very much upon Ô¨Årst-order characteristics which are unknown in
practice, and replacing the intensity by an estimate must be made carefully as it
may imply bias (Baddeley et al. 2000, Gabriel 2014). We note that for Poisson
processes, the product density becomes the product of the Ô¨Årst-order intensities.
In the most general case, the product density is a non-standardised second-order
characteristic which does not depend on the intensity function and provides, in a
general sense, the same amount of information about the nature of the underlying
process as other second-order descriptors (Gonz√°lez et al. 2016).
    In literature, several estimators have been proposed to estimate the product
density function in a spatial setting, see for instance (Fiksel 1988, Ohser 1983,
Stoyan et al. 1993). One of the most elegant estimators of the spatial product
density, in terms of programming and mathematical calculation, is Ohser‚Äôs
estimator (Stoyan et al. 1993). In this paper, we extend the idea in Ohser
(1983) to the spatio-temporal case to provide an estimation of the product density
function. As the estimated second-order characteristics may deviate from their
theoretical counterparts due to statistical Ô¨Çuctuations, it is highly important
to be able to build conÔ¨Ådence surfaces for the theoretical functions. This can
be done assuming normality under the Poisson process (see Section 5). These
surfaces can also be used for model checking and to further discriminate between
clustering or regularity behaviour. Little attention has been paid so far to study
the Ô¨Årst- and second-order moments (mean and variance) of the second-order
characteristics of spatio-temporal point processes. In the spatial context, we refer
to (Ripley 1988) who gave the variance for some estimators of the spatial K-
function for homogeneous Poisson and Binomial point patterns. Later, (Stoyan
et al. 1993) approximated the variance of the spatial product density and the
spatial pair correlation functions, and Cressie & Collins (2001a) obtained closed
form expressions for the mean and variance of the local spatial product densities.
Guan (2009) developed a non-parametric estimator for the K-function variance
under inhomogeneity for a parametric intensity and under the assumption of
SOIRS. To the best of our knowledge, nothing has been developed in the spatio-
temporal context. Gonz√°lez et al. (2020) extend to the spatio-temporal context
the hypothesis test to prove that two (or more) observed point patterns with
replications are realisations of point processes that have the same second-order
descriptors. Here, we follow the original idea in (Stoyan et al. 1993) to extend it
to the spatio-temporal case and obtain exact and approximate expressions of the
mean and variance of the proposed estimator.
    The rest of the paper is organised as follows. In Section 2, we recall some
theoretical background of Ô¨Årst- and second-order characteristics of spatio-temporal
point processes. In Section 3 we propose a non-parametric estimator for the
product density and obtain its mean and variance for the general case and for
homogeneous Poisson processes. Also, we include some asymptotic results for
the spatio-temporal product density. We then present some simulation results
in Section 5. We describe an application of our methodology to spatio-temporal
data on the invasive meningococcal disease in the Rhineland Regional Council in
Germany between 2003 and 2007 in Section 6. We end the paper with some Ô¨Ånal
conclusions.

                     Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

26                                       Rodr√≠guez-Berrio, Rodr√≠guez-Cort√©s, Mateu & AdelÔ¨Åo


2. DeÔ¨Ånitions and Statistical Background
    We consider a Ô¨Ånite realisation x = {(u1 , s1 ), . . . , (un , sn )} of a spatio-temporal
point process X within a bounded spatio-temporal region W √óT ‚äÇ R2 √óR, where a
point (u, s) ‚àà X denotes an event at u ‚àà R2 occurring at time s ‚àà R. We consider
a spatio-temporal point process without any overlapping points as a random
countable subset X of R2 √ó R. Let N (C) denote the number of events falling
in an arbitrary bounded region C R‚äÇ R2R√ó R,R Œòh = {(u1 , s1 ), . . . , (uh , sh ) ‚àà X} is
a set of h-tuples of events in X,      = . . . for h times and C = W √ó T .
                                           C ‚äóh      C     C

   Assume that X has a spatio-temporal hth-order product density œÅ(h) , for
h = 1, 2, . . .. Then for any non-negative measurable function f deÔ¨Åned on
(R2 √ó R)‚äóh ,
     XÃ∏=                                       Z
   E      f ((u1 , s1 ), . . . , (uh , sh )) =   f ((u1 , s1 ), . . . , (uh , sh ))
        Œòh
                                                  (R2 √óR)‚äóh
                                                                                                            (1)
                                                                                       Y
                                                                                       h
                                             √ó œÅ(h) ((u1 , s1 ), . . . , (uh , sh ))         d(ui , si ),
                                                                                       i=1
        PÃ∏=
where        means that we sum over h pairwise distinct points. Considering (1),
in particular for h = 1 and h = 2, the hth-order product density functions are
called the intensity function and product density, respectively. A process for which
œÅ(1) (u, s) = œÅ for all (u, s) is called homogeneous or Ô¨Årst-order stationary and œÅ
is called intensity. Throughout this paper, we assume that the point process X is
second-order intensity-reweighted stationary (SOIRS), i.e.

     œÅ(2) ((u, s), (v, ‚Ñì)) = œÅ(u, s)œÅ(v, ‚Ñì)g(u ‚àí v, s ‚àí ‚Ñì),                (u, s), (v, ‚Ñì) ‚àà R2 √ó R,

where the pair correlation function g depends only on the spatial diÔ¨Äerence u ‚àí v
and time lag s ‚àí ‚Ñì (Gabriel & Diggle 2009). Further, if for any spatial rotation
around the origin, the rotated point process has the same distribution as the
original process then g(u ‚àí v, s ‚àí ‚Ñì) = g0 (‚à•u ‚àí v‚à•, |s ‚àí ‚Ñì|) for some non-negative
function g0 , where ‚à• ¬∑ ‚à• denotes the Euclidean norm in R2 and | ¬∑ | denotes the
absolute value in R we then say that the process is isotropic; for more details
see Gonz√°lez et al. (2020). Throughout the paper, we assume that the process is
isotropic.


3. Product Density Estimation
   We extend the idea developed by Ohser (1983) to estimate the product density
function. A spatio-temporal kernel density estimator of œÅ(2) (r, t) takes the basic
form of a smoothed three-dimensional histogram,
                               ‚àí1
                                       XÃ∏=
                  (|W ||T |)                        Œ∫œµ,Œ¥ (‚à•u ‚àí v‚à• ‚àí r, |s ‚àí ‚Ñì| ‚àí t),
                                    (u,s),(v,l)‚ààx


                        Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

On Some Statistical Properties of the Spatio-Temporal Product Density                          27

where |W | and |T | denote the area of W and the length of T , respectively, and
Œ∫œµ,Œ¥ (¬∑, ¬∑) stands for a kernel function. For the sake of simplicity, we consider the
multiplicative form Œ∫œµ,Œ¥ (‚à•u‚àív‚à•‚àír, |s‚àí‚Ñì|‚àít) = Œ∫1œµ (‚à•u ‚àí v‚à• ‚àí r) Œ∫2Œ¥ (|s ‚àí ‚Ñì| ‚àí t),
where Œ∫1œµ and Œ∫2Œ¥ are one-dimensional kernel functions with bandwidths œµ and Œ¥,
respectively. An edge-corrected kernel estimator of the product density function
is given by
                                     XÃ∏=          Œ∫1œµ (‚à•u ‚àí v‚à• ‚àí r) Œ∫2Œ¥ (|s ‚àí ‚Ñì| ‚àí t)
              œÅd
               (2)
                   œµ,Œ¥ (r, t) =                                                       ,        (2)
                                                               c(r, t)
                                  (u,s),(v,l)‚ààx

where r > œµ > 0, t > Œ¥ > 0 and c(r, t) = 4œÄrŒ≥W (r)Œ≥T (t). Here Œ≥W (r) and
Œ≥T (t) are the spatial and temporal set covariance functions, respectively. The
set covariance function of a sampling window W is deÔ¨Åned as the volume of the
intersection W ‚à© W‚àíœâ where W‚àíœâ is the set shifted by the vector ‚àíœâ (see more
details in Chiu et al. 2013). For small r, Œ≥W (r) can generally be approximated by
Œ≥W (r) ‚âà |W | ‚àí U (W  )
                    œÄ r, where U (W ) is the perimeter of W (Stoyan et al. 1993).
For a small t it follows that Œ≥T (t) = |T | ‚àí t.


3.1. Mean and Variance of the Estimator
    We now obtain the mean and variance of the product density estimator (2)
for the general case. We assume that the product density function is continuous.
Using (1) with h = 2, the estimator (2) satisÔ¨Åes
        h           i     Z
          d                     Œ∫1œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫2Œ¥ (|Œæ ‚àí Œ∑| ‚àí t)
      E œÅ œµ,Œ¥ (r, t) =
          (2)
                                         4œÄŒ≥W (r)Œ≥T (t)r
                              (R2 √óR)‚äó2

                                                     √ó œÅ(2) (‚à•x ‚àí y‚à•, |Œæ ‚àí Œ∑|)d(x, Œæ)d(y, Œ∑)
                               Z‚àû Z‚àû
                                           Œ∫1 (u)Œ∫2 (v)Œ≥W (r + œµu)Œ≥T (t + Œ¥v)
                          =
                                                      rŒ≥W (r)Œ≥T (t)
                              ‚àír/œµ ‚àít/Œ¥

                                                     √ó œÅ(2) (r + œµu, t + Œ¥v)(r + œµu)du dv.     (3)

If (r, t) is a continuity point of œÅ(2) (r, t), then
                                      h                  i
                             lim E œÅd     (2)
                                              œµ,Œ¥ (r, t)   = œÅ(2) (r, t),
                            (œµ,Œ¥)‚Üí(0,0)


hence, œÅd
        (2)
            œµ,Œ¥ (r, t) is an asymptotic unbiased estimator for the spatio-temporal
product density.
    To calculate the variance, under the intensity reweighted stationarity
assumption, application of Campbell‚Äôs formula (Illian et al. 2008, Chiu et al. 2013)
for the spatio-temporal case implies that
                        2                                           
                d                    1
           E œÅ œµ,Œ¥ (r, t)
                 (2)           =              4E1 (C) + 2E2 (C) + E3 (C)         (4)
                                 (c(r, t))2


                         Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

28                                        Rodr√≠guez-Berrio, Rodr√≠guez-Cort√©s, Mateu & AdelÔ¨Åo


where
                 Z
  E1 (C) =             Œ∫1œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫1œµ (‚à•x ‚àí z‚à• ‚àí r)Œ∫2Œ¥ (|Œæ ‚àí Œ∑| ‚àí t)Œ∫2Œ¥ (|Œæ ‚àí Œ∂| ‚àí t)
              C ‚äó3

                        √ó œÅ(3) ((‚à•x ‚àí y‚à•, |Œæ ‚àí Œ∑|), (‚à•x ‚àí z‚à•, |Œæ ‚àí Œ∂|))d(x, Œæ)d(y, Œ∑)d(z, Œ∂),
                 Z
  E2 (C) =             Œ∫21œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫22Œ¥ (|Œæ ‚àí Œ∑| ‚àí t)
              C ‚äó2

                                    √ó œÅ(2) (‚à•x ‚àí y‚à•, |Œæ ‚àí Œ∑|)d(x, Œæ)d(y, Œ∑),
                 Z
  E3 (C) =             Œ∫1œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫1œµ (‚à•z ‚àí w‚à• ‚àí r)Œ∫2Œ¥ (|Œæ ‚àí Œ∑| ‚àí t)Œ∫2Œ¥ (|Œ∂ ‚àí Œ≥| ‚àí t)
              C ‚äó4

                        √ó œÅ(4) ((‚à•x ‚àí y‚à•, |Œæ ‚àí Œ∑|), (‚à•x ‚àí z‚à•, |Œæ ‚àí Œ∂|), (‚à•x ‚àí w‚à•, |Œæ ‚àí Œ∑|))
                                                         √ó d(x, Œæ)d(y, Œ∑)d(z, Œ∂)d(w, Œ≥).             (5)

Thus, to Ô¨Ånd an expression for the variance in terms of (œµ, Œ¥), we have to know
the third- and fourth-order product densities, which opens new mathematical
diÔ¨Éculties (see Guan 2009 for the spatial case).



3.2. Mean and Variance of the Product Density Estimator
     for a Homogeneous Poisson Process

     For a homogeneous Poisson process with intensity œÅ, when (œµ, Œ¥) ‚Üí (0, 0),

      h                i               h                  i                                    
                                                                    1
     E œÅd
        (2)
            œµ,Œ¥ (r, t)   = œÅ 2
                               and Var   d
                                         œÅ (2)
                                               œµ,Œ¥ (r, t)   =                4œÅ 3
                                                                                  S 1 + 2œÅ 2
                                                                                             S 2 ,   (6)
                                                                (c(r, t))2

where S1 and S2 are given by
                 Z
        S1 =           Œ∫1œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫1œµ (‚à•x ‚àí z‚à• ‚àí r)
                C ‚äó3
                            √ó Œ∫2Œ¥ (|Œæ ‚àí Œ∑| ‚àí t)Œ∫2Œ¥ (|Œæ ‚àí Œ∂| ‚àí t)d(x, Œæ)d(y, Œ∑)d(z, Œ∂)
                Z Z                                                    2
            =               Œ∫1œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫2Œ¥ (|Œæ ‚àí Œ∑| ‚àí t) d(y, Œ∑) d(x, Œæ) = S1s S1t
                C       C




and
                       Z
            S2 =            Œ∫21œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫22Œ¥ (|Œæ ‚àí Œ∑| ‚àí t)d(x, Œæ)d(y, Œ∑) = S2s S2t ,
                     C ‚äó2



                              Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

On Some Statistical Properties of the Spatio-Temporal Product Density                             29

with
              Z Z                            2                  Z
      S1s =           Œ∫1œµ (‚à•x ‚àí y‚à• ‚àí r) dy         dx,   S2s =          Œ∫21œµ (‚à•x ‚àí y‚à• ‚àí r)dxdy,
                                                                 W ‚äó2
              Z W
              W
                 Z                           2                   Z
      S1t =           Œ∫2Œ¥ (|Œæ ‚àí Œ∑| ‚àí t) dŒ∑        dŒæ,    S2t =          Œ∫22Œ¥ (|Œæ ‚àí Œ∑| ‚àí t)dŒædŒ∑.
              T   T                                              T ‚äó2


   To show these two results, we note the following. For a homogeneous Poisson
process with intensity œÅ, the hth-order product density œÅ(h) is equal to œÅh , thus
using (3) when (œµ, Œ¥) ‚Üí (0, 0),


   h           i  Z‚àû Z‚àû
   d                    Œ∫1 (u)Œ∫2 (v)Œ≥W (r + uœµ)Œ≥T (t + Œ¥v)
 E œÅ œµ,Œ¥ (r, t) =
    (2)
                                   rŒ≥W (r)Œ≥T (t)
                        ‚àír/œµ ‚àít/Œ¥

                                                    √ó œÅ(2) (r + uœµ, t + Œ¥v)(r + uœµ)du dv ‚Üí œÅ2 .

   To obtain the variance in (6), we should notice that c(r, t)œÅd
                                                                (2)
                                                                    œµ,Œ¥ (r, t) in (2) has
the form               XÃ∏=
               A=               Œ∫1œµ (‚à•u ‚àí v‚à• ‚àí r) Œ∫2Œ¥ (|s ‚àí ‚Ñì| ‚àí t).
                          (u,s),(v,l)‚ààx

So, using Campbell formula for the spatio-temporal case
                      Z
          E [A] = œÅ 2
                        Œ∫1œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫2Œ¥ (|Œæ ‚àí Œ∑| ‚àí t) d(x, Œæ) d(y, Œ∑)
                          C ‚äó2

and
                                   
                                 E A2 = 4œÅ3 S1 + 2œÅ2 S2 + œÅ4 S3 ,

where S1 and S2 are given above, and S3 is given by
        Z
  S3 =     Œ∫1œµ (‚à•x ‚àí y‚à• ‚àí r)Œ∫1œµ (‚à•z ‚àí w‚à• ‚àí r)
          C ‚äó4
                       √ó Œ∫2Œ¥ (|Œæ ‚àí Œ∑| ‚àí t)Œ∫2Œ¥ (|Œ∂ ‚àí Œ≥| ‚àí t)d(x, Œæ)d(y, Œ∑)d(z, Œ∂)d(w, Œ≥).

Further, (E[A])2 = œÅ4 S3 . Hence, Var[A] = 4œÅ3 S1 + 2œÅ2 S2 , and
                      h           i                            
                        d                 1
                 Var œÅ œµ,Œ¥ (r, t) =
                         (2)                         3       2
                                                   4œÅ S1 + 2œÅ S2 .
                                      (c(r, t))2

                       and using the Epanechnikov
   For the spatial case,                            kernel, (Stoyan et al. 1993)
                                                                           
                                        œµ2
showed that S2 = 5œµ |W |œÄr ‚àí U (W ) 7 + r
              s     6                        2
                                                  and S1s = 4œÄ 2 r2 |W | ‚àí D +


                         Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

30                                     Rodr√≠guez-Berrio, Rodr√≠guez-Cort√©s, Mateu & AdelÔ¨Åo


4(r + œµ)2 (œÄ ‚àí 1)2 D, where D = U (W )(r + œµ) ‚àí 4(r + œµ)2 . For the temporal case,
and using the uniform kernel, it is easy to show that
                           |T |                              128 2
                   S2t =        and S1t = 4|T | ‚àí 8(t + Œ¥) +    t (t + Œ¥).
                            Œ¥                                 3
    By combining the above expressions, an approximation of the variance of the
product density estimator is obtained. In practice we substitute œÅ in (6) by its
estimator œÅÃÇ = |Wn||T | .


4. Martingale Characterisation of the Product
   Density
   The convergence to normality is an important asymptotic property of the
expectation of the product density function to build conÔ¨Ådence surfaces under
homogeneous Poisson processes. The central limit theorem for martingales
is a straightforward result that, combining Theorems 4 and 6 in AdelÔ¨Åo &
Schoenberg (2009), provides asymptotic convergence properties related to the
normal distribution for a stochastic process. This classical result for the martingale
diÔ¨Äerence process (Hall & Heyde 2014) can be enunciated in this context as follows.
Theorem 1 (Central limit theorem for martingales). If the martingale diÔ¨Äerence
stochastic process {Zm , Hm }‚àûm=1 , with Borel œÉ-algebra Hm = œÉ(Z1 , Z2 , . . . , Zm )
and E[Zj |Hj‚àí1 ] = 0, for j = 1, 2, . . ., satisÔ¨Åes the following two conditions:

     1. Lindeberg condition: E[Zj2 ] < ‚àû, j = 1, 2, . . . such that for any Œµ > 0,
                               Ô£´                                Ô£∂
                                    1 Xm
                                            2                
                           lim Ô£≠ 2       E Zj I{|Zj |> Œµsm } Ô£∏ = 0,
                          m‚Üí‚àû     sm j=1

        were I is the indicator function and
                                      Ô£Æ       Ô£π
                                        Xm
                            s2m = Var Ô£∞    Zj Ô£ª ‚Üí ‚àû as m ‚Üí ‚àû.
                                             j=1


     2. E[E[Zj2 |Hj‚àí1 ]] = Var[Zj ], j = 1, 2, . . ..

   Then we have convergence in distribution to a standard normal random variable
as m ‚Üí ‚àû,
                              1 X
                                 m
                                         d
                                     Zj ‚Üí N (0, 1).
                             sm j=1

    We do not prove these statements and concentrate on the characterisation
of œÅd
    (2)
        œµ,Œ¥ (r, t). Note that the Lindeberg condition is held if we set the process
                                                                            h     i2
Z = œÅd
 j
          (2)
             œµ,Œ¥ (r, t) ‚àí œÅ(2) (r, t), with expectation zero and Var[Z ] = E œÅd
                                                                             j
                                                                              (2)    .     œµ,Œ¥
Also, the third- and fourth-order product densities exist and are Ô¨Ånite.

                           Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

On Some Statistical Properties of the Spatio-Temporal Product Density                                           31

Theorem 2 (Martingale characterisation of œÅd   (2)
                                                   œµ,Œ¥ (r, t)). Let X be a simple spatio-
temporal point process within a bounded spatio-temporal region W √ó T ‚äÇ R2 √ó R
and with product density œÅ(2) (r, t). The estimator deÔ¨Åned in (2), with expectation
given in the equation (3), is a martingale process, then
                       h                                                      i
                      E œÅd
                         (2)              d
                             œµ,Œ¥ (r, t) ‚àí œÅ
                                            (2)                d
                                                œµ,Œ¥ (r, t ‚àí 1)|œÅ
                                                                (2) (r, t ‚àí 1) = 0.




Proof . Given that œÅd       (2)
                                œµ,Œ¥ (r, t ‚àí 1) is measurable with respect to œÅ
                                                                                                d (2)
                                                                                                      œµ,Œ¥ (r, t ‚àí 1)
then we have that
    h                                                          i        h                                      i
  E œÅd(2)
          œµ,Œ¥ (r, t) ‚àí œÅd(2)
                             œµ,Œ¥ (r, t ‚àí  1)| d
                                              œÅ(2) (r, t ‚àí 1) = E œÅ       d (2)
                                                                                œµ,Œ¥ (r, t)| d
                                                                                            œÅ (2) (r, t ‚àí 1)
                     h                     i       h                                    i
               ‚àí E œÅd  (2)
                           œµ,Œ¥ (r, t ‚àí 1) = E œÅ
                                                     d(2)            d
                                                          œµ,Œ¥ (r, t)|œÅ
                                                                       (2) (r, t ‚àí 1) ‚àí œÅ(2) (r, t ‚àí 1),



since (r, t) is a continuity point of œÅ(2) (r, t) then
           h                                      i     h                      i
          E œÅd
             (2)
                 œµ,Œ¥ (r, t)| d
                             œÅ (2)
                                   œµ,Œ¥ (r, t ‚àí 1)   = E   d
                                                          œÅ (2)
                                                                œµ,Œ¥ (r, t ‚àí 1)   = œÅ(2) (r, t ‚àí 1),

then we have the result. Therefore, having deÔ¨Åned a martingale starting from
œÅd
 (2)
     œµ,Œ¥ (r, t), its normality is proved if the conditions of Theorem 1 hold.



Theorem 3. Let X be a simple spatio-temporal point process in R2 √ó R with
product density function œÅ(2) (r, t) such that E[œÅd     (2) (r, t )|H ] for all t is bounded
                                                                 j   j
                                                   \
and there exists an Œ± > 0 such that E[œÅ(2+Œ±) (r, tj )|Hj ] for all j is bounded.
Moreover, let Zj = œÅd   (2) (r, t ) ‚àí œÅ(2) (r, t ) be a process with expectation zero and
             h                i2 j              j
               d
Var[Zj ] = E œÅ(2) œµ,Œ¥ (r, tj ) , with Ô¨Ånite third- and fourth-order product densities.
Finally, considering the temporal dimension, assume that for any j there exists
œÑj = sup{œÑ : N (œÑ ) = 1, N (œÑ, œÑ + r) = 0, œÑ + r < tj }, r > 0, that is there are not
overlaps in time. Then
                                            1 X
                                                 m
                                                     d
                                                  Zj ‚Üí N (0, 1).
                                           sm j=1



Proof . Starting from Theorem 2 and since E[Zj ] = œÅ(2) (r, tj ) and E[Zj ] < ‚àû
for all j, and X is assumed to be simple, the Lindeberg condition is immediately
proved. First note that
                                       Ô£Æ          Ô£π
                                           X
                                           m            X
                                                        m                   X
                                                                            m
                        s2m = Var Ô£∞            Zj Ô£ª =         Var[Zj ] =          E[Zj2 ].
                                           j              j                   j



                            Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

32                                       Rodr√≠guez-Berrio, Rodr√≠guez-Cort√©s, Mateu & AdelÔ¨Åo


   Hence œµsn ‚Üí ‚àû as n ‚Üí ‚àû. To prove condition 1 (Lindeberg condition) of
Theorem 1, using the H√∂lder inequality, write

 X
 m
                            Xm
                                           2/(Œ±+2)                   Œ±/(Œ±+2)
        E Zj2 I{|Zj |> Œµsm } ‚â§   E |Zj |2+Œ±           P [|Zj | > Œµ sm ]
  j=1                              j=1
                                   Ô£´                                 Ô£∂Ô£´                  Ô£∂ (Œ±+2)
                                                                                             Œ±

                                       X
                                       m
                                                                     Xm
                               ‚â§Ô£≠            E |Zj |   2+Œ± 2/(Œ±+2)   Ô£∏Ô£≠   P[|Zj | > Œµsm ]Ô£∏       .
                                       j=1                               j=1


     Using Chebyshev inequality,

                               X
                               m
                                                            E[Zj ]2   1
                                    P[|Zj | ‚â• œµsm ] ‚â§               = 2,
                               j
                                                            Œµ2 s2m   Œµ

            
and E Zj2+Œ± remains bounded (from the assumption about E[œÅ\          (2+Œ±) (r, t)|H ]),
          Pm        2                                                            t
therefore   j=1  E  Z  I
                      j {|Zj |> Œµsm }   grows less fast than s 2
                                                               m and  the  Lindeberg
condition holds.
     Therefore, we have shown that
                                              1
                                                Z ‚Üí N (0, 1),                                   (7)
                                             sm
             P
             m           m 
                         P                              
with Z =          Zj =       œÅd
                              (2) (r, t ) ‚àí œÅ(2) (r, t ) .
                                       j              j
            j=1          j=1


    A complete simulation exercise to check the normality property for the second-
order characteristics is given in AdelÔ¨Åo et al. (2020). Therefore we take advantage
of the computational results reported in this work which go in the same direction
of the product density to omit presenting those results here.


5. Simulation Study
   The spatio-temporal product density is a valuable tool for model Ô¨Åtting and
checking in a spatio-temporal point process setting. The behaviour of the product
density conveys useful information on the underlying structure of the pattern
considering just the behaviour of the response surface over small values of spatial
and temporal distances (r, t). For a Poisson process E[œÅd  (2)
                                                               œµ,Œ¥ (r, t)] u œÅ which
                                                                              2

represents a plane and where œÅd (2)  (r, t) comes from (2). In general, for small
                                               œµ,Œ¥
values of (r, t), œÅd
                   (2)               2                         d
                       œµ,Œ¥ (r, t) > œÅ indicates clustering and œÅ
                                                                (2)               2
                                                                    œµ,Œ¥ (r, t) < œÅ indicates
regularity or repulsion. To study the behaviour of the estimator for the product
density, we conduct a simulation experiment under the assumption of complete
spatio-temporal randomness. In addition, as we have developed a closed form
expression for the variance in the Poisson case and based on the asymptotic

                          Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

On Some Statistical Properties of the Spatio-Temporal Product Density                                     33

normality of the product density, we generate the corresponding conÔ¨Ådence
surfaces.
    We set W √ó T = [0, 10]2 √ó [0, 10] and simulate spatio-temporal point patterns
with a varying expected number of points E[N (C)] = 100, 200, 300. We consider
100 repetitions per pattern and scenario, and use the R package stpp (Gabriel
et al. 2013). We consider the spatial and temporal distances r and t spanning
the sequence starting from r > œµ > 0 to 2.50 and t > Œ¥ > 0 to 2.50 with small
increments. Currently, there are diÔ¨Äerent methods for bandwidth selection in
the literature of spatial point processes. Minimisation of the mean integrated
square error (MISE) (Berman & Diggle 1989), least square cross-validation (Guan
2007b), and composite likelihood cross-validation (Guan 2007a) are widely used
techniques that have been developed in the literature. For example, in the spatial
        p (1988) suggested the use of the Epanechnikov kernel with bandwidth
case, Fiksel
œµ = 0.1 5/œÅ. In this paper, the dpik function of the R package Kernsmooth (Wand
et al. 2019), (see Deng & Wickham 2011), is used for selecting bandwidth œµ. BrieÔ¨Çy,
the dpik function chooses the bandwidth by the plug-in approach; see more details
in Sheather & Jones (1991), and Wand & Jones (1994). For the temporal case,
the uniform kernel is used, where we again calculate the bandwidth Œ¥ using the
dpik function based on the time lag between the temporal instants of the process.


Table 1: Descriptive measures for the Monte Carlo mean estimates of the product
         density under homogeneous Poisson processes.
  n    œµ     Œ¥    c
                  œÅ 2      r     t     Q5% (œÅd
                                             (2)       d
                                                 œµ,Œ¥ ) œÅ
                                                         (2)           d
                                                             œµ,Œ¥ Q95% (œÅ
                                                                         (2)         d
                                                                             œµ,Œ¥ ) œÉ(œÅ
                                                                                       (2)       b(œÅd
                                                                                           œµ,Œ¥ ) œÉ
                                                                                                    (2)
                                                                                                        œµ,Œ¥ )

                         1.132 0.541       0.009        0.010         0.014           0.003        0.003

                         1.487 1.049       0.010        0.010         0.014           0.005        0.003

 100 0.998 0.384 0.010 1.791 1.484         0.010        0.010         0.013           0.007        0.007

                         2.145 1.992       0.010        0.010         0.014           0.011        0.013

                         2.449 2.427       0.010        0.010         0.014           0.016        0.013

                         1.132 0.541       0.039        0.040         0.052           0.009        0.010

                         1.487 1.049       0.040        0.039         0.051           0.012        0.017

 200 0.735 0.248 0.040 1.791 1.484         0.039        0.040         0.051           0.018        0.017

                         2.145 1.992       0.039        0.039         0.050           0.029        0.027

                         2.449 2.427       0.040        0.040         0.053           0.041        0.037

                         1.132 0.541       0.087        0.090         0.108           0.015        0.013

                         1.487 1.049       0.089        0.089         0.109           0.022        0.020

 300 0.615 0.188 0.090 1.791 1.484         0.090        0.090         0.111           0.032        0.013

                         2.145 1.992       0.090        0.091         0.110           0.051        0.042

                         2.449 2.427       0.090        0.092         0.116           0.072        0.083



                        Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

34                                                                                           Rodr√≠guez-Berrio, Rodr√≠guez-Cort√©s, Mateu & AdelÔ¨Åo


    Table 1 shows some descriptive measures of the product density estimator for
homogeneous Poisson point patterns generated by using the rpp function in stpp
package. The spatial and the temporal bandwidths are estimated for each of the
repetitions. The table displays the average optimal bandwidth for each sample
size. We also studied the behaviour of the product density estimator with non-
optimal bandwidths (the results are omitted here). The estimator in (2) proved to
be robust showing small variations against a range of values for the bandwidths.
From all possible grid cells, we have only shown the descriptive measures for some
particular values of (r, t), for comparison purposes. These (r, t) values have been
selected to cover the ranges of the spatial and temporal distances.


                                                                                                                                                                     0.040
0.0405
                                                                                   0.035                                                                              0.035

 0.0400                                                                                                                                                                0.030

  0.0395                                                                             0.025                                                                              0.025

                                                                                                                                                                         0.020
    0.0390
                                                                                       0.015                                                                                 0.015
     0.0385                                                                                                                                                                   0.010
             2.5                                                                               2.5                                                                                2.5
                                                                             2.4                                                                             2.4                                                                                  2.4
                   2.0                                                    2.2                        2.0                                                  2.2                           2.0                                                    2.2
                                                                       2.0                                                                             2.0                                                                                  2.0
                   t=      1.5                                   1.8         ce                      t=      1.5                                 1.8            ce                      t=      1.5                                   1.8         ce
                                                                           an                                                                              an                                                                                   an
                         tim                               1.6          st                                 tim                             1.6          st                                    tim                               1.6          st
                               e   1.0                                di                                      e    1.0                                di                                            e   1.0                                di
                                                     1.4         r=                                                                  1.4         r=                                                                       1.4         r=
                                               1.2                                                                             1.2                                                                                  1.2
                                         0.5                                                                             0.5                                                                                  0.5


(a) Theoretical and estimated (b) Average standard deviation (c) Theoretical standard devia-
surfaces.                     surface.                       tion surface.
Figure 1: Monte Carlo mean estimates of the product density functions and their
          standard deviation based on 100 simulations of homogeneous Poisson point
          pattern, with expected number of points n = 200 in W √ó T = [0, 10]2 √ó [0, 10],
          œÅb2 = 0.040, œµ = 0.735 and Œ¥ = 0.248.


   Table 1 also shows the theoretical product density (œÅ2 ) under the Poisson case,
together with the estimated average surface (œÅd(2)
                                                   œµ,Œ¥ (r, t)), and the corresponding
5% and 95% sample quantile values for the product density (Q (œÅd            (2) (r, t))                                                                                                                       5%                œµ,Œ¥
and Q95% (œÅd(2)                                                2     n(n‚àí1)
                œµ,Œ¥ (r, t))). Note that we have estimated œÅ by (|W ||T |)2 which is an
unbiased estimator in case of a homogeneous Poisson process (Stoyan & Stoyan
1994). Comparing the results in the fourth and eight columns, clearly the bias is
negligible and œÅd  (2)                          2
                       œµ,Œ¥ (r, t) converges to œÅ . In terms of variances, we present the
approximate theoretical standard deviation surface (œÉ(œÅd        (2) )) together with the                                                                                         œµ,Œ¥
                                                             œÉ (œÅd
Monte Carlo mean estimate of the standard deviation surface (b   (2)
                                                                     œµ,Œ¥ )) obtained
by simulation. Table 1 shows the results for only Ô¨Åve selected cells (spatial and
temporal lags (r, t)) over the Ô¨Åne grid of spatial and temporal distances to save
space.
    For illustrative purposes, the estimated product density function over the whole
grid is depicted in Figure 1, for a homogeneous Poisson point pattern with intensity
0.2 in W √ó T , and with œµ = 0.735 and Œ¥ = 0.248. Figure 1(a) shows the average
estimate of œÅd (2)
                   œµ,Œ¥ (r, t) under 100 repetitions of the selected scenario. Figure 1(a)


                                                             Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

On Some Statistical Properties of the Spatio-Temporal Product Density                                                           35

also presents the constant surface œÅb2 (which is equal to 0.040) for a homogeneous
Poisson point pattern. Clearly œÅd (2)
                                      œµ,Œ¥ (r, t) is an approximate unbiased estimator
of œÅ(2) (r, t).

    Figure 1(b) shows the corresponding average estimate of the standard deviation
surface under the same 100 repetitions. Figure 1(c) depicts the theoretical
standard deviation surface coming from expression (6). Figure 2(a) shows the
conÔ¨Ådence surfaces for homogeneous Poisson point patterns based on the estimated
product density and two standard deviations calculated using the expression of
the variance in (6) together with a constant surface with value œÅb2 = 0.040 and the
average of the estimated product densities. We have obtained very similar results
with intensities equal to 0.1 and 0.3, in simulations not shown here.




                                                                             0.15
            0.08

             0.06                                                             0.10
              0.04
                                                                               0.05
               0.02
                   0.00
                                                                                0.00
                                                                                ‚àí0.05
                      2.0                                              2.0          2.0                                   2.0
                                                                 1.8                                                    1.8 e
                            1.5                                          e                  1.5
                          t=                               1.6         nc              t=                            1.6 nc
                                                                  st
                                                                     a                                                     a
                               tim 1.0               1.4        di                          tim 1.0               1.4 ist
                                  e                        r=                                  e                         d
                                         0.5
                                               1.2
                                                                                                      0.5
                                                                                                            1.2     r=

            (a) Mean,         homogeneous                                    (b) Mean,       inhomogeneous
            Poisson case (white), 0.98%                                      Poisson case (white), 0.98%
            conÔ¨Ådence surfaces (lightgray)                                   conÔ¨Ådence surfaces (lightgray)
            and theoretical product density                                  and theoretical product density
            (grey).                                                          (grey).
Figure 2: Mean estimate of the product density function in the inhomogeneous case
          with the very same region and expected number of points, œµ = 0.99 and
          Œ¥ = 0.38.



     Finally, Figure 2(b) shows the conÔ¨Ådence surfaces for homogeneous Poisson
point patterns with expected number of points n = 200 in W √ó T = [0, 10]2 √ó
[0, 10] together with the average of estimated product densities coming from 100
inhomogeneous Poisson point patterns with intensity function given by


                                        ne20
         œÅ(x, y, t) =                            e‚àíy‚àít , with (x, y, t) ‚àà [0, 10]2 √ó [0, 10].
                                    10(e10 ‚àí 1)2


We note that the average surface for the inhomogeneous Poisson point pattern
falls outside the conÔ¨Ådence surfaces constructed under homogeneity.

                                  Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

36                               Rodr√≠guez-Berrio, Rodr√≠guez-Cort√©s, Mateu & AdelÔ¨Åo


6. Data Application: Invasive Meningococcal
   Disease
    In this section, as a practical example, we illustrate how our product density
estimator applies to Invasive Meningococcal Disease (IMD) data. IMD is a
bacterial infection caused by bacterium Neisseria meningitidis. The data were
previously analysed by Meyer et al. (2012) considering a mechanistic model
with a conditional intensity function which is a superposition of additive and
multiplicative components in space and time. The IMD data analysed in this
section are taken from the R package surveillance (H√∂hle 2007).




           Figure 3: Subregion of Rhineland Regional Council (Germany).


    The IMD data for the whole region of Germany shows a clear clustering
behaviour (see Meyer et al. 2012), even without the help of any statistical
tool. Therefore, we restrict our analysis to the subregion of Rhineland Regional
Council (Germany) between 2003 and 2007 (see Figure 3), where the point pattern
apparently does not show any clustering structure in space. The second-order
analysis starts by applying a mechanism for visual assessment whether our point
pattern is compatible with a spatio-temporal homogeneous Poisson pattern. If
this hypothesis is rejected, the process can be modelled as a regular or as a cluster
process. The area of this region is 9427.59 km2 with a perimeter of 379.89 km. The
IMD dataset consists of the spatio-temporal reports of 107 cases of IMD caused
by two speciÔ¨Åc meningococcal Ô¨Ånetypes, in which the times are given by 1491 days
over the 5-years period, so the temporal region is deÔ¨Åned as T = [500.51, 1992.18].
Figure 4(a) and Figure 4(b) show the estimated spatial and temporal intensities,
respectively. In the purely spatial case, the pattern in Figure 4(a) does not exhibit
any apparent clustering; for the time case, Figure 4(b) shows a nearly constant
intensity indicating that temporal point pattern may be homogeneous.
    Figure 5 shows the surface of the estimated second-order product density
using œµ = 7.72 km and Œ¥ = 45 days. We see large values for small spatial and
temporal distances, which is a typical behaviour when spatio-temporal aggregation
is present. However, the spatial aggregation decreases with increasing spatial

                     Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

On Some Statistical Properties of the Spatio-Temporal Product Density                                                                                                                37

distances, while the temporal aggregation increases throughout the temporal
distances. The clustering-type result is expected after visual inspection of
Figure 5(a), and goes in the line found by Meyer et al. (2012).




                                                                                                           0.10
      3200




                                                                                                           0.08
                                             0.004
                                              0.006
      3150




                                                                                                           0.06
                             0.008
                              0.0
                                  14
                                                  01
      3100




                          0.022




                                                                                                           0.04
                                   0.018


                                                0.




                                                       0.008
                                        12
                                  0.0          0.006




                                                                                                           0.02
      3050




                                                                                                           0.00
              4000        4050                   4100           4150               4200                           500                       1000                     1500    2000

                                                                                                                                                   t = time (days)



               (a) Estimated spatial intensity.                                                             (b) Estimated temporal intensity.
Figure 4: Region of study, and estimated spatial and temporal intensities for the IMD
          dataset.
                                                                                                     350




                                                                                                                                                      9e‚àí11
                                                                                                                        10
                                                                                                                     e‚àí
                                                                                                                  1.2
                                                                                                     300




                                                                                                                                       10      8e‚àí11
    1.2e‚àí10                                                                                                                      1e‚àí
                                                                                                                      ‚àí10
                                                                                                     250




     1.0e‚àí10
                                                                                                                  1.1e




                                                                                                                                                        6e‚àí11
                                                                                          t = time
                                                                                                     200




      8.0e‚àí11                                                                                                                               7e‚àí11                           5e‚àí11
             6.0e‚àí11
                                                                                                     150




                                                                                                                                                                                 1
                                                                                                                                                                             5e‚àí1

                                                                                                                            7e‚àí11                     8e‚àí11
                     350
                                                                                 30
                                                                                                     100




                       300                                                                                             1e
                                                                                                                            ‚àí1
                                                                                                                                       9e‚àí11
                                                                            25        e
                      t = 250                                                       c                                         0

                          tim200                                    20           an
                                                                                                     50




                                                                              st
                             e 150                                          di                                    10                   15             20               25   30
                                                                       r=
                                                               15
                                  100                                                                                                               r = distance

                       (a) Empirical surface.                                                                                (b) Empirical contour.
Figure 5: Two estimation formats of the product density for IMD dataset with œµ = 7.72
          km, and Œ¥ = 45 days.


    To emphasise this clustering behaviour, we also show in Figure 6 the empirical
product density for the data together with simulated pointwise 95% envelope
surfaces obtained from 39 simulations of spatio-temporal Poisson processes.
Figure 6(a) considers homogeneous Poisson point patterns and we note that the
surface of the empirical product density for the data does not have the constant
shape that characterises a completely random point process. In addition, for
small spatial distances œÅd
                         (2)
                             œµ,Œ¥ (r, t) exceeds the upper envelope indicating clustering.
Figure 6(b) considers inhomogeneous spatio-temporal Poisson processes with an

                                              Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

38                                                                   Rodr√≠guez-Berrio, Rodr√≠guez-Cort√©s, Mateu & AdelÔ¨Åo


intensity built as the product of the spatial and temporal intensities for the IMD
data; this plot shows a clear clustering behaviour as well.


                                                                                                                  4e‚àí10
                                                           1.2e‚àí10
1.2e‚àí10
                                                           1.0e‚àí10
1.0e‚àí10                                                                                                            2e‚àí10
                                                             8.0e‚àí11
  8.0e‚àí11
                                                              6.0e‚àí11                                               0e+00
   6.0e‚àí11
                                                              4.0e‚àí11
     4.0e‚àí11                                                                                                        ‚àí2e‚àí10
                                                               2.0e‚àí11

             350                                                        350                                                  350
                                                    30                    300                              30                  300                              30
               300
                                                                         t = 250                                                                           25
              t = 250                      25
                                                     nc
                                                       e                                              25
                                                                                                             ce               t = 250                                ce
                  tim200                         ta                          tim200                        an                     tim200             20        an
                                                                                                                                                            ist
                                     20                                                         20
                                                s                                                       st
                     e 150                 di                                   e 150                 di                             e 150                 d
                                                                                                                                                      r=
                                                                                                                                                15
                                      r=                                                         r=
                                15                                                   100   15
                          100                                                                                                             100


             (a) Homogeneous                                           (b) Inhomogeneous                                       (c) Theoretical
Figure 6: Estimated product density function for the IMD data (white surface)
          together with simulated pointwise 95% envelope surfaces obtained from 39
          simulations of: (a) homogeneous spatio-temporal Poisson point patterns; (b)
          inhomogeneous spatio-temporal Poisson point patterns with the estimated
          intensity function of IMD data (grey surfaces); (c) homogeneous Poisson point
          patterns using theoretical expressions (grey surfaces).


   Note that in Figure 6(c) we construct the conÔ¨Ådence surface under homoge-
neous Poisson point patterns based on the estimated œÅd
                                                     (2)
                                                         œµ,Œ¥ (r, t) ¬± 2 √ó standard
deviations calculated using the approximation of the variance in (6) for the
empirical product density for the IMD data. Again, the empirical second-
order product density exceeds the upper conÔ¨Ådence surface. These three Ô¨Ågures
reveal that IMD has a contagious behaviour in their immediate spatio-temporal
neighborhoods.


7. Discussion
    The spatio-temporal product density describes second-order characteristics of
point processes. It is useful to analyse the spatio-temporal structure of the
underlying point process, and provides a natural starting point for the analysis
of spatio-temporal point process data. It can be considered an exploratory tool,
for check spatio-temporal inhomogeneity, clustering or interaction.
    We have proposed a non-parametric edge-corrected kernel estimator of the
product density under SOIRS hypothesis. The mean and variance of the estimator
are obtained, and approximated closed form expressions are derived under the
Poisson case. The pair correlation and K-functions are severely aÔ¨Äected by the
spatial and temporal intensity estimates as shown in Gabriel (2014). This is one
of the reasons we propose in this paper using the product density. We indeed
postulate the use of the second-order product density as it provides the same
information, but with the added value that there is no need to estimate the spatio-
temporal intensity. The main idea is to compare the Ô¨Çuctuation of the empirical

                                     Revista Colombiana de Estad√≠stica - Applied Statistics 44 (2021) 23‚Äì41

On Some Statistical Properties of the Spatio-Temporal Product Density                     39

surface with the corresponding envelope and conÔ¨Ådence surfaces, as a means to
check for randomness and/or clustering, and also for model checking. The panels
of Figure 6 show that conÔ¨Ådence surfaces Ô¨Çuctuate only slightly more than the
envelope surfaces. Therefore from the point of view of the computational cost,
one can use the conÔ¨Ådence surfaces instead of running 99 simulations to obtain
envelope surfaces.
    We have provided suÔ¨Éciently statistical grounds in favour of using this second-
order tool in the practical analysis of spatio-temporal point patterns. However,
in our developments, we assumed that the point pattern is SOIRS. The statistical
properties of the spatio-temporal product density under general non-stationarity
conditions or anisotropic structures remain an open problem.


Acknowledgements
  Research of J. Mateu were supported by the Spanish Ministry of Science and
Education through the project MTM2016-78917-R.
                                                                           
                  Received: January 2020 ‚Äî Accepted: September 2020


References
AdelÔ¨Åo, G. & Schoenberg, F. P. (2009), ‚ÄòPoint process diagnostics based on weighted second-order statistics and their asymptotic properties‚Äô, Annals of the Institute of Statistical Mathematics 61(4), 929.
AdelÔ¨Åo, G., Siino, M., Mateu, J. & Rodr√≠guez-Cort√©s, F. J. (2020), ‚ÄòSome properties of local weighted second-order statistics for spatio-temporal point processes‚Äô, Stochastic Environmental Research and Risk Assessment 34(1), 149‚Äì168.
Baddeley, A., M√∏ller, J. & Waagepetersen, R. (2000), ‚ÄòNon- and semi-parametric estimation of interaction in inhomogeneous point patterns‚Äô, Statistica Neerlandica 54, 329‚Äì350.
Berman, M. & Diggle, P. (1989), ‚ÄòEstimating weighted integrals of the second-order intensity of a spatial point process‚Äô, Journal of the Royal Statistical Society: Series B (Methodological) 51(1), 81‚Äì92.
Chiu, S. N., Stoyan, D., Kendall, W. S. & Mecke, J. (2013), Stochastic Geometry and Its Applications, third edn, John Wiley and Sons.
Cox, D. R. & Isham, V. (1980), Point Processes, Chapman and Hall, London.
Cressie, N. & Collins, L. B. (2001a), ‚ÄòAnalysis of spatial point patterns using bundles of product density lisa functions‚Äô, Journal of Agricultural, Biological, and Environmental Statistics 6, 118‚Äì135.
Daley, D. J. & Vere-Jones, D. (2003), An Introduction to the Theory of Point Processes. Volume I: Elementary Theory and Methods, second edn, Springer-Verlag, New York.
Deng, H. & Wickham, H. (2011), Density estimation in R. Electronic publication.
Diggle, P. J. (2013), Statistical Analysis of Spatial and Spatio-Temporal Point Patterns, Chapman and Hall/CRC, Boca Raton.
Fiksel, T. (1988), ‚ÄòEdge-corrected density estimators for point processes‚Äô, Statistics 19, 67‚Äì75.
Gabriel, E. (2014), ‚ÄòEstimating second-order characteristics of inhomogeneous spatio-temporal point processes‚Äô, Methodology and Computing in Applied Probability 16(2), 411‚Äì431.
Gabriel, E. & Diggle, P. J. (2009), ‚ÄòSecond-order analysis of inhomogeneous spatio-temporal point process data‚Äô, Statistica Neerlandica 63, 43‚Äì51.
Gabriel, E., Rowlingson, B. & Diggle, P. J. (2013), ‚Äòstpp: An r package for plotting, simulating and analyzing spatio-temporal point patterns‚Äô, Journal of Statistical Software 53(2), 1‚Äì29.
Gabriel, E., Wilson, D. J., Leatherbarrow, A. J. H., Cheesbrough, J., Gee, S.,  Bolton, E., Fox, A., Fearnhead, P., Hart, C. A. & Diggle, P. J. (2010), ‚ÄòSpatio-temporal epidemiology of campylobacter jejuni enteritis, in an area of Northwest England, 2000-2002‚Äô, Epidemiology and Infection 138(10), 1384‚Äì1390.
Gonz√°lez, J. A., Hahn, U. & Mateu, J. (2020), ‚ÄòAnalysis of tornado reports through replicated spatiotemporal point patterns‚Äô, Journal of the Royal Statistical Society: Series C (Applied Statistics) 69(1), 3‚Äì23.
Gonz√°lez, J. A., Rodr√≠guez-Cort√©s, F. J., Cronie, O. & Mateu, J. (2016), ‚ÄòSpatio-temporal point process statistics: A review‚Äô, Spatial Statistics 18, 505‚Äì544.
Guan, Y. (2007a), ‚ÄòA composite likelihood cross-validation approach in selecting bandwidth for the estimation of the pair correlation function‚Äô, Scandinavian Journal of Statistics 34, 336‚Äì346.
Guan, Y. (2007b), ‚ÄòA least-squares cross-validation bandwidth selection approach in pair correlation function estimations‚Äô, Statistics and Probability Letters 77, 1722‚Äì1729.
Guan, Y. (2009), ‚ÄòOn nonparametric variance estimation for second-order statistics of inhomogeneous spatial point processes with a known parametric intensity form‚Äô, Journal of the American Statistical Association 104, 1482‚Äì1491.
Hall, P. & Heyde, C. C. (2014), Martingale limit theory and its application, Academic press.
H√∂hle, M. (2007), ‚Äòsurveillance: An R package for the monitoring of infectious 
Illian, J., Penttinen, A., Stoyan, H. & Stoyan, D. (2008), Statistical Analysis and Modelling of Spatial Point Patterns, John Wiley and Sons, Chichester.
Meyer, S., Elias, J. & M. H√∂hle, M. (2012), ‚ÄòA space-time conditional intensity model for invasive meningococcal disease occurrence‚Äô, Biometrics 68(2), 607‚Äì616.
M√∏ller, J. & Ghorbani, M. (2012), ‚ÄòAspects of second-order analysis of structured inhomogeneous spatio-temporal point processes‚Äô, Statistica Neerlandica 66(4), 472‚Äì491.
M√∏ller, J. & Ghorbani, M. (2015), ‚ÄòFunctional summary statistics for the Johnson-
Mehl model‚Äô, Journal of Statistical Computation and Simulation 85, 899‚Äì916.
M√∏ller, J. & Waagepetersen, R. P. (2004), Statistical Inference and Simulation for Spatial Point Processes, Chapman and Hall/CRC, Boca Raton.
Ohser, J. (1983), ‚ÄòOn estimators for the reduced second moment measure of point processes‚Äô, Mathematische Operationsforschung und Statistik, series Statistics 14, 63‚Äì71.
Ripley, B. D. (1988), Statistical Inference for Spatial Processes, Cambridge University Press, Cambridge.
Sheather, S. J. & Jones, M. C. (1991), ‚ÄòA reliable data-based bandwidth selection method for kernel density estimation‚Äô, Journal of the Royal Statistical Society. Series B (Methodological) 53, 683‚Äì690.
Siino, M., Rodr√≠guez-Cort√©s, F. J., Mateu, J. & AdelÔ¨Åo, G. (2018), ‚ÄòTesting for local structure in spatiotemporal point pattern data‚Äô, Environmetrics 29, 1‚Äì19.
Stoyan, D., Bertram, U. & Wendrock, H. (1993), ‚ÄòEstimation variances for estimators of product densities and pair correlation functions of planar point processes‚Äô, Annals of the Institute of Statistical Mathematics 45, 211‚Äì221.
Stoyan, D. & Stoyan, H. (1994), Fractals, Random Shapes and Point Fields, Wiley, Chichester.
Wand, M. & Jones, M. C. (1994), Kernel smoothing, Chapman and Hall, London.
Wand, M., Moler, C. & Ripley, B. (2019), KernSmooth: Functions for Kernel Smoothing Supporting Wand & Jones (1995). R package version 2.23-16. URL: https://CRAN.R-project.org/package=KernSmooth
