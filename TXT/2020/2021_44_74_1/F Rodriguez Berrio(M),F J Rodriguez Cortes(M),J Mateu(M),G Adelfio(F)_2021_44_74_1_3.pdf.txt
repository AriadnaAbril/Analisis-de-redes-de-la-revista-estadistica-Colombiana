On Some Statistical Properties of the Spatio-Temporal Product Density. Sobre algunas propiedades estadísticas de la densidad producto espacio-temporal
Universidad de Antioquia, Medellín, Colombia.  Universidad Nacional de Colombia, Medellín, Colombia. Escuela Superior de Tecnología y Ciencias Experimentales, Universitat Jaume I, Castellón, España. Università degli Studi di Palermo, Palermo, Italy
Abstract
We present an extension of the non-parametric edge-corrected Ohser-type kernel estimator for the spatio-temporal product density function. We derive the mean and variance of the estimator and give a closed-form approximation for a spatio-temporal Poisson point process. Asymptotic properties of this second-order characteristic are derived, using an approach based on martingale theory. Taking advantage of the convergence to normality, conﬁdence surfaces under the homogeneous Poisson process are built. A simulation study is presented to compare our approximation for the variance with Monte Carlo estimated values. Finally, we apply the resulting estimator and its properties to analyse the spatio-temporal distribution of the invasive meningococcal disease in the Rhineland Regional Council in Germany.
Key words: Envelope; Invasive meningococcal disease; Lindeberg condition; Ohser-type estimator; Second-order product density.
Resumen
En este artículo, presentamos un estimador para la función de densidad producto de un patrón de puntos en espacio-tiempo. Este estimador es una extensión del estimador no paramétrico de Ohser, el cuál está basado en una función Kernel y ponderado por un corrector de borde. Deducimos la media y la varianza del estimador y, a su vez, damos una aproximación analítica para el caso de un patrón Poisson (completamente aleatorio). Adicionalmente, estudiamos ciertas propiedades asintóticas de nuestro estimador utilizando un enfoque basado en la teoría de martingalas y construimos superﬁcies de conﬁanza para el caso de aleatoriedad completa. Presentamos un estudio de simulación para comparar nuestra aproximación de la varianza con los valores estimados a través del método Monte Carlo. Finalmente, utilizamos nuestro estimador para analizar la distribución espacio-temporal de los registros de una enfermedad meningocócica invasiva en la provincia del Rin en Alemania.
Palabras clave: Condición de Lindeberg; Densidad de producto de segundo orden; Envoltura; Enfermedad meningocócica invasiva; Estimador de tipo Ohser.


1. Introduction
    A large amount of point pattern data sets are collected in a wide range
of scientiﬁc settings, such as environmental sciences, climate prediction and
meteorology, epidemiology, image analysis, agriculture, and astronomy. While the
statistical methodology for analysing point pattern data sets in time (Cox & Isham
1980, Daley & Vere-Jones 2003) and space (Diggle 2013, Møller & Waagepetersen
2004, Illian et al. 2008, Chiu et al. 2013) is rather well developed, today the focus
is on spatio-temporal point processes (Diggle 2013, González et al. 2016), where
each point represents the location and time of an event. Thus we have data of the
form (ui , si ) ∈ W × T ⊂ R2 × R, i = 1, . . . , n. We consider here processes that
are temporally and spatially continuous on a suﬃciently large support to justify
formulating explicitly second-order spatio-temporal tools for the data.
    Second-order functions play an essential role in the practical analysis of point
patterns, regarding both exploratory and modelling strategies. Usually, the K-
function and the pair correlation function are used for model checking (Møller
& Ghorbani 2015), and parameter estimation (Møller & Ghorbani 2012). The
second-order product density function (hereafter product density) is also useful
for both exploratory and explanatory statistical analysis (Siino et al. 2018). The
size and shape of these functions help to ﬁgure out the type of interaction within
the point pattern data to further propose suitable point process models.
    Gabriel & Diggle (2009) extended the inhomogeneous K-function (Baddeley
et al. 2000) to the spatio-temporal setting for second-order intensity-reweighted
stationary point processes. The spatio-temporal inhomogeneous K-function
(STIK-function) or equivalently the spatio-temporal pair correlation function are
thus utilised to analyse spatio-temporal correlations (Gabriel & Diggle 2009,
Gabriel et al. 2010, 2013, Gabriel 2014). (Møller & Ghorbani 2012) studied
the assumption of spatio-temporal separability of the STIK-function. These two

                     Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

On Some Statistical Properties of the Spatio-Temporal Product Density                   25

functions rely very much upon ﬁrst-order characteristics which are unknown in
practice, and replacing the intensity by an estimate must be made carefully as it
may imply bias (Baddeley et al. 2000, Gabriel 2014). We note that for Poisson
processes, the product density becomes the product of the ﬁrst-order intensities.
In the most general case, the product density is a non-standardised second-order
characteristic which does not depend on the intensity function and provides, in a
general sense, the same amount of information about the nature of the underlying
process as other second-order descriptors (González et al. 2016).
    In literature, several estimators have been proposed to estimate the product
density function in a spatial setting, see for instance (Fiksel 1988, Ohser 1983,
Stoyan et al. 1993). One of the most elegant estimators of the spatial product
density, in terms of programming and mathematical calculation, is Ohser’s
estimator (Stoyan et al. 1993). In this paper, we extend the idea in Ohser
(1983) to the spatio-temporal case to provide an estimation of the product density
function. As the estimated second-order characteristics may deviate from their
theoretical counterparts due to statistical ﬂuctuations, it is highly important
to be able to build conﬁdence surfaces for the theoretical functions. This can
be done assuming normality under the Poisson process (see Section 5). These
surfaces can also be used for model checking and to further discriminate between
clustering or regularity behaviour. Little attention has been paid so far to study
the ﬁrst- and second-order moments (mean and variance) of the second-order
characteristics of spatio-temporal point processes. In the spatial context, we refer
to (Ripley 1988) who gave the variance for some estimators of the spatial K-
function for homogeneous Poisson and Binomial point patterns. Later, (Stoyan
et al. 1993) approximated the variance of the spatial product density and the
spatial pair correlation functions, and Cressie & Collins (2001a) obtained closed
form expressions for the mean and variance of the local spatial product densities.
Guan (2009) developed a non-parametric estimator for the K-function variance
under inhomogeneity for a parametric intensity and under the assumption of
SOIRS. To the best of our knowledge, nothing has been developed in the spatio-
temporal context. González et al. (2020) extend to the spatio-temporal context
the hypothesis test to prove that two (or more) observed point patterns with
replications are realisations of point processes that have the same second-order
descriptors. Here, we follow the original idea in (Stoyan et al. 1993) to extend it
to the spatio-temporal case and obtain exact and approximate expressions of the
mean and variance of the proposed estimator.
    The rest of the paper is organised as follows. In Section 2, we recall some
theoretical background of ﬁrst- and second-order characteristics of spatio-temporal
point processes. In Section 3 we propose a non-parametric estimator for the
product density and obtain its mean and variance for the general case and for
homogeneous Poisson processes. Also, we include some asymptotic results for
the spatio-temporal product density. We then present some simulation results
in Section 5. We describe an application of our methodology to spatio-temporal
data on the invasive meningococcal disease in the Rhineland Regional Council in
Germany between 2003 and 2007 in Section 6. We end the paper with some ﬁnal
conclusions.

                     Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

26                                       Rodríguez-Berrio, Rodríguez-Cortés, Mateu & Adelﬁo


2. Deﬁnitions and Statistical Background
    We consider a ﬁnite realisation x = {(u1 , s1 ), . . . , (un , sn )} of a spatio-temporal
point process X within a bounded spatio-temporal region W ×T ⊂ R2 ×R, where a
point (u, s) ∈ X denotes an event at u ∈ R2 occurring at time s ∈ R. We consider
a spatio-temporal point process without any overlapping points as a random
countable subset X of R2 × R. Let N (C) denote the number of events falling
in an arbitrary bounded region C R⊂ R2R× R,R Θh = {(u1 , s1 ), . . . , (uh , sh ) ∈ X} is
a set of h-tuples of events in X,      = . . . for h times and C = W × T .
                                           C ⊗h      C     C

   Assume that X has a spatio-temporal hth-order product density ρ(h) , for
h = 1, 2, . . .. Then for any non-negative measurable function f deﬁned on
(R2 × R)⊗h ,
     X̸=                                       Z
   E      f ((u1 , s1 ), . . . , (uh , sh )) =   f ((u1 , s1 ), . . . , (uh , sh ))
        Θh
                                                  (R2 ×R)⊗h
                                                                                                            (1)
                                                                                       Y
                                                                                       h
                                             × ρ(h) ((u1 , s1 ), . . . , (uh , sh ))         d(ui , si ),
                                                                                       i=1
        P̸=
where        means that we sum over h pairwise distinct points. Considering (1),
in particular for h = 1 and h = 2, the hth-order product density functions are
called the intensity function and product density, respectively. A process for which
ρ(1) (u, s) = ρ for all (u, s) is called homogeneous or ﬁrst-order stationary and ρ
is called intensity. Throughout this paper, we assume that the point process X is
second-order intensity-reweighted stationary (SOIRS), i.e.

     ρ(2) ((u, s), (v, ℓ)) = ρ(u, s)ρ(v, ℓ)g(u − v, s − ℓ),                (u, s), (v, ℓ) ∈ R2 × R,

where the pair correlation function g depends only on the spatial diﬀerence u − v
and time lag s − ℓ (Gabriel & Diggle 2009). Further, if for any spatial rotation
around the origin, the rotated point process has the same distribution as the
original process then g(u − v, s − ℓ) = g0 (∥u − v∥, |s − ℓ|) for some non-negative
function g0 , where ∥ · ∥ denotes the Euclidean norm in R2 and | · | denotes the
absolute value in R we then say that the process is isotropic; for more details
see González et al. (2020). Throughout the paper, we assume that the process is
isotropic.


3. Product Density Estimation
   We extend the idea developed by Ohser (1983) to estimate the product density
function. A spatio-temporal kernel density estimator of ρ(2) (r, t) takes the basic
form of a smoothed three-dimensional histogram,
                               −1
                                       X̸=
                  (|W ||T |)                        κϵ,δ (∥u − v∥ − r, |s − ℓ| − t),
                                    (u,s),(v,l)∈x


                        Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

On Some Statistical Properties of the Spatio-Temporal Product Density                          27

where |W | and |T | denote the area of W and the length of T , respectively, and
κϵ,δ (·, ·) stands for a kernel function. For the sake of simplicity, we consider the
multiplicative form κϵ,δ (∥u−v∥−r, |s−ℓ|−t) = κ1ϵ (∥u − v∥ − r) κ2δ (|s − ℓ| − t),
where κ1ϵ and κ2δ are one-dimensional kernel functions with bandwidths ϵ and δ,
respectively. An edge-corrected kernel estimator of the product density function
is given by
                                     X̸=          κ1ϵ (∥u − v∥ − r) κ2δ (|s − ℓ| − t)
              ρd
               (2)
                   ϵ,δ (r, t) =                                                       ,        (2)
                                                               c(r, t)
                                  (u,s),(v,l)∈x

where r > ϵ > 0, t > δ > 0 and c(r, t) = 4πrγW (r)γT (t). Here γW (r) and
γT (t) are the spatial and temporal set covariance functions, respectively. The
set covariance function of a sampling window W is deﬁned as the volume of the
intersection W ∩ W−ω where W−ω is the set shifted by the vector −ω (see more
details in Chiu et al. 2013). For small r, γW (r) can generally be approximated by
γW (r) ≈ |W | − U (W  )
                    π r, where U (W ) is the perimeter of W (Stoyan et al. 1993).
For a small t it follows that γT (t) = |T | − t.


3.1. Mean and Variance of the Estimator
    We now obtain the mean and variance of the product density estimator (2)
for the general case. We assume that the product density function is continuous.
Using (1) with h = 2, the estimator (2) satisﬁes
        h           i     Z
          d                     κ1ϵ (∥x − y∥ − r)κ2δ (|ξ − η| − t)
      E ρ ϵ,δ (r, t) =
          (2)
                                         4πγW (r)γT (t)r
                              (R2 ×R)⊗2

                                                     × ρ(2) (∥x − y∥, |ξ − η|)d(x, ξ)d(y, η)
                               Z∞ Z∞
                                           κ1 (u)κ2 (v)γW (r + ϵu)γT (t + δv)
                          =
                                                      rγW (r)γT (t)
                              −r/ϵ −t/δ

                                                     × ρ(2) (r + ϵu, t + δv)(r + ϵu)du dv.     (3)

If (r, t) is a continuity point of ρ(2) (r, t), then
                                      h                  i
                             lim E ρd     (2)
                                              ϵ,δ (r, t)   = ρ(2) (r, t),
                            (ϵ,δ)→(0,0)


hence, ρd
        (2)
            ϵ,δ (r, t) is an asymptotic unbiased estimator for the spatio-temporal
product density.
    To calculate the variance, under the intensity reweighted stationarity
assumption, application of Campbell’s formula (Illian et al. 2008, Chiu et al. 2013)
for the spatio-temporal case implies that
                        2                                           
                d                    1
           E ρ ϵ,δ (r, t)
                 (2)           =              4E1 (C) + 2E2 (C) + E3 (C)         (4)
                                 (c(r, t))2


                         Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

28                                        Rodríguez-Berrio, Rodríguez-Cortés, Mateu & Adelﬁo


where
                 Z
  E1 (C) =             κ1ϵ (∥x − y∥ − r)κ1ϵ (∥x − z∥ − r)κ2δ (|ξ − η| − t)κ2δ (|ξ − ζ| − t)
              C ⊗3

                        × ρ(3) ((∥x − y∥, |ξ − η|), (∥x − z∥, |ξ − ζ|))d(x, ξ)d(y, η)d(z, ζ),
                 Z
  E2 (C) =             κ21ϵ (∥x − y∥ − r)κ22δ (|ξ − η| − t)
              C ⊗2

                                    × ρ(2) (∥x − y∥, |ξ − η|)d(x, ξ)d(y, η),
                 Z
  E3 (C) =             κ1ϵ (∥x − y∥ − r)κ1ϵ (∥z − w∥ − r)κ2δ (|ξ − η| − t)κ2δ (|ζ − γ| − t)
              C ⊗4

                        × ρ(4) ((∥x − y∥, |ξ − η|), (∥x − z∥, |ξ − ζ|), (∥x − w∥, |ξ − η|))
                                                         × d(x, ξ)d(y, η)d(z, ζ)d(w, γ).             (5)

Thus, to ﬁnd an expression for the variance in terms of (ϵ, δ), we have to know
the third- and fourth-order product densities, which opens new mathematical
diﬃculties (see Guan 2009 for the spatial case).



3.2. Mean and Variance of the Product Density Estimator
     for a Homogeneous Poisson Process

     For a homogeneous Poisson process with intensity ρ, when (ϵ, δ) → (0, 0),

      h                i               h                  i                                    
                                                                    1
     E ρd
        (2)
            ϵ,δ (r, t)   = ρ 2
                               and Var   d
                                         ρ (2)
                                               ϵ,δ (r, t)   =                4ρ 3
                                                                                  S 1 + 2ρ 2
                                                                                             S 2 ,   (6)
                                                                (c(r, t))2

where S1 and S2 are given by
                 Z
        S1 =           κ1ϵ (∥x − y∥ − r)κ1ϵ (∥x − z∥ − r)
                C ⊗3
                            × κ2δ (|ξ − η| − t)κ2δ (|ξ − ζ| − t)d(x, ξ)d(y, η)d(z, ζ)
                Z Z                                                    2
            =               κ1ϵ (∥x − y∥ − r)κ2δ (|ξ − η| − t) d(y, η) d(x, ξ) = S1s S1t
                C       C




and
                       Z
            S2 =            κ21ϵ (∥x − y∥ − r)κ22δ (|ξ − η| − t)d(x, ξ)d(y, η) = S2s S2t ,
                     C ⊗2



                              Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

On Some Statistical Properties of the Spatio-Temporal Product Density                             29

with
              Z Z                            2                  Z
      S1s =           κ1ϵ (∥x − y∥ − r) dy         dx,   S2s =          κ21ϵ (∥x − y∥ − r)dxdy,
                                                                 W ⊗2
              Z W
              W
                 Z                           2                   Z
      S1t =           κ2δ (|ξ − η| − t) dη        dξ,    S2t =          κ22δ (|ξ − η| − t)dξdη.
              T   T                                              T ⊗2


   To show these two results, we note the following. For a homogeneous Poisson
process with intensity ρ, the hth-order product density ρ(h) is equal to ρh , thus
using (3) when (ϵ, δ) → (0, 0),


   h           i  Z∞ Z∞
   d                    κ1 (u)κ2 (v)γW (r + uϵ)γT (t + δv)
 E ρ ϵ,δ (r, t) =
    (2)
                                   rγW (r)γT (t)
                        −r/ϵ −t/δ

                                                    × ρ(2) (r + uϵ, t + δv)(r + uϵ)du dv → ρ2 .

   To obtain the variance in (6), we should notice that c(r, t)ρd
                                                                (2)
                                                                    ϵ,δ (r, t) in (2) has
the form               X̸=
               A=               κ1ϵ (∥u − v∥ − r) κ2δ (|s − ℓ| − t).
                          (u,s),(v,l)∈x

So, using Campbell formula for the spatio-temporal case
                      Z
          E [A] = ρ 2
                        κ1ϵ (∥x − y∥ − r)κ2δ (|ξ − η| − t) d(x, ξ) d(y, η)
                          C ⊗2

and
                                   
                                 E A2 = 4ρ3 S1 + 2ρ2 S2 + ρ4 S3 ,

where S1 and S2 are given above, and S3 is given by
        Z
  S3 =     κ1ϵ (∥x − y∥ − r)κ1ϵ (∥z − w∥ − r)
          C ⊗4
                       × κ2δ (|ξ − η| − t)κ2δ (|ζ − γ| − t)d(x, ξ)d(y, η)d(z, ζ)d(w, γ).

Further, (E[A])2 = ρ4 S3 . Hence, Var[A] = 4ρ3 S1 + 2ρ2 S2 , and
                      h           i                            
                        d                 1
                 Var ρ ϵ,δ (r, t) =
                         (2)                         3       2
                                                   4ρ S1 + 2ρ S2 .
                                      (c(r, t))2

                       and using the Epanechnikov
   For the spatial case,                            kernel, (Stoyan et al. 1993)
                                                                           
                                        ϵ2
showed that S2 = 5ϵ |W |πr − U (W ) 7 + r
              s     6                        2
                                                  and S1s = 4π 2 r2 |W | − D +


                         Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

30                                     Rodríguez-Berrio, Rodríguez-Cortés, Mateu & Adelﬁo


4(r + ϵ)2 (π − 1)2 D, where D = U (W )(r + ϵ) − 4(r + ϵ)2 . For the temporal case,
and using the uniform kernel, it is easy to show that
                           |T |                              128 2
                   S2t =        and S1t = 4|T | − 8(t + δ) +    t (t + δ).
                            δ                                 3
    By combining the above expressions, an approximation of the variance of the
product density estimator is obtained. In practice we substitute ρ in (6) by its
estimator ρ̂ = |Wn||T | .


4. Martingale Characterisation of the Product
   Density
   The convergence to normality is an important asymptotic property of the
expectation of the product density function to build conﬁdence surfaces under
homogeneous Poisson processes. The central limit theorem for martingales
is a straightforward result that, combining Theorems 4 and 6 in Adelﬁo &
Schoenberg (2009), provides asymptotic convergence properties related to the
normal distribution for a stochastic process. This classical result for the martingale
diﬀerence process (Hall & Heyde 2014) can be enunciated in this context as follows.
Theorem 1 (Central limit theorem for martingales). If the martingale diﬀerence
stochastic process {Zm , Hm }∞m=1 , with Borel σ-algebra Hm = σ(Z1 , Z2 , . . . , Zm )
and E[Zj |Hj−1 ] = 0, for j = 1, 2, . . ., satisﬁes the following two conditions:

     1. Lindeberg condition: E[Zj2 ] < ∞, j = 1, 2, . . . such that for any ε > 0,
                                                               
                                    1 Xm
                                            2                
                           lim  2       E Zj I{|Zj |> εsm }  = 0,
                          m→∞     sm j=1

        were I is the indicator function and
                                             
                                        Xm
                            s2m = Var     Zj  → ∞ as m → ∞.
                                             j=1


     2. E[E[Zj2 |Hj−1 ]] = Var[Zj ], j = 1, 2, . . ..

   Then we have convergence in distribution to a standard normal random variable
as m → ∞,
                              1 X
                                 m
                                         d
                                     Zj → N (0, 1).
                             sm j=1

    We do not prove these statements and concentrate on the characterisation
of ρd
    (2)
        ϵ,δ (r, t). Note that the Lindeberg condition is held if we set the process
                                                                            h     i2
Z = ρd
 j
          (2)
             ϵ,δ (r, t) − ρ(2) (r, t), with expectation zero and Var[Z ] = E ρd
                                                                             j
                                                                              (2)    .     ϵ,δ
Also, the third- and fourth-order product densities exist and are ﬁnite.

                           Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

On Some Statistical Properties of the Spatio-Temporal Product Density                                           31

Theorem 2 (Martingale characterisation of ρd   (2)
                                                   ϵ,δ (r, t)). Let X be a simple spatio-
temporal point process within a bounded spatio-temporal region W × T ⊂ R2 × R
and with product density ρ(2) (r, t). The estimator deﬁned in (2), with expectation
given in the equation (3), is a martingale process, then
                       h                                                      i
                      E ρd
                         (2)              d
                             ϵ,δ (r, t) − ρ
                                            (2)                d
                                                ϵ,δ (r, t − 1)|ρ
                                                                (2) (r, t − 1) = 0.




Proof . Given that ρd       (2)
                                ϵ,δ (r, t − 1) is measurable with respect to ρ
                                                                                                d (2)
                                                                                                      ϵ,δ (r, t − 1)
then we have that
    h                                                          i        h                                      i
  E ρd(2)
          ϵ,δ (r, t) − ρd(2)
                             ϵ,δ (r, t −  1)| d
                                              ρ(2) (r, t − 1) = E ρ       d (2)
                                                                                ϵ,δ (r, t)| d
                                                                                            ρ (2) (r, t − 1)
                     h                     i       h                                    i
               − E ρd  (2)
                           ϵ,δ (r, t − 1) = E ρ
                                                     d(2)            d
                                                          ϵ,δ (r, t)|ρ
                                                                       (2) (r, t − 1) − ρ(2) (r, t − 1),



since (r, t) is a continuity point of ρ(2) (r, t) then
           h                                      i     h                      i
          E ρd
             (2)
                 ϵ,δ (r, t)| d
                             ρ (2)
                                   ϵ,δ (r, t − 1)   = E   d
                                                          ρ (2)
                                                                ϵ,δ (r, t − 1)   = ρ(2) (r, t − 1),

then we have the result. Therefore, having deﬁned a martingale starting from
ρd
 (2)
     ϵ,δ (r, t), its normality is proved if the conditions of Theorem 1 hold.



Theorem 3. Let X be a simple spatio-temporal point process in R2 × R with
product density function ρ(2) (r, t) such that E[ρd     (2) (r, t )|H ] for all t is bounded
                                                                 j   j
                                                   \
and there exists an α > 0 such that E[ρ(2+α) (r, tj )|Hj ] for all j is bounded.
Moreover, let Zj = ρd   (2) (r, t ) − ρ(2) (r, t ) be a process with expectation zero and
             h                i2 j              j
               d
Var[Zj ] = E ρ(2) ϵ,δ (r, tj ) , with ﬁnite third- and fourth-order product densities.
Finally, considering the temporal dimension, assume that for any j there exists
τj = sup{τ : N (τ ) = 1, N (τ, τ + r) = 0, τ + r < tj }, r > 0, that is there are not
overlaps in time. Then
                                            1 X
                                                 m
                                                     d
                                                  Zj → N (0, 1).
                                           sm j=1



Proof . Starting from Theorem 2 and since E[Zj ] = ρ(2) (r, tj ) and E[Zj ] < ∞
for all j, and X is assumed to be simple, the Lindeberg condition is immediately
proved. First note that
                                                 
                                           X
                                           m            X
                                                        m                   X
                                                                            m
                        s2m = Var             Zj  =         Var[Zj ] =          E[Zj2 ].
                                           j              j                   j



                            Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

32                                       Rodríguez-Berrio, Rodríguez-Cortés, Mateu & Adelﬁo


   Hence ϵsn → ∞ as n → ∞. To prove condition 1 (Lindeberg condition) of
Theorem 1, using the Hölder inequality, write

 X
 m
                            Xm
                                           2/(α+2)                   α/(α+2)
        E Zj2 I{|Zj |> εsm } ≤   E |Zj |2+α           P [|Zj | > ε sm ]
  j=1                              j=1
                                                                                       (α+2)
                                                                                             α

                                       X
                                       m
                                                                     Xm
                               ≤            E |Zj |   2+α 2/(α+2)      P[|Zj | > εsm ]       .
                                       j=1                               j=1


     Using Chebyshev inequality,

                               X
                               m
                                                            E[Zj ]2   1
                                    P[|Zj | ≥ ϵsm ] ≤               = 2,
                               j
                                                            ε2 s2m   ε

            
and E Zj2+α remains bounded (from the assumption about E[ρ\          (2+α) (r, t)|H ]),
          Pm        2                                                            t
therefore   j=1  E  Z  I
                      j {|Zj |> εsm }   grows less fast than s 2
                                                               m and  the  Lindeberg
condition holds.
     Therefore, we have shown that
                                              1
                                                Z → N (0, 1),                                   (7)
                                             sm
             P
             m           m 
                         P                              
with Z =          Zj =       ρd
                              (2) (r, t ) − ρ(2) (r, t ) .
                                       j              j
            j=1          j=1


    A complete simulation exercise to check the normality property for the second-
order characteristics is given in Adelﬁo et al. (2020). Therefore we take advantage
of the computational results reported in this work which go in the same direction
of the product density to omit presenting those results here.


5. Simulation Study
   The spatio-temporal product density is a valuable tool for model ﬁtting and
checking in a spatio-temporal point process setting. The behaviour of the product
density conveys useful information on the underlying structure of the pattern
considering just the behaviour of the response surface over small values of spatial
and temporal distances (r, t). For a Poisson process E[ρd  (2)
                                                               ϵ,δ (r, t)] u ρ which
                                                                              2

represents a plane and where ρd (2)  (r, t) comes from (2). In general, for small
                                               ϵ,δ
values of (r, t), ρd
                   (2)               2                         d
                       ϵ,δ (r, t) > ρ indicates clustering and ρ
                                                                (2)               2
                                                                    ϵ,δ (r, t) < ρ indicates
regularity or repulsion. To study the behaviour of the estimator for the product
density, we conduct a simulation experiment under the assumption of complete
spatio-temporal randomness. In addition, as we have developed a closed form
expression for the variance in the Poisson case and based on the asymptotic

                          Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

On Some Statistical Properties of the Spatio-Temporal Product Density                                     33

normality of the product density, we generate the corresponding conﬁdence
surfaces.
    We set W × T = [0, 10]2 × [0, 10] and simulate spatio-temporal point patterns
with a varying expected number of points E[N (C)] = 100, 200, 300. We consider
100 repetitions per pattern and scenario, and use the R package stpp (Gabriel
et al. 2013). We consider the spatial and temporal distances r and t spanning
the sequence starting from r > ϵ > 0 to 2.50 and t > δ > 0 to 2.50 with small
increments. Currently, there are diﬀerent methods for bandwidth selection in
the literature of spatial point processes. Minimisation of the mean integrated
square error (MISE) (Berman & Diggle 1989), least square cross-validation (Guan
2007b), and composite likelihood cross-validation (Guan 2007a) are widely used
techniques that have been developed in the literature. For example, in the spatial
        p (1988) suggested the use of the Epanechnikov kernel with bandwidth
case, Fiksel
ϵ = 0.1 5/ρ. In this paper, the dpik function of the R package Kernsmooth (Wand
et al. 2019), (see Deng & Wickham 2011), is used for selecting bandwidth ϵ. Brieﬂy,
the dpik function chooses the bandwidth by the plug-in approach; see more details
in Sheather & Jones (1991), and Wand & Jones (1994). For the temporal case,
the uniform kernel is used, where we again calculate the bandwidth δ using the
dpik function based on the time lag between the temporal instants of the process.


Table 1: Descriptive measures for the Monte Carlo mean estimates of the product
         density under homogeneous Poisson processes.
  n    ϵ     δ    c
                  ρ 2      r     t     Q5% (ρd
                                             (2)       d
                                                 ϵ,δ ) ρ
                                                         (2)           d
                                                             ϵ,δ Q95% (ρ
                                                                         (2)         d
                                                                             ϵ,δ ) σ(ρ
                                                                                       (2)       b(ρd
                                                                                           ϵ,δ ) σ
                                                                                                    (2)
                                                                                                        ϵ,δ )

                         1.132 0.541       0.009        0.010         0.014           0.003        0.003

                         1.487 1.049       0.010        0.010         0.014           0.005        0.003

 100 0.998 0.384 0.010 1.791 1.484         0.010        0.010         0.013           0.007        0.007

                         2.145 1.992       0.010        0.010         0.014           0.011        0.013

                         2.449 2.427       0.010        0.010         0.014           0.016        0.013

                         1.132 0.541       0.039        0.040         0.052           0.009        0.010

                         1.487 1.049       0.040        0.039         0.051           0.012        0.017

 200 0.735 0.248 0.040 1.791 1.484         0.039        0.040         0.051           0.018        0.017

                         2.145 1.992       0.039        0.039         0.050           0.029        0.027

                         2.449 2.427       0.040        0.040         0.053           0.041        0.037

                         1.132 0.541       0.087        0.090         0.108           0.015        0.013

                         1.487 1.049       0.089        0.089         0.109           0.022        0.020

 300 0.615 0.188 0.090 1.791 1.484         0.090        0.090         0.111           0.032        0.013

                         2.145 1.992       0.090        0.091         0.110           0.051        0.042

                         2.449 2.427       0.090        0.092         0.116           0.072        0.083



                        Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

34                                                                                           Rodríguez-Berrio, Rodríguez-Cortés, Mateu & Adelﬁo


    Table 1 shows some descriptive measures of the product density estimator for
homogeneous Poisson point patterns generated by using the rpp function in stpp
package. The spatial and the temporal bandwidths are estimated for each of the
repetitions. The table displays the average optimal bandwidth for each sample
size. We also studied the behaviour of the product density estimator with non-
optimal bandwidths (the results are omitted here). The estimator in (2) proved to
be robust showing small variations against a range of values for the bandwidths.
From all possible grid cells, we have only shown the descriptive measures for some
particular values of (r, t), for comparison purposes. These (r, t) values have been
selected to cover the ranges of the spatial and temporal distances.


                                                                                                                                                                     0.040
0.0405
                                                                                   0.035                                                                              0.035

 0.0400                                                                                                                                                                0.030

  0.0395                                                                             0.025                                                                              0.025

                                                                                                                                                                         0.020
    0.0390
                                                                                       0.015                                                                                 0.015
     0.0385                                                                                                                                                                   0.010
             2.5                                                                               2.5                                                                                2.5
                                                                             2.4                                                                             2.4                                                                                  2.4
                   2.0                                                    2.2                        2.0                                                  2.2                           2.0                                                    2.2
                                                                       2.0                                                                             2.0                                                                                  2.0
                   t=      1.5                                   1.8         ce                      t=      1.5                                 1.8            ce                      t=      1.5                                   1.8         ce
                                                                           an                                                                              an                                                                                   an
                         tim                               1.6          st                                 tim                             1.6          st                                    tim                               1.6          st
                               e   1.0                                di                                      e    1.0                                di                                            e   1.0                                di
                                                     1.4         r=                                                                  1.4         r=                                                                       1.4         r=
                                               1.2                                                                             1.2                                                                                  1.2
                                         0.5                                                                             0.5                                                                                  0.5


(a) Theoretical and estimated (b) Average standard deviation (c) Theoretical standard devia-
surfaces.                     surface.                       tion surface.
Figure 1: Monte Carlo mean estimates of the product density functions and their
          standard deviation based on 100 simulations of homogeneous Poisson point
          pattern, with expected number of points n = 200 in W × T = [0, 10]2 × [0, 10],
          ρb2 = 0.040, ϵ = 0.735 and δ = 0.248.


   Table 1 also shows the theoretical product density (ρ2 ) under the Poisson case,
together with the estimated average surface (ρd(2)
                                                   ϵ,δ (r, t)), and the corresponding
5% and 95% sample quantile values for the product density (Q (ρd            (2) (r, t))                                                                                                                       5%                ϵ,δ
and Q95% (ρd(2)                                                2     n(n−1)
                ϵ,δ (r, t))). Note that we have estimated ρ by (|W ||T |)2 which is an
unbiased estimator in case of a homogeneous Poisson process (Stoyan & Stoyan
1994). Comparing the results in the fourth and eight columns, clearly the bias is
negligible and ρd  (2)                          2
                       ϵ,δ (r, t) converges to ρ . In terms of variances, we present the
approximate theoretical standard deviation surface (σ(ρd        (2) )) together with the                                                                                         ϵ,δ
                                                             σ (ρd
Monte Carlo mean estimate of the standard deviation surface (b   (2)
                                                                     ϵ,δ )) obtained
by simulation. Table 1 shows the results for only ﬁve selected cells (spatial and
temporal lags (r, t)) over the ﬁne grid of spatial and temporal distances to save
space.
    For illustrative purposes, the estimated product density function over the whole
grid is depicted in Figure 1, for a homogeneous Poisson point pattern with intensity
0.2 in W × T , and with ϵ = 0.735 and δ = 0.248. Figure 1(a) shows the average
estimate of ρd (2)
                   ϵ,δ (r, t) under 100 repetitions of the selected scenario. Figure 1(a)


                                                             Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

On Some Statistical Properties of the Spatio-Temporal Product Density                                                           35

also presents the constant surface ρb2 (which is equal to 0.040) for a homogeneous
Poisson point pattern. Clearly ρd (2)
                                      ϵ,δ (r, t) is an approximate unbiased estimator
of ρ(2) (r, t).

    Figure 1(b) shows the corresponding average estimate of the standard deviation
surface under the same 100 repetitions. Figure 1(c) depicts the theoretical
standard deviation surface coming from expression (6). Figure 2(a) shows the
conﬁdence surfaces for homogeneous Poisson point patterns based on the estimated
product density and two standard deviations calculated using the expression of
the variance in (6) together with a constant surface with value ρb2 = 0.040 and the
average of the estimated product densities. We have obtained very similar results
with intensities equal to 0.1 and 0.3, in simulations not shown here.




                                                                             0.15
            0.08

             0.06                                                             0.10
              0.04
                                                                               0.05
               0.02
                   0.00
                                                                                0.00
                                                                                −0.05
                      2.0                                              2.0          2.0                                   2.0
                                                                 1.8                                                    1.8 e
                            1.5                                          e                  1.5
                          t=                               1.6         nc              t=                            1.6 nc
                                                                  st
                                                                     a                                                     a
                               tim 1.0               1.4        di                          tim 1.0               1.4 ist
                                  e                        r=                                  e                         d
                                         0.5
                                               1.2
                                                                                                      0.5
                                                                                                            1.2     r=

            (a) Mean,         homogeneous                                    (b) Mean,       inhomogeneous
            Poisson case (white), 0.98%                                      Poisson case (white), 0.98%
            conﬁdence surfaces (lightgray)                                   conﬁdence surfaces (lightgray)
            and theoretical product density                                  and theoretical product density
            (grey).                                                          (grey).
Figure 2: Mean estimate of the product density function in the inhomogeneous case
          with the very same region and expected number of points, ϵ = 0.99 and
          δ = 0.38.



     Finally, Figure 2(b) shows the conﬁdence surfaces for homogeneous Poisson
point patterns with expected number of points n = 200 in W × T = [0, 10]2 ×
[0, 10] together with the average of estimated product densities coming from 100
inhomogeneous Poisson point patterns with intensity function given by


                                        ne20
         ρ(x, y, t) =                            e−y−t , with (x, y, t) ∈ [0, 10]2 × [0, 10].
                                    10(e10 − 1)2


We note that the average surface for the inhomogeneous Poisson point pattern
falls outside the conﬁdence surfaces constructed under homogeneity.

                                  Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

36                               Rodríguez-Berrio, Rodríguez-Cortés, Mateu & Adelﬁo


6. Data Application: Invasive Meningococcal
   Disease
    In this section, as a practical example, we illustrate how our product density
estimator applies to Invasive Meningococcal Disease (IMD) data. IMD is a
bacterial infection caused by bacterium Neisseria meningitidis. The data were
previously analysed by Meyer et al. (2012) considering a mechanistic model
with a conditional intensity function which is a superposition of additive and
multiplicative components in space and time. The IMD data analysed in this
section are taken from the R package surveillance (Höhle 2007).




           Figure 3: Subregion of Rhineland Regional Council (Germany).


    The IMD data for the whole region of Germany shows a clear clustering
behaviour (see Meyer et al. 2012), even without the help of any statistical
tool. Therefore, we restrict our analysis to the subregion of Rhineland Regional
Council (Germany) between 2003 and 2007 (see Figure 3), where the point pattern
apparently does not show any clustering structure in space. The second-order
analysis starts by applying a mechanism for visual assessment whether our point
pattern is compatible with a spatio-temporal homogeneous Poisson pattern. If
this hypothesis is rejected, the process can be modelled as a regular or as a cluster
process. The area of this region is 9427.59 km2 with a perimeter of 379.89 km. The
IMD dataset consists of the spatio-temporal reports of 107 cases of IMD caused
by two speciﬁc meningococcal ﬁnetypes, in which the times are given by 1491 days
over the 5-years period, so the temporal region is deﬁned as T = [500.51, 1992.18].
Figure 4(a) and Figure 4(b) show the estimated spatial and temporal intensities,
respectively. In the purely spatial case, the pattern in Figure 4(a) does not exhibit
any apparent clustering; for the time case, Figure 4(b) shows a nearly constant
intensity indicating that temporal point pattern may be homogeneous.
    Figure 5 shows the surface of the estimated second-order product density
using ϵ = 7.72 km and δ = 45 days. We see large values for small spatial and
temporal distances, which is a typical behaviour when spatio-temporal aggregation
is present. However, the spatial aggregation decreases with increasing spatial

                     Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

On Some Statistical Properties of the Spatio-Temporal Product Density                                                                                                                37

distances, while the temporal aggregation increases throughout the temporal
distances. The clustering-type result is expected after visual inspection of
Figure 5(a), and goes in the line found by Meyer et al. (2012).




                                                                                                           0.10
      3200




                                                                                                           0.08
                                             0.004
                                              0.006
      3150




                                                                                                           0.06
                             0.008
                              0.0
                                  14
                                                  01
      3100




                          0.022




                                                                                                           0.04
                                   0.018


                                                0.




                                                       0.008
                                        12
                                  0.0          0.006




                                                                                                           0.02
      3050




                                                                                                           0.00
              4000        4050                   4100           4150               4200                           500                       1000                     1500    2000

                                                                                                                                                   t = time (days)



               (a) Estimated spatial intensity.                                                             (b) Estimated temporal intensity.
Figure 4: Region of study, and estimated spatial and temporal intensities for the IMD
          dataset.
                                                                                                     350




                                                                                                                                                      9e−11
                                                                                                                        10
                                                                                                                     e−
                                                                                                                  1.2
                                                                                                     300




                                                                                                                                       10      8e−11
    1.2e−10                                                                                                                      1e−
                                                                                                                      −10
                                                                                                     250




     1.0e−10
                                                                                                                  1.1e




                                                                                                                                                        6e−11
                                                                                          t = time
                                                                                                     200




      8.0e−11                                                                                                                               7e−11                           5e−11
             6.0e−11
                                                                                                     150




                                                                                                                                                                                 1
                                                                                                                                                                             5e−1

                                                                                                                            7e−11                     8e−11
                     350
                                                                                 30
                                                                                                     100




                       300                                                                                             1e
                                                                                                                            −1
                                                                                                                                       9e−11
                                                                            25        e
                      t = 250                                                       c                                         0

                          tim200                                    20           an
                                                                                                     50




                                                                              st
                             e 150                                          di                                    10                   15             20               25   30
                                                                       r=
                                                               15
                                  100                                                                                                               r = distance

                       (a) Empirical surface.                                                                                (b) Empirical contour.
Figure 5: Two estimation formats of the product density for IMD dataset with ϵ = 7.72
          km, and δ = 45 days.


    To emphasise this clustering behaviour, we also show in Figure 6 the empirical
product density for the data together with simulated pointwise 95% envelope
surfaces obtained from 39 simulations of spatio-temporal Poisson processes.
Figure 6(a) considers homogeneous Poisson point patterns and we note that the
surface of the empirical product density for the data does not have the constant
shape that characterises a completely random point process. In addition, for
small spatial distances ρd
                         (2)
                             ϵ,δ (r, t) exceeds the upper envelope indicating clustering.
Figure 6(b) considers inhomogeneous spatio-temporal Poisson processes with an

                                              Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

38                                                                   Rodríguez-Berrio, Rodríguez-Cortés, Mateu & Adelﬁo


intensity built as the product of the spatial and temporal intensities for the IMD
data; this plot shows a clear clustering behaviour as well.


                                                                                                                  4e−10
                                                           1.2e−10
1.2e−10
                                                           1.0e−10
1.0e−10                                                                                                            2e−10
                                                             8.0e−11
  8.0e−11
                                                              6.0e−11                                               0e+00
   6.0e−11
                                                              4.0e−11
     4.0e−11                                                                                                        −2e−10
                                                               2.0e−11

             350                                                        350                                                  350
                                                    30                    300                              30                  300                              30
               300
                                                                         t = 250                                                                           25
              t = 250                      25
                                                     nc
                                                       e                                              25
                                                                                                             ce               t = 250                                ce
                  tim200                         ta                          tim200                        an                     tim200             20        an
                                                                                                                                                            ist
                                     20                                                         20
                                                s                                                       st
                     e 150                 di                                   e 150                 di                             e 150                 d
                                                                                                                                                      r=
                                                                                                                                                15
                                      r=                                                         r=
                                15                                                   100   15
                          100                                                                                                             100


             (a) Homogeneous                                           (b) Inhomogeneous                                       (c) Theoretical
Figure 6: Estimated product density function for the IMD data (white surface)
          together with simulated pointwise 95% envelope surfaces obtained from 39
          simulations of: (a) homogeneous spatio-temporal Poisson point patterns; (b)
          inhomogeneous spatio-temporal Poisson point patterns with the estimated
          intensity function of IMD data (grey surfaces); (c) homogeneous Poisson point
          patterns using theoretical expressions (grey surfaces).


   Note that in Figure 6(c) we construct the conﬁdence surface under homoge-
neous Poisson point patterns based on the estimated ρd
                                                     (2)
                                                         ϵ,δ (r, t) ± 2 × standard
deviations calculated using the approximation of the variance in (6) for the
empirical product density for the IMD data. Again, the empirical second-
order product density exceeds the upper conﬁdence surface. These three ﬁgures
reveal that IMD has a contagious behaviour in their immediate spatio-temporal
neighborhoods.


7. Discussion
    The spatio-temporal product density describes second-order characteristics of
point processes. It is useful to analyse the spatio-temporal structure of the
underlying point process, and provides a natural starting point for the analysis
of spatio-temporal point process data. It can be considered an exploratory tool,
for check spatio-temporal inhomogeneity, clustering or interaction.
    We have proposed a non-parametric edge-corrected kernel estimator of the
product density under SOIRS hypothesis. The mean and variance of the estimator
are obtained, and approximated closed form expressions are derived under the
Poisson case. The pair correlation and K-functions are severely aﬀected by the
spatial and temporal intensity estimates as shown in Gabriel (2014). This is one
of the reasons we propose in this paper using the product density. We indeed
postulate the use of the second-order product density as it provides the same
information, but with the added value that there is no need to estimate the spatio-
temporal intensity. The main idea is to compare the ﬂuctuation of the empirical

                                     Revista Colombiana de Estadística - Applied Statistics 44 (2021) 23–41

On Some Statistical Properties of the Spatio-Temporal Product Density                     39

surface with the corresponding envelope and conﬁdence surfaces, as a means to
check for randomness and/or clustering, and also for model checking. The panels
of Figure 6 show that conﬁdence surfaces ﬂuctuate only slightly more than the
envelope surfaces. Therefore from the point of view of the computational cost,
one can use the conﬁdence surfaces instead of running 99 simulations to obtain
envelope surfaces.
    We have provided suﬃciently statistical grounds in favour of using this second-
order tool in the practical analysis of spatio-temporal point patterns. However,
in our developments, we assumed that the point pattern is SOIRS. The statistical
properties of the spatio-temporal product density under general non-stationarity
conditions or anisotropic structures remain an open problem.


Acknowledgements
  Research of J. Mateu were supported by the Spanish Ministry of Science and
Education through the project MTM2016-78917-R.
                                                                           
                  Received: January 2020 — Accepted: September 2020


References
Adelﬁo, G. & Schoenberg, F. P. (2009), ‘Point process diagnostics based on weighted second-order statistics and their asymptotic properties’, Annals of the Institute of Statistical Mathematics 61(4), 929.
Adelﬁo, G., Siino, M., Mateu, J. & Rodríguez-Cortés, F. J. (2020), ‘Some properties of local weighted second-order statistics for spatio-temporal point processes’, Stochastic Environmental Research and Risk Assessment 34(1), 149–168.
Baddeley, A., Møller, J. & Waagepetersen, R. (2000), ‘Non- and semi-parametric estimation of interaction in inhomogeneous point patterns’, Statistica Neerlandica 54, 329–350.
Berman, M. & Diggle, P. (1989), ‘Estimating weighted integrals of the second-order intensity of a spatial point process’, Journal of the Royal Statistical Society: Series B (Methodological) 51(1), 81–92.
Chiu, S. N., Stoyan, D., Kendall, W. S. & Mecke, J. (2013), Stochastic Geometry and Its Applications, third edn, John Wiley and Sons.
Cox, D. R. & Isham, V. (1980), Point Processes, Chapman and Hall, London.
Cressie, N. & Collins, L. B. (2001a), ‘Analysis of spatial point patterns using bundles of product density lisa functions’, Journal of Agricultural, Biological, and Environmental Statistics 6, 118–135.
Daley, D. J. & Vere-Jones, D. (2003), An Introduction to the Theory of Point Processes. Volume I: Elementary Theory and Methods, second edn, Springer-Verlag, New York.
Deng, H. & Wickham, H. (2011), Density estimation in R. Electronic publication.
Diggle, P. J. (2013), Statistical Analysis of Spatial and Spatio-Temporal Point Patterns, Chapman and Hall/CRC, Boca Raton.
Fiksel, T. (1988), ‘Edge-corrected density estimators for point processes’, Statistics 19, 67–75.
Gabriel, E. (2014), ‘Estimating second-order characteristics of inhomogeneous spatio-temporal point processes’, Methodology and Computing in Applied Probability 16(2), 411–431.
Gabriel, E. & Diggle, P. J. (2009), ‘Second-order analysis of inhomogeneous spatio-temporal point process data’, Statistica Neerlandica 63, 43–51.
Gabriel, E., Rowlingson, B. & Diggle, P. J. (2013), ‘stpp: An r package for plotting, simulating and analyzing spatio-temporal point patterns’, Journal of Statistical Software 53(2), 1–29.
Gabriel, E., Wilson, D. J., Leatherbarrow, A. J. H., Cheesbrough, J., Gee, S.,  Bolton, E., Fox, A., Fearnhead, P., Hart, C. A. & Diggle, P. J. (2010), ‘Spatio-temporal epidemiology of campylobacter jejuni enteritis, in an area of Northwest England, 2000-2002’, Epidemiology and Infection 138(10), 1384–1390.
González, J. A., Hahn, U. & Mateu, J. (2020), ‘Analysis of tornado reports through replicated spatiotemporal point patterns’, Journal of the Royal Statistical Society: Series C (Applied Statistics) 69(1), 3–23.
González, J. A., Rodríguez-Cortés, F. J., Cronie, O. & Mateu, J. (2016), ‘Spatio-temporal point process statistics: A review’, Spatial Statistics 18, 505–544.
Guan, Y. (2007a), ‘A composite likelihood cross-validation approach in selecting bandwidth for the estimation of the pair correlation function’, Scandinavian Journal of Statistics 34, 336–346.
Guan, Y. (2007b), ‘A least-squares cross-validation bandwidth selection approach in pair correlation function estimations’, Statistics and Probability Letters 77, 1722–1729.
Guan, Y. (2009), ‘On nonparametric variance estimation for second-order statistics of inhomogeneous spatial point processes with a known parametric intensity form’, Journal of the American Statistical Association 104, 1482–1491.
Hall, P. & Heyde, C. C. (2014), Martingale limit theory and its application, Academic press.
Höhle, M. (2007), ‘surveillance: An R package for the monitoring of infectious 
Illian, J., Penttinen, A., Stoyan, H. & Stoyan, D. (2008), Statistical Analysis and Modelling of Spatial Point Patterns, John Wiley and Sons, Chichester.
Meyer, S., Elias, J. & M. Höhle, M. (2012), ‘A space-time conditional intensity model for invasive meningococcal disease occurrence’, Biometrics 68(2), 607–616.
Møller, J. & Ghorbani, M. (2012), ‘Aspects of second-order analysis of structured inhomogeneous spatio-temporal point processes’, Statistica Neerlandica 66(4), 472–491.
Møller, J. & Ghorbani, M. (2015), ‘Functional summary statistics for the Johnson-
Mehl model’, Journal of Statistical Computation and Simulation 85, 899–916.
Møller, J. & Waagepetersen, R. P. (2004), Statistical Inference and Simulation for Spatial Point Processes, Chapman and Hall/CRC, Boca Raton.
Ohser, J. (1983), ‘On estimators for the reduced second moment measure of point processes’, Mathematische Operationsforschung und Statistik, series Statistics 14, 63–71.
Ripley, B. D. (1988), Statistical Inference for Spatial Processes, Cambridge University Press, Cambridge.
Sheather, S. J. & Jones, M. C. (1991), ‘A reliable data-based bandwidth selection method for kernel density estimation’, Journal of the Royal Statistical Society. Series B (Methodological) 53, 683–690.
Siino, M., Rodríguez-Cortés, F. J., Mateu, J. & Adelﬁo, G. (2018), ‘Testing for local structure in spatiotemporal point pattern data’, Environmetrics 29, 1–19.
Stoyan, D., Bertram, U. & Wendrock, H. (1993), ‘Estimation variances for estimators of product densities and pair correlation functions of planar point processes’, Annals of the Institute of Statistical Mathematics 45, 211–221.
Stoyan, D. & Stoyan, H. (1994), Fractals, Random Shapes and Point Fields, Wiley, Chichester.
Wand, M. & Jones, M. C. (1994), Kernel smoothing, Chapman and Hall, London.
Wand, M., Moler, C. & Ripley, B. (2019), KernSmooth: Functions for Kernel Smoothing Supporting Wand & Jones (1995). R package version 2.23-16. URL: https://CRAN.R-project.org/package=KernSmooth
