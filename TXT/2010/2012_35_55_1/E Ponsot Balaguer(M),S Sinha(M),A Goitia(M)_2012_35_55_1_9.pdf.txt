Aggregation of Explanatory Factor Levels in Binomial Logit Model: Generalization to the Multifactorial Unsaturated Case
Universidad de Los Andes (ULA);Instituto de Estadística Aplicada y Computación (IEAC);FACES-ULA
Abstract
We discuss a situation in which, once a logit model is fitted to the data in a contingency table, some factor levels are grouped. Generally, researchers reapply a logit model on the pooled data, however, this approach leads to the violation of the original distributional assumption, when the probabilities of success of the random variables of aggregation differ. In this paper we suggest an alternative procedure that operates under the unsaturated, multifactorial, binomial, logit model. Based on asymptotic theory and taking advantage of the decrease in the variance when the correct distributional assumption is made, the suggested procedure significantly improves the estimates, reduces the standard error, produces lower residuals and is less likely to reject the goodness of fit test on the model. We present the necessary theory, the results of an extensive simulation designed for this purpose, and the suggested procedure contrasted with the usual approach, through a complete numerical example.
Key words: Contingency tables, Generalized linear model, Levels sets, Logit model.
Resumen
Se discute la situación en la que, una vez ajustado un modelo logit a los datos contenidos en una tabla de contingencia, se selecciona un factor cualquiera de los participantes y se agregan algunos de sus niveles. Generalmente los investigadores proceden a postular nuevamente un modelo logit sobre los datos agrupados, sin embargo, este proceder conduce a la violación del supuesto distribucional original, cuando las probabilidades de éxito de las variables aleatorias de la agregación, son disímiles. En este trabajo se sugiere un procedimiento alternativo que opera en el marco del modelo logit binomial no saturado, multifactorial. Con base en la teoría asintótica y aprovechando la disminución en la varianza cuando se postula el modelo distribucional correcto, el procedimiento sugerido mejora apreciablemente las estimaciones, reduce el error estándar, produce valores residuales más cercanos al cero y menores probabilidades de rechazo en la prueba de bondad del ajuste del modelo. Sustentan tales afirmaciones tanto los desarrollos teóricos necesarios, como los resultados de una extensa simulación diseñada al efecto. También se expone el procedimiento sugerido contrastado con el habitual, mediante un ejemplo numérico completo.
Palabras clave: conjuntos de niveles, modelo lineal generalizado, modelo logit, tablas de contingencia.




1. Introduction
    Assume a Bernoulli phenomenon, that is, an experiment whose outcome regard-
ing an individual can only be a success or a failure (or equivalently, the presence
or absence of a feature, membership to a particular group or other similar forms).
Assume also that a researcher wants to test whether the outcome of the experiment
is determined by certain characteristics, measurable in each individual and possi-
bly the direction of the relationship if it exists. For this, the researcher collects
data from a previous study or by sampling, for example, and builds a contingency
table including the levels of the factors under study, the number of cases in which
tests the response of interest (success or failure) and total individuals examined,
for each combination of these levels.
    A statistical model is related to a contingency table in order to capture the
essence of the phenomenon of study in a manageable way and to draw valid con-
clusions for the population regarding about the causal relationships between the
observed response and the measured characteristics.
    Now, assuming that the responses are distributed as independent binomials,
a model that postulates a certain function of the probability of success of the re-
sponse and relates linearly with the measured characteristics in individuals looks
suitable for analysis. Thus, taking the probit model as a precursor, are the lo-
gistic regression for continuous variables and its counterpart, the logit model for
categorical explanatory variables or factors introduced by Joseph Berkson in 1944
(Hilbe 2009, p. 3).
                                                                                  p
   In the case of a logit model, the link function considered is logit(p) = log( 1−p ).
Applied to the probability of success p of a Bernoulli random variable, logit(p)
represents the logarithm of the possibility. This, in turn, is defined as the ratio
between the probability of success p and its complement, the probability of failure
1 − p.

                                      Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                   141

    Moreover, suppose that the researcher, after fitting a logit model to the data,
decides to add some levels of one factor, and repeat the analysis, i.e., fit a new
logit model on a contingency table resulting from the aggregation.
    It happens that in reiterating a logit model on a second contingency table,
with grouped levels of the factors, generally the original binomial assumption is
violated, with important implications on the estimated variances (Ponsot, Sinha
& Goitía 2009)1.
    In seeking to address this problem and keep the situation under the general-
ized linear model frame (Nelder   Wedderburn 1972), this paper postulates the
problem of aggregation of factor levels in a broad context, i.e., in multifactorial
unsaturated logit model situation, and proposes and demonstrates some theorems
needed to suggest a procedure, alternative to the usual, that takes advantage of
the true variance of the random variables added. It is shown theoretically by
asymptotic means, and by simulation, that the suggested procedure is appropriate
and in many cases, better than the usual procedure.
    This paper continues with the next section presenting a summary of the main
background of the work. The third section presents the problem and its solution,
including the theorems that support the suggested procedure and their proofs.
The fourth section illustrates the suggested procedure with a numerical example.
The fifth section summarizes the extensive simulation results comparing the two
procedures (normal and suggested). The sixth section is devoted to conclusions,
and the work ends with the acknowledgments, references and a brief appendix on
the design matrix for the saturated and unsaturated models.


2. Backgrounds
    Ponsot et al. (2009) present the problem of aggregation levels of an explana-
tory factor in the saturated logit model. The authors study the affectation of the
binomial distributional assumption and show that, once factor levels are grouped,
which involves adding independent binomial random variables (RV’s), in the gen-
eral case where the probabilities of success are different, the random variable (RA)
resulting from the aggregation does not follow a binomial distribution. Proper dis-
tribution is as follows:
    Let X1 and X2 be two independents RV’s such that X1 ∼ Bin(n1 , p1 ) and
X2 ∼ Bin(n2 , p2 ) with n1 ≤ n2 . Then, the RV Z = X1 + X2 is distributed as
follows:                              k
                                  p1
                  P[Z = k] =              (1 − p1 )n1 (1 − p2 )n2 S(k)            (1)
                                1 − p1




   1 This is central in the doctoral thesis of first author (Ponsot 2011), one of whose results is

this paper.


                                          Revista Colombiana de Estadística 35 (2012) 139–166

142                          Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía

where
              k 
              X n1  n2   p2 (1 − p1 ) i
             
                                                , k = 0, . . . , n1
             
             
              i=0 k − i
             
             
                             i    p1 (1 − p2 )
             
              X  k                           i
                         n1    n2     p2 (1 − p1 )
      S(k) =                                          , k = n1 + 1, . . . , n2
             
                       k−i     i     p1 (1 − p2 )
              i=k−n1 
                                              i
             
                n2
                 X
             
                        n1    n2     p2 (1 − p1 )
             
                                                     , k = n2 + 1, . . . , n1 + n2
                        k−i     i     p1 (1 − p2 )
                 i=k−n1


    The authors also prove that as the difference between the probabilities of suc-
cess of the RV’s involved in the aggregation increases, the correct variance of the
resulting RV [distributed as in (1)], becomes less than the variance calculated
assuming that the RV resulting is binomially distributed.
    In general, let X1 , X2 , . . . , Xa be independents RV’s such that Xi ∼ Bin(ni , pi )
for i = 1, . . . , a. Let Xa−k+1 , Xa−k+2 , . . . , Xa , the k last RV’s being added
(1 < k < a) forming the RV Z = Xa−k+1 +Xa−k+2 +· · ·+Xa . Due to the indepen-
dence of the originals RV’s, V[Z] is the simple sum of V[Xi ] for i = a − k + 1, . . . , a.
However, if Z is assumed (incorrectly) binomial, the variance (VBin ) should be
calculated differently, making assumptions about the probability of success. By
studying the difference ∆V = VBin [Z] − V[Z], it follows that:


                                    a−1
                                    X      a
                                           X
                                                 ni nj (pi − pj )2
                                 i=a−k+1 j=i+1
                          ∆V =               a                                         (2)
                                            X
                                                     ni
                                           i=a−k+1


   Clearly ∆V ≥ 0, then the correct variance is generally smaller than the bino-
mial (equal if and only if pi = pj , ∀i, j).
    Based on these facts and using arguments of asymptotic nature, these authors
suggest an alternative procedure to the reiteration of the logit model fitting when
factor levels are added. This procedure improves the precision of the estimates,
using the true variance of the RV’s involved.
   Now, as mentioned, the entire development applies in the univariate situation
and saturated model exclusively, leaving pending the study of unsaturated logit
model in the multifactorial situation. Such an extension is the aim in this work.
    Besides, it must be mentioned that there are different courses of action than the
asymptotic approach to the problem. For example, we may include (1) as a factor
in the likelihood function; however, clearly an analytically intractable expression
is obtained, and therefore, very difficult to derivate.
   Another possible course of action is to postulate the exact distribution for each
given data set, from the contingency table. This way to avoid the assumption of

                                       Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                                    143

binomial populations, leading to the hypergeometric distribution and combinato-
rial analysis. This path has been explored successfully in the theory of generalized
linear model; however, it is not of very frequent application because it imposes
considerable computational challenges.
    It should also be mentioned that the aggregation of factor levels and subsequent
repetition of a logit setting is of common practice among statisticians. Hosmer
& Lemeshow (2000, p. 136) suggested as a strategy to overcome the drawback of
responses with very low or no representation in the contingency table. Examples
abound in which the researcher adds factor levels, simply to reduce the complexity
of the analysis or because wish to concentrate posteriori on some levels and try the
other anonymously. An exercise that illustrates this approach can be seen in Hilbe
(2009, pp. 74 y 88). In his text the author develops models from the Canada’s
National Cardiovascular Registry, using a first opportunity to age with four levels
as an explanatory factor, and another time, this factor grouping up to only two
levels. Another example of the latter type is shown in Menard (2010). In his text
the author uses data from the National Center for Opinion Research (University of
Chicago, USA), taken from the General Social Survey. In some instances, operates
with three or even more levels for the factor “race” (Caucasian, African descent
and others), while in alternative examples, it does so with only two levels (not
Caucasian and other), grouping the original levels.



3. The Problem and Its Solution
       Let T a contingency table for a binary response with s crossed factors A1 , A2 ,
. . . , As , each with t1 , t2 , . . . , ts levels, respectively. Each combination of factor lev-
els has an observed response (yi1 i2 ···is ) as the number of successes, all assumed in-
dependently binomially distributed with a total number of observations (ni1 i2 ···is ),
ij = 1, . . . , tj and j = 1, . . . , s. On T , an unsaturated logit model is fitted with
the reference parameterization [see for example Rodríguez (2008, cap. 2, p. 29)
or SAS Institute Inc. (2004, p. 2297)], then let:

                 ηi1 i2 ···is = logit(pi1 i2 ···is ) = xTi1 i2 ···is β, ij = 1, . . . , tj ;
                                                                                                              (3)
                                                                        j = 1, . . . , s

be the univariate version of the logit model for crossed factors A1 , . . . , As . To sim-
plify the treatment of the subscripts of the model, assume that each combination
of factors is reindexed orderly, making it correspond to a single value as:

            1 ≡ (1, 1, . . . , 1), . . . , i ≡ (i1 , i2 , . . . , is ), . . . , k ≡ (t1 , t2 , . . . , ts )

so as to produce k = t1 × · · · × ts sequenced indexes. In turn, the response is re-
indexed as y1 , y2 , . . . , yk and so the totals as n1 , n2 , . . . , nk . Then (3) is expressed
in the usual way as:

                            ηi = logit(pi ) = xTi β, i = 1, . . . , k                                         (4)

                                                   Revista Colombiana de Estadística 35 (2012) 139–166

144                          Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía

    In (4) xTi is the row vector corresponding to the combination of levels i1 , i2 , . . . ,
is of the design matrix Xk×m and βm×1 is the vector of parameters to be esti-
mated. Let η = [η1 · · · ηk ]T be the vector that groups the logit elements, then
the multivariate version of the binomial logit model can be expressed as η = Xβ.
    Suppose that after fitting the model to the data, we decide to group some levels
of a factor. In the multifactorial situation, the grouping of levels of a factor occurs
in several separate clusters, whose number is directly related to the number of
levels of other factors of the model. For example, let s = 3, A1 , A2 , A3 be crossed
ordered factors and t1 = t2 = t3 = 3 its levels. This factor structure contains the
tuples (1, 1, 1), (1, 1, 2), . . . , (3, 3, 3), resulting in 3 × 3 × 3 = 27 tuples.
     Let examine the following situation for illustrative purposes: Levels 2 and 3 of
A3 are grouped. In this situation, the new number of levels of A3 is t∗3 = 2 and
factor structure is reduced to 3 × 3 × 2 = 18 tuples. For i = 1, 2, 3 and j = 1, 2, 3,
original tuples (i, j, 2) and (i, j, 3) collapse in the new tuples (i, j, 2∗ ) by adding the
corresponding values of the response variables yij2 + yij3 and the totals nij2 + nij3 .
It is easy to notice that 9 aggregation sets are required, ck , k = 1, 2, . . . , 9, each one
with two elements or levels c1 = {(1, 1, 2), (1, 1, 3)}, . . . , c9 = {(3, 3, 2), (3, 3, 3)}.
    If the proposed model is saturated (k = m), i.e. the number of available
observations equals the number of model parameters, the X matrix is a square, full
rank, and therefore invertible matrix. Moreover, when assuming an unsaturated
logit model, generally k > m, the design matrix X is no longer square and it has
no inverse.
   It has been proved by McCullagh   Nelder (1989, p. 119) that

                                     b = (X T W X)−1
                                  V [β]

where W = diag[ni pi (1−pi )]. These authors also discuss that the problems of over
or under dispersion, deserve detailed study and that they can be solved by simply
           b by a constant, obtained from the deviance or Pearson’s statistics and
scaling V [β]
residual degrees of freedom ratio.
    Thus, assuming no over or under dispersion (which simply involves the appro-
priate scaling of the estimated variance-covariance matrix), an immediate conse-
quence of the fact that X has no inverse is that, once parameters have been es-
timated by iterative reweighted least squares (Searle, Casella   McCulloch 2006,
              b = X(X T W X)−1 X T , do not support further simplification.
p. 295), V [X β]
   Let be Σ = X(X T W X)−1 X T , with elements [σij ], i, j = 1, . . . , k. In general,
though not necessarily, σij 6= 0. Then, due to the central limit theorem (Lehmann
1999, p. 73) and asymptotic properties of maximum likelihood estimators:

                               b = X βb ∼ AN(Xβ; Σk×k )
                               η                                                         (5)

    In (5), “AN” is the abbreviation for “Asymptotically Normal”, commonly used
in the statistical literature. Moreover, it is necessary the asymptotic distribution
of the pbi . It is developed in the following theorem:


                                        Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                                           145

Theorem 1. If η     b = [logit(b  p1 ) logit(b                pk )]T is distributed as in (5),
                                             p2 ) · · · logit(b
                             T
then pb = [b
           p1 pb2 · · · pbk ] , such that:

                                                     exi βb
                                                            T

                                          pbi =                     , i = 1, . . . , k
                                                  1 + exi βb
                                                                T


                                                                                                                 T
is asymptotically distributed as multivariate normal with E[pbi ] = pi = exi β /(1 +
   T
exi β ) and variance covariance matrix Ψ = [ψij ] with elements ψij = σij pi (1 −
pi )pj (1 − pj ), i, j = 1, . . . , k.

Proof . Let gi−1 for i = 1, . . . , k be real-valued functions defined as

                                                                                      eb
                                                                                       ηi
                                       gi−1 (b
                                             η1 , . . . , ηbi , . . . , ηbk ) =
                                                                                   1 + eb
                                                                                        ηi

then,
                                                     (
                                       ∂gi−1                  0                     , i 6= j
                                             =
                                        ∂b
                                         ηj               b
                                                         e /(1 + eb
                                                          ηi      ηi 2
                                                                    )               ,i = j


                          k X
                          X k                               −1                k
                                                                              X                       −1
                                              ∂gi−1 ∂gj                                     ∂gi−1 ∂gj
                ψij =                   σst                               =          σsj
                                                ηs ∂b
                                               ∂b     ηt                                      ηs ∂b
                                                                                             ∂b     ηj
                          s=1 t=1                                   b=η
                                                                    η         s=1                          b=η
                                                                                                           η
                                       −1
                               ∂gi−1 ∂gj                                   e  ηi
                                                                                    e            ηj
                     = σij                                      = σij
                                 ηi ∂b
                                ∂b   ηj                                 (1 + e ) (1 + eηj )2
                                                                              ηi 2
                                                     b=η
                                                     η
                     = σij pi (1 − pi )pj (1 − pj )

    Thus, given the existence of the partial derivatives around η,    b multivariate ver-
sion of the delta method (Lehmann 1999, p. 315) ensures that pb = [b       p1 pb2 · · · pbk ]T
                                               xT  β         xT  β
is asymptotically normal with E[pbi ] = pi = e  i    /(1 + e   i   ) and variance covari-
ance matrix Ψ = [ψij ] with ψij = [σij pi (1 − pi )pj (1 − pj )], i, j = 1, . . . , k.

    Suppose then that the researcher wants to add r levels (1 < r < ti ) of i-th
factor Ai and, therefore, a = t1 × · · · × ti−1 × ti+1 × · · · × ts sets are produced,
whose elements are each r of the indexes 1, . . . , k without repetition, affected by
the aggregation. Let the sets (called “aggregation sets”), be defined by:

    cν = {ξ1i , ξ2i , . . . , ξri },            ξji ∈ {1, . . . , k}; j = 1, . . . , r;
                                                i = 1, . . . , a; ν = min{ξ1i , ξ2i , . . . , ξri } for each i;
                                                cν ∩ cν ′ = φ, ∀ ν, ν ′

for each of which, in turn is defined:
                                                                                 P
                                              X                                      c ν ni p
                                                                                            bi
                                   n∗ν =             ni ,               pb∗ν =           ∗
                                                                                                                     (6)
                                                cν
                                                                                      nν


                                                         Revista Colombiana de Estadística 35 (2012) 139–166

146                               Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía

    Since pb∗ν is the weighted sum of asymptotically normal RV’s, pb∗ν is an asymp-
totically normal RV for all ν and covaries  P with the other probability estimators.
It is easy to verify that E[bp∗ν ] = p∗ν = ( cν ni pi )/n∗ν , however, the variance and
covariance associated with pb∗ν are more complex, as is proved in the following
theorem:
Theorem
 P            2. Given pb =P p1 pb2 · · · pbk ]T distributed as in Theorem 1, if pb∗ν =
                            [b
               ∗       ∗
( cν ni pbi )/nν with nν = cν ni , then:
                                                                                        
                                1    X                       X         X                
                 V[b p∗ν ] = ∗ 2            n2i ψii + 2                        ni nj ψij
                              (nν )  c                                                  
                                         ν              i∈cν −max{cν } j∈cν >i
                              P                               a
                                     ni ψij                  [
           Cov[bp∗ν , pbj ] = i∈cν ∗        , for all j ∈ /     ci
                                   nν                       i=1
                              P      P
                ∗ ∗             i∈cν    j∈cν ′ ni nj ψij
               pν , pbν ′ ] =
           Cov[b
                                      n∗ν n∗ν ′

for any two aggregation sets cν , cν ′ .

Proof .
                     P               2
                          c ν ni p
                                 bi
          p∗ν )2 =
         (b                   ∗
                           nν
                                                                                    
                     1 X 2 2                         X         X                    
                  = ∗ 2           ni pbi + 2                           ni nj pbi pbj
                   (nν )  c                                                         
                               ν                i∈cν −max{cν } j∈cν >i
                    P                2
                        cν ni E[bpi ]
         p∗ν ])2 =
      (E[b
                           n∗
                          ν                                                                        
                     1     X                               X          X                            
                  = ∗ 2           n2i (E[bpi ])2 + 2                           ni nj E[b        pj ]
                                                                                          pi ]E[b
                   (nν )  c                                                                        
                               ν                      i∈cν −max{cν } j∈cν >i
                                                                                             
                     1 X 2                             X           X                         
         p∗ν )2 ] = ∗ 2
      E[(b                        ni E[b p2i ] + 2                         ni nj E[b  pi pbj ] ⇒
                   (nν )  c                                                                  
                                 ν                    i∈cν −max{cν } j∈cν >i

                      p∗ν )2 ] − (E[b
           p∗ν ] = E[(b
         V[b                        p∗ν ])2
                            (
                    1           X
                 = ∗ 2                       p2i ] − E[b
                                      n2i (E[b         pi ]2 )
                  (nν )         cν
                                                                                 
                           X               X                                     
                 +2                                      pi pbj ] − E[b
                                                ni nj (E[b                  pj ])
                                                                      pi ]E[b
                                                                                 
                      i∈cν −max{cν } j∈cν >i




                                                Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                               147


                                                                                    
                 1         X                                    X          X        
              = ∗ 2        n2i V[b
                                 pi ] + 2                                  pi , pbj ]
                                                                 ni nj Cov[b
               (nν )  c                                                             
                         ν                i∈cν −max{cν } j∈cν >i
                                                                       
                 1 X 2                      X          X               
              = ∗ 2        ni ψii + 2                         ni nj ψij
               (nν )  c                                                
                                  ν                  i∈cν −max{cν } j∈cν >i


                       / cν :
    Furthermore, for j ∈

                                             p∗ν pbj ] − E[b
                             p∗ν , pbj ] = E[b
                         Cov[b                               p∗ν ]E[b  pj ]
                                           P                           P
                                                  ni E[bpi pbj ]            ni E[b      pj ]
                                                                                  pi ]E[b
                                         = cν ∗                   − cν           ∗
                                                   nν                          n
                                           P                                P ν
                                                  n i Cov[b p i , p
                                                                  b j ]         ni ψij
                                         = cν           ∗
                                                                        = cν ∗
                                                       nν                      nν

    Finally:
                                              P                  !                                 
                         P               
                              c ν ni p
                                     bi            c ν ′ ni p
                                                            bi          1 X X                      
         pb∗ν pb∗ν ′ =            ∗                     ∗            = ∗ ∗             ni nj pbi pbj ⇒
                               nν                   nν ′              nν nν ′ i∈c j∈c              
                                                                                  ν   ν′

                       p∗ν pb∗ν ′ ] − E[b
    p∗ν , pb∗ν ′ ] = E[b
Cov[b                                          p∗ν ′ ]
                                        p∗ν ]E[b
                                                   
                     1 X X                         
                  = ∗ ∗                     pi pbj ]
                                    ni nj E[b
                   nν nν ′ i∈c j∈c                 
                                          ν   ν′
                                                                                                
                                                           1 X X                                
                                                    − ∗ ∗                              pi ]E[b
                                                                               ni nj E[b     pj ]
                                                         nν nν ′ i∈c j∈c                        
                                                                     ν      ν′
                                                       P          P
                     1 X X                             
                                                               i∈cν   j∈cν ′ ni nj ψij
                  = ∗ ∗                       pi , pbj ]
                                    ni nj Cov[b
                   nν nν ′ i∈c j∈c                                 n∗ν n∗ν ′
                                          ν   ν′




    Note that the cardinality of the index range of the model (originally k) has
been reduced given the aggregation levels and is now k ∗ = k − a(r − 1). Each
group of r originals RV’s, for each of the a different combinations of the levels
of the other factors (A1 , . . . , Ai−1 , Ai+1 , . . . , Ak ), gives way to a single random
variable constructed from the sum, renamed in its index at the lower value of
the aggregation set that corresponds. So, having both likelihood estimators not
affected by aggregation, as those who effectively are, we can settle the new vector:

                                      pb∗k∗ ×1 ∼ AN(p∗k∗ ×1 ; Ψ∗k∗ ×k∗ )                                 (7)

                                                       Revista Colombiana de Estadística 35 (2012) 139–166

148                           Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía

where:
                                                  ∗                     ∗             ∗ 
                         ∗         ∗           ψ11                 ψ12     · · · ψ1k
                         pb1         p1          ψ21
                                                    ∗                    ∗             ∗ 
                         ..  ∗  ..                                ψ22     · · · ψ2k 
             pb∗   =     .  , p =  .  , Ψ∗ =  ..                   ..     ..     .. 
                                                  .                     .         .   . 
                         pb∗k        p∗k            ∗                    ∗             ∗
                                                  ψk1                  ψk2     · · · ψkk

except that the range of the index 1, . . . , k in Ψ∗ , although ordered, is not corre-
lated with N, that is, some of their values are no longer present.
                                   ∗
    Also, pb∗i ≡ pbi , p∗i ≡ pi , ψij                                            ∗
                                                         / ∪cν and pb∗i , p∗i , ψij
                                      ≡ ψij for all i, j ∈                          are as in the
definition and Theorem 2 for the remaining i, j.

Example 1. Let T be a contingency table with two factors A1 and A2 , the first
with 2 levels (1, 2) and the second with three (1, 2, 3). Reindexing the original
subscripts properly, we have:

            1 ≡ (1, 1); 2 ≡ (1, 2); 3 ≡ (1, 3); 4 ≡ (2, 1); 5 ≡ (2, 2); 6 ≡ (2, 3)

with the original logit model estimates pb = [b
                                              p1            pb2    pb3       pb4   pb5   pb6 ]T .
   Now suppose we add levels 2 and 3 of factor A2 . Aggregation sets that arise are
                                                                p∗1 pb∗2 pb∗4 pb∗5 ]T ,
c2 = {2, 3} and c5 = {5, 6}, and the new model estimates pb∗ = [b
where:

                                     pb∗1 = pb1
                                             n2 pb2 + n3 pb3
                                     pb∗2 =
                                              (n2 + n3 )
                                        ∗
                                     pb4 = pb4
                                             n5 pb5 + n6 pb6
                                     pb∗5 =
                                              (n5 + n6 )

    In addition, the variance covariance matrix of pb is
                                                                            
                            ψ11 ψ12 ψ13 ψ14 ψ15                          ψ16
                           ψ                                            ψ26 
                            21 ψ22 ψ23 ψ24 ψ25                              
                                                                            
                           ψ31 ψ32 ψ33 ψ34 ψ35                          ψ36 
                      Ψ=                                                    
                           ψ41 ψ42 ψ43 ψ44 ψ45                          ψ46 
                                                                            
                           ψ51 ψ52 ψ53 ψ54 ψ55                          ψ56 
                            ψ61 ψ62 ψ63 ψ64 ψ65                          ψ66

while the variance covariance matrix of pb∗ (symmetric) is
                                    ∗         ∗       ∗        ∗ 
                                    ψ11       ψ12     ψ14      ψ15
                                     ∗
                                    ψ21        ∗
                                              ψ22      ∗
                                                      ψ24       ∗ 
                                                               ψ25
                              Ψ∗ = 
                                   ψ ∗
                                                                   
                                     41
                                               ∗
                                              ψ42      ∗
                                                      ψ44      ψ∗ 
                                                                  45
                                      ∗        ∗       ∗        ∗
                                    ψ51       ψ52     ψ54      ψ55

                                          Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                            149

where, following the Theorem 2:
         ∗
        ψ11 = ψ11
         ∗
        ψ12 = (n2 ψ12 + n3 ψ13 )/(n2 + n3 )
         ∗
        ψ14 = ψ14
         ∗
        ψ15 = (n5 ψ15 + n6 ψ16 )/(n5 + n6 )
         ∗
        ψ22 = (n22 ψ22 + n23 ψ33 + 2n2 n3 ψ23 )/(n2 + n3 )2
         ∗
        ψ24 = (n2 ψ24 + n3 ψ34 )/(n2 + n3 )
         ∗
        ψ25 = (n2 n5 ψ25 + n2 n6 ψ26 + n3 n5 ψ35 + n3 n6 ψ36 )/[(n2 + n3 )(n5 + n6 )]
         ∗
        ψ44 = ψ44
         ∗
        ψ45 = (n5 ψ45 + n6 ψ46 )/(n5 + n6 )
         ∗
        ψ55 = (n25 ψ55 + n26 ψ66 + 2n5 n6 ψ56 )/(n5 + n6 )2

   Now, returning to the theoretical development, the following theorem shows
                                   p∗i ), i = 1, . . . , k, prior to the estimation of the
the required distribution of logit(b
parameters associated with the factors.

Theorem 3. If pb∗ is distributed as in (7), then:
                                                                                 T
                                              p∗1 )
                          logit(pb∗ ) = logit(b                              p∗k )
                                                                 · · · logit(b

is asymptotically distributed multivariate normal with E[logit(b p∗i )] = logit(p∗i ) and
                                     ∗      ∗ ∗        ∗ ∗
variance covariance matrix Σ = [σij ] = [ψij [pi (1 − pi )pj (1 − p∗j )]−1 ].
                              ∗



Proof . Lets gi (i = 1, . . . , k), real-valued functions defined as

                                    p∗1 , . . . , pb∗i , . . . , pb∗k ) = logit(b
                                gi (b                                           p∗i )

then,
                                             
                                ∂gi                       0               , i 6= j
                                       =
                                ∂ pb∗j           p∗i (1 − pb∗i )]−1 ,
                                                [b                         i=j
and
                       k
                     k X
                     X
              ∗                 ∗    ∂gi ∂gj                     ∗ ∗
             σij =             ψst                            = ψij [pi (1 − p∗i )p∗j (1 − p∗j )]−1
                                     ∂ pb∗s ∂ pb∗t
                     s=1 t=1                         b∗ =p∗
                                                     p

    And because in this case also there are the partial derivatives around pb∗ , using
again a multivariate version of the delta method, logit(pb∗ ) is asymptotically dis-
tributed multivariate normal with E[logit(b  p∗i )] = logit(p∗i ) and variance covariance
               ∗       ∗ ∗         ∗ ∗
matrix Σ = [σij ] = [ψij [pi (1 − pi )pj (1 − p∗j )]−1 ].
         ∗



     Finally, the following theorem shows the distribution of the new parameters
βb∗ , from the new design matrix X ∗ . Its proof is omitted since it is easily obtained
by appealing to the results included in the Appendix.

                                                     Revista Colombiana de Estadística 35 (2012) 139–166

150                          Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía

Theorem 4. Given the model
                    Y = logit(pb∗ ) = X ∗ β ∗ + ǫ, ǫ ∼ AN(0, Σ∗ )
in which, Y = logit(pb∗ ) is a column vector whose elements are logit(b       p∗i ), i =
1, . . . , k and Σ∗ is the variance covariance matrix, both constant and known, cal-
culated according to the Theorem 3. Let X ∗ be the new design matrix2 , using
the reference parameterization, proposed after the process of aggregation of factor
levels, constrained to include the same factors that included the original design ma-
trix X. And let β ∗ be the new vector of parameters to be estimated by maximum
likelihood (βb∗ ). Then:

   • βb∗ = [(X ∗ )T X ∗ ]−1 (X ∗ )T Y .
   • V[βb∗ ] = [(X ∗ )T X ∗ ]−1 (X ∗ )T Σ∗ X ∗ [(X ∗ )T X ∗ ]−1 .
   • βb∗ is distributed asymptotically normal.

    A modification in this asymptotical distribution has been induced for the orig-
inal and transformed RV’s, by applying aggregation some factor levels and some
required sets of aggregation (cν ). Thus, the suggested procedure is as follows:

  1. Fit a logit model by preserving the calculation of the vector of estimates of
     pi and the variance covariance matrix Σ estimated for β.b

  2. Define the required aggregation sets, in order to calculate point estimates
     for the p∗ν as in the Theorem 2 and the variance covariance matrix Ψ∗ of pb∗ ,
     like in (7).
                   p∗i ) for the resulting range of values i and its variance covari-
  3. Compute logit(b
     ance matrix Σ , following Theorem 3.
                  ∗


  4. Build the new design matrix Xk∗∗ ×m∗ according to the new desired parame-
     ters vector βm
                  ∗
                    ∗ ×1 .


  5. In general, setting a generalized least squares regression (Christensen 2002,
     pp. 33, 86) to estimate βb∗ ∗ with a new model formulated as follows:
                               m ×1

                       Y = logit(pb∗ ) = X ∗ β ∗ + ǫ, ǫ ∼ AN(0, Σ∗ )
      in which the matrix Σ∗ is the result of step 3. However, using the reference
      parameterization, the computation of both, the vector of parameters to be
      estimated and the variance covariance matrix, is greatly simplified by using
      the Theorem 4.

    Finally, it is clear that the deductions have been made for the aggregate of
r levels of a single factor. However, this approach does not diminish generality.
If the researcher wants to group two or more factors, we just weed to iteratively
apply the suggested procedure, one factor at a time. In other words, we simply
applies the suggested procedure, repeatedly.
   2 Note that X ∗ has a smaller number of columns than X (hence β ∗ has fewer elements β),

because it models a smaller number of junctions in the levels of the factors.


                                          Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model           151

4. Illustration of the Suggested Procedure

    Table 1 presents a situation where the interest lies in studying the relationship
between a response variable Y and two explanatory factors A1 and A2 with 2 and
3 levels, respectively. The observed frequencies or number of successes for each
levels combination are shown in Table 1 above.


                  Table 1: Example Y (0, 1) vs. A1 (1, 2), A2 (1, 2, 3).
                       i       A1    A2    No. of successes   Total
                       1       1     1                   53    133
                       2       1     2                   11    133
                       3       1     3                 127     133
                       4       2     1                 165     533
                       5       2     2                   41    533
                       6       2     3                 476     533
                       Total                           873    1998



    In this particular case, the proposed logit model omits interactions between
the factors, and therefore is not saturated. Using the first level of each factor as a
reference, the equations are as follows:

                                                     
                           logit(p1 )    1     0   0   0
                         logit(p ) 1                    
                                 2          0   1   0
                                                         β1
                         logit(p ) 1        0   0    
                                                       1  β2 
                                 3    
                                     =                                         (8)
                         logit(p4 ) 1       1   0      
                                                       0 β3 
                                                     
                         logit(p5 ) 1       1   1   0 β4
                           logit(p6 )    1     1   0   1


    In (8), β1 represents the intercept effect, β2 represents the level 2 of A1 effect,
β3 represents the level 2 of A2 effect and β4 the level 3 of A2 effect. The levels 1
of A1 and 1 of A2 are not explicitly represented in the model (are the references
levels).
    Preliminary tests and goodness of fit for this model are shown in Table 2.
The model fits the data appropriately, as it is deduced from the deviance and
Pearson’s statistics. Also, according to the Pearson’s statistic, the overdispersion
is negligible.
    Table 3 contains the parameter estimates with their corresponding standard
tests for H0 : βi = 0, i = 1, 2, 3 and 95% confidence intervals (CI) for βi . The
predicted probabilities and their CI’s are also shown in Table 4.
    Now suppose that we cluster levels 2 and 3 of the factor A2 in Table 1, pro-
ducing the Table 5 with aggregate data, and postulate the usual procedure: a new
logit model.

                                      Revista Colombiana de Estadística 35 (2012) 139–166

152                             Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía


           Table 2: Original model. Preliminary tests and goodness of fit.
                        Test                                     Value
                        Residual deviance:                       2.5065
                        Residual degrees of freedom (DF):        2
                        Deviance χ2 /DF:                         0.2856
                        Deviance test:                           No reject
                        Pearson’s statistic:                     2.3104
                        Pearson’s χ2 /DF:                        0.315
                        Pearson’s test:                          No reject
                        Deviance/DF:                             1.2533
                        Pearson’s/DF:                            1.1552


            Table 3: Original model. βbi and normal tests (H0 : βi = 0).
                               Estimation of βi                                   95% CI
  i          bi
             β        SE       z-Value p (> |z|) Conclusion                    Ll             Ul
  1   −0.39857   0.14688     −2.71369      0.00666   Reject              −0.68644       −0.11070
  2   −0.40725   0.15536     −2.62130      0.00876   Reject              −0.71176       −0.10275
  3   −1.75603   0.16676    −10.53046      0.00000   Reject              −2.08286       −1.42919
  4     2.99348  0.15665     19.10956      0.00000   Reject               2.68646        3.30051
  SE: Standard Error. Ll: Lower limit. Ul: Upper limit.


           Table 4: Original model. Predicted probabilities and 95% CI’s.
            i        b
                     pi        Ll          Ul      i        bi
                                                            p          Ll          Ul
            1    0.4017    0.3325      0.4708      4    0.3088     0.2713      0.3463
            2    0.1039    0.0702      0.1376      5    0.0716     0.0521      0.0912
            3    0.9305    0.9068      0.9542      6    0.8991     0.8752      0.9231


                  Table 5: Example Y (0, 1) vs. A1 (1, 2), A2 (1, 2∗ ).
                  i       A1      A2   No. of success (y)   Total (t)           y/t
                  1       1        1                   53        133         0.3984
                  2       1       2∗                 138         266         0.5188
                  3       2        1                 165         533         0.3096
                  4       2       2∗                 517        1066         0.4850
                Total                                873        1998



    The new unsaturated model (ignoring interactions), using the reference param-
eterization (with level 1 of both factors by reference), unfolds as follows:
                                                
                            logit(p∗1 )    1 0 0  ∗
                          logit(p∗2 ) 1 0 1 β1∗
                                                 
                          logit(p∗ ) = 1 1 0 β2                            (9)
                                    3                   ∗
                                                      β 3
                            logit(p∗4 )    1 1 1

   Now in (9), β1∗ represents the intercept effect, β2∗ level 2 of A1 effect and β3∗
the level 2∗ of A2 effect. Some measures of goodness of fit for this model are
reproduced in Table 6.
   The model fits the data with negligible overdispersion. Re-adjusting a logit
model over the resulting contingency table, the new estimates are shown in Table

                                          Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                   153

7. Without regard the parameters significance, the probabilities predicted by the
model are reproduced in Table 8.

   Table 6: Usual procedure. Testing goodness of fit of the aggregate data model.
                      Test                                        Value
                      Residual deviance:                          1.0986
                      Residual degrees of freedom (DF):           1
                      Deviance χ2 /DF:                            0.2946
                      Deviance test:                              No reject
                      Pearson’s statistic:                        1.1051
                      Pearson’s χ2 /DF:                           0.2932
                      Pearson’s test:                             No reject
                      Deviance/DF:                                1.0986
                      Pearson’s/DF:                               1.1051



            Table 7: Usual procedure. βbi∗ and normal tests (H0 : βi∗ = 0).
                               βi∗ estimation                                 95% CI
      i        bi
               β        SE     z-Value     p (> |z|)        Conclusion        Ll        Ul
      1   −0.5485   0.1220     −4.4965       0.0000         Reject       −0.7876   −0.3094
      2   −0.2162   0.1137     −1.9014       0.0573         No reject    −0.4390    0.0067
      3    0.6885   0.0992      6.9401       0.0000         Reject        0.4941    0.8830



Table 8: Usual procedure. Predicted probabilities and 95% CI without regard to model
         parameters statistical significance.

                                i        b∗i
                                         p             Ll        Ul
                                1    0.3662        0.3107    0.4217
                                2    0.5349        0.4831    0.5868
                                3    0.3176        0.2811    0.3542
                                4    0.4810        0.4519    0.5100


    The new parameter vector β ∗ is estimated differently in both models (original
and aggregated data). With α = 0.05, Table 7 suggests the absence of sufficient
evidence to reject the null hypothesis about β2∗ . This finding has important impli-
cations for the analysis: Since it is not possible to conclude that β2∗ is significantly
different that 0, the predicted probabilities in Table 8, in strict statistical sense,
should not be considered valid. Statistical valid predictions are as follows:

                                         eβb1
                                               ∗

                                pb∗1 =           = 0.3662
                                      1 + eβb1
                                              ∗



                                        eβb1 +βb3
                                           ∗    ∗
                                  ∗
                                pb2 =               = 0.5349
                                      1 + eβb1 +βb3
                                              ∗   ∗




                                 eβb1 +βb2       eβb1 +0
                                    ∗    ∗          ∗

                      pb∗3 =                 =             = 0.3662                          (10)
                               1 + eβb1 +βb2   1 + eβb1 +0
                                       ∗   ∗           ∗




                                         Revista Colombiana de Estadística 35 (2012) 139–166

154                               Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía



                                  eβb1 +βb2 +βb3       eβb1 +0+βb3
                                     ∗    ∗    ∗          ∗      ∗

                       pb∗4 =                      =                 = 0.5349                   (11)
                                1 + eβb1 +βb2 +βb3   1 + eβb1 +0+βb3
                                        ∗    ∗   ∗           ∗     ∗




    Finally, Table 9 contains the estimates and the 95% CIs for the logit model
postulated in (9), obtained by the procedure suggested in this paper. Note that
the point estimates of the standard procedure and the suggested procedure are
slightly but significantly different. Using the suggested procedure, the Pearson’s
goodness of fit of the model produces a χ2 of 0.0104 that leaves a probability of
0.9188 at right. Then, the model analyzed by the suggested procedure properly
fits the data; in fact it fits in a better way than with the usual procedure, which
produces a Pearson’s statistic 1.1051 that leaves a probability of 0.2932 at right
(see Table 6).


             Table 9: Suggested procedure. βbi∗ and normal tests (H0 : βi∗ = 0).
                                    βi∗ estimation                              95% CIs
        i         bi
                  β         SE      z-Value       p (> |z|)    Conclusion        Ll        Ul
        1    −0.4685    0.1257      −3.7280         0.0002     Reject       −0.7149   −0.2222
        2    −0.2673    0.1019      −2.6236         0.0087     Reject       −0.4670   −0.0676
        3     0.6074    0.0931       6.5234         0.0000     Reject        0.4249    0.7899


   Table 9 shows that the estimated standard errors for the parameters β2∗ and
β3∗ ,
    using the suggested procedure are lower than those found by conventional
procedure (Table 7).
    Table 10 presents the predicted probabilities, now fitting the data according to
the procedure suggested in this paper. Note that the predicted probabilities are
considerably closer to those expected for the new data set (see the column and y/t
in the Table 5), than those predicted with the usual procedure.

            Table 10: Suggested procedure. Predicted probabilities and 95% CIs.
                                     i     b∗i
                                           p            Ll        Ul
                                     1   0.4017       0.3325    0.4708
                                     2   0.5172       0.4927    0.5417
                                     3   0.3088       0.2713    0.3463
                                     4   0.4854       0.4696    0.5012


   Also, note in Table 9 that the conclusion about the significance of β2∗ is no
lunger the same. The standard procedure statistically valid estimates (10) and
(11) and look considerably different from using the suggested procedure. The
predictions on Table 10 are statistically valid, approaching in a better way than
would be expected from the available data.
   Finally, Figure 1 presents the Pearson’s standardized residuals, calculated us-
ing both methods. Clearly, the estimates produced by the suggested procedure
are much closer to the expected value than those produced by the conventional
procedure.

                                                 Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                        155




                              0.8
                                                              Usual




                              0.6
                                                              Suggested




                              0.4
                  Residuals

                              0.2
                              0.0
                              −0.2
                              −0.4




                                     1              2                     3           4

                                                          Index (i)
      Figure 1: Pearson’s standardized residuals calculated by both procedures.



5. Comparison of Alternative Procedures Through
   Simulation
   In a situation with a binary response Y and two explanatory factors A1 , A2 ,
the first with 2 levels and the second with 3 leves, we propose a simulation in
order to study the effect of the aggregation of levels 2 and 3 for the factor A2 ,
using pseudo-random generation of a large number of contingency tables of the
type shown in Table 11.

      Table 11: Original arrangement for simulation Y vs. A1 (1, 2), A2 (1, 2, 3).
                       i                 A1   A2   No. of successes (yi )     Total (ni )
                       1                 1    1                       y1             n1
                       2                 1    2                       y2             n2
                       3                 1    3                       y3             n3
                       4                 2    1                       y4             n4
                       5                 2    2                       y5             n5
                       6                 2    3                       y6             n6
                     Total                                            y·              n·


    An unsaturated logit model is fitted to of the generated tables signoring the
effect of interactions, using the first level of each factor as a reference, by
                                                     
                           logit(p1 )      1 0 0 0
                          logit(p ) 1 0 1 0 β 
                                 2                    1
                                                     
                          logit(p3 ) 1 0 0 1           β2 
                                    =                                     (12)
                          logit(p4 ) 1 1 0 0 β3      
                                                     
                          logit(p5 ) 1 1 1 0 β4
                           logit(p6 )      1 1 0 1

    In (12), pi represents the probability of success of the i-th combination of levels
of the two explanatory factors identified in Table 11 (i = 1, . . . , 6), while βj are

                                                   Revista Colombiana de Estadística 35 (2012) 139–166

156                         Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía

the parameters to be fitted (j = 1, . . . , 4). Specifically, β1 represents the effect of
the intercept, β2 is the effect of level 2 of factor A1 , β3 is the effect of level 2 of
the factor A2 and β4 is the effect of the level 3 of the factor A2 .
   The Table 12 is formed by grouping the last two levels of the second factor in
the Table 11.

         Table 12: Aggregated data for simulation Y vs. A1 (1, 2), A2 (1, 2∗ ).
                     i     A1   A2    No. of successes (yi )   Total (ni )
                     1     1     1                       y1           n1
                     2     1    2∗                 y2 + y3       n2 + n3
                     3     2     1                       y4           n4
                     4     2    2∗                 y5 + y6       n5 + n6
                   Total                                 y·            n·


    Following the usual procedure, we set a new unsaturated logit model for the
Table 12, than also ignores the effect of interactions and uses the first level of each
factor as a reference:
                                                     
                             logit(p∗1 )    1 0       0  ∗
                           logit(p∗2 ) 1 0              β1
                                                   1 β ∗ 
                           logit(p∗ ) = 1 1        0 2∗
                                                                                    (13)
                                     3
                                                           β3
                             logit(p∗4 )    1 1       1

    Now, in (13) p∗i represents the probability of success of the i-th combination of
levels of the two explanatory factors identified in the Table 12 (i = 1, . . . , 4), with
β1∗ representing the effect of the intercept, β2∗ the effect of level 2 of the factor A1
and β3∗ the effect of level 2∗ of the factor A2 .
    Lastly, following the suggested procedure, from the original model results (12)
we estimate the parameters of the new model with aggregate levels of the factor.
The comparison between the two procedures (usual and suggested) is then used
to analyze the resulting performance statistics in each case.


5.1. Design of the Experiment of Simulation
    That total in the experiment set n· = 2000 is distributed in two randomized
numbers to each level of A1 and, within these, in three randomized numbers for
each level of A2 . In this particular study, it is not of interest to compare the effect
of both procedures on the levels of factor A1 , or on the first level of factor A2 , p1
y p4 . Then, independent pseudo-randomly uniform (0, 1) samples are generated.
Using the generated values of n1 , n4 (selected randomly from n· ) and p1 and p4 ,
the samples Y1 ∼ Bin(n1 , p1 ) and Y4 ∼ Bin(n4 , p4 ) are generated.
    For the factor levels being compared in A2 , the samples Y2 ∼ Bin(n2 , p2 ),
Y3 ∼ Bin(n3 , p3 ), Y5 ∼ Bin(n5 , p5 ) and Y6 ∼ Bin(n6 , p6 ), are generated nj
randomized as before and sequentially using combinations of ∆p = |p2 − p3 | =
|p5 − p6 | = 0.0, 0.2, 0.4, 0.6, 0.8. Such combinations are obtained by maintaining

                                      Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model          157

the values p2 = p5 = 0.1 as constant and varying by the values of p3 = p6 =
0.1, 0.3, 0.5, 0.7, 0.9.
   For each combinations of ∆p to experiment several, contingency tables are pro-
duced, regrading to by the binomials generated, which are independent within each
table and between tables. We only incorporate samples that meet the following
conditions:

 1. Lead to acceptance of the original logit model, as assessed by the Pearson’s
    goodness of fit.

 2. Lead to an original logit model the does not present important problems on
    subdispertion. That is, that produces a statistical ratio of the Pearson’s and
    residual degrees of freedom in the range (0.75; 1.25).

 3. Lead to acceptance of the logit model with levels 2 and 3 of the factor added
    A2 , also following the Pearson’s test of goodness of fit.

 4. Lead to a logit model with aggregate levels of the factor, which does not
    have important problems of subdispertion. This in order to produce a sta-
    tistical ratio of the Pearson’s and residual degrees of freedom in the range
    (0.75; 1.25).

    Finally, there are 10,000 valid samples, 2,000 for each combination of ∆p , and
significance level is set up with for testing α = 0.05. The performance measures
considere were:

 a) Firstly, we examine descriptive statistics of the differences the Pearson’s χ2
    goodness of fit test, obtained using standard procedures and suggested (in
    that order).

 b) We compare the absolute differences in point estimates of β1∗ , β2∗ y β3∗ , ob-
    tained by the standard and suggested procedures, regardless to their statis-
    tical significance.

  c) Compare the differences in the lengths of the calculated CIs using the usual
     and suggested procedure. It uses the average ratio between the lengths of
     the first and the second (in that order). These ratios are calculated for the
     CIs accompanying the parameter estimates β1∗ , β2∗ and β3∗ .

 d) We study the absolute frequency of occurrence of the change in the conclusion
    of the analysis of variance (acceptance to rejection, or vice versa) for testing
    hypotheses about the parameters H0 : β1∗ = 0, H0 : β2∗ = 0 y H0 : β3∗ = 0,
    when they are contrasted by the usual way, and when they are contrasted
    by the suggested procedure.

  e) Finally, for each sample Pearson’s standardized residuals produced by both
     methods were calculated. Also, analysis of each value of ∆p , we construct
     boxplots their corresponding.


                                     Revista Colombiana de Estadística 35 (2012) 139–166

158                        Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía

5.2. Results of the Simulation Experiment
 a) Firstly, Table 13 shows means and standard deviations (SD) of the simple
    differences between the probabilities that leaves to the right Pearson’s χ2
    test, in the examination of the goodness of fit of the model, obtained by the
    usual and suggested procedure.

Table 13: Mean and standard deviations of the differences to the Pearson’s χ2 proba-
          bilities (Usual - Suggested).
                               ∆p      Mean         SE
                               0.0   −0.0002     0.0006
                               0.2   −0.0104     0.0214
                               0.4   −0.0219     0.0615
                               0.6   −0.0314     0.1148
                               0.8   −0.1173     0.1884


      Since the average values in Table 13 are all negative, it is clear that the
      suggested procedure fits the data consistently better than the usual, with
      the increase in the differences ∆p .
      As evidence of goodness of fit of the model, the Pearson’s statistic is partic-
      ularly suitable in this case, since it is based on the accumulation of the stan-
      dardized residuals. Although the variability is high, Table 13 that steadily
      as there are greater differences between the probabilities of the variables
      involved in the aggregation, the probability to the right of Pearson’s χ2
      goodness of fit test increases in the suggested procedure compared with the
      usual.
      In practice this means that, on average, the estimated parameters using the
      suggested procedure are closer to the expected for a given dataset in compar-
      ison to the estimates produced by the usual procedure. It also means that
      the model fitted using the suggested procedure is less likely to be rejected
      than the other model.
 b) Without considering the significance of the estimated parameters, the Table
    14 contains the ranges obtained by both methods (standard and suggested)
    for each estimate. It can be seen that these ranges are very similar in gen-
    eral and, as should be verified, the same when ∆p = 0, and slightly more
    dissimilar as ∆p increase.
      Table 15 contains the averages and standard deviations of the absolute dif-
      ferences between the parameters. As seen there, both the average and the
      standard deviation of the differences between the parameters estimated by
      the usual procedure (u) and suggested (s), |βi∗ (u) − βi∗ (s)|, i = 1, 2, 3 behave
      similarly. This is, they grow as the probabilities of the variables involved in
      the aggregation are more dissimilar.
      Nevertheless, given the ranges shown in Table 14, these differences do not
      seem important on average. The conclusion here is that both procedures

                                      Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                            159

      (usual and suggested) essentially estimate the same values of model param-
      eters, in most situations.

      Table 14: Ranges of βbi∗ according to the usual and suggested procedures.
                     b1∗
                     β                              b2∗
                                                    β                                 b3∗
                                                                                      β
              Usual      Suggested           Usual      Suggested              Usual      Suggested
     ∆p     Min Max Min Max                Min Max Min Max                   Min Max Min Max
     0.0   -2.43 2.51 -2.43 2.51          -1.31 1.20 -1.31 1.20             -4.69 0.43 -4.69 0.43
     0.2   -2.57 2.50 -2.58 2.50          -0.70 0.92 -0.71 0.92             -4.04 1.22 -4.04 1.22
     0.4   -2.38 2.65 -2.38 2.65          -0.53 0.54 -0.54 0.55             -3.51 1.63 -3.50 1.63
     0.6   -2.51 2.70 -2.51 2.69          -0.57 0.45 -0.66 0.50             -3.13 2.09 -3.13 2.09
     0.8   -2.44 2.52 -2.47 2.59          -0.38 0.32 -0.50 0.39             -2.54 2.52 -2.54 2.45



Table 15: Average of absolute differences and deviations between the parameters esti-
          mated by both methods.
                          b1∗ (u) − βb1∗ (s)|
                         |β                       b2∗ (u) − βb2∗ (s)|
                                                 |β                      b3∗ (u) − βb3∗ (s)|
                                                                        |β
                   ∆p    Mean             SD     Mean             SD    Mean             SD
                   0.0   0.000        0.000      0.000        0.000     0.000        0.000
                   0.2   0.002        0.002      0.001        0.001     0.002        0.003
                   0.4   0.004        0.005      0.004        0.004     0.006        0.007
                   0.6   0.008        0.010      0.009        0.008     0.011        0.013
                   0.8   0.012        0.018      0.014        0.014     0.016        0.022


  c) Regarding to the lengths of the CIs for each estimator, Table 16 presents
     the results of the average rates and standard deviations obtained. In general
     terms, the CI length for the intercept effect shows no appreciable variations
     in both procedures. However, for the other parameters, the higher ∆p is the
     higher the average ratio of the CIs lengths estimated by both methods. Then,
     it consistently appears that the confidence intervals related to the suggested
     procedure are narrower and therefore preferable than those estimated by the
     usual procedure.

Table 16: Averages of the ratio between the lengths of confidence intervals (LCI) ob-
          tained by the usual method (u) and the suggested method (s).
                   β1∗ : LCI(u)/LCI(s)          β2∗ : LCI(u)/LCI(s)       β3∗ : LCI(u)/LCI(s)
             ∆p    Mean            SD           Mean            SD        Mean            SD
             0.0     1.00         0.00            1.00         0.00         1.00         0.00
             0.2     1.00         0.00            1.01         0.00         1.01         0.00
             0.4     1.01         0.01            1.03         0.01         1.03         0.01
             0.6     1.01         0.02            1.06         0.01         1.05         0.02
             0.8     1.00         0.04            1.09         0.03         1.06         0.05


      Another aspect to note is that while in average terms the conclusion is clear,
      the differences for the unsaturated case are not as significant as they were
      in the saturated case developed by Ponsot et al. (2009). The introduction of
      the covariance and the fact that it examines a larger number of factors have
      somewhat dampened these differences.

                                                Revista Colombiana de Estadística 35 (2012) 139–166

160                           Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía

 d) Table 17 shows the absolute frequencies of occurrence of the change in the
    conclusions on the significance of model parameters (H0 : βi∗ = 0 for i =
    1, 2, 3), when they are examined with the usual procedure and when they
    are examined with the suggested procedure.
      β1∗ changes occur in similar frequency and any direction. This indicates
      that is not possible to suggest preferences between the two procedures for
      intercept estimation. On the other hand, for the remaining two parame-
      ters, the conclusion about the statistical significance of not rejecting the null
      hypothesis and its rejection, greatly promotes the suggested procedure. Im-
      provements in the results on β2∗ are remarkable. There was no change from
      rejection to acceptance of the null hypothesis, however, there were consider-
      able changes to the contrary, i.e., acceptance to rejection of this hypothesis.
      The suggested procedure allows us to reject the null hypothesis of model
      parameters, in a higher proportion of cases, generally increasing with ∆p .

Table 17: Change of the conclusions for H0 : βi∗ = 0 from the suggested procedure,
          compared to usual.
                              Rejection                        Acceptance
                    ∆p    to acceptance    without changes     to rejection
                                       For H0 : β1∗ = 0
                    0.0               0                 2000             0
                    0.2               1                 1998             1
                    0.4               1                 1997             2
                    0.6               3                 1989             8
                    0.8               9                 1983             8
                                       For H0 : β2∗ = 0
                    0.0               0                 2000             0
                    0.2               0                 1982            18
                    0.4               0                 1946            54
                    0.6               0                 1951            49
                    0.8               0                 1901            99
                                       For H0 : β3∗ = 0
                    0.0               0                 2000             0
                    0.2               0                 2000             0
                    0.4               1                 1992             7
                    0.6               1                 1990             9
                    0.8               2                 1973            25

  e) Finally, the Figures from 2 to 6 contain Pearson’s standardized residuals
     boxplots, grouped according to the procedure that gave rise to (usual and
     suggested), for each yi , i = 1, . . . , 4. Observe that for ∆p from 0.0 to 0.4,
     boxplots not vary appreciably, indicating that the residuals produced by
     both procedures are very similar. However, when ∆p is greater, although
     the variability of residuals becomes less stable, their averages are closer to
     0 in those settings using the suggested procedure. This confirms that in
     trend terms, the suggested procedure produces better fits than the usual
     procedure3 .
   3 All programs, both for example, as for the simulation, were made with R statistical system

(R Development Core Team 2007).


                                         Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                                       161




                               0.5
                   Residuals

                               0.0
                               −0.5

                                      U−y(1)   S−y(1)   U−y(2)   S−y(2)    U−y(3)   S−y(3)    U−y(4)    S−y(4)

                                           Usual procedure (U) and suggested (S) for each y(i), i=1,2,3,4
          Figure 2: Pearson’s standardized residuals boxplots for∆p = 0.0.
                               0.5
                   Residuals

                               0.0
                               −0.5
                               −1.0




                                      U−y(1)   S−y(1)   U−y(2)   S−y(2)    U−y(3)   S−y(3)    U−y(4)    S−y(4)

                                           Usual procedure (U) and suggested (S) for each y(i), i=1,2,3,4

          Figure 3: Pearson’s standardized residuals boxplots for ∆p = 0.2.
                               1.0
                               0.5
                   Residuals

                               0.0
                               −0.5
                               −1.0




                                      U−y(1)   S−y(1)   U−y(2)   S−y(2)    U−y(3)   S−y(3)    U−y(4)    S−y(4)

                                           Usual procedure (U) and suggested (S) for each y(i), i=1,2,3,4

          Figure 4: Pearson’s standardized residuals boxplots for ∆p = 0.4.




                                                         Revista Colombiana de Estadística 35 (2012) 139–166

162                                   Ernesto Ponsot-Balaguer, Surendra Sinha   Arnaldo Goitía




                               1.0
                               0.5
                   Residuals

                               0.0
                               −0.5
                               −1.0


                                      U−y(1)   S−y(1)   U−y(2)   S−y(2)    U−y(3)   S−y(3)    U−y(4)    S−y(4)

                                           Usual procedure (U) and suggested (S) for each y(i), i=1,2,3,4
          Figure 5: Pearson’s standardized residuals boxplots for ∆p = 0.6.
                               2
                               1
                   Residuals

                               0
                               −1
                               −2




                                      U−y(1)   S−y(1)   U−y(2)   S−y(2)    U−y(3)   S−y(3)    U−y(4)    S−y(4)

                                           Usual procedure (U) and suggested (S) for each y(i), i=1,2,3,4

          Figure 6: Pearson’s standardized residuals boxplots for ∆p = 0.8.




6. Conclusions
    This paper addresses and resolves a problem rarely studied, which arises from
the practical application of the binomial logit model. We discuss the situation in
which, once fitted a logit model to the data in a contingency table, a factor from
any of the participants is selected and some levels are added as a new level, to
reiterate a logit setting.
    In general, there is a problem in the logit model fit with aggregate levels of the
factor, particularly when the probabilities of success of RV’s involved in aggrega-
tion are far from each other. Consequently, this paper suggests a procedure that
operates in a broader context, i.e., under the binomial unsaturated multifactorial
logit model, and with arguments of asymptotic nature, taking advantage of the
reduction in variance when postulates proper distributional model instead of the
binomial model, significantly improves the estimates, while lowering the standard
error.

                                                         Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model           163

    As the difference in the probabilities of success accentuates, it becomes better
supported by the suggested procedure, instead of the usual. The model fitted by
the suggested procedure, also produces closer to zero residuals and less chance of
rejection in the goodness of fit test.
   In summary, it is proposed to the researcher logit model user, an alternative
procedure that can provide theoretical correctness, greater accuracy and less com-
putational effort in the state of aggregation levels of a factor, especially when they
involve sample proportions which are markedly dissimilar.


Acknowledgements
    The authors thank the Council of Scientific, Humanistic, Technology and the
Arts (CDCHTA) of the Los Andes University, the financial support to carry out
this work, registered with the code E-303-09-09-ED.
                                                                       
                  Recibido: junio de 2011 — Aceptado: febrero de 2012

Appendix. Study of the Design Matrix X for
Saturated and Unsaturated Models
Theorem 5. Using the reference parameterization, the design matrix of the saturated
logit model is invertible.

Proof . We prove the invertibility of the matrices of design, both in the univariate situ-
ation, as in the multifactorial situation, then:

  1.   Let the saturated univariate logit model design matrix be:
                                                                           
                                                1    1    0    ···    0    0
                                               1    0    1    ···    0    0
                                               .    ..   ..          ..   .. 
                                               .              ..             
                                 Xk×k     =    .     .    .      .    .    .
                                                                             
                                               1    0    0     0     1    0
                                               1    0    0     0     0    1
                                                1    0    0     0     0    0

       The calculation of the determinant of X by cofactors decomposition (Xij ) is |X| =
       (−1)k+1 |I| = (−1)k+1 6= 0, pivoting the last row of the matrix, since the only one
       nonzero element is xk1 . Then, since |X| 6= 0, X −1 exists.

  2.   Suppose A1 , A2 , . . . , As factors, each one t1 , t2 , . . . , ts levels, respectively. Using
       the reference parameterization, the followings are postulated:

        a) 1 parameter for the effect of the intercept.
        b) t1 − 1 parameters for the main effects of A1 factor levels, except the reference;
           t2 − 1 parameters for the main effects of A2 factor levels, except the reference;
           and so on until ts −1 parameters
                                    Ps      for the main effects of As factor levels, except
           the reference; in total,     (t − 1) parameters for the main effects.
                                     i=1 i



                                            Revista Colombiana de Estadística 35 (2012) 139–166

Aggregation of Factor Levels in the Multifactorial Unsaturated Logit Model                      165

       c) (t1 − 1)(t2 − 1) parameters for the double interaction effects between levels of
          the factors A1 and A2 ; (t1 − 1)(t3 − 1) parameters for the double interaction
          effects between levels of the factors A1 and A3 ; so on until (ts−1 − 1)(ts − 1)
                                 Ps−1 interaction
          parameters for the double     Ps          effects between levels of the factors
          As−1 and As ; in total i=1            (t − 1)(tj − 1).
                                           j=i+1 i

       d) (t1 − 1)(t2 − 1)(t3 − 1) parameters for the triple effects of interaction be-
          tween levels of the factors A1 , A2 and A3 ; (t1 − 1)(t2 − 1)(t4 − 1) parameters
          for the triple effects of interaction between levels of the factors A1 , A2 and
          A4 ; so on until (ts−2 − 1)(ts−1 − 1)(ts − 1) parameters for the triple ef-
                          Ps between levels of the factors As−2 , As−1 and As ; in total
          fects ofPinteraction
          P  s−2    s−1
             i=1    j=i+1
                                   (t − 1)(tj − 1)(tk − 1).
                             k=j+1 i

      In general, for order a interactions (1 ≤ a ≤ s) the followings parameters are
      postulated
                                X
                               s−a+1 s−a+2
                                           X                 X
                                                             s
                                                                      Y
                                                                      a

                                                    ···                     (tij − 1)
                                i1 =1 i2 =i1 +1           ia =ia−1 +1 j=1

      As the model is saturated, the k total number of postulated parameters equals the
      number of observations in the contingency table (k = t1 × t2 × · · · × ts ). Now,
      including the interaction of order a (1 ≤ a ≤ s) in its i1 , i2 , . . . , ia levels, requires
      a row of X like:
                                                                                           
                  1   x1 · · · xs     x12 · · · x(s−1)s        ···     xi1 i2 ···ia   0 ··· 0

      where
                                           
                                               1,   i ∈ {i1 , i2 , . . . , ia }
                                    xi =
                                               0,   otherwise
                                           
                                               1,   i y j ∈ {i1 , i2 , . . . , ia }
                                xij =
                                               0,   otherwise

      and so on until xi1 i2 ···ia = 1. In other words, the equation that introduces a new
      parameter representing the interaction of any kind involves only the parameter
      representing this interaction, and those representing the lower-order interactions
      contained in it.
      Appropriately arranging the rows of X thus constructed, it is easy to verify that
      a triangular matrix is formed, whose diagonal consists of ones only. Then, using
      Theorems 1.5.3 and 8.6.5 of Graybill (1969, pp. 8, 191), |X| ≡ ±1 6= 0, and
      therefore X −1 exist.



Corollary 1. With reference to parameterization, the design matrix X of the logit model
is such that there is (X T X)−1 .

Proof . Clearly in the saturated model situation, as there is X −1 , (X T )−1 exist and
then (X T X)−1 also exist.
    In the unsaturated model situation, the design matrix X is no longer square and
has no inverse. However, the unsaturated model starts from the saturate model ignoring
parameters in reverse order of the interactions (high order to low order) as desired by
the researcher, always following the construction rules described in item 2 of Theorem
5. Therefore, the construction of an unsaturated model is produced by simply removing
columns in the design matrix of the corresponding saturated model. However, as the
columns of the saturated model design matrix are linearly independent, any subset of
the columns in it (in this case X) is also such that its columns are linearly independent,
whereby the unsaturated model matrix is columns full range and following the corollary
B.53 of Christensen (2002, p. 415), (X T X)−1 exist.

References
Christensen R. Plain Answers to Complex Questions, The Theory of Linear Models.(2002).Springer-Verlag.
Graybill F. Introduction to Matrices with Applications in Statistics.(1969). Wadsworth Publishing.
Hilbe J M. Logistic Regression Models.(2009). Chapman Hall.
Hosmer D W, Lemeshow S. Applied Logistic Regression.(2000). John Wiley and Sons.
Lehmann E L. Elements of Large-Sample Theory.(1999). Springer-Verlag.
McCullagh P, Nelder J. Generalized Linear Models.(1989). Chapman Hall.
Menard S. Logistic Regression: From Introductory to Advanced Concepts and Applications.(2010).SAGE Publications.
Nelder J A, Wedderburn R W M. Generalized Linear Models.(1972). Journal of the Royal Statistical Society.
Ponsot E. Estudio de la Agrupación de Niveles en el Modelo Logit.(2011).Universidad de Los Andes.
Ponsot E, Sinha S, Goitía A. Sobre la agrupación de niveles del factor explicativo en el modelo logit binario.(2009).Revista Colombiana de Estadística.
R Development Core Team. R: A Language and Environment for Statistical Computing.(2007). R Foundation for Statistical Computing.
Rodríguez G. Lectures notes about generalized linear models.(2008).Http://data princeton edu/wws509/notes
SAS Institute Inc.SAS/STAT(R) 9 1 User’s Guide.(2004). SAS Institute Inc.
Searle S, Casella G, McCulloch C. Variance Components.(2006).John Wiley and Sons.