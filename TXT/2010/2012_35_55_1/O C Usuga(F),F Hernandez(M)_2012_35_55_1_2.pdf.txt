Bayesian Analysis for Errors in Variables with Changepoint Models. Análisis bayesiano para modelos con errores en las variables con punto de cambio
Universidad de Antioquia, Medellín, Colombia. Universidad de São Paulo, São Paulo, Brasil
Abstract
Changepoint regression models have originally been developed in connection with applications in quality control, where a change from the in-control to the out-of-control state has to be detected based on the available random observations. Up to now various changepoint models have been suggested for differents applications like reliability, econometrics or medicine. In many practical situations the covariate cannot be measured precisely and an alternative model are the errors in variable regression models. In this paper we study the regression model with errors in variables with changepoint from a Bayesian approach. From the simulation study we found that the proposed procedure produces estimates suitable for the changepoint and all other model parameters.
Key words: Bayesian analysis, Changepoint models, Errors in variables models.
Resumen
Los modelos de regresión con punto de cambio han sido originalmente desarrollados en el ámbito de control de calidad, donde, basados en un conjunto de observaciones aleatorias, es detectado un cambio de estado en un proceso que se encuentra controlado para un proceso fuera de control. Hasta ahora varios modelos de punto de cambio han sido sugeridos para diferentes aplicaciones en confiabilidad, econometría y medicina. En muchas situaciones prácticas la covariable no puede ser medida de manera precisa, y un modelo alternativo es el de regresión con errores en las variables. En este trabajo estudiamos el modelo de regresión con errores en las variables con punto de cambio desde un enfoque bayesiano. Del estudio de simulación se encontró que el procedimiento propuesto genera estimaciones adecuadas para el punto de cambio y todos los demás parámetros del modelo.
Palabras clave: análisis bayesiano, modelos con errores en las variables, modelos con punto de cambio.

1. Introduction
    Linear regression is one of the most widely used statistical tools to analyze the
relationship between a response variable Y and a covariate x. Under the classic
model of simple linear regression the relationship between Y and x is given by

                         Yi = α + βxi + ei ,    i = 1, . . . , n                    (1)

                                                 ind
where α and β are unknown constants and ei ∼ N (0, σe2 ), for i = 1, . . . , n, where
N (a, b2 ) denotes the normal distribution with location parameter a and scale pa-
rameter b > 0. Usually it is assumed that xi is measured without error in many
practical situations this assumption is violated. Instead of observing xi is observed

                             Xi = xi + ui   i = 1, . . . , n                        (2)

where xi is the unobservable variable and ui ∼ N (0, σu2 ). Measurements errors
(ei , ui ) are assumed independent and identically distribuited; see, for example,
Cheng & Van Ness (1999) and Fuller (1987).
    Measurement error (ME) model (also called errors-in-variables model) is a
generalization of standard regression models. For the simple linear ME model,
the goal is to estimate from bivariate data a straight line fit between X and Y ,
both of which are measured with error. Applications in which the variables are
measured with error are perhaps more common than those in which the variables
are measured without error. Many variables in the medical field, such as blood
pressure, pulse frequency, temperature, and other blood chemical variables, are
measured with error. Variables of agriculture such as rainfalls, content of nitrogen
of the soil and degree of infestation of plagues can not be measured accurately.
In management sciences, social sciences, and in many other sciences almost all
measurable variables are measured with error.
     There are three ME models depending on the assumptions about xi . If the
x,i s are unknown constan, then the model is known as a functional ME model;
whereas, if the x,i s are independent identically distributed random variables and
independent of the errors, the model is known as a structural ME model. A third
model, the ultrastructural ME model, assumes that the x,i s are independent ran-
dom variables but not identically distributed, instead of having possibly different
means, µi , and common variance σ 2 . The ultrastructural model is a generalization
of the functional and structural models: if µ1 = · · · = µn , then the ultrastructural
model reduces to the structural model; whereas if σ 2 = 0, then the ultrastructural
model reduces to the functional model (Cheng & Van Ness 1999).


                                       Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                     17

    It is common to assume that all the random variables in the ME model are
jointly normal in this case the structural ME model, is not identifiable. This means
that different sets of parameters can lead to the same joint distribution of X and Y .
For this reason, the statistical literature have considered six assumptions about
the parameters which lead to an identifiable structural ME model. The six as-
sumptions have been studied extensively in econometrics; see for example Reiersol
(1950), Bowden (1973), Deistler & Seifert (1978) and Aigner, Hsiao, Kapteyn &
Wansbeek (1984). They make identifiable the structural ME model.

  1. The ratio of the error variances, λ = σe2 /σu2 , is known
  2. The ratio kx = σx2 /(σx2 + σu2 ) is known
  3. σu2 is known
  4. σe2 is known
  5. The error variances, σu2 and σe2 , are known
  6. The intercept, α, is known and E(X) 6= 0

    Assumption 1 is the most popular of these assumptions and is the one with
the most published theoretical results; the assumption 2 is commonly found in the
social science and psychology literatures; the assumption 3 is a popular assumption
when working with nonlinears models; the assumption 4 is less useful and cannot
be used to make the equation error model or the measurement error model with
more than one explanatory variable identifiable; the assumption 5 frequently leads
to the same estimates as those for assumption 1 and also leads to an overidentified
model, and finally the assumption 6 does not make the normal model, with more
than one identifiable explanatory variable.
    In the structural ME model, usually it is assumed that xi ∼ N (µx , σx2 ), ei ∼
N (0, σe2 ) and ui ∼ N (0, σu2 ) with xi , ei and ui independent. A variation of the
structural ME model proposed by Chang & Huang (1997) consists in relaxing the
assumption of xi ∼ N (µx , σx2 ), so that the x,i s are not identically distributed.
Consider an example that can be stated as follows. Let xi denote some family’s
true income at time i, let Xi denote the family’s measured income, let Yi denote its
measured consumption. During the observations (Xi , Yi ), some new impact on the
financial system in the society may occur, for instance, a new economic policy may
be announced. The family’s true income structure may start to change some time
after the announcement; however, the relation between income and consumption
remains unchanged. Under this situation Chang & Huang (1997) considered the
structural ME model defined by (1) and (2), where the covariate xi has a change
in its distribution given by:
                        xi ∼ N (µ1 , σx2 )    i = 1, . . . , k
                        xi ∼ N (µ2 , σx2 )    i = k + 1, . . . , n

  This model with change in the mean of xi at time k is called structural ME
model with changepoint.

                                        Revista Colombiana de Estadística 35 (2012) 15–38

18                                              Olga Cecilia Usuga & Freddy Hernández


    The problems with changepoint have been extensively studied. Hinkley (1970)
developed a frequentist approach to the changepoint problems and Smith (1975)
developed a Bayesian approach. The two works were limited to the inference
about the point in a sequence of random variables at which the underlying dis-
tribution changes. Carlin, Gelfand & Smith (1992) extended the Smith approach
using Markov chain Monte Carlo (MCMC) methods for changepoint with continuos
time. Lange, Carlin & Gelfand (1994) and Kiuchi, Hartigan, Holford, Rubinstein
& Stevens (1995) used MCMC methods for longitudinal data analysis in AIDS
studies. Although there are works in the literature on changepoint problems with
Bayesian approach, the Bayesian approach for ME models has not been studied.
Hernandez & Usuga (2011) proposed a Bayesian approach for reliability models.
The goal of this paper is to propose a Bayesian approach to make inferences in
structural ME model with changepoint.
    The plan of the paper is as follows. Section 2 presents the Bayesian formulation
of the model, Section 3 presents the simulation study and Section 4 presented an
application with a real dataset and finally some concluding remarks are presents
in Section 5.




2. Structural Errors in Variables Models with
   Changepoint

   The structural ME model with one changepoint that will be studied in this
paper is defined by the following equations:
                                                                           )
                     Yi = α1 + β1 xi + ei           i = 1, . . . , k
                                                                                                  (3)
                     Yi = α2 + β2 xi + ei           i = k + 1, . . . , n

and
                           Xi = xi + ui         i = 1, . . . , n                                  (4)

where Xi and Yi are observable random variables, xi is an unobservable random
variable, ei and ui are random errors with the assumption that (ei , ui , xi )T are
independents for i = 1, . . . , n with distribution given by:

                      2                              
        ei           0       σ e1            0         0
       ui  ∼ N3  0  ,  0              σu2 1      0  ,              i = 1, . . . , k
        xi           µ1       0              0        σx21
                      2                              
        ei           0       σ e2            0         0
       ui  ∼ N3  0  ,  0              σu2 2      0  ,              i = k + 1, . . . , n
        xi           µ2       0              0        σx22


                                      Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                                           19

    The observed data (Yi , Xi ) have the following joint distribution for i = 1, . . . , n.
          !                               !                                       !!
     Yi       i.i.d         α1 + β1 µ1            β12 σx21 + σe21     β1 σx21
               ∼ N2                           ,                                        , i = 1, . . . , k
     Xi                        µ1                      β1 σx21       2
                                                                    σx1 + σu2 1
          !                               !                                       !!
     Yi       i.i.d         α2 + β2 µ2            β22 σx22 + σe22     β2 σx22
               ∼ N2                           ,                                        , i = k + 1, . . . , n
     Xi                        µ2                      β2 σx22      σx2 + σu2 2
                                                                     2




     The likelihood function L(θ | X, Y ), where θ = (k, α1 , β1 , µ1 , σx21 , σe21 , σu2 1 , α2 ,
β2 , µ2 , σx22 , σe22 , σu2 2 )T , X = (X1 , . . . , Xn )T and Y = (Y1 , . . . , Yn )T can be written
as:
                                                                                       
                                     2 2   2         2 2      2  2 −k/2               A
           L(θ | X, Y ) ∝ (β1 σu1 σx1 + σe1 σx1 + σu1 σe1 )               exp −
                                                                                      C
                                                                                                (5)
                                     2 2   2         2 2      2  2 −(n−k)/2               B
                                × (β2 σu2 σx2 + σe2 σx2 + σu2 σe2 )              exp −
                                                                                         D

where
                         k
                         X                                 k
                                                           X
 A =(β12 σx21 + σe21 )         (Xi − µ1 )2 − 2β1 σx21            (Yi − α1 − β1 µ1 )(Xi − µ1 )
                         i=1                               i=1
                            k
                            X
        + (σx21 + σu2 1 )       (Yi − α1 − β1 µ1 )2
                            i=1
                            X n                                n
                                                               X
 B =(β22 σx22 + σe22 )            (Xi − µ2 )2 − 2β2 σx22              (Yi − α2 − β2 µ2 )(Xi − µ2 )
                         i=k+1                                i=k+1
                           Xn
        + (σx22 + σu2 2 )           (Yi − α2 − β2 µ2 )2
                            i=k+1

 C =2(β12 σu2 1 σx21 + σe21 σx21 + σu2 1 σe21 )
 D =2(β22 σu2 2 σx22 + σe22 σx22 + σu2 2 σe22 )


2.1. Prior and Posterior Distributions
    It was considered the discrete uniform distribution for k in the range 1, . . . , n
allowing values of k = 1 or k = n, which would indicate the absence of change-
point. Also, it was considered inverse Gamma distribution for each of the variances
and normal distributions for the remaining parameters to obtain posterior distri-
butions. The above distributions with their hyperparameters are given below.
                                      (
                                        P (K = k) = n1 , k = 1, . . . , n,
                            p(k) =
                                        0,               otherwise,

                             σe21 ∼ GI(ae1 , be1 ) σe22 ∼ GI(ae2 , be2 )


                                                  Revista Colombiana de Estadística 35 (2012) 15–38

20                                                             Olga Cecilia Usuga & Freddy Hernández


                            σu2 1 ∼ GI(au1 , bu1 ) σu2 2 ∼ GI(au2 , bu2 )
                            σx21 ∼ GI(ax1 , bx1 ) σx22 ∼ GI(ax2 , bx2 )
                             α1 ∼ N (α01 , σα2 1 ) α2 ∼ N (α02 , σα2 2 )
                              β1 ∼ N (β01 , σβ21 ) β2 ∼ N (β02 , σβ22 )
                              µ1 ∼ N (µ01 , σµ2 1 ) µ2 ∼ N (µ02 , σµ2 2 )
where GI(a, b) denotes the inverse Gamma distribution with shape parameter
a > 0 and scale parameter b > 0. The hyperparameters ae1 , be1 , ae2 , be2 , au1 ,
bu1 , au2 , bu2 , ax1 , bx1 , ax2 y bx2 , α01 , σα2 1 , α02 , σα2 2 , β01 , σβ21 , β02 , σβ22 , µ01 , σµ2 1 ,
µ02 and σµ2 2 are considered as known. The prior distribution for the vector x is
denoted by π(x) and it is based on the assumption of independence and normality
of the model.
    The likelihood function based on complete data X, Y and x = (x1 , . . . , xn )T
is denoted by L∗ (θ | X, Y ) and can be expressed as
                                    k                                  n
                                                               1                               1
                                    Y                                  Y
              L∗ (θ | X, Y ) ∝           (σe21 σu2 1 σx21 )− 2 eE           (σe22 σu2 2 σx22 )− 2 eF     (6)
                                    i=1                             i=k+1

where
                             (Yi − α1 − β1 xi )2   (Xi − xi )2   (xi − µ1 )2
                   E=−                           −             −
                                    2σe21            2σu2 1         2σx21
                             (Yi − α2 − β2 xi )2   (Xi − xi )2   (xi − µ2 )2
                   F =−                          −             −
                                    2σe22            2σu2 2         2σx22

    Based on the prior distributions for each parameter the posterior distribution
for θ can be written as
                                   k                               n
                                                      1                             1
                                   Y                               Y
            π(θ, x | X, Y ) ∝            (σe21 σu2 1 )− 2 eG           (σe22 σu2 2 )− 2 eH p(k)
                                   i=1                         i=k+1
                                                                                                         (7)
                                × π(α1 ) π(α2 ) π(β1 ) π(β2 ) π(µ1 ) π(µ2 )
                                × π(σe21 ) π(σe22 ) π(σu2 1 ) π(σu2 2 ) π(σx21 ) π(σx22 ) π(x)

where
                                      (Yi − α1 − β1 xi )2   (Xi − xi )2
                             G=−                          −
                                             2σe21            2σu2 1
                                      (Yi − α2 − β2 xi )2   (Xi − xi )2
                            H=−                           −
                                             2σe22            2σu2 2

    The conditional posterior distributions for the parameters obtained from the
previous posterior distribution are given in Appendix. For almost all the parame-
ters posterior distributions with pdf known were obtained, except for the param-
eter k. The conditional posterior distribution of the changepoint k in the model

                                                   Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                   21

has not pdf known, making it necessary to use the Gibbs sampler, introduced by
Geman & Geman (1984) to approximate this distribution. The sampler Gibbs is
an iterative algorithm that constructs a dependent sequence of parameter values
whose distribution converges to the target joint posterior distribution (Hoff 2009).
   The procedure used to implement the Gibbs sampler to the problem was:

  1. Generate appropriate initial values for each of the 13 parameters to create
     the initial parameter vector θ = (θ1 , . . . , θ13 )T .
  2. Update the component j = 1, . . . , 13 of θ generating a random observation
     for the parameter θj using the corresponding posterior distribution of Ap-
     pendix and the subset of parameters of θ present in the posterior distribution
     of θj .
  3. Repeat step 2 a number of times until obtaining convergence in all the pa-
     rameters.


3. Simulation Study
    In this section we present the results of implementation of the Gibbs sampler
for the model given in equations (3) and (4) under three different assumptions of
the parameters. In the first case we analyze the model with a simulated dataset
considering λ = σe2i /σu2 i known; in the second case we consider the variances σu2 1
and σu2 2 known and equal, and in the third case we consider the variances σe21
and σe22 known and equals. In addition to the above cases we also analized the
changepoint estimate of the model for different n values with the aim of observing
the behavior of the estimate of k with respect to its true value.


3.1. λ Known
    In Table 1 we present a dataset of n = 60 observations generated in R Deve-
lopment Core Team (2011) from the model given in equations (3) and (4) with the
assumption of λ = 1 considering the following set of parameters: k = 20, α1 = 2,
β1 = 2, µ1 = 1, σx21 = 1, σe21 = 1.5, σu2 1 = σe21 /λ, α2 = −1, β2 = 4, µ2 = 5,
σx22 = 2, σe22 = 2.5 and σu2 2 = σe22 /λ. Figure 1 shows the scatter plot for the
data generated and there is not clear indication of the changepoint in the model
structure.
     We use the Gibbs sampler to obtain estimates of the parameters. The prior
distributions used to run the Gibbs sampler were as follows: α1 ∼ N (2, 15), β1 ∼
N (2, 15), µ1 ∼ N (1, 15), σx21 ∼ GI(2, 5), σe21 ∼ GI(2, 5), σu2 1 ∼ GI(2, 5), α2 ∼
N (−1, 15), β2 ∼ N (4, 15), µ2 ∼ N (5, 15), σx22 ∼ GI(2, 5), σe22 ∼ GI(2, 5) and
σu2 2 ∼ GI(2, 5).




                                      Revista Colombiana de Estadística 35 (2012) 15–38

22                                                       Olga Cecilia Usuga & Freddy Hernández


                  Table 1: Random sample of simulated data with λ = 1.
 X      0.05    4.34     1.18     0.65   1.47 −0.57      2.42    0.78    1.63 −1.02     −0.78    0.48
 Y      0.03    4.92     4.42     1.62   5.91  3.81      6.60    4.97    2.79  2.37      1.45    5.24

 X      1.05    2.50     3.76     0.61   1.46    0.98    1.59   −0.95    4.89    2.28    7.09    7.18
 Y      1.74    6.07     6.96     6.65   2.08    2.63    5.55    1.39   17.84    9.15   16.82   25.40

 X      6.58    4.85     6.23     5.30  7.29     6.73    6.78    7.46  2.86      3.33    3.80    9.66
 Y     18.51   18.86    13.12    19.57 17.16    22.71   22.16   26.90 21.30     12.82   27.43   27.96

 X      3.63    3.66     5.70     5.64  2.15     3.13    9.10    9.88  4.73      7.48    2.55 11.11
 Y      9.53   12.68    18.54    19.15 20.43    21.36   32.97   27.38 13.67     18.73   14.54 23.11

 X      7.10    4.95     9.17     2.03  9.54     5.08    7.36    6.37  4.35      1.45    7.67    2.97
 Y     25.54   21.00    27.77     9.75 27.62    22.29   19.45   17.34 23.68     13.99   25.15   11.38



                            30


                            25


                            20
                        Y




                            15


                            10


                             5


                             0

                                     0      2       4       6      8      10

                                                        X
                       Figure 1: Scatter plot for simulated data with λ = 1.



    We ran five chains of the Gibbs sampler. Each sequence was run for 11000
iterations with a burn-in of 1000 samples. The vectors of initial values for each of
the chains were:
      (0)
     θ 1 = (5, 1.886, 1.827, 2.4, 0.942, 1.134, 1.015, −1.5, 2.100, 1.3, 0.6, 0.893, 1.8)
      (0)
     θ 2 = (10, 2.537, 1.225, 2.2, 1.404, 2.171, 0.552, 0.2, 3.500, 4.3, 1.1, 0.903, 3.4)
      (0)
     θ 3 = (30, 1.856, 1.855, 2.6, 0.928, 1.087, 1.029, −0.3, 3.829, 4.5, 2.0, 0.900, 2.1)
      (0)
     θ 4 = (40, 2.518, 1.242, 2.8, 1.386, 2.142, 0.571, −2.0, 3.829, 3.5, 2.8, 0.901, 1.4)
      (0)
     θ 5 = (50, 2.516, 1.244, 1.8, 1.383, 2.138, 0.573, −1.3, 3.829, 2.5, 3.5, 0.899, 2.4)

   The above vectors were obtained by the following procedure. For fixed values of
k = 5, 10, 30, 40, 50 numerical methods were used to determine the values of θ that
maximize the likelihood function given in (5). These estimates were obtained using
the function optim of R Development Core Team (2011), which uses optimization

                                                Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                                                                                       23

methods quasi-Newton such as the bounded limited-memory algorithm L-BFGS-
B (Limited memory, Broyden- Fletcher-Goldfarb-Shanno, Bounded) proposed by
Byrd, Lu, Nocedal & Zhu (1995).

   In order to verify the convergence of the chains we use the diagnostic indicator
proposed by Brooks & Gelman (1998). The diagnostic value of R found in this case
was 1.04; values close to 1 indicate convergence of the chains. Additionally, for
each parameter, the posterior distribution was examined visually by monitoring
the density estimates, the sample traces, and the autocorrelation function. We
found not evidence of trends or high correlations. Figures 2 and 3 show the
Highest Density Region (HDR) graphics for the parameters of the chain 1. These
graphics show that the true values of the model parameters are in the Highest
Density Regions.

                                                                 0.8




                0.4                                              0.6
      Density




                                                       Density




                                                                                                      Density
                                                                                                                0.5
                                                                 0.4

                0.2

                                                                 0.2



                0.0                                              0.0                                            0.0

                      −2       0       2       4                       −1   0   1        2   3   4                        −1   0        1       2   3

                                   α1                                               β1                                             μ1




                                                                 0.4                                            0.8

                0.6

                                                                 0.3                                            0.6

                0.4
      Density




                                                       Density




                                                                                                      Density




                                                                 0.2                                            0.4


                0.2
                                                                 0.1                                            0.2



                0.0                                              0.0                                            0.0

                      0    2       4       6       8                    0 2 4 6 8                12                   0   1    2   3        4   5   6
                                                                                    2                                               2
                                   σ2x1                                         σ e1                                               σ u1

                               Figure 2: HDR plot for α1 , β1 , µ1 , σx21 ,σe21 and σu2 1 .



    Table 2 presents the posterior mean and standard deviation (SD) for the model
parameters and the 90% HDR interval. Note that the true values parameters are
close to mean and are within the HDR interval.


                                                                        Revista Colombiana de Estadística 35 (2012) 15–38

24                                                                                      Olga Cecilia Usuga & Freddy Hernández


                                                                    0.8                                            1.0



               0.10                                                 0.6


     Density




                                                          Density




                                                                                                         Density
                                                                    0.4                                            0.5

               0.05

                                                                    0.2



               0.00                                                 0.0                                            0.0

                      −10       −5         0    5   10                    2.0   3.0        4.0    5.0                    4.0   5.0       6.0      7.0

                                         α2                                           β2                                                 μ2




                0.4                                                                                                0.4
                                                                    0.2
     Density




                                                          Density




                                                                                                         Density
                0.2                                                                                                0.2
                                                                    0.1




                0.0                                                 0.0                                            0.0

                      0     2        4      6   8   10                    0 5     15         25     35                   0     2     4        6   8

                                         σ2x2                                         σ2u2                                           σ2e2
                                Figure 3: HDR plot for α2 , β2 , µ2 , σx22 ,σe22 and σu2 2 .



Table 2: Posterior mean, standard deviation (SD), HDRlower and HDRupper of pa-
         rameters with λ = 1.
                                     Parameter           Mean             SD           HDRlower          HDRupper
                                         k               19.99            0.10                -              -
                                        α1                2.21            0.83             0.94            3.57
                                        β1                1.50            0.54             0.64            2.38
                                        µ1                1.09            0.40             0.44            1.74
                                        σx21              1.64            0.72             0.60            2.61
                                        σe21              2.28            1.14             0.62            3.77
                                        σu2               1.47            0.59             0.56            2.24
                                            1
                                        α2                0.17            2.54            −3.97            4.46
                                        β2                3.44            0.45             2.71            4.20
                                        µ2                5.72            0.38             4.10            5.34
                                        σx22              2.86            0.94             1.39            4.22
                                        σe22              3.77            2.68             0.53            7.32
                                        σu2               3.18            0.81             1.86            4.42
                                            2




                                                                           Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                                         25

3.2. σu21 and σu22 Known

    In this case we consider the structural ME model with σu2 1 = σu2 2 = 2. Table
3 shows a dataset of size n = 60 generated from the model given in equations (3)
and (4) with the following set of parameters: α1 = 2, β1 = 2, µ1 = 1, σx21 = 1,
σe21 = 1.5, α2 = −1, β2 = 4, µ2 = 5, σx22 = 2 and σe22 = 2.5. Figure 4 shows the
scatter plot for the simulated data.


             Table 3: Random sample of data simulated with σu2 1 = σu2 2 = 2.
 X    2.03     2.16    1.68 −0.07          1.00   −0.82        1.42   −0.42      3.36   0.88    0.12    0.80
 Y    5.11     4.31    5.33  2.73          0.33    1.69        7.48    3.06      2.65   0.48    1.82    5.37

 X    2.84     4.15   −1.54     0.84       1.55       0.99 −0.27          4.16    6.13  5.01    5.09    1.12
 Y    0.42     5.20    3.75     4.88       3.87       0.73  6.01          8.41   20.03 18.82   15.29    8.10

 X    5.40     3.28    8.06     5.78    5.68       3.26     2.48       3.72      2.85  6.13  2.85  8.47
 Y    8.55    16.47   26.13    15.54   16.11      14.48    11.52      21.86      9.55 24.49 14.44 24.76

 X    3.18     3.90    2.58     7.58    5.59       6.79     7.20       4.01  6.10  5.73         1.82  7.95
 Y   20.74    15.84    4.54    20.84   20.96      24.59    23.95      11.74 18.99 15.13         9.98 29.01

 X    4.42     4.01    7.72     9.25    4.60       4.73     0.52       0.46      2.76  5.44  7.22       3.33
 Y   13.82    14.92   23.08    32.71   10.53      22.03    11.28      14.74      8.30 15.60 30.96      17.54




                          30


                          25


                          20
                      Y




                          15


                          10


                           5


                           0

                                       0          2        4          6          8

                                                          X
             Figure 4: Scatter plot for the simulated data with σu2 1 = σu2 2 = 2.



   The prior distributions for α1 , β1 , µ1 , σx21 , σe21 , α2 , β2 , µ2 , σx22 , and σe22 were the
same considered in the case of λ known. The vectors of initial values for the model
parameters in each of the five Markov chain were as follows:

                                                  Revista Colombiana de Estadística 35 (2012) 15–38

26                                                                                          Olga Cecilia Usuga & Freddy Hernández




       (0)
     θ 1 = (5, 1.0, 2.305, 1.063, 0.189, 3.0, 2, −2.0, 4.071, 4.727, 2.0, 1.984, 2)
       (0)
     θ 2 = (10, 1.5, 2.800, 1.063, 0.189, 1.7, 2, −2.0, 4.071, 3.300, 3.0, 1.980, 2)
       (0)
     θ 3 = (30, 3.1, 2.305, 0.300, 2.000, 2.0, 2, −0.5, 1.500, 3.200, 2.0, 2.700, 2)
       (0)
     θ 4 = (40, 3.1, 1.900, 1.063, 1.400, 2.1, 2, −2.0, 4.071, 4.727, 1.4, 1.981, 2)
       (0)
     θ 5 = (50, 2.9, 0.500, 1.063, 0.189, 2.6, 2, 0.7, 2.400, 1.500, 3.1, 1.981, 2).

    The diagnostic value of convergence R was 1.01 indicating the convergence of
the chains. A visual monitoring of the density estimates, the sample traces, and
the correlation function for each parameter in each of the chains did not show any
problem. In Figures 5 and 6 we present the HDR graphics for the parameters
in the chain 1. The graphics show that true values of the parameters model are
within the Highest Density Regions.

                                                                                                                      0.8
                   0.3

                                                                      0.3
                                                                                                                      0.6

                   0.2
         Density




                                                            Density




                                                                      0.2                                   Density   0.4


                   0.1
                                                                      0.1                                             0.2



                   0.0                                                0.0                                             0.0

                             −2 0   2       4   6   8                       −4 −2       0      2   4    6                   −1   0   1    2   3

                                    α1                                                  β1                                           μ1




                                                                      0.2
                   0.6
         Density




                                                            Density




                   0.4
                                                                      0.1


                   0.2



                   0.0                                                0.0

                         0     2        4       6       8                    0      5       10     15

                                    σ2x1                                                σ2e1

                                Figure 5: HDR plot for α1 , β1 , µ1 , σx21 and σe21 .


   Table 4 shows the posterior mean and standard deviation (SD) for each of the
parameters model and the 90% HDR interval. It is noted again that the true
values of the parameters are close to the mean and within the HDR intervals.

                                                                            Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                                                                           27

                                                                       0.8
                                                                                                                     1.0
                  0.15

                                                                       0.6

                  0.10


        Density




                                                             Density




                                                                                                          Density
                                                                       0.4
                                                                                                                     0.5


                  0.05
                                                                       0.2



                  0.00                                                 0.0                                           0.0

                         −10 −5       0        5       10                        2   3      4     5   6                    3   4    5   6

                                      α2                                                  β2                                       μ2




                                                                       0.3

                   0.4


                                                                       0.2
        Density




                                                             Density




                   0.2
                                                                       0.1




                   0.0                                                 0.0

                         0   2    4        6       8   10                    0   5   10          20

                                   σ2x2                                                   σ2e2

                                 Figure 6: HDR plot for α2 , β2 , µ2 , σx22 and σe22 .


Table 4: Posterior mean, standard deviation (SD), HDRlower and HDRupper of pa-
         rameters with σu2 1 = σu2 2 .
                                 Parameter                  Mean             SD            HDRlower                 HDRupper
                                     k                      19.25            0.61                 -                     -
                                    α1                       2.48            1.24              0.48                   4.47
                                    β1                       0.89            0.99             −0.69                   2.46
                                    µ1                       1.15            0.43              0.44                   1.86
                                    σx21                     1.51            0.73              0.52                   2.47
                                    σe21                     3.85            1.72              1.05                   6.18
                                    α2                      −1.00            2.31             −4.62                   2.91
                                    β2                       3.82            0.46              3.04                   4.55
                                    µ2                       4.79            0.36              4.20                   5.36
                                    σx22                     3.02            0.94              1.53                   4.39
                                    σe22                     3.21            2.16              0.53                   6.07



3.3. σe21 and σe22 Known
   In this case we consider the structural ME model with σe21 = σe22 = 2. Table
5 shows a dataset of size n = 60 generated from the model given in equations (3)
and (4) considering the same parameters values of the case λ known. Figure 7
presents the scatter plot of the simulated data.

                                                                             Revista Colombiana de Estadística 35 (2012) 15–38

28                                                                Olga Cecilia Usuga & Freddy Hernández


           Table 5: Random sample of the simulated data with σe21 = σe22 = 2.
 X −0.82          1.06 −2.25        0.76       1.71 −0.93              0.50   −0.08    1.12   −0.14    1.59    0.99
 Y  2.72          2.75  1.88        8.66       5.12  2.51              7.00    7.64    4.55    7.50    2.89    2.55

 X −1.69        −0.14       2.32   −1.42       2.99        0.70        0.99    0.06    5.20    2.18  6.69  8.79
 Y  2.47         0.43       5.32    3.10       6.63        1.99        5.57    3.39   11.10   13.80 17.71 32.28

 X      4.98     8.05    6.29       5.99  5.32             5.80        7.73    5.45  4.27      2.84    7.69   10.61
 Y     16.11    19.64   16.59      17.86 16.14            19.01       34.01   19.65 19.77     21.84   23.58   30.02

 X      5.90     3.51    2.15       3.10  9.42             3.31        4.06    1.44  7.18      1.72    6.61  5.28
 Y     21.45    11.51   17.44      17.75 29.13            18.25       20.95    8.24 24.11      8.12   29.31 19.54

 X      4.68     1.88    5.02       1.76  7.67             5.31        6.42    7.79  4.32      1.20    3.22    3.37
 Y     17.90    17.81   16.27      14.20 23.72            27.51       28.17   18.41 18.28     11.89   15.10   19.96

                             35


                             30


                             25


                             20
                        Y




                             15


                             10


                              5


                              0

                                   −2      0          2           4       6      8      10

                                                                  X
               Figure 7: Scatter plot for the simulated data with σe21 = σe22 = 2.


    The prior distributions for α1 , β1 , µ1 , σx21 , σu2 1 , α2 , β2 , µ2 , σx22 and σu2 2 were the
same considered in the case of λ known. The vectors of the initial values for each
of the five Markov chains were as follows:
 (0)
θ 1 = (5, 3.264, 2.650, 0.366, 0.437, 2.001, 1.276, 4.287, 3.0, 5.106, 3.793, 2.001, 2.394)
 (0)
θ 2 = (10, 1.000, 1.904, 1.500, 1.370, 2.001, 0.500, 4.512, 5.0, 2.000, 2.700, 2.001, 1.000)
 (0)
θ 3 = (30, 2.500, 2.650, 1.000, 0.437, 2.001, 1.500, 4.286, 2.0, 4.000, 3.792, 2.001, 0.700)
 (0)
θ 4 = (40, 0.500, 1.904, 0.900, 1.369, 2.000, 2.000, 4.512, 1.8, 5.500, 4.000, 2.001, 2.100)
 (0)
θ 5 = (50, 3.600, 2.652, 1.900, 0.437, 2.000, 0.700, 4.287, 4.1, 4.200, 3.792, 2.001, 2.000)

    The diagnostic value of convergence was of 1.04 indicating the convergence of
the chains. In Figures 8 and 9 we present the HDR graphics of the parameters
for the chain 1. Note that the true values of the parameters model are within the
Highest Density Regions.

                                                      Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                                                                                                                    29

                           0.6                                                                                                                1.0
                                                                                       0.6


                           0.4
                                                                                       0.4




                Density




                                                                             Density




                                                                                                                                    Density
                                                                                                                                              0.5

                           0.2
                                                                                       0.2




                           0.0                                                         0.0                                                    0.0

                                       0   1        2       3   4       5                    0   1       2    3     4       5   6                   −1       0       1       2

                                                    α1                                                        β1                                                 μ1




                           0.8

                                                                                       0.6
                           0.6
                Density




                                                                             Density
                                                                                       0.4
                           0.4


                                                                                       0.2
                           0.2



                           0.0                                                         0.0

                                  0        2            4           6                        0       2        4         6

                                                    σ2x1                                                     σ2u1

                          Figure 8: HDR plot for α1 , β1 , µ1 , σx21 and σu2 1 .


                                                                                                                                              1.0

                          0.10                                                         0.6




                                                                                       0.4
                Density




                                                                             Density




                                                                                                                                    Density




                                                                                                                                              0.5
                          0.05

                                                                                       0.2




                          0.00                                                         0.0                                                    0.0

                                 −15           −5       0       5       10                   2       3        4         5                                4       5       6       7

                                                    α2                                                       β2                                                  μ2




                           0.4                                                         0.6



                           0.3
                                                                                       0.4
                Density




                                                                             Density




                           0.2


                                                                                       0.2
                           0.1



                           0.0                                                         0.0

                                   0       2    4           6   8       10                       2            4         6

                                                    σ2x2                                                     σ2u2

                          Figure 9: HDR plot for α2 , β2 , µ2 , σx22 and σu2 2 .



    Table 6 shows the posterior mean and the standard deviation (SD) for the
model parameters and the 90% HDR interval. As in the previous cases the poste-
rior means are close to the true values and are within the HDR interval.


                                                                                             Revista Colombiana de Estadística 35 (2012) 15–38

30                                             Olga Cecilia Usuga & Freddy Hernández


Table 6: Posterior mean, standard deviation (SD), HDRlower and HDRupper of pa-
         rameters with σe21 = σe22 .
               Parameter     Mean     SD      HDRlower      HDRupper
                   k         20.22    0.47           -          -
                  α1         2.95     0.62        0.96        2.98
                  β1         2.09     0.61        1.09        3.02
                  µ1         0.59     0.37       −0.01        1.20
                  σx21       1.41     0.64        0.53        2.26
                  σu2 1      1.76     0.64        0.80        2.64
                  α2         0.60     2.62       −2.01        0.97
                  β2         3.70     0.49        2.93        4.49
                  µ2         5.16     0.35        4.57        5.73
                  σx22       2.85     0.93        1.41        4.19
                  σu2 2      2.62     0.63        1.59        3.53


3.4. Constant Sample Size and Variable Changepoint
    In this case our objective was determine if the estimated changepoint of the
model given in equations (3) and (4) differs from its true value when n = 60 is
fixed. We generated nine random samples of size n = 60 based on the structure
considered in Section 3.1; the values of the parameters were the same ones used in
this section. The changepoint k for each nine random samples had different values,
and the values were k = 3, 5, 10, 20, 30, 40, 50, 55 and 58. For each of the random
samples were run five Markov chains of size 150000 with a burn in of 15000. Table
7 presents for the estimated changepoint k the posterior mean, standard deviation
and percentiles of 10% and 90% when n = 60. Note that posterior mean of
the changepoint is very close to the true value and the standard deviation tends
to increase as the changepoint approach to the extreme values. Also the Table 7
shows that the distance between the percentiles 10% and 90% is at most 1%, which
indicates that the posterior distribution for the parameter k is highly concentrated
in one or two possible values and they match with the true value of k.


3.5. Sample Size and Changepoint Variable
    In this case our objective was to determine if the estimated changepoint of the
model given in equations (3) and (4) differs from its true value for differents values
of n. As in the previous case we generated nine dataset with the structure of the
Section 3.1. Each of the dataset had samples sizes of n = 20, 30, 40, 50, 60, 70, 80, 90
and 100. The true value for k in each of the nine set was k = n/2. Table 8
presents the posterior mean, standard deviation and 10% and 90% percentiles
for the estimated changepoint and the true values of k. Again we see that the
posterior mean of k is very close to the true values of k; it is also noted that the
standard deviation tends to increase as the size sample n decreases; this means
that if we have fewer observations the posterior distribution for k tends to have


                                        Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                   31

greater variability. As in the previous case the distance between the percentiles
10% and 90% is at most 1%, which means that the posterior distribution for the
parameter k is highly concentrated in one or two possible values and they match
the true value of k.

Table 7: Posterior mean, standard deviation (SD) and 10% and 90% percentiles of k
         estimated when n = 60.
                         k    Mean     SD     10%      90%
                         3     3.16   0.67    3.00     4.00
                         5     5.03   0.43    5.00     5.00
                        10     9.95   0.30   10.00    10.00
                        20    19.89   0.31   19.00    20.00
                        30    29.97   0.19   30.00    30.00
                        40    39.99   0.12   40.00    40.00
                        50    49.98   0.13   50.00    50.00
                        55    54.98   0.14   55.00    55.00
                        58    57.97   0.18   58.00    58.00


Table 8: Posterior mean, standard deviation (SD) and 10% and 90% percentiles of k.
                       n      k   Mean     SD     10%     90%
                      20     10    9.94   0.29   10.00   11.00
                      30     15   14.96   0.27   15.00   16.00
                      40     20   19.98   0.21   19.00   20.00
                      50     25   24.98   0.16   24.00   24.00
                      60     30   30.17   0.12   30.00   30.00
                      70     35   34.99   0.10   35.00   35.00
                      80     40   39.99   0.10   39.00   39.00
                      90     45   44.99   0.11   44.00   45.00
                     100     50   50.00   0.06   49.00   49.00




4. Application
   This section illustrates the proposed procedure for the structural ME model
with changepoint using a dataset of imports in the French economy.
   Malinvaud (1968) provided the data of imports, gross domestic product (GDP),
and other variables in France from 1949-1966. The main interest is to forecast the
imports given the gross domestic product of the country. Chatterjee & Brockwell
(1991) analyzed these data by the principal component method and found two
patterns in the data; they argued that the models before and after 1960 must
be different due to the fact the European Common Market began operations in
1960. Maddala (1992) considered a functional ME model; however, he ignored


                                      Revista Colombiana de Estadística 35 (2012) 15–38

32                                            Olga Cecilia Usuga & Freddy Hernández


the possibility that some changes in the data may arise. Chang & Huang (1997)
considered a structural ME model with changepoint using the likelihood ratio
test based on the maximum Hotelling T 2 for the test of no change against the
alternative of exactly one change and concluded that the changepoint ocurred in
1962. Table 9 presents the import data (Y ) and gross domestic product (X).

Table 9: Imports and gross domestic product data from January 1949 to November
         1966.
         Year         1949      1950      1951      1952      1953      1954
         GDP        149.30    161.20    171.50    175.50    180.80    190.70
         Imports     15.90     16.40     19.00     19.10     18.80     20.40
         Year         1955      1956      1957      1958      1959      1960
         GDP        202.10    212.40    226.10    231.90    239.00    258.00
         Imports     22.70     26.50     28.10     27.60     26.30     31.10
         Year         1961      1962      1963      1964      1965      1966
         GDP        269.80    288.40    304.50    323.40    336.80    353.90
         Imports     33.30     37.00     43.30     49.00     50.30     56.60

    The data were reanalized under a Bayesian perspective by adopting the struc-
tural ME model with changepoint. We considered non informative prior distri-
butions for all parameters. Again as in the previous cases, we built five chains
with different initial values of size 11000 with a burn in of 1000 samples to avoid
correlations problems. We found the value R = 1.03, indicating the convergence
of the chains.
    Figure 10 shows the high concentration in the value 14 for the posterior dis-
tribution for the parameter k. The mean for this distribution is 13.92, which is
the same obtained by Chang & Huang (1997), indicating that the data present a
changepoint for the year 1962. Table 10 presents estimates for the remaining pa-
rameters of the model. The values are also close to the results obtained by Chang
& Huang (1997). It is also noted that the means for β1 and β2 were 0.14 and 0.16,
which indicates no significant changes in the slope for the trend lines before and
after k = 14. The means obtained for the parameters α1 and α2 were −5.53 and
−2.23, not being to close these values, which indicate that the trend lines before
and after the change have different changepoints; this can be seen clearly in the
Figure 11.


5. Conclusions
    This paper proposes the Bayesian approach to study the structural ME model
with changepoint. Through the simulation study was shown that the proposed
procedure identifies correctly the point where the change comes to structure; note
also that the variability in the posterior distribution of k decreases as the number
of observations in the dataset increases. Another important aspect is that the
variability of the posterior distribution for k increases as the true value of k is


                                       Revista Colombiana de Estadística 35 (2012) 15–38

Bayesian Analysis for Errors in Variables with Changepoint Models                            33

                              1.0
                                                              0.9082


                              0.8




                              0.6




                    Density
                              0.4




                              0.2

                                                 0.0612
                                     0.0069                            0.0178
                              0.0
                                       12        13             14       15

                                                          k
                                Figure 10: Posterior density for k.




                              Table 10: Posterior summary results.
           Parameter               Mean            SD         HDRlower          HDRupper
                  α1              −5.53           1.95             8.77             −2.50
                  β1                0.14          0.01             0.13               0.16
                  µ1               16.33          3.88             9.99              22.67
                σx21            34601.81      13191.57         13641.42           51588.36
                 σe21               1.93          0.89             0.72               3.07
                σu2 1               4.37          5.18             0.37               8.66
                  α2              −2.23           3.78           −8.35                3.96
                  β2                0.16          0.01             0.14               0.18
                  µ2                5.39          3.89           −1.02               11.82
                σx22            70266.22      48727.80          1141.85          120582.77
                 σe22               5.43          4.61             0.72              10.16
                σu2 2               5.14         13.70                -                  -




close to 1. For the other parameters the proposed procedure generated posterior
distributions with means very close to the real parameters in all cases considered.
The proposed procedure generates chains that converge to the true parameters,
regardless of whether or not identifiability assumptions.

   Possible future works could consider other prior distributions such as non in-
formative and skew normal and also introduce multiple changepoints in Y and
X.

                                               Revista Colombiana de Estadística 35 (2012) 15–38

34                                                     Olga Cecilia Usuga & Freddy Hernández


                                Trend before change
                                Trend after change

                     50




                     40




                 Y   30




                     20




                          150           200           250     300       350

                                                       X
                     Figure 11: Scatter plot for the application.


6. Acknowledgements
   The authors are grateful to the editor and referees for their valuable comments
and helpful suggestions which led to improvements in the paper, and the professor
Carlos Alberto de Bragança Pereira (IME-USP) for the motivation to write this
work.
   During the course of this work the authors received financial support from
Coordenação de aperfeiçoamento de pessoal de nível superior (CAPES), Conselho
Nacional de Desenvolvimento Científico e Tecnológico (CNPq) and the Universidad
de Antioquia.
                                                                 
              Recibido: octubre de 2010 — Aceptado: enero de 2011


References
Aigner, D. J., Hsiao, C., Kapteyn, A. & Wansbeek, T. J. (1984), Latent variable models in econometrics, in Z. Griliches & M. D. Intriligator, eds, ‘Handbook of Econometrics’, Vol. 2, Elsevier Science, Amsterdam, pp. 1321–1393.
Bowden, R. J. (1973), ‘The theory of parametric identification’, Econometrica 41, 1069–1174.
Brooks, S. P. & Gelman, A. (1998), ‘General methods for monitoring convergence of iterative simulations’, Journal of Computational and Graphical Statistics 7(4), 434–455.
Byrd, R. H., Lu, P., Nocedal, J. & Zhu, C. (1995), ‘A limited memory algorithm for bound constrained optimization’, SIAM Journal on Scientific Computing 16, 1190–1208.
Carlin, B. P., Gelfand, A. E. & Smith, A. F. M. (1992), ‘Hierarchical Bayesian analysis of changepoint problems’, Applied of Statistics 41, 389–405.
Chang, Y. P. & Huang, W. T. (1997), ‘Inferences for the linear errors-in-variables with changepoint models’, Journal of the American Statistical Association 92(437), 171–178.
Chatterjee, E. & Brockwell, P. J. (1991), Regression Analysis by Example, Wiley, New York.
Cheng, C. L. & Van Ness, J. W. (1999), Statistical Regression with Measurement Error, Arnold, London.
Deistler, M. & Seifert, H. G. (1978), ‘Identifiability and consistent estimability in econometrics models’, Econometrica 46, 969–980.
Fuller, W. A. (1987), Measurement Error Models, Wiley, New York.
Geman, S. & Geman, D. (1984), ‘Stochastic relaxation, Gibbs distributions and the Bayesian restoration of images’, IEEE Transactions on Pattern Analysis and Machine Intelligence 6, 721–741.
Hernandez, F. & Usuga, O. C. (2011), ‘Analisis bayesiano para la distribucion lognormal generalizada aplicada a modelos de falla con censura’, Revista Colombiana de Estadística 34(1), 95–100.
Hinkley, D. V. (1970), ‘Inference about the change-point in a sequence of random variables’, Biometrika 57, 1–17.
Hoff, P. (2009), A First Course in Bayesian Statistical Methods, Springer, New York.
Kiuchi, A. S., Hartigan, J. A., Holford, T. R., Rubinstein, P. & Stevens, C. E. (1995), ‘Change points in the series of T4 counts prior to AIDS’, Biometrics 51, 236–248.
Lange, N., Carlin, B. & Gelfand, A. E. (1994), ‘Hierarchical Bayes models for the progression of HIV infection using longitudinal CD4 T-cell numbers (with discussion)’, Journal of the American Statistical Association 87, 615–632.
Maddala, G. S. (1992), Introduction to Econometrics, Macmillan, New York.
Malinvaud, E. (1968), Statistical Methods of Econometrics, Rand-McNally, Chicago.
R Development Core Team (2011), R: A Language and Environment for Statistical Computing, R Foundation for Statistical Computing, Vienna, Austria. ISBN 3-900051-07-0. *http://www.R-project.org
Reiersol, O. (1950), ‘Identifiability of a linear relation between variables which are subject to errors’, Econometrica 18, 375–389.
Smith, A. F. M. (1975), ‘ A Bayesian approach to inference about a change-point in a sequence of random variables’, Biometrika 62, 407–416.