Conditional Duration Model and the Unobserved Market Heterogeneity of Traders: An Infinite Mixture of Non-Exponentials. Modelo de duración condicionada y heterogeneidad inobservada de los agentes. Una mezcla infinita de distribuciones no exponenciales
University of Las Palmas de Gran Canaria and TIDES Institute, Las Palmas de Gran Canaria, Spain.  University of Las Palmas de Gran Canaria, Las Palmas de Gran Canaria, Spain
Abstract
This paper extends the conditional duration model proposed by Luca & Zuccolotto (2003) proposing an infinite mixture of distributions based on non-exponentials that account for the unobserved market heterogeneity of traders. The model we propose takes into account the fact that reaction times follow a gamma distribution and that the intensity parameter follows the reciprocal of an inverse Gaussian distribution. This extension allows us to capture, not only various density shapes of durations, but also nonmonotonic shapes of hazard functions. The model also allows us to test the unobserved heterogeneity of traders. This mixture model is easy to fit and characterises the behaviour of the conditional durations reasonably well.
Key words: Autoregressive conditional duration model, Exponential distribution, Gamma distribution, Heterogeneity, Reciprocal inverse gaussian distribution.
Resumen
Este trabajo extiende el modelo de duración condicionada propuesto por Luca & Zuccolotto (2003) introduciendo una mezcla infinita de distribuciones no exponenciales que permite incorporar la heterogeneidad inobservada en el mercado por los agentes. El modelo propuesto tiene en cuenta el hecho de que el tiempo de respuesta sigue una distribución gamma y que el parámetro que mide la intensidad sigue una distribución recíproca inversa Gaussiana. Esta modelización permite no sólo capturar distintas formas de la distribución de la duración sino que también captura funciones de azar no monótonas. El modelo propuesto es fácil de ajustar a datos de duración proporcionando resultados razonables y competitivos con otros modelos utilizados en la literatura.
Palabras clave: modelo de duración autorregresivo condicional, distribución exponencial, distribución Gamma, heterogeneidad, distribución recíproca inversa gaussiana.



1. Introduction
    The most popular econometric model for the intraday trading process has
traditionally been the autoregressive conditional duration (ACD) model (Engle
& Russell 1998) and its extensions: logarithmic ACD (Bauwens & Giot 2000),
stochastic conditional duration (Bauwens & Veredas 2004) and stochastic volatil-
ity duration. To cope with higher-order dynamics in the duration process (Ghysels,
Gouriéroux & Jasiak 2004), a nonlinear version based on self-exciting threshold
autoregressive processes (Zhang, Russell & Tsay 2001), or a family of ACD mod-
els that encompasses most specifications proposed in the literature (Fernandes &
Grammig 2006), among others.
    However, the recent focus of several studies of the financial duration of transac-
tions has taken into account the heterogeneity of agents. This heterogeneity plays
an important role in determining the size of price movements, the amount being
exchanged, and the frequency at which orders are presented and executed, among
other factors (Luca & Gallo 2009). For example, financial market microstructure
theories divide traders into informed and non-informed traders. The assumption of
interaction among agents, i.e, the coexistence of informed traders who possess pri-
vate information and liquidity traders whose information set is publicly available
(O’Hara (1995) and Ghysels (2000)) suggests that financial durations may obey
different probability laws. In addition, there are many reasons to believe that ar-
rival rates for informed and uninformed agents exhibit temporal dependence: each
having its own distinct pattern.
    Since durations reflect the heterogeneity of traders, modelling their baseline
distribution requires us to take into account random effects that account for unob-
served heterogeneity, rather than fixed effects, which can suffer from the incidental
parameter problem. The distribution of the duration is assumed to be derived from
a mixture of distributions given that heterogeneity could reflect differing rates of
information arrival (i.e., Clark 1973, Luca & Gallo 2009 and references therein).
   The basic idea of enabling the inclusion of the unobservable heterogeneity of
individuals in models, by means of diverse probability laws, is not new in microe-
conometric literature (Lancaster 1990). For example, this approach is taken in
shared-frailty models, which are the survival-data analogue to regression models
with random effects.1
  1 A frailty is a latent random effect that enters multiplicatively on the hazard function.




                                         Revista Colombiana de Estadística 39 (2016) 307–325

Conditional Duration Model and Unobserved Heterogeneity                                     309

    However, in a financial context, durations could also reflect the heterogeneity
of traders. Therefore, modelling the baseline distribution requires a mixture of
distributions. For example, Luca & Zuccolotto (2003), Luca & Gallo (2004) and
Luca & Gallo (2009) have proposed a link between statistical and financial aspects
within a set of distributional assumptions based on financial market microstructure
theories. These are related to a wide variety, or heterogeneity, of agents and also
of trading conditions (for example, different degrees of information possessed by
various traders and differing attitudes toward risk or budget constraints, among
others).
    These authors have proposed a mixture of distributions based on exponentials
in the context of ACD models, such as finite mixtures (i.e., the traders are assumed
to be divided into a finite number of groups),2 or infinite mixtures (i.e., when every
trader is considered to have an individual behaviour).
   However, unlike Luca & Zuccolotto (2003), our paper contributes to the fi-
nancial duration literature by considering another baseline distribution for ACD
models. More specifically, we propose an infinite mixture of non-exponential distri-
butions for reaction times, thus we draw attentran to a more complex unobserved
heterogeneity based on the intensity of duration we do this by using a reciprocal
inverse Gaussian distribution, which is related to the inverse Gaussian distribution.
   The reciprocal inverse Gaussian distribution, just like the connected inverse
Gaussian distribution, has a flexible shape and location in the positive support.
This shape is allowed to vary according to the position of the data.
    There are several motivations for doing so. First, the inverse Gaussian dis-
tribution (also known as the Wald distribution) has many applications in study-
ing lifetime and number of event occurrences (Lancaster 2003, Jørgensen 1982,
Zhang, Russell & Tsay 1983, Seshadri 1993, Chhikara & Folks 1989, Abraham
& Balakrishnan 1998, Balakrishnan & Nevzorov 2003, among others).3 When
modelling the unobserved heterogeneity of individuals, the inverse Gaussian dis-
tribution is also employed in frailty duration models (Hougard 1984, Hanagal &
Dabade 2013). However, the reciprocal of the inverse Gaussian distribution (which
is not commonly used by statisticians and has been little explored in the literature)
allows us to introduce more flexibility and tractability into the modelling of scale
parameters and to obtain closed form expressions for the infinite mixture.
    Second, following Grammig & Maurer (2000), it is well known that a good
candidate distribution should allow for both greater flexibility in modelling and
non-monotonic hazard shapes (i.e., QML estimation may provide very inaccurate
estimates if the baseline hazard function is non-monotonic). This argument sug-

   2 For example, Luca & Gallo (2009) suggest using a mixture of two distributions with time-

varying weights (Mixture ACD model). These authors show that the limitations of the standard
base model, and its inadequate modelling of the behaviour in the tail of the distribution, are
resolved by their model.
   3 This is a member of the natural exponential family of distributions and can be considered

an alternative to the exponential, log-normal, Frechet and Weibull distributions, among others.
However, it also provides flexibility in modelling when early occurrences of failure are dominant
in a lifetime distribution and the failure rate is expected to be non-monotonic.


                                          Revista Colombiana de Estadística 39 (2016) 307–325

310                                         Emilio Gómez-Déniz & Jorge V. Pérez-Rodríguez


gests that another way to increase the flexibility of ACD models is to use a mixture
of distributions.
    Finally, parameter estimates are very sensitive to the choice of mixing distri-
bution and hence it is important to consider one that takes this non-monotonicity
in the baseline hazard into consideration. The proposed approach facilitates the
natural parameterisation of a point process in terms of a conditional mean dura-
tion for the ACD model4 and provides estimates with a high degree of fit in terms
of the log likelihood function for the family of exponentials.
   The rest of this paper is organised as follows: in Section 2, we describe two
mixture models based on the exponential and gamma-reciprocal inverse Gaussian
ACD model. An empirical example is developed in Section 3, and some conclusions
are drawn in Section 4.


2. The New Mixture ACD Model
    Let xi = ti − ti−1 be the duration between two consecutive periods, where
ti is the time for period i, and the expected conditional duration for the ith
trade is expressed as ψi = E(xi | xi−1 , . . . , x1 ; θ1 ), where xi = ψi εi . Therefore,
standardised or excess durations are described by xi /ψi ≡ εi ∼ iid D(θ2 ), where
D is a general distribution defined within the interval (0, ∞) with E(εi ) = 1, and
where θ1 and θ2 are vectors of unknown parameters. ψi is called the conditional
duration and can be expressed as a linear function of past durations and lagged
conditional durations. Hence, the ACD (p, q) model can be written as:
                          q
                          X                 p
                                            X
              ψi = ω +          αj xi−j +         βj ψi−j ,   i = 1, 2, . . . , N,
                          j=1               j=1


where ω > 0, αj ≥ 0 and βj ≥ 0 for all j. Although not necessary, these sign
restrictions are convenient to ensure the positivity of ψi in the estimation.
    In this paper, we focus particularly on D(θ2 ). Any distribution defined as a
positive support can be specified for D to estimate ACD models. Simple distri-
butional assumptions for the conditional excess durations have been employed,
such as exponential and Weibull distributions (Engle & Russell 1998). How-
ever, these pdfs are far from capturing the most salient features of the errors,
namely their variability. Therefore, alternative hypotheses have been considered,
such as the Generalised gamma distribution (Lunde 1999), or the Burr distribu-
tion (Grammig & Maurer 2000) (both nest Weibull and exponential as special
cases), and other standardised financial duration distributions such as Birnbaum-
Saunders (Bhatti 2010). There are distributions which accommodate certain
stylised facts such as over-dispersion (standard deviation greater than the mean),
slowly-decreasing autocorrelations (Bauwens, Giot, Gramming & Veredas 2004) or
   4 In the basic formulation, ACD considers that all heterogeneity is captured by the condi-

tional expectation term, which is linear in lagged durations and exhibits persistence decay at an
exponential rate.


                                            Revista Colombiana de Estadística 39 (2016) 307–325

Conditional Duration Model and Unobserved Heterogeneity                            311

a finite and infinite mixture of distributions to model the behaviour in the tail of
the distribution (Luca & Zuccolotto 2003, Luca & Gallo 2004, Luca & Gallo 2009).
    Regarding the consistency of the estimation, (Engle & Russell 1998) show that
consistent and asymptotically Normal estimates of vector parameters are obtained
by maximising by QML. This is the case even if the distribution of the standardised
duration, D(θ2 ), is not exponential. Drost & Werker (2004) show that consistent
estimates are obtained when the QML estimation method is based on the standard
gamma family (including the exponential).
   In this paper, we examine exponential and gamma distributions with reciprocal
inverse Gaussian heterogeneity. Unlike Luca & Zuccolotto (2003), who studied an
exponential inverse gamma distribution, we take into account the non-monotonic
hazard function (i.e., that the intensity function conditional on past durations
could be constant, increasing or decreasing with respect to duration (like Grammig
& Maurer 2000).


2.1. The mixture model
    A mixture of distributions is usually employed for modelling situations with
characteristics that differ from those that would be anticipated under a simple
component distribution. This is what occurs with the exponential distribution,
where the variance is determined by the mean. For this reason, general families
of distributions, such as mixtures, are often taken as alternative models that offer
greater flexibility. Apart from this flexibility, a mixture model can be thought of
as a market which is heterogeneous in which the mixing distribution represents a
measure of this heterogeneity.
    Let the pdf of the gamma distribution be f (x) = θσ Γ(σ)  1
                                                                 xσ−1 e−x/θ , with a
scale parameter θ > 0 and shape parameter σ > 0. A new class of probability
distributions with a domain in IR + is now introduced by mixing the θ param-
eter with the reciprocal of the inverse Gaussian distribution. This family can
be considered as an alternative to the exponential-inverse Gaussian distribution
described in Bhattacharya & Kumar (1986) and Frangos & Karlis (2004), and
also to the gamma-generalised inverse Gaussian distribution proposed in Gómez-
Déniz, Calderín & Sarabia (2013). Distribution mixtures have often been used in
statistical research, especially in the construction of duration models (see Luca &
Zuccolotto 2003, Luca & Gallo 2004, Luca & Gallo 2009) because they make it
possible to model heterogeneity.
   It is straightforward to show that

                                (γz + δ)2
                                         
                      γ
           g(z) = √       exp −             ,   z > 0, γ > 0, δ > 0                (1)
                      2πz          2z

is the probability density function of the reciprocal of a variable distributed ac-
cording to the inverse Gaussian distribution with parameters γ > 0 and δ > 0.
That is, if Y , Y > 0, follows an inverse Gaussian distribution with parameters
γ > 0 and δ > 0, then the random variable Z = 1/Y follows the distribution

                                    Revista Colombiana de Estadística 39 (2016) 307–325

312                                         Emilio Gómez-Déniz & Jorge V. Pérez-Rodríguez


given in (1). See, for instance, Jørgensen, Seshadri & Whitmore (1991).5 Hence-
forth, when a positive random variable Z follows the pdf given in (1) we write
Z ∼ RIG(γ, δ) and X ∼ G(σ, θ) to denote that the random variable X follows
a gamma distribution. Additionally, the reciprocal inverse Gaussian distribution
can be derived, as the inverse Gaussian distribution, as a particular case of the
generalised inverse Gaussian distribution (see Mohtashami & Mohtashami 2011,
for details).
   We begin with the definition of the gamma-reciprocal inverse Gaussian distri-
bution.
Definition 1. A random variable X follows a gamma-reciprocal inverse Gaussian
distribution if it admits the following stochastic representation:
                         X | σ, θ   ∼   G(σ, θ)                                              (2)
                               θ    ∼   RIG(δ, γ),      θ ∈ Θ = (0, ∞),                      (3)
where σ, δ, γ > 0. Henceforth, this distribution is denoted by X ∼ GRIG(σ, δ, γ).

      The next result gives us closed expressions for the pdf of the new distribution.
Theorem 1. Let εi ∼ GRIG(σ, δ, γ), i.e. εi follow the representation given by
expressions (2)-(3). Then its pdf is given by:
                   r
                     2γ γ σ eγ δ σ−1            1/2−σ
         f (εi ) =              x    [φ(εi , δ)]      Kσ−1/2 (γφ(εi , δ)) ,   (4)
                     π Γ(σ)
                   √
where φ(εi , δ) = δ 2 + 2εi and Kν (z) represents the modified Bessel function of
the second kind (see Jørgensen 1982).

Proof . The pdf can be obtained directly by using the well-known compounding
formula
                                Z ∞
                      f (εi ) =     f (εi | θ)g(θ) dθ,                   (5)
                                        0

and by arranging the parameters.

   The mean and variance of the new distribution can also be obtained by com-
pounding and are given by
                                   σ(1 + γδ)
                E(εi )    = λ=               ,                                               (6)
                                      γ2
                                                                      
                               σ (σ + 1) γ 2 δ 2 + 3 + 3γδ − σ(γδ + 1)2
              var(εi )    =                                               .
                                                    γ4

    The next result gives the closed expression for the cumulative distribution
function (cdf) of this new distribution, in which the parameter σ is assumed to be
integer and known.
   5 Note that there are several different parameterizations of the inverse Gaussian distribution

(see, for example Zhang et al. 1983).


                                            Revista Colombiana de Estadística 39 (2016) 307–325

Conditional Duration Model and Unobserved Heterogeneity                                    313

Theorem 2. Let σ > 0 be an integer and known and εi ∼ GRIG(δ, γ), i.e. εi
follows the representation given by expressions (2)-(3). Then its cdf is given by:
                   r           σ−1
                     2 3/2 γ δ X (γx)j              1/2−j
     F (εi ) = 1 −     γ e              (φ(εi , δ))       Kj−1/2 (γφ(εi , δ)) . (7)
                     π         j=0
                                    j!


Proof . The cdf can be computed by using:
                              Z εi Z ∞
                    F (εi ) =          f (ti | θ)f (θ)dt dθ.
                                       0    0

Now, by applying Fubini’s theorem and taking into account the expression, for
integer values of σ,

                      Z εi                        σ−1
                                                  X (εi /θ)j e−εi /θ
                1             1 σ−1 −t/θ
                                t  e     dt = 1 −                    ,
               Γ(σ)    0     θσ                   j=0
                                                           j!

is satisfied (see for instance (Castillo, Hadi, Balakrishnan & Sarabia 2005), p. 82),
then the desired result is obtained after some algebra.


2.2. Two Simple Sub-Models
   Two simple sub-models obtained from the model above are now studied in some
detail.

2.2.1. The Exponential-Reciprocal Inverse Gaussian

    It is known that the exponential distribution is a particular case of the gamma
distribution and obtained by taking σ = 1 in (2). In this case, after the com-
pounding process with the reciprocal inverse Gaussian distribution we obtain the
exponential-inverse Gaussian distribution mixture, the pdf   p of which is obtained
                                                                π
from (4). It should be taken into account that K1/2 (z) = 2z      exp(−z) and thus,
after some simple algebra, we obtain
                                        γeγ δ
                           f (εi ) =             exp [−γφ(εi , δ)] ,                       (8)
                                       φ(εi , δ)
for εi > 0, δ > 0 and γ > 0, which are the heterogeneity parameters.
   It is straightforward to see that
                        d2                  2 + γφ(εi , δ)
                          2
                            (log f (εi )) =                > 0,
                       dx                     [φ(εi , δ)]4
and so the distribution is log-convex. Therefore, the cumulative distribution func-
tion, F (εi ), and the survival function, 1 − F (εi ) are also log-convex and the hazard
rate function is nonincreasing.

                                            Revista Colombiana de Estadística 39 (2016) 307–325

314                                   Emilio Gómez-Déniz & Jorge V. Pérez-Rodríguez


   To further investigate the properties of this mixture model, we examine the
behaviour of some parameters of interest.
   The mode is always at the origin of the support of the Distribution. Some pdf
curves are shown in Figure 1.

Figure 1: Some examples of the probability density function of the gamma-reciprocal
          inverse Gaussian mixture distribution for selected parameter values, δ = 0.5
          (thick), δ = 1 (dashed) and δ = 2 (dotdashed).




      The mean and the variance are given by

                                                 1+γδ
                             E(εi )   = κ=              ,                            (9)
                                                   γ2
                                          γ 2 δ 2 + 4γδ + 5
                           var(εi )   =                     .
                                                   γ4

                                      Revista Colombiana de Estadística 39 (2016) 307–325

Conditional Duration Model and Unobserved Heterogeneity                              315

    The survival function of the exponential-reciprocal inverse Gaussian mixture
distribution is obtained from (7). This gives:

                        F̄ (εi ) = exp {γ [δ − φ(εi , δ)]} .                        (10)

    By applying (8) in conjunction with (10) we obtain the hazard rate function
given by:
                                              γ
                                h(εi ) =             ,
                                           φ(εi , δ)
which is clearly decreasing, as expected from a mixture of the exponential distri-
bution.
    For many insurance and financial risks, the right-tail risk, representing low-
frequency and large-loss events, is usually measured in terms of the right-tail index
(Frangos & Karlis 2004), given by:
                                      Z ∞q
                                  1
                      ζ(εi ) =               F̄ (t) dt − 1.
                               E(εi ) 0

    In some computations, for the exponential-reciprocal inverse Gaussian mixture
distribution, this value is given by
                                                 2
                              ζ(εi ) = 1 +           ,
                                              1 + γδ
and, therefore a value larger than 1, which is that of the exponential distribution.
    Moreover, in recent years there has been increasing interest (especially in actu-
arial and financial settings) in computing quantiles of probability of the distribu-
tion of a particular risk. Two measures of risk that are of particular importance in
this framework are the value of risk (VaR) and the tail of the value of risk (TVaR);
see Furman & Zitikis (2008) for details. For the distribution we are considering,
these measures are obtained in simple forms, and are given by:
                                    "            2      #
                                  1         1           2
                       VaR(q) =        δ − log q − δ ,
                                  2         γ
                                                             
                                      q log q           1
                     TVaR(q) = µ +             1 + γδ − log q ,
                                        γ2              2

for 0 < q < 1.
    Finally, the mean residual life, which is defined as m(t) = E(X − t | x > t)
gives
                                      1
                            m(t) =       [1 + γφ(t)] .
                                      γ2

             d
   Because dt  m(t) > 0 for all t, the resulting mean residual life is an increasing
function on t.

                                      Revista Colombiana de Estadística 39 (2016) 307–325

316                                          Emilio Gómez-Déniz & Jorge V. Pérez-Rodríguez


2.2.2. The Gamma(2, θ)-Reciprocal Inverse Gaussian Distribution

    One of the disadvantages of employing the exponential-reciprocal inverse Gaus-
sian distribution is that, with this mixture, the hazard rate function decreases.
This problem can be overcome by considering the case in which σ = 2, which cor-
responds to the G(2, θ)-reciprocal inverse Gaussian mixture distribution, the pdf
of which is given by:

                         εi γeδγ
                                                 
                                           1
               f (εi ) = 2           γ+             exp [−γφ(εi , δ)] .       (11)
                        φ (εi , δ)      φ(εi , δ)

      The next result shows that the above distribution is unimodal.
Theorem 3. The density given in (11) is unimodal with a modal value satisfying
the following equation

       Ψ(εi ) = 2ε2i γ 2 − δ 2 [1 + γφ(εi , δ)] + x 1 + γ(γδ 2 + φ(εi , δ)) = 0.
                                                                          
                                                                                 (12)

Proof . By computing the derivative of (11) and equating it to zero, we obtain,
after some simple algebra, the equation given in (12). Now, taking into account
that Ψ(∞) = ∞, Ψ(0) = −δ 2 (1 + γδ) < 0 and the fact that
                                          3εi γ
                       Ψ0 (εi ) = 1 +              + γ 2 (4x + δ 2 ) > 0
                                         φ(εi , δ)
the theorem is proved.

      The mean and the variance are given by
                                        2(1 + γδ)
                  E(εi )    =   ϑ=                ,                                        (13)
                                            γ2
                                                                           !
                                                                             2
                                 2                                 1
                                                                   2
                var(εi )    =           3(γδ(γδ + 3) + 3) − 2δ γ +               .
                                 γ4                                δ

  Figure 1 shows some examples of the pdf of the gamma(2, θ)-reciprocal inverse
Gaussian mixture distribution for γ = 0.5 and γ = 2.
      Again, the survival function is obtained from (7). This gives
                                              
                                 1     εi
                  F̄ (εi ) = γ     +             exp {γ [δ − φ(εi , δ)]} .                 (14)
                                 γ   φ(εi , δ)

      From (11) and (14) can we obtain the hazard rate function, given by:
                                      γεi      1 + γφ(εi , δ)
                           h(εi ) =                                  .
                                       φ φ(εi , δ)[γ εi + φ(εi , δ)]

   This function is non-monotonic with respect to duration, as is to be expected
from a mixture of exponential distributions. Figure 2 shows some curves for this
hazard rate function for various parameter values.

                                             Revista Colombiana de Estadística 39 (2016) 307–325

Conditional Duration Model and Unobserved Heterogeneity                                   317

Figure 2: Some examples of the hazard rate function of the gamma(2, θ)-reciprocal
          inverse Gaussian mixture distribution for various parameter values, δ = 0.5
          (thick), δ = 1 (dashed) and δ = 2 (dotdashed).




2.3. Likelihood of the Conditional Duration
   With the usual change of variable proposed in duration models, we obtain the
conditional pdf of xi given ψi . From this, the log-likelihood function is given by

                                                                               1
  log f (xi | ψi )   =   log σ − 2 log(Γ(σ)) + log δ − log M − log ψi − log 2
                                                                        2 
                              1 σ                  2ε i φ                    εi φ
                         +      −       log δ 2 +           + (σ − 1) log
                              4    2                ψi                        ψi
                                    
                                   1
                         + σ−          (2 log γ + log [φ(xi λ/ψi , δ)] − log 2) + γδ
                                   2
                                                                                      
                                                                      M  −1
                                  1                                      X
                         + log        + 1 + log χ(ϕ) + χ(ϕ) + 2              χ(ϕ + hj) ,
                                  γδ                                     j=0


where λ is given in (6). See Appendix A for details of the other elements of this
expression.
    For σ = 1, when applying the infinite exponential mixture, the conditional pdf
of xi given ψi , is

                                      γκ exp {γ [δ − φ(εi κ/ψi , δ)]}
                     f (xi | ψi ) =                                   ,
                                      ψi        φ(εi κ/ψi , δ)

where κ is given in (9).
   The log-likelihood function is then

              log f (xi | ψi )   =     log(1 + γδ) − log γ − log ψi
                                                           1
                                 +     γ [φ(xi κ/ψi , δ)] − log [φ(xi κ/ψi , δ)] .
                                                           2

  As an alternative to the maximum likelihood method of estimation, a maxi-
mum expectation algorithm could be straightforwardly developed, to facilitate the

                                           Revista Colombiana de Estadística 39 (2016) 307–325

318                                   Emilio Gómez-Déniz & Jorge V. Pérez-Rodríguez


estimation procedure. In this respect, see Frangos & Karlis (2004) and Gómez-
Déniz et al. (2013) who addressed the estimation by using the exponential-inverse
Gaussian distribution and the gamma-inverse Gaussian distribution, respectively.
   Since we do not provide the estimated parameters or the Fisher’s information
matrix in closed-form expression the next subsection includes a bootstrapping tech-
nique. This allows for measures of accuracy (defined in terms of bias and standard
deviation) to be assigned toof the estimated parameters of the two distributions,
the exponential-reciprocal inverse Gaussian and the gamma(2, θ)-reciprocal inverse
Gaussian distribution.


2.4. Simulation Experiment
   in this section we present some simulation results that were obtained by the
bootstrap experiment. The proposed of therm is to study the behavior of the
maximum likelihood estimators. In this work we have used the Mathematica
package to create random variates directly from the pdf’s (8) and (11).
    We have considered three different sets of model parameters (see Table 1) for
the case of the exponential-reciprocal inverse Gaussian distribution and two sets
of model parameters in the case of the gamma(2, θ)-reciprocal inverse Gaussian
distribution (see Table 2). In all the cases we have used n = 500, 1000 and 200.
We have proposed the average estimates and square root of the mean squared
errors based on 1000 replications. The results are reported in Tables 1 and 2. As
the sample size increases, the biases and the mean squared errors decrease, which
verifies the consistency properties of maximum likelihood estimates.

Table 1: Average estimates (first row) and the square root of the mean squared errors
         (second row) for the exponential-reciprocal inverse Gaussian distribution.
             n    δ = 0.5    γ=1       δ=3        γ=2      δ = 0.75    γ=2
            500   0.66260   1.07758   0.73602    1.97440   2.34040    1.6209
                  0.11380   0.07977   0.12875    0.18829   0.55175    0.28380
           1000   0.50187   0.95921   2.91440    1.95555   0.71118    2.03135
                  0.06443   0.04774   0.75168    0.39719   0.07792    0.13000
           2000   0.50685   1.02411   3.36927    2.20952   0.80300    2.04216
                  0.04532   0.03371   0.54636    0.29348   0.08065    0.11565



Table 2: Average estimates (first row) and the square root of the mean squared errors
         (second row) for the gamma(2, θ)-reciprocal inverse Gaussian distribution.
                      n     δ = 0.5     γ=1       δ=1      γ = 0.5
                     500    0.53553    1.03282   0.79510   0.45954
                            0.07671    0.05190   0.09765   0.01928
                     1000   0.45411    0.96222   0.99347   0.53990
                            0.03952    0.03621   0.08912   0.01931
                     2000   0.51444    0.99679   0.94204   0.48733
                            0.03000    0.02406   0.06026   0.01189




                                      Revista Colombiana de Estadística 39 (2016) 307–325

Conditional Duration Model and Unobserved Heterogeneity                                     319

3. An Empirical Example
    As an illustration of the application of our specification to duration models, we
estimated a simple ACD model using data obtained from the transaction durations
of IBM stock on five consecutive trading days from November 1 to November 7,
1990 (Tsay 2002). Focusing on positive transaction durations, we obtained 3534
observations. In addition, the data were adjusted by removing the deterministic
component. Thus, a total of 3534 positive adjusted durations were used.
    To compare several distribution results, we examined exponential, Weibull,
Burr, infinite mixture of (Luca & Zuccolotto 2003) and exponential-inverse Gaus-
sian ACD models, together with the density function and the logarithm of like-
lihood for various duration models (see Table 3). Let Θ be a vector of unknown
parameters to be estimated. Then, the density functions and the logarithm of each
of the duration models used in this paper are as follows:
                                   N                
                                  X               xi
       Exponential: `(Θ, xi ) =       − log ψi −       ,
                                  i=1
                                                  ψi
                                   N                           γ 
                                  X                           xi   xi
             Weibull: `(Θ, xi ) =     log γ − log xi + γ log     −       ,
                                  i=1
                                                              φi   φi
                             −1
where φi = ψi [Γ (1 + 1/γ)]        .

                                                N
                                                X
       Generalised gamma: `(Θ, xi ) =                 [log γ − log Γ(δ) + (δγ − 1) log xi
                                                i=1
                                                                                γ 
                                                                            xi
                                             − δγ(log φ + log ψi ) −                    ,
                                                                           φψi
       where φ = Γ(δ)/Γ(δ + 1/γ),


                                       N
                                       X
               Burr: `(Θ, xi ) =             [log κ − κ log i + (κ − 1) log xi
                                       i=1
                                                                 
                                           1               2 −κ κ
                                   −          + 1 log(1 + σ i xi ) ,
                                           σ2
                2 1+1/κ      2
                  )
where i = ψiΓ(σ 1+   Γ(1/σ +1)
                                   .
               ( κ1 )Γ( σ12 − κ1 )
   For the infinite exponential mixture of Luca & Zuccolotto (2003),
                             N
                             X
               `(Θ, xi ) =         [(θ1 + 1) log θ1 − log ψi + log(θ1 + 1)
                             i=1
                                                          
                                              xi
                          − (θ1 + 2) log θ1 +                   ,
                                              ψi


                                             Revista Colombiana de Estadística 39 (2016) 307–325

320                                                        Emilio Gómez-Déniz & Jorge V. Pérez-Rodríguez


    Table 3 shows the estimated parameters, with the asymptotic t-statistics cor-
rected to take into consideration the presence of unobserved heteroskedasticity,
and, also, the value of the logarithm of maximum likelihood.


Table 3: Quasi maximum likelihood estimates, statistics and misspecification tests of
         the different ACD(1,1) models.
                    Exponential     Weibull     Generalised        Burr       Infinite     Exponential-reciprocal   Gamma-reciprocal
                                                 Gamma                      exponentials     inverse Gaussian       inverse Gaussian
        δ                                         4.0689                                           1.7748                 0.401
                                                   (5.66)                                         (15.47)                (21.32)
        γ                            0.8788       0.4038                                           1.6082
                                     (78.48)      (10.14)                                         (15.47)
        κ                                                         0.9812
                                                                  (60.21)
       σ2                                                         0.1885
                                                                   (5.81)
        σ                                                                                                                0.5767
                                                                                                                        (188.24)
       θ1                                                                     3.7437
                                                                               (8.81)
        ω               0.1803      0.1687         0.1411        0.1119       0.1177              0.1470                0.2727
                        (2.35)       (2.33)        (3.01)        (2.82)        (2.71)              (2.87)                (2.78)
       α1                0.065       0.0639        0.0627        0.0499       0.0573              0.0637                0.1165
                        (4.93)       (5.39)        (5.75)        (5.70)        (5.54)              (6.48)                (6.28)
       β1               0.8811      0.8852         0.8968        0.8966       0.9081              0.8933                0.8907
                        (27.9)      (30.61)       (47.59)       (42.69)       (43.77)             (44.34)               (41.19)
      `max            −7688.09     −7583.66      −7633.65      −7615.51      −7613.70            −7610.02              −6992.73
      AIC               4.3526      4.3224         4.2947        4.3127       4.3111              4.3096                3.9602
      BIC               4.3579      4.3294         4.3034        4.3214       4.3181              4.3183                3.9690
   E(xi | ψi )          1.0014      1.0058         0.9894        1.2457       0.9943              0.9961                0.9667
     σxi |ψi            1.2276      1.2336         1.2157        1.2629       1.2095              1.2234                1.1883
   MSExi |ψi            13.701      13.658         13.860        13.373       16.368              16.393                16.415
   MAExi |ψi            2.2906      2.2862         2.3025        2.2624       2.7582              2.7593                2.7928
Excess-Dispersion       4.7728       4.8365        4.5032        5.2195       4.7384              4.6346                4.0722
      Q(1)              0.0680      0.0850         0.1566         0.146        0.376              0.1125                0.0998
                        [0.79]       [0.77]        [0.69]        [0.70]        [0.54]              [0.74]                [0.75]
      Q(5)              2.8626      2.8591         2.7562        2.9510        3.043              2.8385                2.6580
                        [0.72]       [0.72]        [0.74]        [0.70]        [0.69]              [0.72]                [0.75]
      Q(10)             5.1054      5.1193         5.1449         5.147        4.784              5.0560                5.3740
                        [0.88]       [0.88]        [0.88]        [0.88]        [0.90]              [0.89]                [0.86]
      Q(20)            11.2538      11.0604       10.6352        10.742       10.658              10.479                10.787
                        [0.94]       [0.94]        [0.95]        [0.95]        [0.95]              [0.96]                [0.95]
Note: The t-values are shown in parentheses and the p-values in brackets.




    Because the tests for ACD models involve basic residual examinations that test
for the functional form of the conditional mean duration or test for the distribution
of the error term, Table 3 shows the following statistics. They are based on
standardised durations: mean, standard deviation, mean square error (MSExi |ψi ),
mean absolute error (MAExi |ψi ), and excess-dispersion. Thus,


                                                              N
                                                1 X xi
                               E(xi | ψi ) =             ,
                                                N i=1 ψi
                                                v
                                                u
                                                u1 X N                    2
                                                           xi
                                      σxi |ψi = t             − E(xi | ψi ) ,
                                                  N i=1 ψi
                                                              N
                                                      1 X             2
                                MSExi |ψi =                 (xi − ψi ) ,
                                                      N i=1


                                                          Revista Colombiana de Estadística 39 (2016) 307–325

Conditional Duration Model and Unobserved Heterogeneity                                                                                        321



                                                                                       N
                                                                               1 X
                                                       MAExi |ψi =                   | xi − ψi |,
                                                                               N i=1
                                                                              √        σx2i |ψi − 1
                                           Excess-dispersion =                     N                       .
                                                                                       σ(xi |ψi −1)2

   We also include the Akaike and Schwarz Bayesian information criteria (AIC
and BIC, respectively) and the Ljung-Box statistic (Q(k)) for k = 1, k = 5, k = 10
and k = 20 lags for autocorrelation in the standardised residuals.
    In general, these results indicate that all the parameters, in each of the models
estimated, are statistically significant at any conventional level of significance, but
also that the standardised residual does not present serial dependence. For exam-
ple, the heterogeneity parameters for the gamma-reciprocal inverse Gaussian are
positive (γ, δ > 0), but they are also positive in the infinite exponential of (Luca
& Zuccolotto 2003)’s model (θ1 > 0). Henceforth, misspecification tests based on
the autocorrelation of standardised residuals indicate the non-presence of serial
dependence. All of the models examined present good behaviour in their stan-
dardised residuals, and wherefore, the models cannot be compared by means of
this portmanteau test. Additionally, in terms of the log-likelihood measures and of
AIC and BIC information criteria, the gamma-reciprocal inverse Gaussian distri-
bution achieves the best fit. Moreover, with respect to statistical error measures,
the gamma-reciprocal inverse Gaussian has the lowest excess dispersion. Finally,
the durations show overdispersion phenomena in all models, as is shown by the
fact that the mean value is lower than the variance.
    Finally, we used the Vuong closeness test for model selection: a likelihood-
ratio-type test based on the Kullback-Leibler information criterion. This statistic
makes probabilistic statements about two models and the limiting distribution is
standard Normal. Table 4 shows the Vuong statistic results for our non-nested
models. Model 0 is shown in the rows and Model 1 in the columns. As most of
the results are both negative and large, Model 1 is favoured, and, Therefore, so we
conclude that the gamma-reciprocal inverse Gaussian model outperforms the other
models at all conventional significance levels. The only exception is the Weibull
model as 0. In this case, the results are inconclusive.
                              Table 4: Vuong statistic test for nonnested models
                                             Exponential   Weibull   Generalised   Burr       Infinite     Exponential-reciprocal   Gamma-reciprocal
                                                                      Gamma                 exponentials     inverse Gaussian       inverse Gaussian
 Exponential                                      -        −3.40       −3.92       −4.35       −6.15               −4.48                 −18.35
                                                           [0.00]       [0.00]     [0.00]      [0.00]              [0.00]                 [0.00]
 Weibull                                                      -        −0.39       −0.12       −0.17               −0.16                  −0.16
                                                                        [0.35]     [0.45]      [0.43]              [0.43]                 [0.43]
 Generalized Gamma                                                         -        6.08        5.03                7.54                 −24.71
                                                                                   [0.00]      [0.00]              [0.00]                 [0.00]
 Burr                                                                                 -        −2.48               −3.22                 −24.26
                                                                                               [0.01]              [0.00]                 [0.00]
 Infinite exponentials                                                                            -                 0.47                 −23.74
                                                                                                                   [0.32]                 [0.00]
 Exponential-reciprocal inverse Gaussian                                                                              -                  −25.20
                                                                                                                                          [0.00]
 Gamma-reciprocal inverse Gaussian                                                                                                           -

 Note: The p-values are shown in brackets.




                                                                    Revista Colombiana de Estadística 39 (2016) 307–325

322                                  Emilio Gómez-Déniz & Jorge V. Pérez-Rodríguez


4. Conclusions
   In this paper, we have proposed a baseline ACD model based on a mixture of
gamma and reciprocal inverse Gaussian distributions to take into account the more
complex unobserved heterogeneity arising from the variety of agents and trading
conditions in financial markets.
    The closed form solution obtained for the mixture distribution means that our
proposed model is easy to fit. In this respect, the statistical measures used, the
autocorrelation tests performed on standardised residuals and the Vuong closeness
test conducted for non-nested models show that the gamma-reciprocal inverse
Gaussian ACD model performs better than those without heterogeneity, such as
the exponential, Weibull, and Burr models, but also with regard to other infinite
exponential mixtures. Therefore, we conclude that our model characterises the
behaviour of conditional durations reasonably well.


Acknowledgements
   The authors are indebted to the anonymous referee for helpful comments which,
without doubt, helped to improve an earlier version of the paper. The authors
thank to the Ministerio de Economía y Competitividad (EGD project ECO2013-
47092 and JVPR project ECO2011-23189) for partial support of this work.

                     Received: June 2015 — Accepted: March 2016
                                                                   




References
Abraham, B. & Balakrishnan, N. (1998), ‘Inverse gaussian autoregressive models’, Working Paper. University of Waterloo.
Balakrishnan, N. & Nevzorov, V. (2003), A Primer on Statistical Distributions, John Wiley and Sons, New York.
Bauwens, L. & Giot, P. (2000), ‘The logarithmic acd model: an application to the bid-ask quote process of three nyse stocks’, Annales d’Economie et de Statistique 60, 117–150.
Bauwens, L., Giot, P., Gramming, J. & Veredas, D. (2004), ‘Comparison of financial duration models via density forecasts’, International Journal of Forecasting 20, 598–609.
Bauwens, L. & Veredas, D. (2004), ‘The stochastic conditional duration model: a latent factor model for the analysis of financial durations’, Journal of Econometrics 119, 381–412.
Bhattacharya, S. & Kumar, S. (1986), ‘E-ig model in life testing’, Calcutta Statistical Association Bulletin 35, 85–90.
Bhatti, C. R. (2010), ‘The birnbaum-saunders autoregressive conditional duration model’, Mathematics and Computers in Simulation 79, 2250–2257.
Castillo, E., Hadi, A., Balakrishnan, N. & Sarabia, J. (2005), Extreme Value and Related Models with Applications in Engineering and Science, Wiley.
Chhikara, R. & Folks, T. (1989), The inverse Gaussian Distribution, Marcel Dekker, New York.
Clark, P. (1973), ‘A subordinated stochastic process model with finite variance for speculative prices’, Econometrica 41, 135–156.
Drost, F. C. & Werker, B. J. M. (2004), ‘Semiparametric duration models’, Journal of Business and Economic Statistics 22, 40–50.
Engle, R. & Russell, J. (1998), ‘Autoregressive conditional duration: a new for irregularly-spaced transaction data’, Econometrica 66, 1127–1162.
Fernandes, M. & Grammig, J. (2006), ‘A family of autoregressive conditional duration models’, Journal of Econometrics 130, 1–23.
Frangos, N. & Karlis, D. (2004), ‘Modelling losses using an exponential-inverse gaussian distribution’, Insurance: Mathematics and Economics 35, 53–67.
Furman, E. & Zitikis, R. (2008), ‘Weighted risk capital allocations’, Insurance: Mathematics and Economics 43(2), 263–269.
Ghysels, E. (2000), ‘Some econometric recipes for high-frequency data cooking’, Journal of Business & Economic Statistics 18, 154–163.
Ghysels, E., Gouriéroux, C. & Jasiak, J. (2004), ‘Stochastic volatility duration’, Journal of Econometrics 119, 413–433.
Gómez-Déniz, E., Calderín, E. & Sarabia, J. (2013), ‘Gamma-generalized inverse gaussian class of distributions with applications’, Communications in Statistics–Theory and Methods 42, 919–933.
Grammig, J. & Maurer, K. (2000), ‘Non-monotonic hazard functions and the autoregressive conditional duration model’, Econometrics Journal 3, 16–38.
Hanagal, D. & Dabade, A. (2013), ‘Modeling inverse Gaussian frailty model for bivariate survival data’, Communication in Statistics-Theory and Methods 42, 3744–3769.
Hougard, P. (1984), ‘Life table methods for heterogeneous populations: distributions describing the heterogeneity’, Biometrika 71, 75–83.
Jørgensen, B. (1982), Statistical Properties of the Generalized Inverse Gaussian Distribution. Lecture Notes in Statistics, Springer-Verlag, New York.
Jørgensen, B., Seshadri, V. & Whitmore, G. (1991), ‘On the mixture of the inverse gaussian distribution with its complementary reciprocal’, Scandinavian Journal of Statistics 18, 77–89.
Lancaster, T. (1990), The Econometric Analysis of Transition Data, Cambridge University Press.
Lancaster, T. (2003), ‘A stochastic model for the duration of a strike’, Journal of the Royal Statistical Society, Series A 135(2), 257–271.
Luca, G. D. & Gallo, G. (2004), ‘Mixture processes for intradaily financial durations’, Studies in Nonlinear Dynamics and Econometrics 8(2), 1–18.
Luca, G. D. & Gallo, G. (2009), ‘Time-varying mixing weights in mixture autoregressive conditional duration models’, Econometric Reviews 28(1), 102–120.
Luca, G. D. & Zuccolotto, P. (2003), ‘Finite and infinite mixtures for financial durations’, Metron 61, 431–455.
Lunde, A. (1999), ‘A generalized Gamma autoregressive conditional duration model’, Discussion Paper. Aalborg Universiteit.
Mohtashami, G. R. & Mohtashami, H. A. (2011), ‘Log-concavity property for some well-known distributions’, Surveys in Mathematics and its Applications 6, 203–219.
O’Hara, M. (1995), Market Microstruture Theory, Basil Blackwell Inc., Oxford.
Seshadri, V. (1993), The Inverse Gaussian Distribution: A Case Study in Exponential Families, Oxford Science Publications.
Tsay, R. (2002), Analysis of financial time series, John Wiley & Sons.
Zhang, M., Russell, J. & Tsay, R. (1983), ‘The inverse gaussian distribution: Some properties and characterizations’, The Canadian Journal of Statistics 11, 131–136.
Zhang, M., Russell, J. & Tsay, R. (2001), ‘A nonlinear autoregressive conditional duration model with applications to financial transaction data’, Journal of Econometrics 104(7), 179–207.


Appendix
      The integral representation of the Bessel function of the second kind is given
by:
                              √      Z ∞
                           zν π
                Kν (z) = ν               e−zt (t2 − 1)ν−1/2 dt,
                        2 Γ (ν + 1/2) 1

which, after changing the variable t = 1/y, can be rewritten as
                               √      Z 1
                            zν π          (1 − y 2 )ν−1/2
                                                                  
                                                                 z
             Kν (z) =                                     exp  −     dy.
                        2ν Γ (ν + 1/2) 0      y 2ν+1             y

                                       Revista Colombiana de Estadística 39 (2016) 307–325

Conditional Duration Model and Unobserved Heterogeneity                             325

    The latter integral can now be approximated by using the composite trape-
zoidal rule:
                                                                           
Z 1                                                           M
    (1 − y 2 )ν−1/2                y−y
                           
                          z             χ2 (y) + χ2 (y) + 2
                                                             X
                    exp −     dy ≈                               χ2 (y + jh),
 0      y 2ν+1            y        2M                        j=0


where y and y are appropriate values that are near to 0 and 1, respectively,

                                (1 − y 2 )ν−1/2
                                                         
                                                        z
                     χ2 (y) =                   exp   −
                                    y 2ν+1              y

M is the number of grid points considered and h = 1/M .




                                     Revista Colombiana de Estadística 39 (2016) 307–325

