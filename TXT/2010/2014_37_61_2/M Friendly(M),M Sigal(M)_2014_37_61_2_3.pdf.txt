Recent Advances in Visualizing Multivariate Linear Models. Avances recientes para la visualización de modelos lineales multivariados
Faculty of Health, York University, Toronto, Canada
Abstract
This paper reviews our work in the development of visualization methods (implemented in R) for understanding and interpreting the effects of predictors in multivariate linear models (MLMs) of the form Y = XB + U , and some of their recent extensions. We begin with a description of and examples from the Hypothesis-error (HE) plots framework (utilizing the heplots package), wherein multivariate tests can be visualized via ellipsoids in 2D, 3D or all pairwise views for the Hypothesis and Error Sum of Squares and Products (SSP) matrices used in hypothesis tests. Such HE plots provide visual tests of significance: a term is significant by Roy’s test if and only if its H ellipsoid projects somewhere outside the E ellipsoid. These ideas extend naturally to repeated measures designs in the multivariate context. When the rank of the hypothesis matrix for a term exceeds 2, these effects can also be visualized in a reduced-rank canonical space via the candisc package, which also provides new data plots for canonical correlation problems. Finally, we discuss some recent work-in-progress: the extension of these methods to robust MLMs, development of generalizations of influence measures and diagnostic plots for MLMs (in the mvinfluence package).
Key words: Graphics, Multivariate Analysis, Software, Visualization.
Resumen
Este artículo hace una revisión de los desarrollos recientes en métodos de visualización (implementados en R) para la comprensión e interpretación de los efectos de los predictores en modelos lineales multivariados (MLMs) de la forma Y = XB + U y sus extensiones recientes. Comenzamos con una descripción y ejemplos de los gráficos de HipótesisError (HE), (utilizando el paquete heplots) en los cuales los tests multivariados son visualizados vía elipsoides en 2D, 3D o todas las vistas pareadas de las matrices de sumas de cuadrados y productos (SSP por sus siglas en inglés) de Hipótesis y Error. Las gráficas HE permiten pruebas de significancia visuales: un término es significativo en el test de Roy si y solo si su elipsoide H es proyectado fuera del elipsoide E. Estas ideas se extienden a diseños de medidas repetidas en el contexto multivariado. Cuando el rango de la matriz de hipótesis para un término es mayor a 2, estos efectos pueden ser visualizados en un espacio canónico de rango reducido vía el paquete candisc, que a su vez también permite nuevos gráficos para problemas de correlación canónica. Finalmente, se discuten algunas áreas de investigación en desarrollo: la extensión de estos métodos a MLMs robustos, generalizaciones de las medidas de influencia y gráficas de diagnóstico para MLMs (en el paquete mvinfluence).
Palabras clave: análisis multivariado, gráficas, software, visualización.



1. Introduction
    Multivariate response data are very common in applied research. A research out-
come (e.g., depression, job satisfaction, academic achievement, childhood attention
deficit hypheractivily disorders-ADHD) may have several observed measurement
scales or related aspects. In this framework, the primary concern of the researcher
is to ascertain the impact of potential predictors on two or more response vari-
ables. For example, if adolescent academic achievement is measured by reading,
mathematics, science, and history scores, do predictors such as parent encourage-
ment, socioeconomic status and school environmental variables affect all of these
outcomes? And, do they affect these outcomes in similar or different ways?
    Statistically, this is easy, because the classical univariate response model for
ANOVA and regression, y = Xβ + u, with u ∼ N (0, σ 2 I) generalizes directly
to an analogous multivariate linear model (MLM), Y = XB + U for multiple
responses, Y = (y1 , y2 , . . . , yp ). Happily as well, hypothesis tests for the MLM are
also straight-forward generalizations of the familiar F and t tests for univariate
response models.
    However, due to the possibly high-dimensional nature of the data, visualizations
for multivariate response models are not as straightforward as they are for simpler,
univariate models, either for understanding the effects of predictors, model param-
eters, or for standard model diagnostics, such as influence plots. Consequently,
the results of such studies are often discussed solely in terms of coefficients and
significance, and visualizations of relationships are presented for one response
variable at a time.

                                        Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                          263

    This is unfortunate, because visualization affords us a window to truly see what
is happening in our data, and can aid in interpretation, yet the univariate graphical
methods cannot show the important relations among the multivariate responses.
The aim of this paper is to present a few methods that are currently employed for
the visualization of high-dimensional data, and then review a series of methods we
have worked on to apply these methods to MLMs. These extensions involve the
Hypothesis-Error (HE) plot framework and the use of rank reduction, and can be
utilized under a range of circumstances.
    The plan of this paper is as follows: In Section 2, we illustrate three basic
techniques that can be utilized in presentation graphics to enhance the usefulness
and applicability of traditional statistical graphic displays for multivariate data.
Next, Section 3 describes the framework for generating HE plots, that are useful
for visualizing the relationships found in MLMs. The idea of low-dimensional
visualization introduced in Section 2.2 is extended to MLMs in Section 4. Finally,
in Section 5, we describe some recent extensions of these methods, designed to make
graphical methods for MLMs more closely approximate the range of techniques
available for univariate response models.


2. Basic Approaches to Visualizing Multivariate
   Data
    Attempts to visualize multivariate data using static graphs almost always have
to proceed by reducing the complexity of the data to what can be shown on a 2D
page or screen image. The most common methods involve a pairwise display of
bivariate relationships in a scatterplot matrix and various dimension-reduction
techniques, as we illustrate below.
    An important adjunct to these basic ideas is the use of plot annotations to
highlight important features of the data or the relationships among variables that
might not be seen otherwise or as readily. Another consequential idea is the use of
plot summaries to suppress some details of the data that obscure the features we
want to see.
    To frame our approach in a general context, we begin with some examples of
visualizations of the well-known iris dataset, made famous by Fisher (1936). This
contains data on measurements of four characteristics of iris flowers (sepal length
and width, and petal length and width), for three species of the flower (setosa,
virginica, and versicolor).


2.1. Bivariate Views: Scatterplot Matrices
   One basic method often employed when investigating the relationship between
multiple response variables is to generate a scatterplot matrix, which features every
possible pairwise relationship between the variables.
   These allow us to notice trends between the response categories, and can be
annotated to include more information, such as via shading to differentiate between

                                    Revista Colombiana de Estadística 37 (2014) 261–283

264                                                      Michael Friendly & Matthew Sigal


levels of a categorical variable, data ellipses for visualizing confidence intervals, or
through the addition of simple regression lines. In each case, the analyst gets to
observe how each variable relates to the others. For example, see Figure 1 for a
scatterplot matrix concerning the four variables in the iris dataset, annotated with
68% data ellipses and simple regression lines for each type of flower.
                       79




            SepalLen

       43
                                            44




                                 SepalWid

                            20
                                                                 69




                                                      PetalLen

                                                 10
                                                                                     25




                                                                          PetalWid

                                                                      1


Figure 1: An enhanced scatterplot matrix, showing linear regression lines and 68% data
          ellipses by iris species, for all pairs of variables in the iris dataset.

    However, this pairwise display does not yield any information on how the
variables interact within a higher dimensional space. With three variables, we can
no longer simultaneously plot and print the simple raw data on a static graphic,
and must utilize software to view an interactive data cloud that can be rotated.
Yet, with more variables, even this approach fails.


2.2. Low-Dimensional Views: Biplots
   One way to understand how three or more dependent variables are related
at once in a static graphic is to map the data into a low-dimensional space that
preserves as much information in the data as possible. One such technique is the
biplot (Gabriel 1971, Gabriel 1981, Gower, Lubbe & Roux 2011), which projects

                                       Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                                                                       265

the data into a 2D (or 3D) space accounting for the largest amount of variance in
the data. The name “biplot” comes from the fact that this technique displays both
the observations and the variables in a single, joint plot.
    The standard biplot is essentially based on a principal components (or singular
value) decomposition, plotting the component scores for the observations on the
first two (or three) components. On such a plot, vectors (component loadings)
are drawn for each variable that indicate the relationship they hold with each of
the components. For example, see Figure 2. In this plot, one can observe that
petal length and width are strongly related to differentiating between the species
on the first component (plotted along the X axis), while sepal width differentiates
between species on the vertical axis. These two dimensions account for 95.8% of
the variance of the four iris variables, ensuring the adequacy of this visual summary.
In less structured data, when the two dimensions account for less variance, the
biplot still provides a useful 2D summary between the data, the variables, and the
strongest available components. See Gower et al. (2011) for a wider presentation
on this topic.
                            1.0




                                                                ●




                                                            ●
                                                           ●
                            0.5




                                                                         ●●
                                                                    ●●                    ●
                                                           ●
                                                                                      ●
                                          setosa                     ●●
                                                                    ●
                                                                ●●
                                                                     ●      ●
                                                                     ●
                                                                   ●●
             PC2 (22.85%)




                                                                    ●●    ●
                                                                ● ● ●●
                                                                       ●
                                                                    ●
                                                                 ●● ● ●●● ●
                            0.0




                                                                            ●
                                                                ● ● ●● ●                                         Petal.Length
                                                                                                                 ●

                                             ●                                    ●
                                                                                              ●   ●
                                                                                                                ●Petal.Width
                                                                              ●
                                                                                  ●●
                                                                              ●           ●
                                                                              ●
                                                                          ●
                                                                          versicolor
                                                                              ●
                                                                                                            ●   Sepal.Length
                            −0.5




                                                                                                  virginica

                                                   ●   Sepal.Width
                            −1.0




                                   −1.0    −0.5                 0.0                                   0.5                 1.0

                                                        PC1 (72.96%)

Figure 2: A biplot, visualizing the first two components from a PCA of the iris dataset.
          Data ellipses show the covariance structure for each species and for the total
          sample. Vectors show the projections of the original variables in this space.




                                                   Revista Colombiana de Estadística 37 (2014) 261–283

266                                                    Michael Friendly & Matthew Sigal


2.3. Visual Summaries: Data Ellipses
    The data ellipse (Monette 1990) (or concentration ellipse, Dempster, 1969, Ch.
7) provides a remarkably simple and effective display for viewing and understanding
bivariate relationships in multivariate data. The data ellipse is typically used to
add a visual summary to a scatterplot, indicating the means, standard deviations,
correlation, and slope of the regression line for two variables. See Friendly, Monette
& Fox (2013) for a complete discussion of the role of ellipsoids in statistical data
visualization.
    Formally, for two variables, Y1 , Y2 , the sample data ellipse Ec of size c is
defined as the set of points y = (y1 , y2 )T whose squared Mahalanobis distance,
D2 (y) = (y − ȳ)T S −1 (y − ȳ), from the means, ȳ, is less than or equal to c2 ,

                    Ec (y; S, ȳ) ≡ {y : (y − ȳ)T S −1 (y − ȳ) ≤ c2 },              (1)

where S is the sample variance-covariance matrix,
                                          n
                                          X
                         S = (n − 1)−1      (yi − ȳ)T (yi − ȳ)
                                          i=1


      When y is (at least approximately) bivariate normal, D2 (y) has a large-sample
χ22 distribution (χ2 with 2 df), so taking c2 = χ22 (0.68) = 2.28 gives a “1 standard
deviation bivariate ellipse”, an analog of the standard interval ȳ ± 1s, while
c2 = χ22 (0.95) = 5.99 ≈ 6 gives a data ellipse of 95% coverage. A bivariate ellipse of
≈ 40% coverage has the property that its shadow on the y1 or y2 axes (or any linear
combination of y1 and y2 ) corresponds to a univariate ȳ ± 1s interval. These ideas
generalize readily to p-dimensional ellipsoids, and we will use the term “ellipsoid”
below to cover all cases.
    Thus, in Figure 1, the data ellipses show clearly how the means, variances,
correlations, and regression slopes differ systematically across the three iris species
in all pairwise plots. The iris setosa flowers (in blue) are not only smaller on
all variables than the other species, but its variances are also smaller, and the
correlations differ from those of the other species.
    Similarly, in the reduced-rank principal component analysis (PCA) view shown
in Figure 2, you can see that the component scores are uncorrelated for setosa but
slightly negatively correlated for the other two species. The data ellipse for the
total sample (ignoring species), shows that the two components, PC1 and PC2,
are of course uncorrelated, as guaranteed in PCA. The variable vectors in this
plot show that PC1 is largely determined by three of the variables while PC2 is
determined mainly by sepal width.


3. Hypothesis-Error (HE) Plots
    Hypothesis-Error (HE) plots build upon the idea of the data ellipse, but attempt
to also display indicators of significance and effect size for predictors (Friendly 2007),

                                       Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                          267

by visualizing hypothesis and error covariation as ellipsoids. These plots can be
generated using the heplots package (Fox, Friendly & Monette 2013) in R (R Core
Team 2013), as shown in the Appendix, and, by default, will display significance in
terms of the Roy’s largest root test.
   The MLM we want to visualize here is given by:

                             Yn×p = Xn×q Bq×p + U ,                                (2)

for p responses, Y = (y1 , y2 , . . . , yp ), and q regressors in X. The regressors
can comprise quantitative predictors, factors (represented as dummy variables or
contrasts), interaction terms, or any other term (e.g., a polynomial or spline) that
can be represented within the framework of the general linear model.
   The essential ideas here are that:

   • Every multivariate hypothesis test is carried out by a multivariate analog of
     the general linear test, H0 : Ch×q Bq×p = 0h×p , where the matrix of constants
     C selects subsets or linear combinations (contrasts) of the coefficients in B
     to be tested.

   • Every such hypothesis gives rise to (p × p) matrices, H and E that are the
     multivariate analogs of the familiar sums of squares, SSH and SSE , used in
     univariate F tests.

                                b T [C(X T X)− C T ]−1 , (C B),
                         H = (C B)                          b                      (3)
                                        T      T
                               E = U U = Y [I − H]Y .                              (4)

   • The univariate F test statistic, F = SS  H /dfh
                                            SSE /dfe has a direct multivariate analog
     in terms of the latent s = min(p, dfh ) non-zero latent roots, λi , of H relative
     to E that solve
                                   det(H − λE) = 0
     The various multivariate test statistics such as Wilks’ Λ, the Pillai and
     Hotelling trace criteria, and Roy’s maximum root test are all functions of the
     λi that reflect different geometric properties of the size of the H ellipsoid
     relative to the size of the E ellipsoid. The statistical and geometric details
     are described in Friendly (2007) and Friendly et al. (2013).

  An animated display of these ideas and the relations between data ellipses and
HE plots can be seen at http://www.datavis.ca/gallery/animation/manova/.


3.1. Visualizing H and E (Co)variation
   A standard ellipsoid representing residual (error) variation reflected in the E
matrix is simply the data ellipse of the residuals in U , scaled as E/dfe . In an
HE plot, we typically show this as an ellipse of 68% coverage, but centered at the
overall means of the variables plotted, so that we can also show the means for

                                    Revista Colombiana de Estadística 37 (2014) 261–283

268                                                                                       Michael Friendly & Matthew Sigal


factors on the same scale. This also allows you to “read” the residual standard
deviation as the half-length of the shadow of the E ellipsoid on any axis.
    An ellipsoid representing variation in the means of a factor (or any other term
reflected in (3) in the H matrix is simply the data ellipse of the fitted values for
that term. Scaling the H matrix as H/dfe puts this on the same scale as the
E ellipse, as shown in the left panel of Figure 3. We refer to this as effect size
scaling, because it is similar to an effect size index used in univariate models, e.g.,
ES = (x2 − x̄2 )/s in a two-group, univariate design.


                                                                                                         Significance scaling:H λαdfe
              4.5




                                                                                4.5
                                     Effect size scaling:H dfe
              4.0




                                                                                4.0
                                       Error                                                                  Error
                            setosa                                                                 setosa
              3.5




                                                                                3.5
                              ●                                                                      ●
Sepal.Width




                                                                  Sepal.Width
                                     + virginica                                                            + virginica
              3.0




                                                                                3.0
                                             ●                                                                    ●
                                  versicolor                                                             versicolor
                                      ●                                                                      ●

                                          Species
              2.5




                                                                                2.5
              2.0




                                                                                2.0
              1.5




                                                                                1.5




                                                                                                                          Species

                    2   4             6             8                                 2        4             6            8

                             Sepal.Length                                                           Sepal.Length

Figure 3: HE plots for two variables in the iris data set. Left: effect scaling of the H
          matrix. Right: significance scaling of the H matrix.


    The geometry of ellipsoids and multivariate tests allow us to go further with a
re-scaling of the H ellipsoid that gives a visual test of significance for any term in a
MLM, simply by dividing H/dfe further by the α-critical value of the corresponding
test statistic. Among the various multivariate test statistics, Roy’s maximum root
test gives H/(λα dfe ) which has the visual property that the scaled H ellipsoid will
protrude somewhere outside the standard E ellipsoid if and only if Roy’s test is
significant at significance level α. For these data, the HE plot using significance
scaling is shown in the right panel of Figure 3.
    You can interpret the HE plot by recalling that they reflect data ellipsoids
of the fitted values (group means, here) and the residuals. The direction of the
H ellipsoid relative to that of E reflects the linear combinations of the response
variables shown that depart from the null hypothesis.
    In this example, the iris data has p = 4 dimensions, but with three groups,
dfh = 2, so the H and E ellipsoids all have s = min(p, dfh ) = 2 non-zero dimensions.
To see these relations for all variables together, it is easy to use a scatterplot matrix
format, as shown in Figure 4. The plot shown in Figure 3 is just the panel in row
1, column 2, and the entire plot in Figure 4 is just an alternative visualization of
the data-based scatterplot matrix shown in Figure 1, focussed on the evidence for
differences among the species means.

                                                            Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                                                                                                                       269

                                                                                                                                     Species                             Species
     7.9




                            Sepal.Length




                                                                             Sepal.Length




                                                                                                                      Sepal.Length
                                                             virginica
                                                                   Error                                  virginica
                                                                                                          Error                                             virginica
                                                                                                                                                           Error
                                                                 ●                                            ●                                                 ●
                                                           versicolor                                   versicolor                                       versicolor
      Sepal.Length                                             ●
                                                                   +setosa                            setosa+  ●
                                                                                                                                                       setosa+
                                                                                                                                                             ●

                                                                      ●                                 ●                                                ●




                                           4.3
                                                                             Species

                                                     4.4

            c(min, max)                                     Sepal.Width                               Petal.Length                                      Petal.Width
           setosaError                                                                                    Error
                                                                                                      setosa                                               Error
                                                                                                                                                       setosa




                                                                             Sepal.Width




                                                                                                                      Sepal.Width
                            c(min, max)

             ●                                                                                          ●                                                ●
                virginica                                                                                 virginica                                         virginica
                 +
             versicolor
                 ●
                    ●                                  Sepal.Width                                          +
                                                                                                        versicolor
                                                                                                              ●
                                                                                                               ●
                                                                                                                                                             +
                                                                                                                                                         versicolor
                                                                                                                                                             ●
                                                                                                                                                                ●




                                                                                            2
                          Species                                                                                       Species                                       Species
                                           Species                                                                                                                       Species
                                                                                                6.9

           Sepal.Length                                     c(min, max)                               Petal.Length                                     Petal.Width
                            Petal.Length




                                                                                                                      Petal.Length
                                                                             c(min, max)

                virginica                                    virginica                                                                                      virginica
             versicolor
                    ●
                 Error                                     versicolor
                                                                 ●
                                                                  Error                                                                                  versicolor
                                                                                                                                                           Error●

                +
           setosa
                 ●                                             ●
                                                                   +setosa                        Petal.Length                                         setosa+
                                                                                                                                                             ●

             ●                                                        ●                                                                                  ●




                                                                                                                                       1
                                                                                Species
                                           Species                                                                                   Species
                                                                                                                                               2.5

           Sepal.Length                                     Sepal.Width                               c(min, max)                                      Petal.Width
                                                                                                                      c(min, max)

                virginica                                    virginica                                    virginica
                            Petal.Width




                                                                             Petal.Width




                Error●
             versicolor                                          ●
                                                           versicolor
                                                                  Error                                   Error●
                                                                                                        versicolor
           setosa+
                 ●                                             ●
                                                                   +setosa                            setosa+  ●
                                                                                                                                                     Petal.Width
             ●                                                        ●                                 ●




                                                                                                                                                                          0.1
                                                                             Species


Figure 4: HE plot matrix for all variables in the iris data set. Each panel shows the HE
          plot as projected onto the plane of two response variables.



    It is now easy to see the relationships among all four variables that are reflected
in the multivariate tests of H0 : no differences among species means. For all variables
except sepal width, the variation of the species means is essentially one-dimensional;
however, sepal width has an opposite pattern to the others.
    As a supplementary example, let’s look at the Romano-British pottery dataset
(Tubb, Parker & Nickless 1980). This data pertains to 26 ancient pottery samples
found at four kiln sites in Britain (Ashley Rails, Caldicot, Isle of Thorns, and
Llanedryn), and their chemical makeup. Each sample was quantified in terms
of it’s aluminum (Al), iron (Fe), magnesium (Mg), calcium (Ca), and sodium
(Na) content, which naturally yields a one-way multivariate analysis of variance
(MANOVA) design with 4 groups (site) and 5 responses (chemical composition).
The primary question posed by this data is: Can the chemical composition of the
samples differentiate the sites? And, how can we understand the contributions of
the chemical elements to such a discrimination?

                                                                             Revista Colombiana de Estadística 37 (2014) 261–283

270                                                                                              Michael Friendly & Matthew Sigal


    Using the HE plot framework, we can visualize each pairwise combination of the
chemical compounds, and assess the sites in terms of effect or significance scaling,
see the left panel of Figure 5. In this view, we can see that there does appear to
be significant separation between the locations, with the Caldicot and Llanedryn
being relatively high in iron but low in aluminum, while the Ashley Rails and Isle
of Thorns samples being the opposite.

                                                                                                              Pottery data: Contrasts
                           Pottery data: Al and Fe

              Significance scaling: H / λαdfe
                                                                                                  Site: 3 df H




                                                                                        8
     8




                                                                                                         Llanedyrn
                      Llanedyrn                                                                               ●
                           ●




                                                                                        6
     6




                                                                                                  Caldicot                      Error
               Caldicot                     Error                                                    ●

                                                            E dfe
                  ●

                                                                                                                                I−A
                                       +                                                                                   +


                                                                                   Fe
Fe




                                                                                                                  1 df H




                                                                                        4
     4




                                                                                                                                               2 df H
                                                                                                                                              C−A
                                                                                                                                        Caldicot & Isle Thorns
                                                                                                                                                   IsleThorns
                                                                                        2
                                                                                                                                            AshleyRails●
                                                               IsleThorns
     2




                                                                                                                                                 ●
                                                         AshleyRails●
                                                             ●
                                                                                        0




                                                                                                                                                                 Site
     0




                                                                            Site
                                                                                            10           12           14                16           18            20
         10           12          14                16           18           20
                                                                                                                           Al
                                       Al


Figure 5: HE plots for a one-way MANOVA design using the Romano-British pot-
          tery dataset. Left: Significance scaling of the H matrix. Right: Visual
          decomposition of a multi-degree of freedom hypothesis test.


    Further, we can utilize this approach to decompose a multi-degree of freedom
hypothesis test into a set of orthogonal contrasts, exactly as the univariate SSH
may be decomposed in an ANOVA. Each subhypothesis matrix with rank greater
than 1 will have hypothesis ellipse, while those of rank 1 will plot as a vector in
the HE graphic. In this example, the overall 3 df hypothesis tests the equality of
the four Site mean vectors. Also overlaid on this plot is the 2 df sub-hypothesis
test, which is the contrast between the average of Caldicot and Isle Thorns against
Ashley Rails. This in turn can be decomposed into two 1 df tests for each of Caldicot
and Isle Thorns versus Ashley Rails, in which only the former is significant. The
hypothesis ellipsoids in this plot have the interesting visual property that they
form conjugate directions with respect to the ellipsoid for the joint test, provided
the sub-hypotheses are statistically independent. More details about this approach
can be found in Friendly et al. (2013).


3.2. More General Models
  The HE plot framework extends quite naturally to all cases of the general
multivariate linear model. This includes multiple MANOVA models with two or
more factors (and their interactions), multivariate analysis regression (MMRA),
models with mixtures of factors and quantitative regressors (MANCOVA) (Fox,

                                                                            Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                                 271

Friendly & Weisberg 2013) and repeated measure designs (Friendly 2010). More
importantly, HE plots provide a visualizations of such complex models from which
many features can be “read” far more directly than from the collection of many
numerical tables that they summarize.
    All hypothesis tests for these models can be formulated as special cases of the
general linear test, H0 : Ch×q Bq×p = 0h×p , giving rise to H and E matrices
as indicated in (3) and (4). For example, in a MMRA model, the test of the
multivariate hypothesis H0 : B = 0 that all predictors have no effect on any
responses is given by specifying C = Iq×q , while the multivariate test for the ith
predictor is given by using C = (0, 0, . . . , 1, 0, . . . 0), with a value of 1 in position i.
    We illustrate the flexibility of these models and HE plots using data from an
experiment by William Rohwer (Timm 1975, Table 4.7.1) on kindergarten children
(n = 37 of low socioeconomic status (SES), n = 32 of high SES) designed to
examine how well performance on a set of paired-associate (PA) tasks can predict
performance on measures of aptitude and achievement: the Peabody Picture
Vocabulary Test (PPVT), a Student Achievement Test (SAT), and the Raven
Progressive matrices test. The PA tasks varied in how the stimuli were presented,
and are called named (n), still (s), named still (ns), named action (na), and sentence
still (ss).
   A simple MANCOVA model, allowing different intercepts (means) for the SES
groups, but assuming that the regression slopes for the PA tasks are the same for
both groups can be fit in R as follows:

rohwer.mod <- lm(cbind(SAT, PPVT, Raven) ~ SES + n + s + ns + na + ss,
                 data=Rohwer)

    Multivariate hypothesis tests show that only SES, ns and na have significant
effects. But, how can we understand these results and the nature of the relationships
in these data?
    The left panel of Figure 6 shows the HE plot for this model, for the first two
variables, SAT and PPVT. The ellipsoid labeled “Regr” gives the result of an
overall multivariate test for all of the PA tests jointly. As can be seen based upon
its extension past the error ellipse, this test is highly significant. Note that the
predictors are all 1 dfh terms, so the H matrices are all of rank 1, and their H
ellipsoids degenerate to lines.
    We can interpret this display as follows: (a) The length of each predictor line
indicates the strength of its relationship to the two responses jointly. (b) Only the
predictor lines for na and ns lie outside the E ellipsoid, and the latter is just barely
significant. (c) The orientation of each predictor line shows its relationship to SAT
and PPVT. (d) The means for the SES groups show that the high group performs
better on both the SAT and the PPVT, but more so on the PPVT. (e) The Regr
ellipsoid for the overall test of the regression variables can be seen as a sum of
the contributions of the individual predictors, some of which make it larger in the
direction of SAT, others in the direction of PPVT. (f) The orientation of the E
ellipsoid indicates a small positive correlation between the residuals for SAT and

                                        Revista Colombiana de Estadística 37 (2014) 261–283

272                                                                                                                                       Michael Friendly & Matthew Sigal


PPVT; the shadows of this ellipsoid on the horizontal and vertical axes reflect the
residual standard deviations, apparently larger for SAT than PPVT.


                                                                 SES




                                                                                                                              110
                                                                                Regr
                                  100




                                                                                                                              100
                                                                                                                                                                        Error        B=0, High SES
                                                                           na
Peabody Picture Vocabulary Test




                                                                                                                                                                                                   na
                                  90




                                                        Error




                                                                                                                              90
                                                                                            Peabody Picture Vocabulary Test
                                                           Hi
                                                             ●                                                                                                                       s            ns
                                                                 ss                                                                                                                      n
                                  80




                                                                                ns




                                                                                                                              80
                                                                      n                                                                                                  ss
                                                        +
                                  70




                                                                                                                              70
                                                   Lo s
                                                    ●
                                  60




                                                                                                                                                           n+




                                                                                                                              60
                                                                                                                                                   ss
                                                                                                                                                   ns
                                                                                                                                                               s
                                  50




                                                                                                                                                        Error




                                                                                                                              50
                                                                                                                                                           na
                                  40




                                                                                                                                               B=0, Low SES




                                                                                                                              40
                                        0     20        40            60         80                                                 −20    0         20            40           60           80         100

                                            Student Achievement Test                                                                                       Student Achievement Test


Figure 6: HE plots for SAT and PPVT in the Rohwer data. Left: Fitting a MANCOVA
          model, assuming equal slopes for the SES groups. Right: Fitting a model of
          heterogeneous regressions.



   To test the assumption of equal slopes in the simple MANCOVA model, we
can fit extended models that allow heterogeneous slopes and intercepts in the two
groups. One way to do this is to fit separate multivariate regression models for the
two groups, and overlay the HE plots on common scales. This result is shown in
the right panel of Figure 6.

    Some additional aspects that can be seen here are: (a) The centers of the
ellipsoids show the group means that were reflected in the SES factor in the
MANOVA. (b) The overall regression ellipsoid testing H0 : B = 0 is more aligned
with the SAT axis for the high SES group than for the low group, reflecting the
better prediction of SAT than PPVT for the high group. (c) Among the individual
predictors, na and ns are more important predictors in the high SES group, and
are also more important in predicting SAT and PPVT.

    In closing this section, we hope we have convinced the reader that HE plots,
once you learn how to read them, provide much more direct information about the
relationships between predictors and responses in complex MLMs than is easy to
understand from tables or univariate displays.

    In Figure 6 we only showed the HE plots for two of the response variables. As
shown in Figure 7, we can extend this to any number of responses using an HE
plot matrix. However, the idea of a low-dimensional view for multivariate data per
se discussed in Section 2.2 has a direct connection with similar low-D views for
MLMs, that we will discuss in the following section.

                                                                                      Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                                                                                  273

                                                                                   Regr                                Regr
            99
                                                                      ns
                                                                     Error                                             Error
                                                                                   na
                                                                     n                            SES             n              SES
                                                                          ssHi                                         Hi
                                                                              ●                                        ●
                                                                                                                                 s




                                     SAT




                                                                                   SAT
                   SAT                                          Lo
                                                                ●
                                                                     +s                                      Lo
                                                                                                             ●
                                                                                                                  +
                                                                                                                  ss

                                                                                                                  na
                                                    1
                                                                                                                            ns

                             SES                                                                                              SES
                                        Regr            105                                                                 Regr

                  c(min, max)        na                             PPVT                                     Raven
                      Error                                                                                      Error
                        Hi                                                                                       Hi
                        ● ss                                                                                           ●



                                     c(min, max)
                                               ns




                                                                                   PPVT
                            n                                                                                     n
                        +                                       PPVT                                              +
                   Lo                                                                                        Lo             ns s
                    ● s                                                                                      ●    ss

                                                                                                                  na
                                                                                                  40

                         Error
                          Regr                                       Error Regr
                                                                                                        21
                          SES                                                                     SES
                      s
                     SAT                                        c(min, max)                                  Raven
                            Hi                                                Hi

                                                                                    c(min, max)
                            ●                                                 ●
                                     Raven




                                 n                                   n
                   Lo   + ss na                                 Lo   + ss na                                 Raven
                    ●                                           ●

                                               ns                        ns
                                                                          s
                                                                                                                                       8



        Figure 7: HE plot matrix for all three responses in the Rohwer data.



4. Generalized Canonical Discriminant HE Plots
    For even a one-way MANOVA design with three or more response variables,
it is difficult to visualize how the groups vary on all responses together, and
how the different variables contribute to discrimination among groups. In this
situation, canonical discriminant analysis (CDA) is often used, to provide a low-D
visualization of between-group variation, analogous to the biplot technique for
purely quantitative variables.
    CDA amounts to a transformation of the p responses, Yn×p into the canonical
space, Zn×s = Y E −1/2 V , where V contains the eigenvectors of HE −1 and
s = min(p, dfh ). It is well-known (e.g., Gittins, 1985) that canonical discriminant
plots of the first two (or three, in 3D) columns of Z corresponding to the largest
canonical correlations provide an optimal low-D display of the variation between
groups relative to variation within groups.
   For a one-way design, the canonical HE plot is simply the HE plot of the
canonical scores in the analogous MLM model that substitutes Z for Y . This is
shown in Figure 8 for the iris data. The interpretation of this plot is the same
as before: if the hypothesis ellipse extends beyond the error ellipse, then that
dimension is significant. Vectors for each predictor are then superimposed and
demonstrate the relation between each and the two canonical dimensions.

                                                              Revista Colombiana de Estadística 37 (2014) 261–283

274                                                                                       Michael Friendly & Matthew Sigal

                                       4                             sepalwid




        Canonical Dimension 2 (0.9%)
                                       2
                                                                     Species         sepallen
                                                                                            petalwid Virginica
                                                  Setosa
                                       0                                                       petallen
                                                                                      Versicolor
                                       -2


                                       -4
                                            -10      -8    -6   -4       -2     0     2       4       6     8    10
                                                                Canonical Dimension 1 (99.1%)

Figure 8: A canonical HE plot, visualizing the two canonical dimensions of the iris
          dataset.


    The interpretation of this plot is quite simple: In canonical space, variation of
the means for the iris species is essentially one-dimensional (99.1% of the effect
of species), and this dimension corresponds to overall size of the iris flowers. All
variables except for sepal width are aligned with this axis.
    We have extended this to generalized canonical discriminant plots for the
general MLM as follows: (a) Let t index the various hypothesized terms in an
arbitrary MLM. Canonical discriminant analysis can be extended by performing
the canonical analysis of the Ht and E matrices for each term in the model, based
on the eigenvalues and eigenvectors of Ht E −1 . Then, for term t: (b) The canonical
discriminant HE plot is the HE plot of canonical scores in the model Zt ∼ •, where
• symbolizes all terms in the original MLM for Y . These and other extensions
of canonical analysis are implemented in the candisc package in R (Friendly &
Fox 2013).
    An application of this idea is shown in Figure 9 for the Rohwer data. In
this case, the two dimensions account for 93.7% of the variability in achievement
scores, and each predictor is plotted in relation to the two canonical dimensions.
It is directly observable how both the predictors in the model and the outcome
variables relate to the canonical dimensions. For instance, the SAT and PPVT
extend horizontally, reflecting a strong loading on dimension 1, while the Raven
is aligned more vertically, and is more strongly associated with dimension 2. For
the predictors, ss is almost perfectly aligned with dimension 1, while the other
variables load on both. Similar to the biplots that were previously discussed, this
plot provides a compact 2D view for a complex multivariate problem.


5. Recent Extensions
    The general goal of this work has been to extend data visualization methods
for univariate response models to their counterparts for MLMs. Towards this end,
we describe some recent efforts to address: The interpretation of model coefficients,
the use of such plots in robust analyses, and in examining data for influential cases.

                                                                        Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                                                              275




                                                   2
                 Y canonical dimension 2 (16.4%)
                                                                               Error




                                                   1
                                                             SAT
                                                                                +


                                                   0
                                                                                                 ss
                                                        PPVT                                n

                                                                                                               na
                                                   −1
                                                   −2
                                                                Raven                   s




                                                                                                      ns

                                                        −2         −1           0           1              2

                                                               Y canonical dimension 1 (77.3%)

Figure 9: Generalized canonical HE plot, visualizing the two canonical dimensions of
          the Rohwer dataset.


5.1. Coefficient Plots for MLMs
    In presentations and articles, it is commonplace to present results of fitted models
in tables of estimated coefficients and their standard errors. This practice, while
convenient, is now often deprecated (Gelman, Pasarica & Dodhia 2002, Kastellec
& Leoni 2007) in favor of plots of point estimates and confidence intervals that,
when carefully done, can communicate findings more clearly.
   The left panel of Figure 10 gives an example of a univariate coefficient plot for
the results of the linear model for SAT in the Rohwer data, showing 68% and 95%
confidence intervals set at β ± {1, 2}seβ . The corresponding MLM would require
three such plots, one for each response variable and could not indicate multivariate
confidence regions for joint hypothesis tests.
    However, a simple generalization of this idea is the multivariate coefficient
plot, which is illustrated in bivariate form in the right panel of Figure 10. To
simplify the plot, this shows only joint 68% confidence ellipses, corresponding to a
multivariate version of β ± seβ . This has the property that a joint, multivariate
test of H0 : β = 0 is rejected when the confidence ellipse does not cover the origin
(as shown by shading). See Friendly et al. (2013) for more details.


5.2. Robust MLMs
   All calculations and test statistics for classical, normal-theory linear models are
based on standard, first and second moment summaries, such as mean vectors and
covariance matrices. It is well-known that these can be distorted by multivariate
outliers, particularly in smaller samples.
   In principle, such effects in standard multivariate analyses can often be countered
by using robust mean and covariance estimates, such as simple multivariate trim-

                                                                        Revista Colombiana de Estadística 37 (2014) 261–283

276                                                                                    Michael Friendly & Matthew Sigal


                                                                                       Bivariate 68% coefficient plot for SAT and PPVT
                   Coefficient plot for SAT
          −4       −2           0             2    4
                                                                                                                                         na




                                                                           2.0
   ss                                   ●                                                                                       ss




                                                                           1.5
                                                                                                                                         n
                                                                                                                                     ●




                                                                           1.0
                                                                                                                            ●
  na                                          ●




                                                        PPVT coefficient
                                                                                                                                     ●




                                                                           0.5
                                                                                                                        s
                                                                                               ns
   ns                                                                                                               +




                                                                           0.0
               ●                                                                                               H0




                                                                           −0.5
                                                                                                                 ●
                                                                                           ●
      s                        ●




                                                                           −1.0
   n                                          ●                                   −4                −2              0                2

                                                                                                         SAT coefficient




Figure 10: Coefficient plots for the Rohwer data. Left: Plot of coefficients in the
           univariate linear model for SAT. Right: Bivariate coefficient plot for SAT
           and PPVT. 68% confidence ellipsoids that exclude the origin, corresponding
           to H0 : β = 0, are shaded.




ming (Gnanadesikan & Kettenring 1972) or the high-breakdown bound minimum
volume ellipsoid (MVE) and minimum covariance determinant (MCD) methods
(Rousseeuw & Leroy 1987, Rousseeuw & Van Driessen 1999). Often, these robust
methods supply weights that can be used to “robustify” other multivariate methods
and visualization techniques, but this integration in applied software is still quite
spotty, inference for the general MLM is weak and associated graphical methods
are limited.

    In the heplots package (Fox, Friendly & Monette 2013), we extend normal-
theory HE plots to robust equivalents via similar use of weighting and robust
covariance estimation, using a simple iteratively reweighted least squares approach.
Other approaches do provide high breakdown bound estimates, and will be imple-
mented in the future. As an example, we have reestimated the MANOVA model
with the Romano-British pottery data utilizing the robmlm function in the heplots
package. Fitting is done by iterated re-weighted least squares, using weights based
on the Mahalanobis squared distances of the current residuals from the origin, and
a scaling (covariance) matrix, and its visual output is shown in Figure 11.

    In this example, the figure on the left illustrates changes in observation weight.
It clearly shows that three data points from Llanedyrn and one from Ashley Rails
are atypical and given weights close to zero. The right figure demonstrates the
difference between the classical and robust estimates. It is interesting to note that
there is only minimal change in the mean ellipse when using the robust estimation,
but there is a substantial difference in the error covariance ellipse. This is a quick
representation that visually demonstrates how effects become more visible using
robust methods.

                                                  Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                                                                                                                            277




                     1.0
                                                                             ●       ●●●       ●●       ●●
                                            ●                                    ●                           ●        ●                                                      Classical
                                        ●       ●                                                                                                                            Robust




                                                                                                                               8
                                                                                                    ●
                                   ●●                   ●
                     0.8                                                 ●
                                                                                                                                          Llanedyrn
Observation weight

                                                                                           ●                                                     ●




                                                                                                                               6
                                                                                                                                        Caldicot            Error
                     0.6



                                                                                                                                           ●


                                                                                                                                                           +




                                                                                                                          Fe
                                                            ●




                                                                                                                               4
                                                                ●
                     0.4




                                                                                                                                                                        IsleThorns




                                                                                                                               2
                                                                                                                                                                    AshleyRails
                     0.2




                                                                                                                                                                             ●
                                                                                                                                                                         ●




                                                    ●                                Caldicot   AshleyRails




                                                                                                                               0
                     0.0




                               ●   Llanedyrn                         ●                  IsleThorns ●                                                                               Site
                           0                5                   10                   15        20                25                10       12        14            16        18     20

                                                                         Index                                                                             Al

Figure 11: Robust MLMs. Left: Observation weights estimates by reweighted LS. Right:
           HE plot, overlaying the classical and robust estimates of H and E.


5.3. Influence Diagnostics for MLMs
    A wide variety of influence diagnostics (e.g., Cook’s distance, DFFITS, Hat
values) and associated plots (leverage–influence plots) for detecting influential
observations in univariate models have been available for a long time (Cook &
Weisberg 1982). As well, a general theory of influence diagnostics for MLMs (Barrett
& Ling 1992) is available to support these measures, but there is no available
software implementation allowing these methods to be used. Our mvinfluence
package is an initial implementation of some of these ideas (Friendly 2012).
    The generalization of influence measures to multivariate response models is
relatively straight-forward, and also extend to case deletion diagnostics for subsets
(I) of size m > 1. For example, the multivariate analog of Hat values, that measure
leverage of observations in terms of the predictors is
                                                                                               HI = XI (X T X)−1 XIT ,
where XI refers to the rows of X in subset I.
    The multivariate version of Cook’s distance can be represented as the stan-
dardized distance between the estimated coefficients B using all cases and B(I)
estimated omitting subset I.
                                                DI = [vec(B − B(I) )]T [S −1 ⊗ (X T X)] [vec(B − B(I) )].                                                                            (5)

  A wide variety of other influence measures is also defined (e.g., DFFITS,
COVRATIO), but all can be expressed in the general form
                                                                                 InfluenceI = LeverageI × ResidualI                                                                  (6)
for some function of leverage and the multivariate residuals corresponding to subset
I.

                                                                                                             Revista Colombiana de Estadística 37 (2014) 261–283

278                                                                                                                                         Michael Friendly & Matthew Sigal


    We illustrate these methods using the MLM for the Rohwer data using only the
low SES group in Figure 12. The left panel is a bubble plot of Cook’s DI against
leverage, HI for subsets of size m = 1, also showing DI by the area of the bubble
symbol. It can be seen that observation 5 is highly influential, but four other cases
also have Cook’s distances greater than the nominal cutoff for identifying “large”
values.

                                                                                                          5                                                                                                                5
           0.8




                                                                                                                                                                      ●25




                                                                                                                              −1
                                                                                                                                                                   ●14                         29 27
                                                                                                                                                       ●              ●
           0.6




                                                                                                                                                                              ●
                                                                                                                                                                              ●
                                                                                                                                        ●
                                                                                                                                                                              ●                    ●




                                                                                                               log Residual
                                                                                                                                              ●
                                                                                                                                                                              ●
                                                                                                                                   ●
Cook's D




                                                                                                                              −2
                                                                                                                                    ●
                                                                                                                                                                      ●
                                                                                                                                                       ●
                                                                                                                                                   ●                                                   ●
           0.4




                                                                                                                                                           ●
                                                                                                                                                                                      ●

                                                                                                                                                                      ●

                                                                                 27
                                                                                                                                                               ●
                                                                                                                                                                          ●

                                                                                                                                                                                               ●
                                                                               29                                                                                                 ●
                                                                                                                                                                                                              10 ●
                                              ●       25



                                                                                                                              −3
                                                                                                                                                                                          ●
           0.2




                                             ●●
                                              14                           ●
                                                 ●
                                                 ●
                                                      ●
                                                      ●                          ●                                                                                        ●




                                 ●
                                              ●                ●
                                                                                            10 ●
                                                                                                                                               ●




                         ●                                             ●
                                                                                                                              −4
                     ●           ●   ●        ●●           ●
                             ●           ●                         ●
                 ●
                 ●
           0.0




                                                  ●                              ●

                         ●                                                                                                                                                                             ●




                                 0.1                      0.2              0.3        0.4          0.5                             −3.0       −2.5             −2.0           −1.5            −1.0         −0.5      0.0

                                                                       Hat value                                                                                    log Leverage

Figure 12: Influence plots for MLMs, using Rohwer data Left: Generalized Cook’s D vs.
           Hat value. Dashed lines in the plot indicate conventional cutoffs for “large”
           values. Right: Leverage–Residual LR plot. Dashed lines represent contours
           of constant influence.


    The right panel shows a novel form of influence plot (the LR plot) suggested
originally by McCulloch & Meeter (1983). From (6), it follows that a plot of
log(Leverage) vs. log(Residual) will have contours of constant influence along lines
with slope = −1. This plot simplifies the interpretation of influence plots by placing
all observations in relation to their influence away from the origin.



6. Summary and Conclusion
    The classical univariate general linear model is the cornerstone for the devel-
opment of much of modern statistical theory and practice. A great deal of the
applied usefulness of this methodology stems from development of a wide range of
visualization methods allowing researchers to see and understand their data, diag-
nose possible problems with assumptions and model specification and communicate
their results effectively.
   As we have argued, the extension of this model to multivariate responses is
well-developed in theory and increasingly prevalent in applied research. Yet, the
analogous advancement of visualization methods for MLMs has lagged behind. In

                                                                                                         Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                           279

this paper we have set out a framework for filling these gaps, based on the following
general ideas:

Data ellipsoids provide a simple visual summary of bivariate relations under
    classical (Gaussian) assumptions.
         • They highlight important differences among groups (means, variances,
           correlations) in MANOVA designs;
         • They can be embedded in scatterplot matrix format to show all pairwise,
           bivariate relations;
         • They extend easily to 3D visualizations, and can be modified to use
           robust estimators.
HE plots provide a visual summary of multivariate hypothesis tests for all MLM
    models.
         • They show H ellipsoids with group means for MANOVA factors and 1 dfh
           ellipsoids for quantitative predictors in ways that facilitate interpretation
           of multivariate effects.
         • They can be embedded in an HE plot matrix to show all pairwise views.
Dimension-reduction techniques provide low-dimensional (2D or 3D), approx-
    imate visual summaries for high-D data.
         • The biplot shows multivariate observations and variable vectors in the
           low-D view that accounts for the maximum variance in the data.
         • Canonical HE plots are similar, but show the dimensions that account for
           maximal discrimination among groups or maximal canonical correlation.

    In the popular children’s TV show Sesame Street, it was common to sign off with
“Today’s show has been brought to you by the letter E”, where they might have
featured elephants, eagles, emus, and ellipses. In a similar vein and as a coda to this
paper, we also remark that this approach has been provided by the beautiful and
useful connections that exist among aspects of statistical models, matrix algebra,
and geometry (Friendly et al. 2013). There are ellipsoids everywhere and almost
all the properties of multivariate tests and dimension-reduction techniques can
be understood in terms of eigenvalue decompositions. This framework provides
opportunities for further extensions.
   R code for some of the figures in this paper are included in the Appendix
and related examples in the web supplement for a conference presentation, http:
//www.datavis.ca/papers/ssc2013/.


Acknowledgments
    This work was supported by Grant OGP0138748 from the National Sciences
and Engineering Research Council of Canada to Michael Friendly. We are grateful
to John Fox, whose work on R packages (car, heplots) provided the necessary
infrastructure for much of this work.

                                     Revista Colombiana de Estadística 37 (2014) 261–283

280                                                 Michael Friendly & Matthew Sigal

                                                                   
                Recibido: mayo de 2014 — Aceptado: noviembre de 2014

Appendix. Supplement to Friendly & Sigal

Sample R Code to Reproduce Figures 3 and 4
Hypothesis-Error (HE) Plots
library(heplots)   # load heplots library
data(iris)         # load data



Conduct the MLM:
mod <- lm(cbind(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width) ~ Species,
          data = iris)



HE Plot with Effect-Size scaling:
heplot(mod,
       xlab = "Petal Length in cm.", ylab = "Sepal length in cm.",
       size = "effect.size",
       fill = TRUE, # shade ellipses
       fill.alpha = c(0.3, 0.1), # set transparency for E and H ellipses
       ylim = c(1.5, 4.75), xlim = c(2, 10))



HE Plot with Signicance scaling:
heplot(mod,
       xlab = "Petal Length in cm.", ylab = "Sepal length in cm.",
       size = "evidence",
       fill = TRUE,
       fill.alpha = c(0.3, 0.1),
       ylim = c(1.5, 4.75), xlim = c(2, 10))



Pairs Plot can be used to show each projection of response variables:
pairs(mod,
      fill = TRUE,
      fill.alpha = c(0.3, 0.1))



Sample R Code to Reproduce Figure 5 and 6
The MANCOVA Model:
rohwer.mod <- lm(cbind(SAT, PPVT, Raven) ~ SES + n + s + ns + na + ss,
                 data = Rohwer)



Colours to be used in the graphic:
col <- c("red", "black", "gray", "cyan", "magenta", "brown", "green", "blue")


                                   Revista Colombiana de Estadística 37 (2014) 261–283

Recent Advances in Visualizing Multivariate Linear Models                          283

Figure 5
Add ellipse to test all 5 regressors:
 heplot(rohwer.mod,
        hypotheses = list("Regr" = c("n", "s", "ns", "na", "ss")),
        xlab = "Student Achievement Test",
        ylab = "Peabody Picture Vocabulary Test",
        cex.lab = 1.25, cex = 1.25,
        col = col, fill = TRUE, fill.alpha = 0.1)


Figure 6: Heterogenous Regressions
Fit both models:
 rohwer.ses1 <- lm(cbind(SAT, PPVT, Raven) ~ n + s + ns + na + ss,
                   data = Rohwer, subset = SES == "Hi")
 rohwer.ses2 <- lm(cbind(SAT, PPVT, Raven) ~ n + s + ns + na + ss,
                   data = Rohwer, subset = SES == "Lo")


Low SES students:
 heplot(rohwer.ses2, col = c("red", rep("black",5), "blue"),
      hypotheses = list("B=0, Low SES" = c("n", "s", "ns", "na", "ss")),
        level = 0.5, cex = 1.25,
      fill = c(TRUE, FALSE), fill.alpha = 0.05,
      xlim = c(-15, 110), ylim = c(40,110),
      xlab = "Student Achievement Test",
      ylab = "Peabody Picture Vocabulary Test",
      label.pos = c(1, rep(NULL, 5), 1))


High SES students:
 heplot(rohwer.ses1, col = c("red", rep("black", 5), "blue"),
       hypotheses = list("B=0, High SES" = c("n", "s", "ns", "na", "ss")),
       level = 0.5, cex = 1.25,
       add = TRUE, # place both plots on same graphic
       error = TRUE, # error ellipse is not drawn by default with add = TRUE
       fill = c(TRUE, FALSE), fill.alpha = 0.05,
       xlim = c(-15, 110), ylim = c(40,110))

References
Barrett B E, Ling R F. General classes of influence measures for multivariate regression.(1992). Journal of the American Statistical Association.
Cook R D, Weisberg S. Residuals and Influence in Regression.(1982). Chapman and Hall.
Dempster A P. Elements of Continuous Multivariate Analysis.(1969). Addison-Wesley.
Fisher R A. The use of multiple measurements in taxonomic problems.(1936). Annals of Eugenics.
Fox J, Friendly M, Monette G. heplots: Visualizing Tests in Multivariate Linear Models. (2013). R package.
Fox J, Friendly M, Weisberg S. Hypothesis tests for multivariate linear models using the car package.(2013). The R Journal.
Friendly M. HE plots for multivariate general linear models.(2007). Journal of Computational and Graphical Statistics.
Friendly M. HE plots for repeated measure designs.(2010). Journal of Statistical Software.
Friendly M. mvinfluence: Influence Measures and Diagnostic Plots for Multivariate Linear Models.(2012). R package.
Friendly M, Fox J. candisc: Visualizing Generalized Canonical Discriminant and Canonical Correlation Analysis.(2013). R package.
Friendly M, Monette G, Fox J. Elliptical insights: Understanding statistical methods through elliptical geometry.(2013). Statistical Science.
Gabriel K R. The biplot graphic display of matrices with application to principal components analysis.(1971). Biometrics.
Gabriel K R. Biplot display of multivariate matrices for inspection of data and diagnosis.(1981). John Wiley and Sons.
Gelman A, Pasarica C, Dodhia R. Let’s practice what we teach: Turning tables into graphs.(2002). The American Statistician.
Gittins R. Canonical Analysis: A Review with Applications in Ecology.(1985).Springer-Verlag.
Gnanadesikan R, Kettenring J R. Robust estimates residuals and outlier detection with multiresponse data.(1972). Biometrics.
Gower J, Lubbe S, Roux N. Understanding Biplots.(2011).Wiley.
Kastellec J P, Leoni E L. Using graphs instead of tables in political science.(2007). Perspectives on Politics.
McCulloch C E, Meeter D.Discussion of outliers.(1983). Technometrics.
Monette G. Geometry of multiple regression and interactive 3-D graphics.(1990). Sage Publications.
R Core Team. R: A Language and Environment for Statistical Computing.(2013). R Foundation for Statistical Computing.
Rousseeuw P, Leroy A. Robust Regression and Outlier Detection.(1987). John Wiley and Sons.
Rousseeuw P, Van Driessen K. A fast algorithm for the minimum covariance determinant estimator.(1999). Technometrics.
Timm N H. Multivariate Analysis with Applications in Education and Psychology.(1975). Wadsworth (Brooks/Cole).
Tubb A, Parker A, Nickless G. The analysis of Romano-British pottery by atomic absorption spectrophotometry.(1980). Archaeometry.