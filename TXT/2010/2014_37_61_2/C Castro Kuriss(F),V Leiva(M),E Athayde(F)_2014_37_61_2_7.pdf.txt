Graphical Tools to Assess Goodness-of-Fit in Non-Location-Scale Distributions. Herramientas gráficas para evaluar bondad de ajuste en distribuciones de no-localización-escala
Instituto Tecnológico de Buenos Aires, Argentina. Universidad Adolfo Ibáñez, Chile. Universidad de Valparaíso, Chile. Universidade do Minho, Portugal
Abstract
Goodness-of-fit (GOF) techniques are used for assessment whether a distribution is suitable to describe a data set or not. These techniques have been studied for distributions belonging to the location-scale family. However, one could be interested in making this assessment for distributions that do not belong to this family. We review the available GOF tests and propose graphical tools based on these tests for censored and uncensored data from non-location-scale distributions. Anderson-Darling, Cramér-von Mises, Kolmogorov-Smirnov, Kuiper, Michael and Watson GOF statistics are considered. We apply the proposed results to real-world data sets to illustrate their potential, with emphasis on some Birnbaum-Saunders distributions.
Key words: Censored Data, Confidence Band, Data Analysis, Probability Plots.
Resumen
Las técnicas de bondad de ajuste se usan para establecer si una distribución es apropiada o no para describir un conjunto de datos. Estas técnicas han sido estudiadas para distribuciones pertenecientes a la familia de locación y escala. Sin embargo, podríamos también estar interesados en establecer si una distribución que no pertenece a esta familia brinda un buen ajuste a los datos. Revisamos los tests de bondad de ajuste disponibles y proponemos herramientas gráficas basadas en estos tests para datos completosy censurados desde distribuciones de no locación y escala. Consideramos los estadísticos de Anderson-Darling, Cramér-von Mises, Kolmogorov-Smirnov, Kuiper, Michael y Watson. Aplicamos los resultados propuestos a conjuntos de datos reales para ilustrar su potencial, particularmente en algunas distribuciones Birnbaum-Saunders.
Palabras clave: análisis de datos, bandas de confianza, datos censurados, gráficos de probabilidad.



1. Introduction
    Life distributions are widely studied and applied; see Lawless (2003) and Mar-
shall & Olkin (2007). Among the different life distributions, we can mention
the classical (BS), Student-t (BS-t) and truncated (TBS) Birnbaum-Saunders,
gamma (GA), inverse Gaussian (IG), lognormal (LN) and Weibull (WE) models;
see Johnson, Kotz & Balakrishnan (1994), Balakrishnan, Leiva, Sanhueza & Ca-
brera (2009), Balakrishnan, Leiva, Sanhueza & Vilca (2009), Balakrishnan, Gupta,
Kundu, Leiva & Sanhueza (2011), Barros, Paula & Leiva (2009), Ahmed, Castro-
Kuriss, Leiva, Flores & Sanhueza (2010), Kotz, Leiva & Sanhueza (2010), Vilca,
Sanhueza, Leiva & Christakos (2010), Leiva, Sanhueza, Kotz & Araneda (2010),
Leiva, Athayde, Azevedo & Marchant (2011), Leiva, Soto, Cabrera & Cabrera
(2011), Sanhueza, Leiva & Lopez-Kleine (2011), Athayde, Azevedo, Leiva & San-
hueza (2012), Azevedo, Leiva, Athayde & Balakrishnan (2012), Ferreira, Gomes &
Leiva (2012), Fierro, Leiva, Ruggeri & Sanhueza (2013), Leiva, Marchant, Saulo,
Aslam & Rojas (2014), Leiva, Santos-Neto, Cysneiros & Barros (2014), Leiva,
Saulo, Leao & Marchant (2014) and Rojas, Leiva, Wanke & Marchant (2015). It
is important to stress that, in the case of the BS-t distribution, we obtain a robust
estimation procedure for its parameters; see Paula, Leiva, Barros & Liu (2012).
All of these distributions do not belong to the location-scale (LS) family, thus we
refer to them as non-location-scale (NLS) distributions.
    Several efforts have been made to develop goodness-of-fit (GOF) techniques
allowing us to address the problem of fitting the mentioned distributions to dif-
ferent types of data. In general terms, GOF tests permit us to assess whether the
distribution under a null hypothesis (H0 ) is adequate to describe a data set or not.
For this hypothesis, there are two options: (i) the distribution can be completely
specified (known parameters) or (ii) some (or all) of its parameters are unknown,
in which case they need to be estimated with proper methods, such as maximum
likelihood (ML). Depending on the distribution under H0 , ML estimates of its pa-
rameters cannot be easily calculated and iterative numerical procedures must be
used, but problems of convergence may arise, which have not yet been completely
studied; see Castillo & Puig (1997) for more details in this regard.
    According to D’Agostino & Stephens (1986, pp. xi-xiii), GOF methods can
be of graphical type, of chi-squared type or based on the empirical cumulative
distribution function (ECDF), on correlation/regression, on transformations or
on moments. Most test statistics used for assessing GOF, such as Anderson-
Darling (AD), Cramér-von Mises (CM), Kolmogorov-Smirnov (KS), Kuiper (KU)


                                     Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                            343

and Watson (WA), compare the ECDF and the hypothesized theoretical cumula-
tive distribution function (CDF) assumed for the data. KU and WA statistics are
modifications of the KS and CM statistics, respectively, in particular for circular
data given its invariant property under change of origin in a circle. For more
details about AD, CM, KS, KU and WA statistics, see D’Agostino & Stephens
(1986, Ch. 4). Some graphical counterparts of the mentioned goodness-of-fit tests
are considered by Chen & Balakrishnan (1995), Choulakian & Stephens (2001),
Hui, Gel & Gastwirth (2008) and Stehlík, Strelec & Thulin (2014).
    A graph allowing us to relate the ECDF with a specified theoretical CDF is
the probability versus probability (PP) plot. Analogously, ordered observations
corresponding to empirical quantiles can be plotted versus the theoretical quantiles
of a specified distribution in a graph known as the QQ plot; see Marden (2004).
This author studied such a plot in the case of the normal distribution and provided
tools for graphical comparison of two samples, extending also the QQ plot to
multivariate data. A disadvantage of the PP plot associated with the KS test
is that some points in this graph can be more variable than others. Michael
(1983) proposed a modification for the KS test based on the arcsin transformation
to stabilize the variance of the points in the PP plot. The graph related to this
variance stabilizing transformation is known as the stabilized probability (SP) plot
and the statistic associated with the test proposed by Michael (1983) is denoted
as MI. This author studied the power of the MI test showing that it proves more
powerful than the KS test for certain alternative hypotheses. Stehlík et al. (2014)
compared the power and robustness of several classic tests for normality, such
as the AD, Jarque-Bera, KU and Shapiro-Wilk, for different distributions in the
alternative hypothesis, including the Cauchy, Laplace and Student-t with different
degrees of freedom (DF) models. These authors concluded that in general no test
can be recommended as the best for all the alternatives considered.
    In reliability and survival analyses, it is frequent to find situations where not all
individuals or instruments tested complete the event under study which, without
the loss of generality, may be referred to as a “failure”. Samples involving such
situations are named censored data; for literature on this topic see, e.g., Cohen
(1991) and Lawless (2003).
    When a parametric statistical analysis with censored data needs to validate
its distributional assumption, classical GOF test statistics need to be adapted to
consider the censorship following two options. The first consists of using GOF
tests for uncensored data adapting the type-II right censored data to become
an uncensored (complete) data sample, whereas the second option adapts test
statistics to type-II right censored data; see, e.g., Malmquist (1950), D’Agostino
& Stephens (1986, Chs. 4 and 11), Lin, Huang & Balakrishnan (2008) and Barros,
Leiva, Ospina & Tsuyuguchi (2014).
    Castro-Kuriss, Kelmansky, Leiva & Martinez (2009) and Castro-Kuriss, Kel-
mansky, Leiva & Martinez (2010) proposed GOF tests for the LN and normal
distributions with type-II right censored data. Castro-Kuriss (2011) studied GOF
tests for LS distributions with type-II right censored data and unknown parame-
ters. Other works on the topic based on different types of censoring can be found


                                      Revista Colombiana de Estadística 37 (2014) 341–365

344                            Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde


in Barr & Davidson (1973), Dufour & Maag (1978), O’Reilly & Stephens (1988),
Balakrishnan, Ng & Kannan (2004), Lin et al. (2008), Rad, Yousefzadeh & Bal-
akrishnan (2011) and Pakyari & Balakrishnan (2012).
   The objectives of this article are to review the available GOF tests and propose
graphical tools for assessing GOF in NLS distributions based on these tests with
uncensored and censored data. These tools can be used for any distribution in the
NLS family, as long as their parameters are known or properly estimated. With
the provided tools, it is possible to decide what distribution best fits the data.
    This article is structured as follows. In Section 2, we present some well-known
life distributions and the estimation of their parameters with packages of the R
software; see www.r-project.org. In Section 3, we introduce GOF tests for NLS
distributions with uncensored and censored data. In Section 4, we propose graph-
ical tools based on these GOF tests. In Section 5, we illustrate the graphical tools
provided in this paper analyzing real-world data sets from different fields, with em-
phasis on some Birnbaum-Saunders distributions. We also analyze some empirical
robustness aspects with one of these data sets, following the ideas of Hui et al.
(2008) and Stehlík et al. (2014). Finally, in Section 6, we sketch some conclusions
and mention future research on this topic.


2. Life Distributions
    In this section, we present some well-known life distributions, with α > 0 and
β > 0 denoting shape and scale parameters, respectively, and µ denoting the mean
of the distribution.


2.1. BS and Truncated BS Distributions
   A random variable (RV) T with BS distribution of shape α > 0 and scale β > 0
parameters is denoted by T ∼ BS(α, β), where “∼” means “distributed as”. In this
case, the CDF of T is
                        F (t; α, β) = Φ ([1/α]ξ(t/β)) , t > 0,
              √        √                 √
where ξ(y) = y−1/ y = 2 sinh(log( y)) and Φ(·) is the N(0, 1) CDF. The corre-
                                                                p
sponding quantile function (QF) is F −1 (q; α, β) = β[αz(q)/2 + (αz(q)/2)2 + 1]2 ,
for 0 < q < 1, where z(·) is the N(0, 1) QF and F −1 (·) is the inverse CDF. Note
that F −1 (0.5; α, β) = β, that is, β is also the median or 50th percentile of the
BS distribution. If T ∼ BS(α, β), then X ∼ TBSκ (α, β) denotes the truncated
version at κ of T and its CDF is
                          Φ ([1/α]ξ (t/β)) − Φ ([1/α]ξ (κ/β))
         F (t; α, β, κ) =                                     , t ≥ κ > 0.
                                    Φ (−[1/α]ξ (κ/β))
The corresponding QF is F −1 (q; α, β, κ) = β[αzη (q)/2 + (αzη (q)/2)2 + 1]2 , for
                                                            p

0 < q < 1, where zη (·) is the QF of the N(0, 1) distribution truncated (TN) at
η = [1/α]ξ(κ/β); for details about the TN and TBS distributions, see Cohen
(1991) and Ahmed et al. (2010), respectively.

                                    Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                              345

2.2. The BS-t Distribution
   A RV T following the BS-t distribution with shape α > 0, ν > 0 and scale
β > 0 parameters is denoted by T ∼ BS-t(α, β, ν). In this case, the CDF of T is

                                   1h                          i
                F (t; α, β, ν) =      1 + I ξ(t/β)/α (1/2, ν/2) ,       t > 0,
                                   2       ξ(t/β)/α+ν



where Ix (·, ·) ispthe incomplete beta ratio. The corresponding QF is F −1 (q; α, β, ν) =
β[αzt (q)/2 + (αzt (q)/2)2 + 1]2 , for 0 < q < 1, where zt (·) is the QF of the
Student-t distribution with ν DFs. Note that once again β is the median of the
BS-t distribution. For details on the BS-t distribution, see Azevedo et al. (2012).


2.3. The Gamma Distribution
   A RV T following the GA distribution with shape α > 0 and scale β > 0
parameters is denoted by T ∼ GA(α, β). In this case, the CDF of T is

                                       Γ(1/α2 , t/[α2 β])
                       F (t; α, β) =                      ,    t > 0,
                                           Γ(1/α2 )

where Γ(·) and Γ(·, ·) denote the usual and incomplete gamma functions, respec-
tively. Now, the QF given by F −1 (q; α, β), for 0 < q < 1, must be obtained by
means of an iterative method.


2.4. The Inverse Gaussian Distribution
   A RV T following the IG distribution with mean µ > 0 and scale β > 0
parameters is denoted by T ∼ IG(µ, β). In this case, the CDF of T is
                    p             p   p    p 
  F (t; µ, β) = Φ    β/µ ξ(t/µ) + Φ β/µ t/µ + µ/t exp(2β/µ),                      t > 0.

Again the corresponding QF, expressed as F −1 (q; µ, β) = t(q), must be obtained
with a numerical method.


2.5. The Lognormal Distribution
    If X = log(T ) has a normal distribution with mean µ and variance α2 , that
is, X = log(T ) ∼ N(µ, α2 ), then the RV T follows the LN distribution with shape
α > 0 and scale β = exp(µ) > 0 parameters, respectively, which is denoted by
T ∼ LN(α, β). In this case, the CDF of T is

                     F (t; α, β) = Φ ([log(t) − log(β)]/α) ,     t > 0.

The corresponding QF is F −1 (q; α, β) = β exp(z(q)α), for 0 < q < 1, where z(·) is
the N(0, 1) QF.

                                        Revista Colombiana de Estadística 37 (2014) 341–365

346                                Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde


2.6. The Weibull Distribution
   A RV T following the WE distribution with shape α > 0 and scale β > 0
parameters is denoted by T ∼ WE(α, β). In this case, the CDF of T is

                        F (t; α, β) = 1 − exp(−[t/β]α ),       t > 0.

The corresponding QF is F −1 (q; α, β) = β[− log(1 − q)]1/α , for 0 < q < 1.


2.7. Estimation of Parameters
    Using R software (i) exploratory data analysis (EDA) can be conducted for di-
agnosing statistical features present in the data to be analyzed; and (ii) estimation
of the parameters of BS, BS-t, GA, IG, LN, TBS and WE distributions can be
carried out by the ML method. Next, we describe the R functions (commands)
of gbs, ig and basic packages and briefly illustrate their use. The tbs package
is available upon request from the authors. These packages incorporate CDF,
probability density function (PDF) and QF of the TBS distribution, as well as a
random number generator, the moments and the ML estimation of its parameters
for censored and uncensored data.
   The R software can be downloaded from CRAN.r-project.org and installed
as any other software. It may be used in a simple interactive form with the R
commander by installing the Rcmdr package. The gbs, ig and tbs packages must
be also installed. Data analyses based on (i) BS and BS-t distributions can be
carried with the gbs package, (ii) IG distribution with the ig package and (iii) GA,
LN and WE distributions with the basic or fitdistrplus packages. As an example,
the gbs package and a data set, x say, must be loaded as

> library(gbs)
> data(x)

The data can also be directly imported from text files, from other statistical soft-
ware or from Excel. Table 1 provides examples of some commands that allow us
to work with the BS distribution, whereas similar instructions may be used for
the other distributions; for more details on how to use the gbs package, see Barros
et al. (2009).

                      Table 1: Basic functions of the gbs package.
 Function Instruction                       Result
 CDF       pgbs(1.0, alpha=0.5, beta=1.0)   0.500
 PDF       dgbs(1.0, alpha=0.5, beta=1.0)   0.798
 QF        qgbs(0.5, alpha=0.5, beta=1.0)   1.000
 numbers rgbs(n=100, alpha=1.0, beta=1.0) 100 BS(1, 1) random numbers are generated.
 MLE       mlegbs(x)                        ML estimates for data x are provided.
 EDA       descriptiveSummary(x)            A descriptive summary of data x is obtained.
 histogram histgbs(x, boxPlot=T, pdfLine=T) Histogram, boxplot and fitted PDF for x are given.




                                         Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                                   347

3. GOF Tests with Censored and Uncensored Data
    In this section, we define the notations and provide some transformations useful
for obtaining the graphical tools proposed in the paper. In addition, we establish
the hypotheses of interest and the corresponding test statistics to assess GOF for
NLS distributions with censored and uncensored data.


3.1. Un/Censored Data, Transformations and Order
     Statistics
    Let T1 , . . . , Tn be a sample of size n extracted from a RV T following a dis-
tribution with CDF F (·). Also, let T1:n ≤ · · · ≤ Tn:n be the order statistics
(OSs) of T1 , . . . , Tn , with t1:n ≤ · · · ≤ tn:n and t1 , . . . , tn being their corresponding
observations (data). The ECDF is defined by
                 
                  0,                    if t < t1:n ;
                     j           1
      Fn (t) =       n = wj:n + 2n ,     if tj:n ≤ t < tj+1:n , for j = 1, . . . , n − 1;    (1)
                                         if t ≥ tn:n ;
                 
                     1,

where wj:n = [2j − 1]/[2n].
    As it is well-known, the RV U given by the transformation

                                          U = F (T )                                         (2)

follows a uniform distribution in [0,1], denoted by U(0,1), for any continuous F (·),
which is known as probability integral transformation (PIT).
     Another transformation associated with the U(0, 1) distribution was proposed
by Michael (1983), who noted that, if U ∼ U(0, 1), then the RV given by the
transformation
                                         2      √
                                     S = arcsin( U ),                            (3)
                                         π
which is known as stabilized probability transformation, follows a distribution with
PDF
                                       2
                              fS (s) = sin(πs), 0 < s < 1.                       (4)
                                       π
The OSs S1:n ≤ · · · ≤ Sn:n associated with a sample of size n from the distribution
of the RV S given in (3) have a constant asymptotic variance, because as n goes
to ∞ and j/n to q, Var[n Sj:n ] goes to 1/π 2 , which is independent of q, for j =
1, . . . , n; see Michael (1983).
    Consider a sample with censoring proportion p, which conducts to r failure
(uncensored) data and n − r censored data. Note that n and p are controlled
by the researcher. Assume a type-II right censorship, so that, in this case, r is
fixed and n − r observations are greater than the censoring point tr:n . Then,
U1:n = F (T1:n ) ≤ · · · ≤ Ur:n = F (Tr:n ) are the smallest r OSs of the type-II
censored sample of size n and n − r observations are greater than ur:n = F (tr:n ).
Let Uj:n = F (Tj:n ) be the jth OS of a sample of size n extracted from a RV


                                          Revista Colombiana de Estadística 37 (2014) 341–365

348                               Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde


U ∼ U(0, 1) and uj:n = F (tj:n ) be its observed value, for j = 1, . . . , n. Consider
the transformation

           0       Uj:n [Br,n−r+1 (Ur:n )]1/r
          Uj:n =                              ,   j = 1, . . . , r,   r = 1, . . . , n,   (5)
                             Ur:n

where Br,n−r+1 (x) = Ix (r, n − r + 1) is the Beta(r, n − r + 1) CDF, with Ix (·, ·)
                                                             0             0
being the incomplete beta ratio function. Hence, the OSs U1:n   , . . . , Ur:n obtained
from the transformation given in (5) are distributed as the OSs from a complete
sample of size r from U 0 ∼ U(0, 1); see details in Theorem 1 of Lin et al. (2008),
Theorem 1 of Michael & Schucany (1979) and Theorem 8 of Fischer & Kamps
(2011).



3.2. Hypotheses

    Consider the hypotheses: H0 : “The data come from a RV T with CDF F (·)”
versus H1 : “The data do not come from this RV”. The hypothesized distribution
with CDF F (·) is indexed by a parameter vector θ that can contain location (µ),
scale (β), shape (α) parameters, or any other parameter not necessarily of location
and scale, that is, T belongs to the NLS family. If the CDF is completely specified
in H0 , that is, θ is assumed to be known, the data must be transformed for testing
uniformity. On the contrary, the parameters must be consistently estimated and
the data transformed for testing normality of the distribution under H0 .



3.3. Test Statistics for GOF with Uncensored Data

    In order to test H0 established in Subsection 3.2, where F (·) is completely
specified, and then to assess GOF of a distribution to a censored or uncensored data
set, we consider test statistics based on the ECDF Fn (·) defined in (1). The most
common statistics constructed with the ECDF use vertical differences between
Fn (t) and F (t) by means of the supremum and quadratic classes. Statistics that
consider the mentioned classes are AD, CM, KS, KU and WA given by
           Z ∞
               [Fn (t) − F (t)]2
  AD = n                         dF (t),                                   (6)
           −∞ F (t)[1 − F (t)]
          Z ∞
  CM = n      [Fn (t) − F (t)]2 dF (t),                                    (7)
           −∞
                                    n                                 o
  KS = sup Fn (t) − F (t) = max sup Fn (t) − F (t) , sup F (t) − Fn (t) , (8)
         t                            t                      t
                                   
  KU = sup Fn (t) − F (t) + sup F (t) − Fn (t) ,                           (9)
         t                        t
          Z ∞h                    Z ∞                          i2
                                        
  WA = n        Fn (t) − F (t) −          Fn (t) − F (t) dF (t) dF (t).   (10)
             −∞                      −∞



                                       Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                                 349

By considering (3) and (8), we can define the MI statistic as
                      n
              MI = max sup π2 arcsin(Fn (t)) − π2 arcsin(F (t)) ,
                           
                         t
                                                                 o
                        sup π2 arcsin(F (t)) − π2 arcsin(Fn (t)) .
                           
                                                                                         (11)
                                       t


Now, by considering (2), AD, CM, KS, KU, MI and WA statistics defined in
(6)-(11) can be implemented in practice by the formulas

                 n
                 X
    AD = −2            [wj:n log(Uj:n ) + {1 − wj:n } log(1 − Uj:n )] − n,               (12)
                 j=1
           n
           X                       2
                                   1
   CM =          [Uj:n − wj:n ] + 12n ,                                                  (13)
           j=1
                  n                                                  o
                               1                                   1
                                                 
    KS = max           max
                       wj:n + 2n  − Uj:n , max Uj:n − wj:n + 2n       ,                  (14)
               1≤j≤n                        1≤j≤n
              n                  o          n                  o
                       1                                     1
    KU = max wj:n + 2n    − Uj:n + max Uj:n − wj:n + 2n         ,                        (15)
        1≤j≤n                         1≤j≤n
             n
    MI = max max π2 arcsin wj:n + 2n     1
                                           2
                                            − π arcsin(Uj:n ) ,
               1≤j≤n
                                                             o
                max π2 arcsin(Uj:n ) − π2 arcsin wj:n − 2n1
                     
                                                                 ,                       (16)
                       1≤j≤n
           n
           X                       h P n          i2
                               2
   WA =          [Uj:n − wj:n ] − n n1                1
                                         Uj:n − 21 + 12n ,                               (17)
           j=1                             j=1



where wj:n and Uj:n are as given in (1) and (5), respectively. Further details on
the expressions provided in (6)-(17) can be found in D’Agostino & Stephens (1986,
Ch. 4) and Michael (1983). Quantiles of the distribution of the statistics AD, CM,
KS, KU, MI and WA must be obtained under H0 . However, if the distribution
under this hypothesis is not completely specified, its parameters must be properly
estimated and the AD, CM, KS, KU, MI and WA statistics must be modified for
the distribution under H0 . These modified statistics are denoted by AD? , CM? ,
KS? , KU? , MI? and WA? , and their calculated values by ad? , cm? , ks? , ku? , mi?
and wa? , respectively. In this case, new quantiles of the distribution of AD? , CM? ,
KS? , KU? , MI? and WA? must be computed under H0 .



3.4. Test Statistics for GOF with Censored Data

    To test H0 where F (·) is completely specified and then to assess GOF in prac-
tice with r uncensored data and n − r type-II right censored data, we use the
results presented in D’Agostino & Stephens (1986, Ch. 4) and adapt the statistics
given in (12)-(17) as


                                           Revista Colombiana de Estadística 37 (2014) 341–365

350                                     Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde



                       r
                       X
      ADr,n = −2             [wj:n log(Uj:n ) − {1 − wj:n } log(1 − Uj:n )]                 (18)
                       j=1
              1
                {n − r}2 log(1 − Ur:n ) − r2 log(Ur:n ) + n2 Ur:n ,
                                                                 
             −
              n
              r                                         3
                                     r     n
                                               Ur:n − nr ,
                                             
                 [Uj:n − wj:n ]2 + 12n
              P
      CMr,n =                          2 + 3                                                (19)
                 j=1
                        n                                               o
                                   1                                  1
                                                    
      KSr,n = max   max wj:n + 2n    − Uj:n , max Uj:n − wj:n + 2n       ,                  (20)
                   1≤j≤r                      1≤j≤r
                   n                 o          n                  o
                             1                                   1
      KUr,n = max wj:n + 2n    − Uj:n + max Uj:n − wj:n + 2n        ,                       (21)
             1≤j≤r                       1≤j≤r
                  n
      MIr,n = max max π2 arcsin wj:n + 2n   1
                                               2
                                                − π arcsin(Uj:n ) ,
                    1≤j≤r
                                                                 o
                                                              1
                     max π2 arcsin(Uj:n ) − π2 arcsin wj:n − 2n
                           
                                                                     ,                      (22)
                             1≤j≤r
                 r                                             3
                                           r     n
                                                     Ur:n − nr
                                                   
                       [Uj:n − wj:n ]2 + 12n
                 P
      WAr,n =                                2 + 3
                 j=1
                                         Pr
                                            j=1 Uj:n
                         hr
                         Ur:n                          i2
             − nUr:n   −      −                             .                               (23)
                     n    2                 nUr:n
The quantiles of the distribution of the ADr,n , CMr,n , KSr,n , KUr,n , MIr,n and
WAr,n statistics given in (18)-(23) must be obtained under H0 . However, if the
distribution under H0 is not completely specified, its parameters must be properly
estimated, taking into account the censorship, and the statistics must be modified
for each case under H0 . We denote these statistics by AD?r,n , CM?r,n , KS?r,n , KU?r,n ,
MI?r,n and WA?r,n , and their calculated values by ad?r,n , cm?r,n , ks?r,n , ku?r,n , mi?r,n
and wa?r,n , respectively. Also, new quantiles of the distribution of AD?r,n , CM?r,n ,
KS?r,n , KU?r,n , MI?r,n and WA?r,n must be computed under H0 . For more details
about how to obtain the quantiles of the distributions of the corresponding test
statistics under H0 , which have been studied for different distributions of the LS
family with uncensored and censored, see D’Agostino & Stephens (1986), Castro-
Kuriss et al. (2009), Castro-Kuriss et al. (2010) and Castro-Kuriss (2011). In the
next subsections, we mention that, for NLS distributions, analogous results for
assessing GOF with both censored and uncensored data can be considered.


3.5. GOF Tests for NLS Distributions with Uncensored Data
    If the hypotheses of interest H0 is F (t) = Φ([t − µ]/β) with unknown parame-
ters, we can consider the procedure detailed in Algorithm 1.
    We consider a procedure that can be applied to NLS distributions based on the
work proposed by Chen & Balakrishnan (1995), which provides an approximate
GOF method. This method first transforms the data to normality and then applies
Algorithm 1, generalizing it. Testing normality in H0 allows us to compute the
critical values of the corresponding test statistics, independently of the parameter


                                              Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                                                  351

Algorithm 1 GOF test for normality with uncensored data
1: Collect data t1 , . . . , tn and order them as t1:n , . . . , tn:n ;
2: Estimate µ and β of Φ([t − µ]/β) by µ             b respectively, with t1 , . . . , tn ;
                                               b and β,
3: Obtain ubj:n = Φ(b   zj ), with zbj = [tj:n − µ  b for j = 1, . . . , n;
                                                 b]/β,
4: Evaluate AD? , CM? , KS? , KU? , MI? and WA? statistics at u            bj:n ;
5: Compute the p-values of the AD? , CM? , KS? , KU? , MI? and WA? statistics;
6: Reject H0 : F (t) = Φ([t − µ]/β) for a specified significance level based on the obtained p-
   values.




estimators, if they are consistent and the sample size is large enough. To test the
hypotheses of interest defined in Subsection 3.2, for α > 0 and β > 0 unknown, we
consider a generalization of Algorithm 1 based on Chen & Balakrishnan (1995)’s
method, which is detailed in Algorithm 2. Following Chen & Balakrishnan (1995);
in general, we recommend a sample size n > 20, so that the approximations work
well. This is also valid for the algorithms presented in the next sections.

Algorithm 2 GOF test for NLS distributions with uncensored data
1: Collect data t1 , . . . , tn and order them as t1:n , . . . , tn:n ;
2: Estimate α and β of F (t; α, β) by α      b and β,b respectively, with t1 , . . . , tn ;
3: Compute v bj:n = F (tj:n ; α       b for j = 1, . . . , n;
                                  b, β),
4: Calculate ybj = Φ−1 (b     vj:n ), where Φ−1 (·) is the N(0,
                                                              P 1) inverse CDF or QF     P z(·);
5: Obtain ubj:n = Φ(b   zj ), with zbj = [byj − ȳ]/sy , ȳ = n  j=1 y bj /n and sy = [ n        yj − ȳ)2 /(n −
                                                                                            j=1 (b
      1/2
   1)] ;
6: Repeat Steps 4-6 of Algorithm 1 with F (t) = F (t; α, β).




3.6. GOF Tests for NLS Distributions with Censored Data

   As mentioned, GOF tests for NLS distributions with uncensored data can be
considered for censored data adapting them or the GOF statistics.
   To test the hypotheses of interest defined in Subsection 3.2, for α > 0 and β > 0
both of them unknown and type-II right censored data, we first transform censored
data into uncensored data by using (5). Algorithm 3 details the corresponding
GOF procedure.

Algorithm 3 GOF test 1 for NLS distributions with censored data
1: Repeat Steps 1-3 of Algorithm 2;
2: Determine v 0
             bj:n =v                vr:n )]1/r /b
                    bj:n [Br,n−r+1 (b           vr:n , for j = 1, . . . , r and r = 1, . . . , n;
3: Repeat Steps 4-6 of Algorithm 2 replacing v  bj:n by v  0
                                                          bj:n in Step 4.



    Second, as mentioned, another way to perform a GOF test for NLS distribu-
tions with censored data can be obtained adapting the GOF statistics, as detailed
in Algorithm 4.

                                               Revista Colombiana de Estadística 37 (2014) 341–365

352                               Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde

Algorithm 4 GOF test 2 for NLS distributions with censored data
1: Repeat Steps 1-5 of Algorithm 2;
2: Evaluate AD?r,n , CM?r,n , KS?r,n , KU?r,n , MI?r,n and WA?r,n statistics at u
                                                                                bj:n ;
3: Determine the p-values of AD?r,n , CM?r,n , KS?r,n , KU?r,n , MI?r,n and WA?r,n statistics;
4: Reject the corresponding H0 for a specified significance level depending on the obtained
   p-values.



4. Graphical Tools
   In this section, based on Algorithm 4, we provide acceptance regions for the
KS and MI statistics that allow graphical tools to be obtained for assessing GOF
in NLS distributions.


4.1. PP and SP Plots
    PP and QQ plots are well known, however this is not the case of the SP plot.
Note that, if the distribution under H0 is U(0,1), then the corresponding QQ plot is
essentially the same as the PP plot; see Castro-Kuriss et al. (2009). Michael (1983)
used the arcsin transformation to stabilize the variance of points on probability
graphs associated with the KS test to propose the SP plot; see PDF given in (4)
and comments relating thereto in Subsection 3.1. Formulas to construct PP and
SP plots are provided in Table 2. In this table, wj:n is as given in (1) and uj:n as
given above (5).
                 Table 2: formulas for the indicated probability plot.
                 Plot           Abscissa                          Ordinate
                 PP              wj:n                               uj:n
                                            √                                 √
                        xj:n = π2 arcsin                   sj:n = π2 arcsin
                                                                                        
                  SP                            wj:n                              uj:n




4.2. Acceptance Regions for Probability Plots
    Acceptance regions for PP and SP plots can be constructed by means of KS
and MI statistics. Thus, we can display acceptance bands to assess whether the
data can come from the distribution under H0 with these two statistics; see Castro-
Kuriss et al. (2009) and Castro-Kuriss et al. (2010). Formulas to construct 100%%
acceptance regions on PP and SP plots with right type-II censored data, based on
KS?r,n and MI?r,n , are displayed in Table 3. In this table, w and x are continuous
versions of wj:n and xj:n given in Table 2 to construct the acceptance bands. If all
of the r data points lie within the constructed acceptance bands, then H0 cannot
be rejected at the 1 − % level. Also, if a noticeable curvature is detected, we can
question such a hypothesis. Table 3 may be adapted to the uncensored case with
r = n and the quantiles must be replaced by the quantiles of the distribution of
the corresponding statistics without censorship.
    To test H0 defined in Subsection 3.2, for some α > 0 and β > 0 and type-II
right censored data, we propose a graphical tool which procedure is detailed in


                                           Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                                            353

Table 3: 100%% acceptance regions for the indicated plot and statistic with 100%th
         quantiles ks?r,n,% and mi?r,n,% .
   Plot Stat Bands defining acceptance regions
                               1                           1
   PP KS? [max{w − ks?r,n,% + 2n , 0}, min{w + ks?r,n,% − 2n , 1}]
                                   1                                         1
   PP MI? [max{sin2 (arcsin(w 2 ) − π2 mi?r,n,% ), 0}, min{sin2 (arcsin(w 2 ) + π2 mi?r,n,% ), 1}]
                                                           1
   SP KS? [max{ π2 arcsin({sin2 ( π2 x) − ks?r,n,% + 2n
                                                      1 2
                                                        } ), 0},
                                                                                      1 1
                                           min{ π2 arcsin({sin2 ( π2 x) + ks?r,n,% − 2n } 2 ), 1}]
   SP     ?           ?                     ?
        MI [max{x − mir,n,% , 0}, min{x + mir,n,% , 1}]



Algorithm 5 based on Algorithm 4 and Tables 2 and 3, which is valid for censored
or uncensored data. We consider the general case for unknown parameters of the
distribution under H0 , although it may also be used when the parameters are
known.

Algorithm 5 Acceptance regions to test GOF for NLS distributions with censored data
1: Repeat Step 1 of Algorithm 4;
2: Draw the PP plot with points wj:n versus u bj:n , for j = 1, . . . , r and r = 1, . . . , n;
                                                      √                                         p
3: Draw the SP plot with points xj:n = [2/π] arcsin( wj:n ) versus sj:n = [2/π] arcsin( u         bj:n );
4: Construct acceptance bands according to Table 3 specifying a 1 − % level;
5: Decide if H0 must be rejected for the corresponding significance level;
6: Corroborate decision in Step 5 with the p-values after evaluating KS?r,n and MI?r,n statistics
   at u
      bj:n .




5. Examples
    In this section, we consider several real-world data sets and NLS distributions
under H0 and decide whether such data may reasonably come from the hypothe-
sized distribution. The results are also displayed by means of the probability plots
with the acceptance bands proposed in Section 4.


5.1. Example 1: Uncensored Sea Data
    These data are drawn from sea surface temperatures (in o K), generated by an
advanced very high resolution radiometer. We name data “sea”. The sample size is
n = 88 and the truncation point is κ = 278.187o K; see DePriest (1983). An EDA
for sea data is provided in Table 4, including the coefficients of variation (CV),
skewness (CS) and kurtosis (CK) and the standard deviation (SD). Figure 1 dis-
plays their histogram and boxplot. This EDA indicates that the TBS distribution
can be suitable for describing such data, as a competitor of the TN distribution.
Some atypical data are detected in the boxplot, but their study is not considered
here since it is beyond the scope of this work. We consider the TBS and TN
models under H0 with parameters estimated. We use the tbs and truncnorm R


                                             Revista Colombiana de Estadística 37 (2014) 341–365

354                                                   Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde


packages, respectively, for making this estimation with the ML method. The cor-
responding estimates and the p-values from the GOF tests are displayed in Table
5. According to these p-values, both distributions perform a good fitting to the
data. We show the PP and SP plots in Figure 2 for the TBS distribution defined
in Section 2. From this figure, note that the points are well aligned, as expected,
due to the high p-values obtained for the TBS distribution, and that all the points
fall inside the 95% acceptance bands, which confirms the good fitting of the TBS
distribution to sea data.
                                  Table 4: Descriptive statistics for sea data.
      Median   Mean       SD       CV       CS      CK      Range     Min    Max           n
       279.5   279.6     0.787    0.003    0.008      3       3.8    278.2   282           88
      where CV: coefficient of variation, CS: coefficient of skewness, CK: coefficient of kurtosis
             SD: standard deviation, Min: minimum value and Max: maximum value.
        0.5




                                                                           0.5
        0.4




                                                                           0.4
        0.3




                                                                           0.3
PDF




                                                                     PDF
        0.2




                                                                           0.2
        0.1




                                                                           0.1
        0.0




                                                                           0.0




              278         279          280           281       282               278   279          280           281     282


                           sea surface temperature (in °K)                              sea surface temperature (in °K)




Figure 1: Histogram, boxplot and estimated PDF from TN (left) and TBS (right) dis-
          tributions for sea data.


Table 5: Estimated parameters and values of the statistics for the indicated distribution
         under H0 with sea data.
                    Distribution Parameter Estimate      Estimated statistic    p-value
                        TBS          α          0.0057       ks? = 0.0653      [0.4, 0.5]
                                     β        278.8488      mi? = 0.0414       [0.7, 0.8]
                        TN           µ        279.6093       ks? = 0.0600      [0.5, 0.6]
                                     σ          1.0011      mi? = 0.0369       [0.8, 0.9]
                            ?      ?
                    where ks and mi are the estimated values of the KS and MI statistics.




5.2. Example 2: Uncensored Forestry Data
   Data correspond to the diameter at breast height (DBH, in cm) of loblolly
pine trees from a plantation in the Western Gulf Coast. We name data “forestry”.
The sample size is n = 75 and the left-truncation point is κ = 6 cm; see Leiva,

                                                             Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                                                                                                                355




                                                                                                      1.0
               1.0
                            SP bands                                                                                SP bands
                            KS bands                                                                                KS bands




               0.8




                                                                                                      0.8
                                                                       ECDF transformed with arcsin
               0.6




                                                                                                      0.6
        ECDF

               0.4




                                                                                                      0.4
               0.2




                                                                                                      0.2
               0.0




                     0.0     0.2       0.4      0.6     0.8      1.0                                                0.2        0.4        0.6        0.8      1.0

                                        U(0,1) CDF                                                                    U(0,1) CDF transformed with arcsin

Figure 2: PP (left) and SP (right) plots with 95% acceptance bands for the TBS dis-
          tribution with sea data.


Ponce, Marchant & Bustos (2012). Table 6 provides an EDA of forestry data,
which indicates once again that the TBS distribution can be a good model for the
data.
    From the histograms displayed in Figure 3, note that the fit of the TBS dis-
tribution is apparently better than for the TN distribution. The corresponding
estimates and the p-values from the GOF tests are displayed in Table 7. Accord-
ing to these p-values, both distributions perform a reasonable fit to the data, but
clearly the TBS distribution has a better performance. Figure 4 shows the PP
and SP plots for the TBS distribution. From this figure, note that once again
the points are well aligned, as expected, due to the p-values obtained for the TBS
distribution, and all the points fall within distribution to forestry data.
                              Table 6: Descriptive statistics for forestry data.
       Median              Mean          SD            CV         CS                                         CK           Range          Min           Max          n
        8.20               8.19         1.013         0.124      0.053                                      2.253          4.1           6.2           10.3         75


Table 7: Estimated parameters and statistic values for the indicated distribution under
         H0 with forestry data.
               Distribution            Parameter              Estimate                                      Estimated statistic                     p-value
                   TBS                     α                   0.12804                                        ks? = 0.07031                        [0.4, 0.5]
                                           β                   8.23963                                        mi? = 0.05923                       [0.25, 0.4]
                       TN                  µ                   7.54905                                        ks? = 0.08201                       [0.2, 0.25]
                                           σ                   2.42369                                        mi? = 0.06697                        [0.1, 0.2]




5.3. Example 3: Uncensored Survival Data
    These data are drawn from survival times (in days) of pigs injected with a dose
of tubercle bacilli, under a regimen corresponding to 4.0 × 106 bacillary units per
0.5 ml (log(4.0 × 106 ) = 6.6). We name data “survival”. The sample size is n = 72
guinea pigs infected with tubercle bacilli in regimen 6.6; see Azevedo et al. (2012).

                                                              Revista Colombiana de Estadística 37 (2014) 341–365

356                                                       Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde




                                                                                                                0.3
                    0.3
                    0.2




                                                                                                                0.2
       PDF




                                                                               PDF
                    0.1




                                                                                                                0.1
                    0.0




                                                                                                                0.0
                           6          7         8         9         10
                                                                                                                      6            7            8            9         10


                                           DBH (in cms)                                                                                       DBH (in cms)




Figure 3: Histogram, boxplot and estimated PDF from TN (left) and TBS (right) dis-
          tributions for forestry data.
              1.0




                                                                                                                          SP bands
                               SP bands

                                                                                                               0.8
                               KS bands
                                                                                                                          KS bands
              0.8




                                                                                ECDF transformed with arcsin

                                                                                                               0.6
              0.6
       ECDF




                                                                                                               0.4
              0.4
              0.2




                                                                                                               0.2
              0.0




                     0.0        0.2       0.4       0.6       0.8        1.0                                              0.2           0.4          0.6         0.8        1.0

                                           U(0,1) CDF                                                                           U(0,1) CDF transformed with arcsin

Figure 4: PP (left) and SP (right) plots with 95% acceptance bands for the TBS dis-
          tribution with forestry data.




Table 8 and Figure 5 provide an EDA of survival data. From this EDA, we detect
a distribution skewed to the right with the presence of some outliers. We are
considering an outlier in the sense defined by Hubert & Vandervieren (2008). We
propose the BS and BS-t distributions defined in Section 2 for analyzing survival
data. ML estimates of the BS and BS-t parameters, which are obtained using the
gbs package, and the p-values from the GOF tests are displayed in Table 9. Clearly
the BS distribution does not properly fit these data, whereas the BS-t distribution
provides a better fit. Figures 6 and 7 show the PP and SP plots for the BS and
the BS-t distributions, respectively. From Figure 6, note that the points are not
well aligned, particularly in the center, and that one observation (number 15) is
outside the KS band. In Figure 7, the points are better aligned, as expected, due
to the p-values obtained for the BS-t distribution, and all the points fall within
the 95% acceptance bands, indicating the good fitting of the BS-t distribution to
survival data.


                                                                    Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                                                                                                                       357

                                 Table 8: Descriptive statistics for survival data.
          Median                Mean               SD              CV          CS                                    CK          Range             Min             Max    n
           70.00                99.82             81.12            0.81       1.76                                  5.46          364              12              376    72




                 0.010




                                                                                                                    0.010
                 0.008




                                                                                                                    0.008
                 0.006




                                                                                                                    0.006
       PDF




                                                                                   PDF
                 0.004




                                                                                                                    0.004
                 0.002




                                                                                                                    0.002
                 0.000




                                                                                                                    0.000
                           0          100           200            300       400                                            0         100           200            300    400


                                                  time (in days)                                                                                  time (in days)




Figure 5: Histogram, boxplot and estimated PDF from BS (left) and BS-t (right) dis-
          tributions for survival data.

Table 9: Estimated parameters and statistic values for the indicated distribution under
         H0 with survival data.
               Distribution                 Parameter                    Estimate                                   Estimated statistic                          p-value
                    BS                          α                          0.7600                                     ks? = 0.08848                           [0.01, 0.05]
                                                β                         77.5348                                     mi? = 0.07318                            [0.05, 0.1]
                         BS-t                   α                          0.6085                                     ks? = 0.08201                             [0.1, 0.2]
                                                β                         75.5880                                     mi? = 0.05908                            [0.25, 0.4]
                                                ν                          5.0000                                           -                                       -
               1.0




                                SP bands                                                                                         SP bands
                                KS bands                                                                                         KS bands
                                                                                                                  0.8
                                                                                   ECDF transformed with arcsin
               0.8




                                                                                                                  0.6
               0.6
        ECDF

               0.4




                                                                                                                  0.4
               0.2




                                                                                                                  0.2
               0.0




                         0.0    0.2         0.4           0.6      0.8      1.0                                                 0.2         0.4        0.6         0.8   1.0

                                            U(0,1) CDF                                                                           U(0,1) CDF transformed with arcsin

Figure 6: PP (left) and SP (right) plots with 95% acceptance bands for the BS distri-
          bution with survival data.


5.4. Example 4: Uncensored Survival Data with Outliers
   Next, we conduct a simple empirical robustness study. First, we add a large
value (outlier) to the data and call them “survival1”, so that we now have a sample

                                                                          Revista Colombiana de Estadística 37 (2014) 341–365

358                                                Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde




              1.0
                          SP bands                                                                     SP bands
                          KS bands                                                                     KS bands




                                                                                                0.8
              0.8




                                                                 ECDF transformed with arcsin

                                                                                                0.6
              0.6
       ECDF

              0.4




                                                                                                0.4
              0.2




                                                                                                0.2
              0.0




                    0.0   0.2        0.4     0.6    0.8    1.0                                        0.2      0.4        0.6       0.8     1.0

                                     U(0,1) CDF                                                        U(0,1) CDF transformed with arcsin

Figure 7: PP (left) and SP (right) plots with 95% acceptance bands for the BS-t dis-
          tribution with survival data.




of size n = 73. This new observation is greater than all the observed values
(t73:73 = 580). Second, we add another large value (t74:74 = 750) to the data and
call them as “survival2’, so that we now have a sample of size n = 74. Then, we
add one more outlier, corresponding to the value t75:75 = 1000, and call these data
as “survival3’. Figure 8 displays usual and adjusted boxplots and stripcharts for
survival data, as well as for the data with one, two and three outliers, that is, for
survival1, survival2 and survival3. The adjusted boxplot is often used for skewed
data because it includes a robust measure of skewness; see Hubert & Vandervieren
(2008) and Hubert & Vanderveeken (2008). The stripchart is a scatterplot in
one dimension, where all the observations are plotted. From these graphs we can
visualize the effect of the outliers added to the data. In the adjusted boxplot for
survival1 (see Figure 8-center), it is possible to note that the first added value
is an outlier, but when a second atypical value is added for survival2, only this
second value is detected as outlier, the first is no longer an outlier for this data
set. With the third value being part of the sample, which is much greater than
the others, the presence of two outliers is detected. ML estimates and the p-values
of the GOF tests for survival1, survival2 and survival3 are provided in Table 10.
Note that minor changes in the estimated parameters and in the bounds for the
p-values of the tests are detected. For survival3 data, the differences are more
noticeable. We conclude that the GOF tests are relatively robust to outliers when
the BS-t distribution is considered under H0 , in particular the MI test, nonetheless
a more extensive study on this issue should be carried out.

     Figure 9 shows the PP and SP plots based on the BS-t distribution for the
survival data with three outliers added. From this figure, note that the points are
still well aligned, particularly in the center, but now observation number 15 is not
near the bands and there is one observation (number 42) outside the KS band. If
we compare Figures 7 and 9, there are no apparently visual differences with minor
different alignments in the points, specifically because rejection is due to points in
the center and not in the tails of the sample where the outliers are located.


                                                          Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                                                                                                                                                                                                   359




                  1000




                                                                                             1000




                                                                                                                                                                                                        1000
                  800




                                                                                             800




                                                                                                                                                                                                        800
                  600




                                                                                             600




                                                                                                                                                                                                        600
time (in days)




                                                                            time (in days)




                                                                                                                                                                                       time (in days)
                                                                                             400
                  400




                                                                                                                                                                                                        400
                                                                                                                                                                                                        200
                                                                                             200
                  200




                                                                                                                                                                                                        0
                                                                                             0
                  0




                          survival     survival1    survival2   survival3                             survival    survival1                              survival2   survival3                                 survival    survival1        survival2   survival3

Figure 8: Boxplots (left), adjusted boxplots (center) and stripchart (right) for survival
          and outliers added.

Table 10: Estimated parameters and statistic values for the indicated distribution under
          H0 with survival data.
                 Distribution                      Parameter                Estimate                             Estimated statistic                                                                      p-value                      n           Data set
                     BS-t                              α                      0.6036                               ks? = 0.09313                                                                         [0.10, 0.2]                   73          survival1
                                                       β                     76.2200                               mi? = 0.05916                                                                         [0.25, 0.4]
                                                       ν                      4.0000                                     -                                                                                    -
                         BS-t                          α                      0.5806                              ks? = 0.095664                                                                         [0.05, 0.1]                   74          survival2
                                                       β                     76.0500                              mi? = 0.058160                                                                         [0.25, 0.4]
                                                       ν                      3.0000                                     -                                                                                    -
                         BS-t                          α                      0.6049                              ks? = 0.102022                                                                        [0.01, 0.05]                   75          survival3
                                                       β                     77.2200                              mi? = 0.060802                                                                        [0.20, 0.25]
                                                       ν                      3.0000                                     -                                                                                    -
                                     1.0




                                                       SP bands                                                                                                              SP bands
                                                       KS bands                                                                                                              KS bands
                                                                                                                                                           0.8
                                     0.8




                                                                                                                          ECDF transformed with arcsin

                                                                                                                                                           0.6
                                     0.6
                            ECDF

                                     0.4




                                                                                                                                                           0.4
                                     0.2




                                                                                                                                                           0.2
                                     0.0




                                           0.0          0.2        0.4      0.6                     0.8          1.0                                                       0.2                    0.4                0.6       0.8           1.0

                                                                    U(0,1) CDF                                                                                                   U(0,1) CDF transformed with arcsin

Figure 9: PP (left) and SP (right) plots with bands for the BS-t distribution with
          survival and 3 outliers added.



5.5. Censored Fatigue Data
  These data correspond to fatigue life (in cycles ×10−3 ) aluminum coupons.
We name data “fatigue”; see details in Birnbaum & Saunders (1969) and Leiva,

                                                                                                           Revista Colombiana de Estadística 37 (2014) 341–365

360                                                      Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde


Rojas, Galea & Sanhueza (2014). We consider a censored fatigue data sample,
such as in Barros et al. (2014), so that we have r = 80 failures and n − r = 21 data
censored. From the histogram displayed in Figure 10, note that the distribution
of fatigue data is clearly skewed to the right and that the BS distribution shows a
good fitting to these data, which must be corroborated.
    The parameters are estimated at α    b = 0.1751 and βb = 132.2525, by the ML
method, considering the presence of type-II censoring. The KS and MI statistics
are computed such as in Examples 1 and 2, and their corresponding p-values based
on the BS distribution are in [0.2, 0.25] and [0.4, 0.5]. According to these p-values,
we cannot reject the null hypothesis that the censored sample comes from a BS
distribution, which can be confirmed from the PP and SP plots shown in Figure
11. This result is consistent with those obtained by other authors.
                                                 0.015
                                                 0.010
                                     PDF


                                                 0.005
                                                 0.000




                                                         80     100    120       140                             160   180    200     220


                                                                              fatigue life (in cycles x 10^{−3})




       Figure 10: Histogram, boxplot and estimated BS PDF for fatigue data.
              0.8




                                                                                                                 0.7




                          SP bands                                                                                               SP bands
                                                                                  ECDF transformed with arcsin

                                                                                                                 0.6




                          KS bands                                                                                               KS bands
              0.6




                                                                                                                 0.5
                                                                                                                 0.4
       ECDF

              0.4




                                                                                                                 0.3
              0.2




                                                                                                                 0.2
                                                                                                                 0.1
              0.0




                    0.0   0.2              0.4            0.6           0.8                                                     0.2         0.4       0.6         0.8

                                U(0,1) CDF                                                                                   U(0,1) CDF transformed with arcsin

Figure 11: PP (left) and SP (right) plots with 95% acceptance bands for the BS dis-
           tribution with fatigue data.




                                                                      Revista Colombiana de Estadística 37 (2014) 341–365

Graphical Tools to Assess Goodness-of-Fit                                           361

6. Conclusions and Future Research
    We reviewed goodness-of-fit tests for life distributions not belonging to the
location-scale family with uncensored and type-II right censored data. We con-
sidered the most used tests to assess goodness-of-fit based on the empirical distri-
bution function. These tests are Anderson-Darling, Cramér-von Mises, Kolmogo-
rov-Smirnov, Kuiper, Michael and Watson, which we have used for assessing if a
non-location-scale distribution is suitable to fit a data set. We adopted the two
options available in the literature on the topic to construct goodness-of-fit tests
with censored data, that is, transforming the censored sample into an uncensored
one thereafter applying the usual tests, or adapting the goodness-of-fit test to cen-
sored data. We proposed graphical tools related to goodness-of-fit tests based on
Kolmogorov-Smirnov and Michael statistics, useful for diverse practitioners who
in the past were limited to fit distributions in the location-scale family. Now,
they may take into account any distribution with parameters properly estimated
and sample size large enough. We illustrated the use of the results proposed in
the paper, with emphasis in some Birnbaum-Saunders distributions, by means of
several censored and uncensored real-world data sets, which analyses have shown
their potential and how the goodness-of-fit tests and the associated graphs can be
used in practice. Also, we analyzed some empirical robustness aspects through
an example. We would like to mention some future research on this topic. We
specifically propose:
   • to study the sensitivity of the tests to outliers with different distributions
     under the null hypothesis.
   • to analyze the robustness of the tests for different alternative hypothesis.
   • to establish for distributions not considered by Chen & Balakrishnan (1995)
     what sample size and censoring proportion can be recommended, for approx-
     imate tests to work well.
   • to study the power of the Michael test and compare it to other considered
     tests.
   • to extend the proposed graphical tools to multivariate data.


Acknowledgments
     The authors thank the Guest Editor of the Special Issue on “Current Topics in
Statistical Graphics”, Dr. Fernando Marmolejo-Ramos, the Editor-in-Chief of the
journal, Dr. Leonardo Trujillo, and two anonymous referees for their constructive
comments on an earlier version of this manuscript which resulted in this improved
version. This study was partially supported by the Chilean Council for Scien-
tific and Technological Research under the project grant FONDECYT 1120879
and by the Research Centre of Mathematics of the University of Minho with the
Portuguese Funds from the “Fundação para a Ciência e a Tecnologia” under the
project grant PEstOE/MAT/UI0013/2014.


                                     Revista Colombiana de Estadística 37 (2014) 341–365

362                           Claudia Castro-Kuriss, Víctor Leiva & Emilia Athayde

                                                                
             Recibido: mayo de 2014 — Aceptado: noviembre de 2014


References
Ahmed S, Castro Kuriss C, Leiva V, Flores E, Sanhueza A. Truncated version of the Birnbaum-Saunders distribution with an application  financial risk.(2010). Pakistan Journal of Statistics.
Athayde E, Azevedo C, Leiva V, Sanhueza A. About BirnbaumSaunders distributions based on the Johnson system.(2012). Communications in Statistics Theory and Methods.
Azevedo C, Leiva V, Athayde E, Balakrishnan N. Shape and change point analyses of the Birnbaum-Saunders-t hazard rate and associated estimation.(2012). Computational Statistics and Data Analysis.
Balakrishnan N, Gupta R, Kundu D, Leiva V, Sanhueza A. On some mixture models based on the Birnbaum-Saunders distribution and associated inference.(2011). Journal of Statistical Planning and Inference.
Balakrishnan N, Leiva V, Sanhueza A, Cabrera E. Mixture inverse Gaussian distribution and its transformations moments and applications.(2009). Statistics.
Balakrishnan N, Leiva V, Sanhueza A, Vilca F. Estimation in the Birnbaum-Saunders distribution based on scale-mixture of normals and the EM-algorithm.(2009). Statistics and Operations Research Transactions.
Balakrishnan N, Ng H, Kannan N. Goodness-of-fit tests based on spacings for progressively type-II censored data from a general location-scale distribution.(2004). IEEE Transactions on Reliability.
Barr D, Davidson T. A Kolmogorov-Smirnov test for censored samples.(1973). Technometrics.
Barros M, Leiva V, Ospina R, Tsuyuguchi A. Goodness-of-fit tests for the Birnbaum-Saunders distribution with censored reliability data.(2014). IEEE Transactions on Reliability.
Barros M, Paula G, Leiva V. An R implementation for generalized Birnbaum-Saunders distributions.(2009). Computational Statistics and Data Analysis.
Birnbaum Z, Saunders S. Estimation for a family of life distributions with applications to fatigue.(1969). Journal of Applied Probability.
Castillo J, Puig P. Testing departures from Gamma - Rayleigh - and truncated normal distributions.(1997). Annals of the Institute of Statistical Mathematics.
Castro Kuriss C. On a goodness-of-fit test for censored data from a location-scale distribution with application.(2011). Chilean Journal of Statistics.
Castro Kuriss C, Kelmansky D, Leiva V, Martinez E. A new goodness-of-fit test for censored data with an application in monitoring processes.(2009). Communications in Statistics: Simulation and Computation.
Castro Kuriss C, Kelmansky D, Leiva V, Martinez E. On a goodness-of-fit test for normality with unknown parameters and type-II censored data.(2010). Journal of Applied Statistics.
Chen G, Balakrishnan N. A general purpose approximate goodnessof-fit test.(1995). Journal of Quality Technology.
Choulakian V, Stephens M. Goodness-of-fit tests for the generalized Pareto distribution.(2001). Technometrics.
Cohen C. Truncated and Censored Samples.(1991). Marcel Dekker.
D’Agostino C, Stephens M. Goodness of Fit Techniques.(1986). Marcel Dekker.
DePriest D. Using the singly truncated normal distribution to analyse satellite data.(1983). Communications in Statistics Theory and Methods.
Dufour R, Maag U. Distribution results for modified Kolmogorov-Smirnov statistics for truncated or censored samples.(1978). Technometrics.
Ferreira M, Gomes M, Leiva V. On an extreme value version of the Birnbaum-Saunders distribution.(2012). REVSTAT - Statistical Journal. 
Fierro R, Leiva V, Ruggeri F, Sanhueza A. On a Birnbaum-Saunders distribution arising from a non-homogeneous Poisson process.(2013). Statistics and Probability Letters.
Fischer T, Kamps U. On the existence of transformations preserving the structure of order statistics in lower dimensions.(2011). Journal of Statistical Planning and Inference.
Hubert M, Vanderveeken S. Outlier detection for skewed data.(2008). Journal of Chemometrics.
Hubert M, Vandervieren E. An adjusted boxplot for skewed distributions.(2008). Computational Statistics and Data Analysis.
Hui W, Gel Y, Gastwirth J. lawstat: An r package for law public policy and biostatistics.(2008). Journal Statistical Software.
Johnson N, Kotz S, Balakrishnan N. Continuous Univariate Distributions.(1994). Wiley.
Kotz S, Leiva V, Sanhueza A. Two new mixture models related the inverse Gaussian distribution.(2010). Methodology and Computing in Applied Probability.
Lawless J. Statistical Models and Methods for Lifetime Data.(2003). Wiley.
Leiva V, Athayde E, Azevedo C, Marchant C. Modeling wind energy flux by a Birnbaum-Saunders distribution with unknown shift parameter.(2011). Journal of Applied Statistics.
Leiva V, Marchant C, Saulo H, Aslam M, Rojas F. Capability indices for Birnbaum-Saunders processes applied to electronic and food industries.(2014). Journal of Applied Statistics.
Leiva V, Ponce M, Marchant C, Bustos O. Fatigue statistical distributions useful for modeling diameter and mortality of trees.(2012). Revista Colombiana de Estadística.
Leiva V, Rojas E, Galea M, Sanhueza A. Diagnostics in Birnbaum Saunders accelerated life models with an application to fatigue data.(2014). Applied Stochastic Models in Business and Industry.
Leiva V, Sanhueza A, Kotz S, Araneda N. A unified mixture model based on the inverse Gaussian distribution.(2010). Pakistan Journal of Statistic.
Leiva V, Santos-Neto M, Cysneiros F, Barros M. Birnbaum-Saunders statistical modelling: A new approach.(2014). Statistical Modelling.
Leiva V, Saulo H, Leao J, Marchant C. A family of autoregressive conditional duration models applied to financial data.(2014). Computational Statistics and Data Analysis.
Leiva V, Soto G, Cabrera E, Cabrera G. New control charts based on the Birnbaum-Saunders distribution and their implementation.(2011). Revista Colombiana de Estadística.
Lin C T, Huang Y L, Balakrishnan N. A new method for goodness of-fit testing based on type-II right censored samples.(2008). IEEE Transactions on Reliability.
Malmquist S. On a property of order statistics from a rectangular distribution.(1950). Scandinavian Actuarial Journal.
Marden J. Positions and QQ-plots.(2004). Statistical Sciences.
Marshall A, Olkin I. Life Distributions.(2007). Springer.
Michael J. The stabilized probability plot.(1983). Biometrika.
Michael J, Schucany W. A new approach to testing goodness of fit for censored samples.(1979). Technometrics.
O’Reilly F, Stephens M. Transforming censored samples for testing fit.(1988). Technometrics.
Pakyari R, Balakrishnan N. A general purpose approximate goodness-of-fit test for progressively type-II censored data.(2012). IEEE Transactions on Reliability.
Paula G, Leiva V, Barros Liu S. Robust statistical modeling using the Birnbaum-Saunders-t distribution applied to insurance.(2012). Applied Stochastic Models in Business and Industry.
Rad A, Yousefzadeh F, Balakrishnan N. Goodness-of-fit test based on Kullback-Leibler information for progressively type-II censored data.(2011). IEEE Transactions on Reliability.
Rojas F, Leiva V, Wanke P, Marchant C. Optimization of contribution margins in food services by modeling independent component demand.(2015). Revista Colombiana de Estadística.
Sanhueza A, Leiva V, Lopez Kleine L. On the student-t mixture inverse Gaussian model with an application to protein production.(2011). Revista Colombiana de Estadística.
Stehlík M, Strelec L, Thulin M. On robust testing for normality in chemometrics.(2014). Chemometrics and Intelligent Laboratory Systems.
Vilca F, Sanhueza A, Leiva V, Christakos G. An extended Birnbaum-Saunders model and its application in the study of environmental quality in Santiago, Chile.(2010). Stochastic Environmental Research and Risk Assessment.
