Hierarchical Graphical Bayesian Models in Psychology. Modelos Bayesianos gráficos jerárquicos en psicología
Edith Cowan University, Mount Lawley, Australia.  Universidad Nacional de Entre Ríos, Argentina
Abstract
The improvement of graphical methods in psychological research can promote their use and a better comprehension of their expressive power. The application of hierarchical Bayesian graphical models has recently become more frequent in psychological research. The aim of this contribution is to introduce suggestions for the improvement of hierarchical Bayesian graphical models in psychology. This novel set of suggestions stems from the description and comparison between two main approaches concerned with the use of plate notation and distribution pictograms. It is concluded that the combination of relevant aspects of both models might improve the use of powerful hierarchical Bayesian graphical models in psychology.
Key words: Visual Statistics, Graphical Models, Bayesian Statistics, Hierarchical Models, Psychology, Statistical Cognition.
Resumen
El mejoramiento de los métodos gráficos en la investigación en psicología puede promover su uso y una mejor compresión de su poder de expresión. La aplicación de modelos Bayesianos gráficos jerárquicos se ha vuelto más frecuente en la investigación en psicología. El objetivo de este trabajo es introducir sugerencias para el mejoramiento de los modelos Bayesianos gráficos jerárquicos en psicología. Este conjunto de sugerencias se apoya en la descripción y comparación entre los dos enfoques principales con el uso de notación y pictogramas de distribución. Se concluye que la combinación de los aspectos relevantes de ambos puede mejorar el uso de los modelos Bayesianos gráficos jerárquicos en psicología
Palabras clave: cognición estadística, estadística Bayesiana, estadística visual, modelos gráficos, modelos jerárquicos, psicología.

1. Introduction
    Graphical models are powerful formal tools to represent dependencies and in-
dependence among variables, to make probabilistic inferences of conditional prob-
abilities, and to estimate the values of parameters (Jordan 2004, Koller, Friedman,
Getoor & Taskar 2007, Pearl 2009). This article focuses on the use of graphical
models as tools to specify or illustrate hierarchical Bayesian models in psychol-
ogy. More specifically, we concentrate on the visual features and the pieces of
information represented in graphical hierarchical Bayesian models in psychology.
Issues related to the formalism of the graphical model representation, algorithms
to infer conditional probabilities, and machine learning procedures to estimate pa-
rameters are beyond the scope of this article (see for an exhaustive treatment of
these issues Koller & Friedman 2009). Research into the role of graphs on the un-
derstanding of statistical information has shown that diagrams facilitate different
kinds of reasoning (Bauer & Johnson-Laird 1993, Stenning & Oberlander 1995).
It also emphasised that, in order to make research interesting for readers, graphs
that represent complex information should be kept as simple as possible (Gray &
Wegner 2013).
    This article discusses two types of graphical models that have been used in psy-
chology to represent hierarchical Bayesian models–graphical models with plate no-
tation (Buntine 1994, Gilks, Thomas & Spiegelhalter 1994, Lee 2008) and graphical
models with distribution pictograms (Kruschke 2010a, Kruschke 2010b). Moreover,
it introduces a new type of graphical model that aims at combining the positive
aspects of those two alternatives, while keeping the representation as simple as
possible. In line with Gray and Wegner’s proposal we aimed at generating an at-
tractive graphical representation, for example, by adding 3D shapes to the graph.
As indicated by a reviewer and by Wickens, Merwin & Lin (1994) 3D graphs some-
times improve understanding, but sometimes decrease understanding of statistical
information. Therefore, we were very cautious when using 3D shapes. The article
continues as follows. We first very briefly describe hierarchical Bayesian models,
and then we discuss the use of graphical models to represent such models. After
that we present the rationale of graphical models with plate notation, and we de-
scribe the introduction of hierarchical Bayesian graphical models in psychology.
We then explain and discuss the use of graphical models with plate notation and
graphical models with distribution pictograms. Lastly, we present the new type of
representation, and we discuss advantages and disadvantages.


2. Hierarchical Bayesian Models
    Bayesian analysis was introduced to psychology by Edwards, Lindman & Sav-
age (1963). In this article we concentrate on the hierarchical aspect of the hierar-
chical Bayesian models (for an introduction to Bayesian statistics see, for example,
Bolstad, 2007). Good (1980) indicated that there are three types of hierarchies
that could be represented with hierarchical Bayesian models. One type is hierar-
chies about physical probabilities. For example, in a population of animals, there


                                    Revista Colombiana de Estadística 37 (2014) 319–339

Hierarchical Graphical Bayesian Models in Psychology                                    321

is a probability that an animal belongs to a category of animal (e.g., mammal), a
probability that it belongs to a species (e.g., dog), a probability that belongs to
an age category (e.g., 1 year of age), and so forth.
    The second type of hierarchy arises from the fact that subjective probabilities
about events cannot be sharp (e.g., the probability of an article being accepted
being 0.65474). One way of dealing with this is to express the confidence of this
subjective probability, and represent it as a probability distribution of a higher
type. The third type of hierarchy is a combination of the first two types. Lee
(2008) takes a pragmatic approach, and considers that a Bayesian model is hierar-
chical when it is more complex than a Bayesian model with a set of parameters θ
generating a set of data d through a likelihood function f (.). Similarly, Kruschke’s
(2010a) chapter on hierarchical Bayesian models includes hyper-parameters, which
are parameters that do not generate data, instead they affect other parameters.


3. Graphical Model Representation of Hierarchical
   Bayesian Models
    Jordan (2004) indicated that a graphical model is a family of probability dis-
tributions represented in a directed or undirected graph. Graphs contain nodes
–which represent random variables– connected by edges, which could be either di-
rected (i.e., arrows) or undirected (i.e., lines). The most popular graphical models
are Markov networks and Bayesian networks (or “Bayes nets”). In Markov net-
works all the edges are undirected whereas in the Bayesian networks all the edges
are directed and the graph is acyclic. A graph is cyclic if it contains a cyclic path.
A path is a sequence of nodes in which each node, except the first node in the
sequence, receives a directed edge from the precedent node in the sequence (e.g.,
o→ o→ o→ o). When the last node in the sequence is the same as the first node,
the path is cyclic, otherwise it is acyclic. In this article we focus on directed acyclic
graphs (DAG). Although graphical models could be used both by frequentist and
Bayesian approaches, they are very powerful tools to formulate complex models
of joint probability distributions; hence, they have been very popular within the
Bayesian approach (Jordan 2004). We present more details of graphical models in
the following sections.


4. Plate Notation in Graphical Model
   Representations of Hierarchical Bayesian Models
   The plate notation was introduced by Buntine (1994)1 in order to solve the
problem that graphical models were not representing the fact that the learning
algorithms to estimate parameters had to do so over a repeated set of measured
   1 Note that Buntine indicated that the notion of plate was personally communicated to him

by Spiegelhalter in 1993, but the similar notion of “replicated node” was developed by him
independently, and that in order to maintain the same language he used the term plate.


                                       Revista Colombiana de Estadística 37 (2014) 319–339

322                                              Guillermo Campitelli & Guillermo Macbeth


variables. Figure 1 is an adaptation of Buntine’s Figure 13, which shows how
repetition of variables were represented without plates (panel a) and the same
model represented with plates (panel b). The graphical model represents a biased
coin toss experiment in which the probability of heads is θ , and the coin is tossed
N times. Each time the coin is tossed the experimenter records whether it was a
head or not. The hierarchical aspect of the model is apparent by the introduction
of a prior distribution in the graph–that is, a Beta distribution with parameters
a = 1.5 and b = 1.5–from which the parameter θ is generated.

                   a)                               b)

                  heads 1

                                                         heads 1        θ
                  heads 2           θ

                   ...                                             Beta (1.5, 1.5)
                                                     N
                               Beta (1.5, 1.5)

                  heads N


Figure 1: Adaptation of the plate graphical model (in panel b) presented by Buntine
          (1994) to represent the graphical model without plates in panel a. Instead
          of representing a number of nodes of the variable heads as in panel a, the
          plate representation surrounds one heads node by a plate, indicating that
          the model structure is repeated N times. Shaded nodes indicate observed
          variables and unshaded nodes indicate unobserved variables. The arrows
          show the dependencies between the variables.


    There is nothing wrong with the model without plates, but when the number
of variables and parameters increases the graphical model becomes difficult to rep-
resent in a limited space. The plate indicates that the variables within that plate
are repeated the number of times indicated in the plate (in the model presented in
Figure 1b, N times). This version of plate notation includes other important fea-
tures: shaded nodes indicate observed data or variables with known values whereas
unshaded nodes are unobserved variables. In other graphical models in the article
Buntine (1994) used a double border to represent deterministic variables (the same
notation was adopted by Lee (2008); see Figure 5.1, variables hi and fi ). A note
of interest is that Buntine included in the graph the Beta distribution from which
the parameter θ is generated, but not the Bernoulli distribution by which each
value in heads is obtained.
    Figure 2 presents an adaptation of Gilks et al.’s (1994) graphical model with
plates in their presentation of the BUGS (Bayesian inference Using Gibbs Sam-
pling) language and sampler. (For historical reasons, it is probably important to
note that the term “plate” was not used in this article). The model represents two
research studies with the purpose of estimating disease risk associated to exposure
to chemical agents: in the “disease study” the variables jobtype and disease were
collected, and in the “exposure study” the variables jobtype and exposuretoagents
were collected in another set of individuals. The model is the following:

                               Di ∼ Bernoulli(θi ),                                    (1)


                                        Revista Colombiana de Estadística 37 (2014) 319–339

Hierarchical Graphical Bayesian Models in Psychology                                 323




Figure 2: Graphical model with plates presented by Gilks et al. (1994). Circle nodes
          denote unobserved stochastic variables, square nodes with a single border rep-
          resent observed stochastic variables (i.e., data), squares with double border
          denote fixed quantities in prior distributions, and triangles denote determin-
          istic variables. The arrows represent the dependencies between variables. In
          this model all the arrows represent stochastic dependencies.


where Di is the disease status of the ith individual and θi is his/her probability of
disease
                                              nA
                                              X
                            logit(θi ) = β0 +    βk Eik ,                         (2)
                                               k=1

   where Eik is the unobserved exposure status (0 = unexposed; 1 = exposed) of
the ith individual to the kth chemical agent, and nA = 4 is the number of chemical
agents. The model for the exposure study is:

                             mjk ∼ Binomial(πjk , nj ),                              (3)

where j = 1 to nJ, nJ = 2 is the number of job types, πjk is an exposure
probability, nj is the number of individuals in the exposure study who were in job
type j, and mjk is the number of those individuals in job type j who were exposed
to chemical agent k. The connection between the disease study and the exposure
study is indicated by:
                             Eik ∼ Bernoulli(πj(i)k ),                         (4)
where j(i) is the job type of individual i in the “disease study”. The priors are
denoted by:
                              βk ∼ N ormal(µk , σk2 )                         (5)

   and

                                  logit(πjk ) = φjk ,                                (6)
with
                               φjk ∼ N ormal(µ∗k , σk∗2 )                            (7)


                                      Revista Colombiana de Estadística 37 (2014) 319–339

324                                         Guillermo Campitelli & Guillermo Macbeth


    The graphical representation of this Bayesian hierarchical model in Figure 2
contains the plates i, j, k. The variables within each plate are replicated for each
unit indicated in the plate. For example, Di indicates that there is a value of
disease for each individual i, and nj that there is a value for the variable n for
each job type j (e.g., 10 individuals are drivers, 25 individuals are teachers, etc.).
The number of replications of variables that are contained in two plates (e.g., i
and j ) is the product of the number of units indicated in each plate (e.g., number
of i units x number of k units). The replication aspect of this graphical model is
identical to that of Buntine (1994).
    However, there are a number of differences in the graphical representations. In
Gilks et al. (1994) there are no shaded nodes, and the difference between observed
and unobserved variables is given by the shape of the nodes. Circles denote un-
observed stochastic variables, square nodes with a single border denote observed
stochastic variables (i.e., data), squares with double border denote fixed quantities
in prior distributions, and triangles denote deterministic variables. Another differ-
ence is that in Gilks et al. (1994) the name of the distributions are not included,
and instead of including the total number of units per plate they present the unit
index (i.e., i, j, k), the name of the units (i.e., individuals, jobs, agents), and the
indices of the variables are located within the nodes.
    Lunn, Thomas, Best & Spiegelhalter (2000) presented WinBUGS, which uses
a graphical interface called DoodleBUGS. The graphical representation code in
DoodleBUGS differs from the previous two versions. Figure 3 shows the simple
example presented by Lunn et al. (2000), in which the graphical model represents
a linear regression model expressed by

                                  yi ∼ N (µi , τ −1 ),                              (8)

where yi are observations measured at an experiment design points’ xi , i =
1, . . . , N, τ is the inverse of the residual variance, and

                                    µi = α + βxi ,                                  (9)

for i = 1, . . . , N . α is the intercept parameter, β is the slope parameter, and both
are unknown.
    In this representation rectangular nodes denote known constants, and round
nodes denote deterministic relationships or stochastic quantities. Stochastic de-
pendence is represented by single-edged arrows and deterministic dependence is
denoted by double-edged arrows. The plate includes both the index of the units
(i.e., i) and the fact that the repetition is from i unit 1 to i unit N .
    Summing up, a number of visual components of the graphical models have been
used to represent hierarchical Bayesian models: shape of nodes, shade of nodes,
type of arrows, indication of repetition, indices and inclusion of the distribution
name. In the next section we describe the most popular plate notation that has
been used to represent hierarchical Bayesian models in psychology and a new type
of graphical model, which does not contain plates.


                                     Revista Colombiana de Estadística 37 (2014) 319–339

Hierarchical Graphical Bayesian Models in Psychology                                    325

                                    α            β




                                    xi           µi




                                                 yi          τ

                               i = 1, . . ., N



Figure 3: Graphical model with plates presented by Lunn et al. (2000). Rectangu-
          lar nodes denote known constants, round nodes denote deterministic rela-
          tionships or stochastic quantities. Stochastic dependence is represented by
          single-edged arrows and deterministic dependence is denoted by double-edged
          arrows.


5. Graphical Model Representation of Hierarchical
   Bayesian Models in Psychology
5.1. Lee’s (2008) Hierarchical Bayesian Graphical Models with
     Plate Notation
    Lee (2011) indicated that Bayesian statistics have been used in psychology in
three ways. The first use of Bayesian statistics is to conduct data analysis. Ed-
wards et al. (1963) introduced Bayesian analysis to psychology, and more recently
a number of researchers (Dienes 2011, Kruschke 2010a, Kruschke 2010b, Lee &
Wagenmakers 2005, Wagenmakers 2007) have advocated that Bayesian statistics
should replace the Null Hypothesis Statistical Testing (NHST) paradigm, which
is still the most popular paradigm in psychology. Another use of a Bayesian ap-
proach in psychology is to produce psychological models of how humans make
inferences (see Griffiths, Kemp & Tenenbaum, 2008 for a detailed treatment of
this approach). The third use –the one we focus on in this article–is to relate
psychological models to data. To our knowledge Lee (2008) presented the first
graphical model with plates to represent hierarchical Bayesian models in psy-
chology. Lee “translated” three influential cognitive models in psychology –the
multidimensional scaling (MSD) representation of stimulus similarity (Shepard,
1962, 1980), the generalized context model (GCM) account of category learning
(Nosofsky, 1984, 1986), and a signal detection theory (SDT) account of reasoning
(Heit & Rotello 2005)–into hierarchical Bayesian models. (see Figure 4).
    The plate represents repetitions over N participants in a reasoning experiment
(see 2005 Heit & Rotello for details of the experiment). Lee uses shaded nodes for
observed variables and nodes without shading for unobserved variables. Contin-
uous variables are represented by circles and discrete variables with squares; and


                                         Revista Colombiana de Estadística 37 (2014) 319–339

326                                        Guillermo Campitelli & Guillermo Macbeth


                          mc        τc      md               τd




                                    ci       di



                                    hi       fi



                                    khi      kfi



                                                   i = 1, . . ., N


                                    ts        tn

Figure 4: Graphical model with plate notation adapted from Lee (2008, Figure 10).
          Squares represent discrete variables, circles continuous variables, shaded
          nodes denote observed variables and unshaded nodes represent unobserved
          variables. The plate represents repetition of the model structure over units
          i = 1 to N . The arrows represent dependencies between variables.


stochastic and deterministic unobserved variables are denoted by single border
and double border, respectively. In the model, di and ci denote the ith individ-
ual’s discriminability and bias, respectively. They are generated from a normal
distribution with mean parameters md and mc , respectively, and precision (i.e.,
1/variance) parameters τd and τc ; that is:

                               di ∼ N ormal(md , τd )                              (10)


                                ci ∼ N ormal(mc , τc )                             (11)
    The priors of the mean and precision parameters are not shown in the graphical
model, and their mean and precision have standard near non-informative priors
[md ∼ N ormal(0, ε), mc ∼ N ormal(0, ε), τd ∼ Gamma(ε, ε), τd ∼ Gamma(ε, ε);
where ε = .001]. The hit and false alarm rates are deterministic variables calcu-
lated by:
                                hi = Φ(0.5di − ci )                           (12)
                                 fi = Φ(0.5di − ci )                               (13)
where Φ(.) is the standard cumulative Gaussian function. The count on hit rate
and false alarms comes from a Binomial distribution with probabilities hi and fi ,
respectively. This is expressed by
                               kih ∼ Binomial(hi , ts )                            (14)

                                     Revista Colombiana de Estadística 37 (2014) 319–339

Hierarchical Graphical Bayesian Models in Psychology                               327

                              kif ∼ Binomial(fi , tn ),                           (15)
where ts and tn are the number of signal and noise trials presented in the exper-
iment. As in Buntine (1994) this graphical model uses shading to differentiate
observed from unobserved variables, and double border to represent deterministic
variables. A new aspect of this representation is that shape is used to differentiate
continuous from discrete variables. Like Lunn et al. (2000), Lee (2008) indicated
the unit index and the total number of repetitions, but he did not follow the for-
mer in using double-edged arrows to denote a deterministic dependency between
variables. The distributions are not represented in the graphical model.
    After Lee’s (2008) article the plate notation gained popularity within math-
ematical psychology, and it has been subsequently used in a number of studies
(e.g., Ahn, Krawitz, Kim, Busemeyer & Brown 2011, Bridwell, Hecker, Serences &
Srinivasan 2013, Dyjas, Grasman, Wetzels, van der Maas & Wagenmakers 2012,
Lee & Newell 2011, Lodewyckx, Kim, Lee, Tuerlinckx, Kuppens & Wagenmakers
2011, Orhan & Jacobs 2013, Scheibehenne, Rieskamp & Wagenmakers 2013, Stey-
vers, Lee & Wagenmakers 2009, van Ravenzwaaij, Moore, Lee & Newell 2014),
and in the book “Bayesian Cognitive Modeling: A Practical Course” by Lee &
Wagenmakers (2014).


5.2. Kruschke’s (2010) Hierarchical Bayesian Graphical
     Models with Distribution Pictograms
    Kruschke (2010a, 2010b) introduced a new graphical representation of hier-
archical Bayesian models in his book “Doing Bayesian Data Analysis: A tuto-
rial with R and BUGS”. He explained the purpose of introducing his graphi-
cal representation in a post of October 2013 in his blog (doingbayesiandataanal-
ysis.blogspot.com). He stated that the directed acyclic graphs are incomplete
and/or confusing for him, and that designing graphical models with the pictograms
of the distributions help him explaining, inventing and programming models. As
shown in Figure 5 this graphical model does not use plates, the variables are not
represented by nodes but by letters, and pictograms with a prototypical distribu-
tion shapes are used. Moreover, the arrows are accompanied by a ∼ sign indicating
a stochastic dependency, and a = sign denoting deterministic dependency. The
repetition is represented by three dots and the index (e.g., . . . i), and when vari-
ables repeat over two different sets of units it is indicated with the conditional
notation (e.g., j | i).
    Moreover, unlike in the graphs with plate notation, the equations to calculate
the deterministic variables are included in the model. The graphical model in
Figure 5 was presented by Kruschke in his blog (which differs from the models
in his book in which only “. . . ” without the index is used to represent repetition)
with the purpose of comparing his novel graphical model with the more estab-
lished graphical models with plate notation. It represents a model described by
Spiegelhalter, Thomas, Best & Gilks (1996), in which yj|i denotes the weight of
rat i at day after birth j. This variable is generated by the normal distribution so
that:


                                    Revista Colombiana de Estadística 37 (2014) 319–339

328                                                            Guillermo Campitelli & Guillermo Macbeth



                                             yj|i ∼ N ormal(wj|i , λ),                                              (16)
where wj|i is the mean and λ is the precision. wj|i is deterministically calculated
by
                               wj|i = φi + ξi xj|i ,                           (17)
where φi is the intercept and ξi is the slope, and both come from normal distribu-
tions with means κ and ζ,; and precision δ and γ, respectively so that:

                                                 φi ∼ N ormal(κ, δ)                                                 (18)

                                                 ξi ∼ N ormal(ζ, γ)                                                 (19)
The mean parameters come from a normal distribution with priors M and H, and
the precisions come from a gamma distribution with parameters K and I.

             M H                           K I                       M          H                       K I
            normal                          gamma                    normal                             gamma


             ~                        ~                                    ~                        ~

                      κ           δ                                                        ζ    γ
                                                                     ~
                     normal                                                            normal


                                          ...i
                              ~                                                ...i
                                                                                                           K I
                                                 φi + ξi . xj|i
                                                                                                            gamma

                                                                                                    ~
                                                                  ...j|i
                                                           =
                                                                               ωj|i    λ
                                                                           normal




                                                                       ~          ...j|i
                                                                               yj|i

Figure 5: Adaptation of the type of graphical model representation introduced by Kr-
          uschke (2010a, 2010b). Stochastic variables are represented by small letters
          which are generated by a distribution (represented by pictograms) with the
          corresponding parameters. Stochastic variables are represented with small
          letters, and their values are computed by the corresponding equation. Ar-
          rows with the sign ∼ denote stochastic dependencies, and arrows with the
          sign= represent deterministic dependencies. The pictograms were generated
          using Bååth’s (2013) template for LibreOffice.


    This graphical representation was subsequently used by Kruschke and his col-
leagues (e.g., Kruschke 2013, Kruschke, Aguinis & Joo 2012). Bååth (2013) created
a script in R (R Development Core Team 2013) to produce Kruschke’s distribu-
tion pictograms and a template for the LibreOffice (Document Foundation, 2013)

                                                      Revista Colombiana de Estadística 37 (2014) 319–339

Hierarchical Graphical Bayesian Models in Psychology                                 329




Figure 6: Adaptation of Schneider’s (2013) representation of Kruschke’s (2010) style
          graphical models. We generated the pictograms with Bååth’s (2013) template
          for LibreOffice. The shapes surrounding the distributions are not plates, they
          only emphasise to which distribution the parameters belong to.



free software to draw the graphical diagrams with the distribution pictograms.
Schneider (2013) presented a graphical model using Bååth’s pictograms. This rep-
resentation differs from that of Kruschke in that boxes were added around the
distributions and double-edge arrows were used to denote deterministic relations.
(Note that instead of the single-edged arrow used in Figure 6, Schneider used a
curly arrow), and the deterministic equation is surrounded by a brace. Summing
up, Kruschke’s (2010a, 2010b) graphical model puts emphasis on the type of dis-
tribution. The repetition is not represented by plates, rather three dots and the
indices of the variables are presented to denote the repetition. Another important
aspect of this graphical model is that the parameters that belong to the same
distribution are presented contiguously in space. (Note that this is even more
emphasized in Schneider’s representation, in which the parameters that form a
distribution are surrounded by a box). As indicated by Kruschke the inclusion of
distribution pictograms plays a heuristic role for the invention, explanation and
programming of models. A possible problem with this approach is that sometimes
a deterministic variable comes from a long relation between other variables, which
could use a lot of space and make the graph difficult to understand.


6. Discussion
    Both the graphical models with plates and the graphical models with distri-
bution pictograms share the importance of representing the dependencies between
variables by using arrows. The former emphasise the independent repetition of the
variables, and the latter emphasises the probabilistic distributions. As mentioned
earlier, Buntine’s (1994) graphical models contained both plates and the names


                                      Revista Colombiana de Estadística 37 (2014) 319–339

330                                        Guillermo Campitelli & Guillermo Macbeth


(instead of the pictograms) of the distributions. However, Buntine only presented
graphical models with one or two plates, and the larger the number of plates the
smaller the space to include information about the distribution.
    Moreover, complex models are also difficult to represent with graphical models
with plates. For example, Figure 6.3 shows a hierarchical Bayesian model presented
by Lee (2008). The complexity of the model led the author to use three i plates
and two j plates. Although this solution is flawless from the formal point of view,
it reduces the heuristic value of the graphical models with plates. Given that
there is no differentiation between plates (i.e., they all have the same format)
the only graphical difference between, say the plate i and the plate j is that
they are different plates. Therefore, adding more plates for denoting repetition
over the same set of units might be confusing for some researchers. One obvious
solution to this problem is to colour code or shape code the plates. That is, to
use a different colour (or shape) for each type of plate. Based on this summary
we aimed at developing a type of graphical model that incorporates both the
distribution pictograms and the plate notation, that solves the problems identified
in the discussion, and that it has heuristic value to help researchers invent, explain
and program hierarchical Bayesian models.


6.1. Hierarchical Bayesian Graphical Models with
     Distribution Pictograms and Mini-Plates
    The first ingredient of our proposal is the replacements of plates by colour-
coded mini-plates. (Note that in the paper version of this article we use shadings;
please refer to the link provided below to see a colour version of the graphical
models). As explained above, the purpose of colour-coding is to graphically dif-
ferentiate between different types of plates. While we were developing the idea of
using colour to differentiate between plates we realise that if the colour indicates
the set of units over which the repetition occurs then the plates might not be nec-
essary. Thus, we originally developed graphical models without plates in which
we colour coded the nodes. However, because colour (or shading) is already used
to code for variable type (i.e., observed vs. unobserved) this implementation was
unsatisfactory.
   That led us to develop the idea of colour coded mini-plates, and use them to
surround each node. However, this was also unsatisfactory because the mini-plates
with the nodes occupied too much space. In parallel we were also considering the
use of 3D representations in order to make the graphical models more attractive.
When we were trying different ways of using 3D nodes we found out that in some
cases the combination of 3D shapes occupy less space than 2D shapes because the
former allow more flexibility to locate the nodes in space. Thus, we realised that
using 3D nodes was also a good idea to save space, and then we came up with the
idea of using 3D rotated mini-plates under the nodes, instead of surrounding the
nodes.
   Unfortunately, in order to trigger the perception of 3D nodes it is necessary
to add some shading to the nodes, which, as indicated by a reviewer, was very


                                     Revista Colombiana de Estadística 37 (2014) 319–339

Hierarchical Graphical Bayesian Models in Psychology                                 331

distracting. Therefore, we used 3D mini-plates and 2D nodes. Note that in the
link provided below we used 3D nodes with colour because the shading in some
colours is not distracting. Figure 7 shows the mini-plate version of the bottom
right part of the graphical model presented in Figure 4. (Note that this is a black-
grey-white version of the graphical model. A colour version of Figure 7, as well
as Figure 8 and Figure 11, could be accessed in this link: http://dx.doi.org/
10.6084/m9.figshare.1020148. Moreover, a Microsoft PowerPoint template to
create the figures could be accessed in this link: http://dx.doi.org/10.6084/
m9.figshare.1020020) As in 4, the nodes of the variable kf i and tn are shaded
because they are observed variables, and they have the shape of a square to indicate
that they are discrete variables. Likewise, the fi node is unshaded to denote that
it is an unobserved variable, and it is a circle to indicate that it is a continuous
variable. Like in Figures 3 and 6, we adopted the double-arrow to indicate a
deterministic dependency. Thus, the fi node does not have a double border as
in Figure 4. The grey mini-plates under the fi and kf i indicate that they repeat
over i = 1 to N units. Mini-plates play exactly the same role as the plates; that
is, they indicate that the variables within them are repeated over the number the
units indicated in the plates or mini-plates.



                                                       tn



                               fi                      kf i


Figure 7: Graphical model representation with mini-plates representing the bottom
          right hand side part of the model illustrated in Figure 4. The white plates
          under fi and kf i indicate repetition over units i = 1 to N . The dark grey
          square denotes an observed discrete variable and the unshaded circle indicates
          unobserved continuous variable. The stochastic dependencies are indicated
          by arrows.



    Having mini-plates provides flexibility to the modeler to where to position the
nodes in space, and, as a consequence, it makes easier to incorporate Kruschke’s
distribution pictograms. Figure 8 shows the mini-plate version of the bottom
part of the graphical model presented in Figure 5. As in Figure 5, the mini-plate
version incorporates the pictogram of the normal distribution with the parameters
represented with unshaded circles. Note that two plates are located under yij : The
grey i plate and the diagonally stripped j plate. Likewise the normal distribution
and the ωij are on top of an i plate and a j plate, indicating that the process that
generates yij repeats over the i and j units. However the λ node is not on top of
any plate because the generating process uses only one value of λ.


                                      Revista Colombiana de Estadística 37 (2014) 319–339

332                                         Guillermo Campitelli & Guillermo Macbeth




Figure 8: Graphical model with mini-plates and distribution pictograms representing
          the bottom part of Figure 5. The white plate under yij and ωij indicate that
          these variables repeat over i = 1 to N units. The diagonally stripped plates
          under the same variables denote their repetition over j = 1 to M units. λ is
          a parameter of the normal distribution, and given that it is not located on
          top of plates, it does not repeat itself.



6.2. Comparison Between Three Graphical Model
     Representations of a Hierarchical Bayesian Model
    Having presented the mini-plate with distribution pictograms, we now discuss
whether this type of graphical representation is capable of representing complex
models, and how it compares with the other two types of graphical models. For
this purpose we present here a complex hierarchical Bayesian model with plate no-
tation developed by Lee (2008, pages 5 to 8), based on Nosofsky (1986) generalised
context model (GCM) of category learning.
    This model aims at explaining how people learn to categorise unknown stimuli
into two categories in experiments in which the researcher uses different category
structures (see more details in Lee, 2008). In those experiments the researcher
assigns one fourth of the total number of stimuli to one category (i.e., category
A), one fourth to the other category (i.e., category B), and one half is not assigned
to any category. The model utilises the multidimensional scaling (MDS) represen-
tation of stimulus similarity developed by Shepard (1962). Stimuli are represented
as points (p) in a D-dimensional space. In Figure 9 pix denotes a coordinate value
of stimulus i in dimension x. The surrounding plates indicates that, in this exam-
ple, there are N stimuli and x = 2 dimensions. Lee (2008) assigned the following
prior probability to pix (not shown in the graph):

                           pix ∼ U nif orm(−δ, δ); δ > 0,                           (20)

d2ij denotes the squared psychological distance between all the possible pairs of N
stimuli, where i denotes the first stimulus and j the second stimulus of the pair.
The node is surrounded by the i and j plates to denote the repetition over all the
possible pairs of stimuli. The squared psychological distance between stimuli is
determined by:
                     d2ij = w(pi1 − pj1 )2 + (1 − w)(pi2 − pj2 )2 ,                 (21)


                                      Revista Colombiana de Estadística 37 (2014) 319–339

Hierarchical Graphical Bayesian Models in Psychology                                 333

where w is the relative attention paid to the first stimulus over the second stimulus,
and has the following prior distribution (not shown in the graph):

                                 w ∼ U nif orm(0, 1).                               (22)




Figure 9: Adaptation of the graphical model with plates presented by Lee (2008, page
          6, Figure 5). The notation is the same as in Figure 4.


   The similarity between each pair of stimuli is given by:

                                 sij = exp[−(cdij )2 ],                             (23)

where c is a generalisation gradient parameter, with the following prior (not shown
in the graph):
                                 c2 = Gamma(ε, ε),                              (24)
where ε = .001.
    The number of times the ith stimulus is chosen as a member of category A out
of ti trials is denoted by ki , which follows a binomial distribution:

                                ki ∼ Binomial(ri , ti ),                            (25)

where ri is the probability of stimulus i being chosen as a member of category A.
This probability is determined by the similarities between stimuli (sij ), a response
bias b, how the stimuli were assigned to the categories by the researcher (i.e.,
indicator variables aj , zj ), and a third indicator variable xi . The prior distribution
of the response bias b (not shown in the graph) is:

                                 b ∼ U nif orm(0, 1).                               (26)


                                      Revista Colombiana de Estadística 37 (2014) 319–339

334                                           Guillermo Campitelli & Guillermo Macbeth


    aj denotes the known assignment of the jth presented stimulus, which ranges
over N/2 such stimuli, and zj indicates the latent assignment of the jth unassigned
stimulus, ranging over the N/2 such stimuli (see Lee, 2008, for a more detailed
explanation of stimuli assignment structures), with the following prior:

                                   zj ∼ Bernoulli(1/2).                               (27)

    The xi is incorporated in the graph in order to compare a model that uses the
latent stimulus assignment zj with a simpler model without this latent variable.
xi indicates for each stimulus i whether the response probability ri uses aj and
zj (i.e., xi = 1) or only aj (i.e., xi = 0). It is assumed that all the indicators
xi support either model following a fixed underlying rate of use (i.e., θ), which is
given by the following prior:

                                    θ ∼ U nif orm(0, 1).                              (28)

    The posterior rate of use provides information on how well each model accounts
for the categorisations of the participants (for a more detailed explanation see Lee,
2008, page 8). Finally, the probability for the ith stimulus to be classified as a
member of category A is given by:
                                         P
                                        b aA sia
                         ri = P                     P       ,                    (29)
                              b aA sia + (1 − b) aB sia
if xi is 0.
                                    P             P
                                  b[ aA sia + zA siz ]
              ri =     P         P                    P         P          ,          (30)
                     b[ aA sia + zA siz ] + (1 − b)[ aB sia + zB siz ]
if xi is 1.
    Figure 9 shows Lee’s (2008) graphical model with plates, 10 presents our best
attempt to represent the same model with the graphical model with distribution
pictograms proposed by Kruschke (2010a), and Figure 11 depicts the graphical
model with mini-plates and distribution pictograms, as proposed in this arti-
cle. Regarding the amount of information presented, Kruschke’s graphical model
presents more information (equations, distributions, dependencies and repetitions)
than the mini-plate graphical model (distributions, dependencies and repetitions)
and the plate graphical model (dependencies and distributions). However, it seems
to us that the inclusion of equations in Kruschke’s graphical model attempts
against the heuristic value of the model by cluttering the space with too much
information. Possibly, Kruschke’s style graphical model should include equations
only when the models are simple and exclude them when the models contain more
than one or two equations and/or when the equations are large.
    The mini-plate graphical representation seems to strike a balance between
amount of information and use of space. By using the concept of plates in a flexible
way (i.e., mini-plates), combining them with Kruschke’s distribution pictograms,
and using 3D shapes it has a strong visual appeal. However, this comparison
is not completely fair for the other graphical representations. As we mentioned


                                        Revista Colombiana de Estadística 37 (2014) 319–339

Hierarchical Graphical Bayesian Models in Psychology                                335




Figure 10: Graphical model with Kruschke’s style distribution pictograms of the hier-
           archical Bayesian model presented by Lee (2008, pages 5 to 8). The notation
           is the same as in Figure 5.




Figure 11: Graphical model with mini-plates of the hierarchical Bayesian model pre-
           sented by Lee (2008, pages 5 to 8). The notation is the same as in Figure
           8.



above, Kruschke’s graphical models could be improved by not including equations
in complex models, and we might not have done the best to present the best pos-
sible representation. Moreover, there are a variety of plate graphical models that
we are not displaying in this article. For example, van Ravenzwaaij et al. (2014)

                                     Revista Colombiana de Estadística 37 (2014) 319–339

336                                       Guillermo Campitelli & Guillermo Macbeth


presented a plate graphical model following Lee’s (2008) notation, but in the right
hand side of the figure they added both the distributions and the equations in
text format. Allegedly, this might be a better representation than the mini-plate
graphical models because it combines graphical aspects with text, rather than
being too graphical.


7. Conclusion
    We discussed two types of hierarchical Bayesian graphical models used in psy-
chology –Lee’s (2008) plate graphical models and Kruschke’s (2010b) graphical
models with distribution pictograms. We proposed a third type– graphical mod-
els with colour-coded mini-plates– as an attempt to combine the positive aspects
of the other two types of graphical models, and we presented a preliminary in-
tuitive analysis of the informative value of this new graphical respresentation.
We believe our proposal provides an important contribution to the field, but our
intuitive evaluation should be confirmed by empirical evidence. Statistical cogni-
tion is a flourishing area of research in psychology (e.g., Beyth Marom, Fidler &
Cumming 2008), that investigates how people understand statistical information.
Our proposal could be followed up by a research that aims at elucidating which
type of graphical model leads to a better understanding of hierarchical Bayesian
models.
                                                                 
             Recibido: mayo de 2014 — Aceptado: septiembre de 2014


References
Ahn W Y, Krawitz A, Kim W, Busemeyer J R, Brown J W. A model-based FMRI analysis with hierarchical Bayesian parameter estimation.(2011). Journal of Neuroscience Psychology and Economics.
Bauer M I, Johnson Laird P N. How diagrams can improve reasoning. (1993).Psychological Science.
Beyth Marom R, Fidler F, Cumming G. Statistical cognition: Towards evidence-based practice in statistics and statistics education.(2008). Statistics Education Research Journal.
Bolstad W M. Introduction to Bayesian Statistics 2 edn.(2007). Wiley Jobs in Hoboken.
Bridwell D A, Hecker E A, Serences J T, Srinivasan R. Individual differences in attention strategies during detection fine discrimination and coarse discrimination.(2013). Journal of Neurophysiology.
Bååth R. Distribution diagram R scripts. (2013). https://github com/rasmusab/distribution_diagrams
Buntine W L. Operations for learning with graphical models.(1994). Journal of Artificial Intelligence Research.
Dienes Z. Bayesian versus orthodox statistics: Which side are you on?.(2011). Perspectives on Psychological Science.
Dyjas O, Grasman R P, Wetzels R, van der Maas H L, Wagenmakers E. A Bayesian hierarchical analysis of the name-letter effect.(2012). Frontiers in Psychology. 
Edwards W, Lindman H, Savage L J. Bayesian statistical inference for psychological research.(1963). Psychological Review.
Gilks W R, Thomas A, Spiegelhalter D J. A language and program for complex Bayesian modelling.(1994). The Statistician.
Good I J. Some history of the hierarchical Bayesian methodology.(1980). Trabajos de Estadística y de Investigación Operativa.
Gray K, Wegner D M. Six guidelines for interesting research.(2013). Perspectives on Psychological Science.
Griffiths T L, Kemp C, Tenenbaum J B. Bayesian models of cognition - R Sun ed The Cambridge Handbook of Computational Psychology.(2008). Cambridge University Press.
Heit E, Rotello, C. Are there two kinds of reasoning?.(2005). Lawrence Erlbaum Mahwah.
Jordan M I. Graphical models.(2004). Statistical Science.
Koller D, Friedman N. Probabilistic Graphical Models: Principles and Techniques.(2009). MIT press.
Koller D, Friedman N, Getoor L, Taskar B. Graphical models in a nutshell in L Getoor B Taskar eds Introduction to statistical relational learning.(2007). MIT Press.
Kruschke J K. Doing Bayesian Data Analysis: A Tutorial with R and BUGS.(2010). Academic Press.
Kruschke J K. What to believe: Bayesian methods for data analysis.(2010). Trends in Cognitive Science.
Kruschke J K. Bayesian estimation supersedes the t test.(2013). Journal of Experimental Psychology.
Kruschke J K, Aguinis H, Joo, H. The time has come: Bayesian methods for data analysis in the organizational sciences.(2012). Organizational Research Methods.
Lee M D. Three case studies in the Bayesian analysis of cognitive models.(2008). Psychonomic Bulletin and Review.
Lee M D. How cognitive modeling can benefit from hierarchical Bayesian models.(2011). Journal of Mathematical Psychology.
Lee M D, Newell B R. Using hierarchical Bayesian methods to examine the tools of decision-making.(2011). Judgment and Decision Making.
Lee M D, Wagenmakers E J. Postscript: Bayesian statistical inference in psychology: Comment on Trafimow (2003).(2005). Psychological Review.
Lee M D, Wagenmakers E J. Bayesian cognitive modeling: A practical course.(2014). Cambridge University Press.
Lodewyckx T, Kim W, Lee M D, Tuerlinckx F, Kuppens P, Wagenmakers E J. A tutorial on Bayes factor estimation with the product space method.(2011). Journal of Mathematical Psychology.
Lunn D J, Thomas A, Best N, Spiegelhalter D. A Bayesian modelling framework: Concepts structure and extensibility.(2000). Statistics and Computing.
Nosofsky R M. Choice,similarity and the context theory of classification.(1984). Journal of Experimental Psychology: Learning Memory and Cognition.
Nosofsky R M. Attention similarity and the identification–categorization relationship.(1986). Journal of Experimental Psychology.
Orhan A E, Jacobs R A. A probabilistic clustering theory of the organization of visual short-term memory.(2013). Psychological Review.
Pearl J. Causal inference in statistics: An overview.(2009). Statistics Surveys.
R Development Core Team. R: A Language and Environment for Statistical Computing.(2013). R Foundation for Statistical Computing. 
Scheibehenne B, Rieskamp J, Wagenmakers E J. Testing adaptive toolbox models: A Bayesian hierarchical approach.(2013). Psychological Review.
Schneider T. Diagram for Hierarchical Models.(2013). https://github com/tinu-schneider/DBDA_hierach_diagram
Shepard R N. The analysis of proximities: Multidimensional scaling with an unknown distance function I.(1962). Psychometrika.
Shepard R N. Multidimensional scaling tree-fitting and clustering.(1980). Science.
Spiegelhalter D, Thomas A, Best N, Gilks W. BUGS 0 5 Examples.(1996). MRC Biostatistics Unit.
Stenning K, Oberlander J. A cognitive theory of graphical and linguistic reasoning: Logic and implementation.(1995). Cognitive Science.
Steyvers M, Lee M D, Wagenmakers E J. Bayesian analysis of human decision-making on bandit problems.(2009). Journal of Mathematical Psychology.
van Ravenzwaaij D, Moore C P, Lee M D, Newell B R. A hierarchical Bayesian modeling approach to searching and stopping in multi-attribute judgment.(2014). Cognitive Science.
Wagenmakers E. A practical solution to the pervasive problems of p values.(2007). Psychonomic Bulletin and Review.
Wickens C D, Merwin D H, Lin E L. Implications of graphics enhancements for the visualization of scientific data: Dimensional integrality stereopsis motion and mesh.(1994). Human Factors.
