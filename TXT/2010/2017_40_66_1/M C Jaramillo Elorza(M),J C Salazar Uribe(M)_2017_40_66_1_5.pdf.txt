Confidence Bands for the Survival Function Using a Weibull Regression Model in Presence of Arbitrary Censoring. Bandas de confianza para la función de supervivencia usando la ONU modelo de regresión de Weibull en presencia de censura arbitraria
Universidad Nacional de Colombia, Medellín, Colombia
Abstract
Usually, the exact time at which an event occurs cannot be observed for several reasons; for instance, it is not possible to constantly monitor a characteristic of interest. This generates a phenomenon known as censoring that can be classified as having a left censor, right censor or interval censor. When one is working with survival data in the presence of arbitrary censoring, the survival time of interest is defined as the elapsed time between an initial event and the next event that is generally unknown. This problem has been widely studied in the statistic literature and some progress has been made, toward resolving and the formulation of a bivariate likelihood to estimate parameters in a parametric regression model offers positive development opportunities. In this paper, we construct a bivariate likelihood for the Weibull regression model in the presence of interval censoring. Finally, its performance is illustrated by means of a simulation study.
Key words: Biostatistics, Confidence Bands, Goodness of Fit, Regression Models, Simulation, Survival Analysis.
Resumen
Usualmente, el tiempo exacto en el que ocurre un evento no se puede observar por diversas razones; por ejemplo, no es posible un monitoreo constante de las características de interés. Esto genera un fenómeno conocido como censura que puede ser de tres tipos: a izquierda, a derecha, o de intervalo. En datos de tiempo de vida con censura arbitraria (censura a izquierda, a derecha, o de intervalo), el tiempo de supervivencia de interés es definido como el lapso de tiempo entre un evento inicial y el evento siguiente, el cuál generalmente es desconocido. Este problema ha sido ampliamente estudiado en la literatura estadística, y se evidencian avances importantes. Sin embargo, la construcción de una verosimilitud bivariada para la estimación de los parámetros de modelos de regresión paramétricos, ofrece oportunidades de desarrollo. En este trabajo se construye una verosimilitud bivariada para el modelo de regresión Weibull, en presencia de censura arbitraria. Finalmente se ilustra su desempeño por medio de un estudio de simulación.
Palabras clave: análisis de supervivencia, bandas de confianza, bioestadística, modelos de regresión, simulación.


1. Introduction
     Situations in which the observed response for each individual under study is
either an exact survival time or a censoring time are commonly in practice, There
are two types of censoring known as type I and type II, respectively. Type I
censoring occurs when units that have not failed are removed from a test at a
prespecified time; on the other hand, type II censoring occurs when a life test is
terminated after r failures are observed. Nonetheless, there can be situations, such
as in longitudinal studies which individuals are monitored during a fixed period
of time or periodically visited during a certain period. In this context, the time
Ti , i = 1, . . . , n, until the occurrence of an event of interest for each individual is
unknown, the only known fact is that the event occurred on an interval between
visits, in other words, between the visit at time Li and the visit at time Ui , where
Li < Ui . It is important to point out that in such studies, the survival time Ti
is not exactly known. We only know that the event of interest occurred inside
the interval (Li , Ui ] with Li < Ti ≤ Ui . Moreover, taking into account that if the
event occurs in the exact moment of a visit, which is very unlikely but could occur,
an exact survival time would be obtained. In this case, it is possible to assume
that Li = Ti = Ui .
   On the other hand, it is known that for individuals whose times are right-
censored, the event of interest has not occurred until the last visit, but that could
happen at any time beyond that moment. Therefore, it is assumed in this case
that Ti could occur inside the interval (Li , ∞), with Li being equal to the time
period from the start of the study to the last visit, so Ui = ∞.
   Similarly, it is known that for individuals whose times are left-censored, the
event of interest occurred before the first visit and, hence, it is possible to assume
that Ti occurred on the interval (0, Ui ] with Li = 0 representing the start of the
study and Ui being the time period from the start of the study to the first visit.
    In survival data analysis, it is of interest to estimate the survival function S (t)
and to assess the importance of the potential factors or individual features over
this survival time.
    A common practice among data analysts is to assume that the event that
already occurred inside the interval (Li , Ui ] occurred either in the inferior or su-
perior limit or in the midpoint of each interval. Some authors, such as Rucker
& Messerer (1988), Odell, Anderson & D’Agostinho (1992), and Dorey, Little &


                                        Revista Colombiana de Estadística 40 (2017) 85–103

Confidence Bands with Survival Data with Arbitrary Censororing                              87

Schenker (1993), state that to treat the survival time of interest as if it were exact
could lead to biased estimators as well as to partial and unreliable conclusions and
estimations.
   These affirmations somehow motivate different proposals related to the treat-
ment of these censorings in order to avoid bias and to extract more information
from the data. Our proposal partially covers this objective.
    For the case of right censoring, the Kaplan-Meier estimator could be used
to obtain F (t) Kaplan & Meier (1958). However, with interval-censored data,
the classic Kaplan-Meier method could not be implemented. For these interval-
censored data, Peto (1973), Turnbull (1974) and Turnbull (1976) developed the so
called nonparametric maximum likelihood estimator (NPMLE); from now on, we
will call it Turnbull estimator.
    The Turnbull estimator is based on a sample of observed intervals [Li , Ri ], i =
1, 2, . . . n, including the independent random variables T1 , T2 , . . . , Tn . As stated
above, an exact observation of Ti is obtained only if Li = Ri .
   Given this example, the likelihood function to be maximized is:

                                       n
                                       Y
                            L (F ) =         [F (Ri +) − F (Li −)]                         (1)
                                       i=1

   To solve this maximization problem, (Peto 1973) defines two sets: γ = {Li ,
i = 1, 2, . . . n} and κ = {Ri , i = 1, 2, . . . , n} containing the right and left sides of
the intervals respectively.
    From these sets, new [q1 , p1 ] , [q2 , p2 ] , . . . , [qm , pm ] disjoint intervals are
formed, such that qj ∈ γ, pj ∈ κ and qj ≤ pj . It could be proved that a
function that maximizes (1) is constant between the intervals [qj , pj ] and it is not
defined inside those intervals. This implies that P̂ (T ∈ (pj−1 , qj )) = 0 for any
j. Let sj be the increases of F inside the [qj , pj ] intervals, j = 1, . . . , m, L (F )
must be maximized as a function of s1 , s2 , . . . , sm subject to the constrain sj ≥ 0
                Pm−1
and sm = 1 − j=1 sj . Peto addresses this maximization problem using the
Newton-Raphson algorithm.
     In contrast to Peto, Turnbull (1976), proposes the use of the so called self-
consistency algorithm for the same maximization problem. The idea of the self-
consistency algorithm was first introduced by Efron (1967). Its application for the
maximization in (1) is as follows: Let αij = I{[qj ,pj ]∈[Li ,Ri ]} , i = 1, . . . , n, j =
1, . . . m, be the indicator variables that tell whether the interval [qj , pj ] is contained
in the interval [Li , Ri ]. Then, the probability of Ti being inside the interval [qj , pj ],
                                          0
given a vector s = (s1 , s2 , . . . , sm ) , is given by:

                                              αij sj
                                   µij (s) = P
                                             m                                             (2)
                                               αik sk
                                                  k=1




                                             Revista Colombiana de Estadística 40 (2017) 85–103

88                              Mario César Jaramillo Elorza & Juan Carlos Salazar Uribe


    Since F̂ is constant outside the intervals [qj , pj ], the proportion of observations
inside the interval [qj , pj ] is equal to:

                                                  n
                                             1X
                                    πj (s) =       µij (s)                               (3)
                                             n i=1

                                           0
     And a vector s = (s1 , s2 , . . . , sm ) is called self-consistent if,

                               sj = πj (s) ,    j = 1, 2, . . . , m

   Following this definition, the Turnbull self-consistency algorithm to calculate
the nonparametric estimator of F (t) could be implemented following these steps:

                                                              (0)    1
     1. Obtain initial estimations of s; for instance, sj          =m  , j = 1, 2, . . . , m.
                                                                         
     2. For i = 1, 2, . . . , n, j = 1, 2, . . . , m, calculate µij s(0) in accordance with
                                     
        (2), then update πj s(0) in accordance with (3).
                                                                (1)            
     3. Obtain improved estimations for s by finding sj               = πj s(0) .

     4. Return to step 2, replace s(0) with s(1) , and continue until convergence is
        attained.

    Meeker & Escobar (1992) proposed evaluating the effect of perturbations on
the model, or the weight they have on the maximum likelihood estimates obtained
from censored survival data. Waller & Turnbull (1992) analyzed several graphic
methods to check goodness of fit in the case of right censored data, and the pro-
posed making an empirical rescaling of the axes to prevent data to be grouped
around particular areas in the graphics. Chang & Weissfeld (1999) proposed two
diagnostic methods to evaluate the accuracy of the confidence region based on
the partial likelihood function using a Cox’s proportional hazards model with cen-
sored data. Joly & Commenges (1999) studied both the intensity and survival
function for a progressive right-shift multi-state model using arbitrary censored
data; they illustrated their method using longitudinal data about AIDS. Rosales
& Salazar (2006) generalized the model proposed by Joly & Commenges (1999)
and formulated a likelihood function that considers the presence of arbitrary cen-
soring. However, the problem of constructing simultaneous confidence bands with
arbitrary censoring still presents opportunities for development. This paper dis-
cusses how to obtain simultaneous confidence bands when a Weibull regression
model with arbitrary censoring is considered. In the case of simultaneous confi-
dence bands (SCB) for the cumulative distribution function, Cheng & Iles (1983)
used the Wald statistic to construct the SCB for quantiles of the cumulative dis-
tribution function and the probability of failure. Cheng & Iles (1988) extended
their confidence bands results to cumulative distribution functions that are mem-
bers of the location and scale family with complete data. Jeng & Meeker (2001)
generalized the work of Cheng & Iles (1988) using the Wald statistic with the


                                           Revista Colombiana de Estadística 40 (2017) 85–103

Confidence Bands with Survival Data with Arbitrary Censororing                      89

observed Fisher’s information matrix, the Wald statistic with local information
matrix Fisher, and the likelihood ratio statistic. Finally, Escobar, Hong & Meeker
(2009) extend the work of Cheng & Iles (1983) in the following ways:

  1. They showed how to compute SCB based on local information, expected
     information, and estimated expected information for both the “cdf method”
     and the “quantile method”, Escobar et al. (2009); Cheng & Iles (1983) con-
     sidered only the expected information case

  2. They described a calibration method of the intervals to provide exact cover-
     age for type II censoring and improved approximate coverage for other kinds
     of censoring.

  3. They discussed how to extend these procedures to regression analysis.

    This work was motivated by a radiographic progression study conducted in
Colombia the propose of which was to identify risk factors related with Rheuma-
toid Arthritis (RA Rojas, Diaz, Calvo, Salazar, Iglesias, Mantilla & Anaya 2009).
Suppose that a patient is observed at irregular times and at each visit his/her
health state is assessed and classified in three categories namely mild, moderate,
or severe. Since, in general, it is not possible to observe a patient continuously,
one of the following situations would probably by time:

  1. On the first visit, the patient could be in a moderate or severe state of
     the disease. In this case, the time when the patient changed from mild to
     moderate or from mild to severe is unknown. This generates left censored
     data.

  2. The patient is observed at least once in mild or moderate condition and then
     he/she left the study for some reason. This generates right censored data.

  3. In two consecutive visits the patient changed of state (say from mild to
     moderate or from moderate to severe) but the exact time when this occurred
     is unknown. This generates interval censored data.

    This dataset about radiographic progression of RA exhibits these three types
of censoring, and therefore it is not convenient to analyze it using conventional
approaches that take into account only right censored data, such as the well-known
Cox model. Even if we fit a parametric model that takes into account the dynam-
ics of censoring the data set, the way the goodness of fit is evaluated could not
be entirely correct because the confidence bands of Nair (1984) are used; these
are nonparametric and only work for right censored data. Ii then seems more rea-
sonable to build confidence bands that take into account arbitrary censored data.
PROC LIFEREG of SAS c , allows data to be modeled with censored arbitrary
data as long as a parametric regression model is specified. Allison (1995) fitted a
Weibull model, but the way he assessed the model’s goodness of fit is not entirely
satisfactory because he used Nair’s confidence bands in the presence of interval
censored data, which cannot not correct.


                                     Revista Colombiana de Estadística 40 (2017) 85–103

90                            Mario César Jaramillo Elorza & Juan Carlos Salazar Uribe


    The goal of this paper is to propose simultaneous confidence bands for a Weibull
regression model in the presence of arbitrary censored data. Specifically, instead
of using likelihood to obtain the confidence interval, we adapted the simultaneous
confidence parametric bands proposed by Escobar et al. (2009) in conjunction with
the likelihood function of a bivariate distribution. This is a different strategy from
that of just imputing the interval censored data. This strategy is the works most
important contribution and it yields simultaneous parametric confidence bands.
It is contrasted this with PROC LIFEREG of SAS c , which yields nonparametric
confidence bands.
    They also made comparisons, using a simulation study based on the deviance
of two models. The first estimated the parameters using likelihood with arbitrary
censoring, and the other estimated the parameters using a bivariate likelihood
(Gentleman & Vandal 2001). The goal was to evaluate which of the two likelihoods
yielded better estimates.
   Take into consideration that the goal of this paper is to build a bivariate likeli-
hood with dependency for interval-censored data in order to find S(t).
                                                                    b     Since this
dependency will be specified by means of copulas, it is important to first define
them.


2. Copulas
                                                                                        2
    Suppose that Cα is a distribution function with density cα over [0, 1] for
α ∈ R. Let (T1 , T2 ) be the failure times and let both (S1 , S2 ) and (f1 , f2 ) be
its corresponding marginal survival and density functions, respectively. If (T1 , T2 )
comes from a copula Cα , for any α ∈ R, the joint survival and density functions
of (T1 , T2 ) are given by

                     S (t1 , t2 ) = Cα (S1 (t1 ) , S2 (t2 ))     t1 , t2 ≥ 0,

             f (t1 , t2 ) = cα (S1 (t1 ) , S2 (t2 )) f1 (t1 ) f2 (t2 )   t1 , t2 ≥ 0,
where α represents the dependency parameter between T1 and T2 .
   We will use the Archimedean family of copulas because is the most used copula
family. A bivariate distribution belonging to the family of Archimedean copula
models can be represented in the following way:

                 Cα (u, v) = φ−1
                              α [φα (u) + φα (v)] ,             0 ≤ u, v ≤ 1,

where φ is a convex and decreasing function such that φ ≥ 0, φ (1) = 0. The
φ function is named generator of the Cα copula and the inverse of the genera-
tor, φ−1 and is the Laplace transform of a latent variable denoted as γ, which
induces the dependency α. Thus, the selection of a generator results in several
families of copulas. Table 1 shows the forms for bivariate survival functions in
three Archimedean copula families. Additionally, Table 2 shows the generators
and the Laplace transform for the considered families.



                                           Revista Colombiana de Estadística 40 (2017) 85–103

Confidence Bands with Survival Data with Arbitrary Censororing                              91

                            Table 1: Common Archimedean copulas.
                  Family      Parameter               Bivariate Copula
                  Copula        Space                     Cα (u, v)
                                                 1−α              1/(1−α)
                  Clayton        α>1           n uh   + v 1−α − 1            iα o
                                                           1/α
                  Gumbel       0<α<1        exp − (− ln u)     + (− ln v)1/α
                  Frank          α>0        logα {1 + (αu − 1) (αv − 1) / (α − 1)}

                     Table 2: Generators and their Laplace Transforms.
                    Family      Parameter    Generator      Laplace Transform
                    Copula        Space         φ(t)         (τ (s) = φ−1 (s))
                    Clayton       α>1         t1−α − 1        (1 + s)1/(1−α)
                    Gumbel      0<α<1        (− ln t)1/α         exp (−sα )
                                                  t
                                                   −1
                    Frank          α>0        ln αα−1      logα {1 − (1 − α) es }



3. A Likelihood Function for Interval-Censored
   Bivariate Data
    Let T and V be two random variables with the cumulative distribution function
F (t, v); both T and V are Type I interval censoring. So, instead of observing the
pair (T, V ), we observe the vector Ψ = (T1 , T2 , V1 , V2 , ∆). Here 0 < T1 < T2 < ∞
are the observation times for T , 0 < V1 < V2 < ∞ are the observation times for
V , and ∆ is the vector ∆ = (∆11 , ∆12 , ∆13 , ∆21 , ∆22 , ∆23 , ∆31 , ∆32 , ∆33 ). ∆jk is
defined as:
∆11 = I{T ≤T1 ,V ≤V1 }
∆12 = I{T1 <T ≤T2 ,V ≤V1 }
∆13 = I{T >T2 ,V ≤V1 }
∆21 = I{T ≤T1 ,V1 <V ≤V2 }
∆22 = I{T1 <T ≤T2 ,V1 <V ≤V2 }
∆23 = I{T >T2 ,V1 <V ≤V2 }
∆31 = I{T ≤T1 ,V >V2 }
∆32 = I{T1 <T ≤T2 ,V >V2 }
∆33 = I{T >T2 ,V >V2 }

    Let T = (T1 , T2 ) and V = (V1 , V2 ) be two bivariate random variables with the
joint probability density function g(t, v), the joint cumulative distribution function
G(t, v). Also t = (t1 , t2 ) y v = (v1 , v2 ) are the respective observations of these
variables.
     Rij (t, v) is defined as a function from R4+ to R2+ where t = (t1 , t2 ) and v =
(v1 , v2 ), as follows:
R11 (t, v) = [0, t1 ] × [0, v1 ]
R12 (t, v) = (t1 , t2 ] × [0, v1 ]
R13 (t, v) = (t2 , ∞) × [0, v1 ]
R21 (t, v) = [0, t1 ] × (v1 , v2 ]
R22 (t, v) = (t1 , t2 ] × (v1 , v2 ]


                                             Revista Colombiana de Estadística 40 (2017) 85–103

92                               Mario César Jaramillo Elorza & Juan Carlos Salazar Uribe


R23 (t, v) = (t2 , ∞) × (v1 , v2 ]
R31 (t, v) = [0, t1 ] × (v2 , ∞)
R32 (t, v) = (t1 , t2 ] × (v2 , ∞)
R33 (t, v) = (t2 , ∞) × (v2 , ∞)

   It is understood that (T , V ) and (T, V ) are independent and Pr(T1 < T2 ) =
Pr(V1 < V2 ) = 1.
    We assume n independent and identically distributed repetitions of Ψ. No-
tice that Pr(U1 < U2 ) = Pr(V1 < V2 ) = 1. The underlying repetitions of
(T, V ) are (t1 , v1 ), . . . , (tn , vn ). For each observation i, the (T i , V i ) points de-
fine 9 rectangles the are denoted as Rjki , for j, k = 1, 2, 3, where the values of
∆i = (∆11i , ∆12i , ∆13i , ∆21i , ∆22i , ∆23i , ∆31i , ∆32i , ∆33i ) indicate which rectangle
includes the (ti , vi ) pair.
     Let g(t, v) denote the joint density of (T , V ), where t = (t1 , t2 ) and v =
(v1 , v2 ). Let f (t, v) denote the joint density of (T, V ). Since (T , V ) and (T, V )
are independent, the joint density of (T , V , T, V ) is h(t, v, t, v) = g(t, v)f (t, v).
Thus, using the notation R(t, v) = R(t1 , t2 , v1 , v2 ) and the fact that ∆11 = 1, the
distribution of Ψ is obtained as follows:

     FΨ (ψ) = Pr(T1 ≤ t1 , T2 ≤ t2 , V1 ≤ v1 , V2 ≤ v2 , ∆11 = 1)
             = Pr(T1 ≤ t1 , T2 ≤ t2 , V1 ≤ v1 , V2 ≤ v2 , T ≤ T1 , V ≤ V1 )
               Z v 2 Z v 1 Z t2 Z t1 " Z Z                                    #
             =                             h(t01 , t02 , v10 , v20 , t, v)dtdv dt01 dt02 dv10 dv20
                  0    0     0       0
                                          R(t0 ,v 0 )
                 Z v2 Z v1 Z t2 Z t1                    " ZZ                       #
             =                           g(t0 , v 0 )                 f (t, v)dtdv dt01 dt02 dv10 dv20
                  0    0     0       0
                                                        R(t0 ,v 0 )
                 Z v2 Z v1 Z t2 Z t1
                                         g(t0 , v 0 ) Pr (T, V ) ∈ R(t0 , v 0 ) dt01 dt02 dv10 dv20
                                                                              
             =
                  0    0     0       0
                 Z v2 Z v1 Z t2 Z t1
                                         g(t0 , v 0 ) PrF R(t0 , v 0 ) dt01 dt02 dv10 dv20
                                                                     
             =
                  0    0     0       0
                 Z v2 Z v1 Z t2 Z t1
                                         g(t0 , v 0 ) PrF R(t0 , v 0 ) dt0 dv 0
                                                                     
             =
                  0    0     0       0


    Here, for convenience, we use the notations dt0 = dt,1 dt,2 and dv 0 = dv1, dv2, .
                                                                         
    It can be concluded that the density of Ψ is g(t, v) PrF R(t, v) , where g(t, v)
is independent of F .
                                                                                      
    Usually, if ∆jk = 1, (j, k) ∈ {1, 2, 3}2 , the density of Ψ is: g(t, v) PrF R(t, v) ,
where g(t, v) is independent of F . Then, the likelihood function of F is: Ln (F ) =
Qn Q3                          δjki
   i=1   j,k=1 PrF Rjk (t, v)          .
                                              Pn P3                              
    Then, the loglikelihood is: `n (F ) = i=1 j,k=1 δjki log{PrF Rjk (t, v) }. If
FT is the marginal distribution function for T and FV is the marginal distribution
function for V , the loglikelihood for F is given by:


                                               Revista Colombiana de Estadística 40 (2017) 85–103

Confidence Bands with Survival Data with Arbitrary Censororing                                            93



            n
            X
`n (F ) =         {δ11i log[F (t1i, v1i )] + δ12i log[F (t2i , v1i ) − F (t1i , v1i )] + δ13i log[F2 (v1i )
            i=1
            − F (t2i , v1i )] + δ21i log[F (t1i , v2i ) − F (t1i , v1i )] + δ22i log[F (t2i , v2i )
            − F (t1i , v2i ) − F (t2i , v1i ) + F (t1i , v1i )] + δ23i log[F2 (v2i ) − F (t2i , v2i )
            − F2 (v1i ) + F (t2i , v1i )] + δ31i log[F1 (t1i ) − F (t1i , v2i )]
            + δ32i log[F1 (t2i ) − F1 (t1i ) − F (t2i , v2i )
            + F (t1i , v2i )] + δ33i log[1 − F1 (t2i ) − F2 (v2i ) + F (t2i , v2i )]}

   When we only have interval and right censoring, δ11i = 0, δ12i = 0 and δ13i = 0,
then `n (F ) reduces to:
                    n
                    X
     `n (F ) =            {δ22i log[F (t2i , v2i ) − F (t1i , v2i ) − F (t2i , v1i ) + F (t1i , v1i )]+
                    i=1
                    δ33i log[1 − F1 (t2i ) − F2 (v2i ) + F (t2i , v2i )]}

   In terms of the survival function, we have:
                    n
                    X
      `n (S) =        {δ22i log[S(t1i , v1i ) − S(t1i , v2i ) − S(t2i , v1i ) + S(t2i , v2i )]+
                     i=1
                    δ33i log[S(t2i , v2i )]}

since, F (t, v) = 1 − S1 (t) − S2 (v) + S(t, v)
   Consider the Weibull regression model,

                                       log (T ) = β0 + β 0 Z + σ W

    Where the response variable T could include the three types of censoring (left,
right, and interval censoring), β is a vector of unknown parameters, and σ is the
scale parameter (σ > 0), T ∼ Weibull(µ, σ), W ∼ SEV(0, 1), with µ = β0 + β 0 Z
where SEV (0.1) is the standard smallest extreme value distribution.
   To verify the assumptions of the Weibull regression model, we use the stan-
dardized residuals:
                                                              0
                                             log Tj − βˆ0 − β̂ Z j
                                        Wj =
                                                      σ̂
   If the Weibull model is suitable, then these residuals could be thought of as a
censored sample of a small extreme value distribution, (W ∼ SEV(0,1)).
    Let V be an auxiliary variable so that T and V are highly dependent, let τT,V ,
be the Kendall’s tau, τ , between T and V . Since W = (log T − β0 − β 0 Z)/σ, is
an increasing function of T and τ is invariant under monotonic transformations,
τT,V = τW,V .

                                                  Revista Colombiana de Estadística 40 (2017) 85–103

94                                 Mario César Jaramillo Elorza & Juan Carlos Salazar Uribe


    To estimate the parameters of the Weibull regression model, we use the bivari-
ate loglikelihood for S, which is expressed as:
                 n
                 X
      `n (S) =         {δ22i log[S(w1i , v1i ) − S(w1i , v2i ) − S(w2i , v1i ) + S(w2i , v2i )]+
                 i=1
              δ33i log[S(w2i , v2i )]}

     If we assume that V ∼ UNIF(a, b), then
                                                                      b−v
                            S1 (w) = exp {− exp(w)} , S2 (v) =
                                                                      b−a
   If the Gumbel copula is used for constructing the bivariate distribution with
dependency parameter τ, we have the following:
                        ( "                            1/α #α )
                                     1/α            b−v
           S(w, v) = exp − (exp w)       + − log
                                                    b−a

   Even though the uniform distribution has rough edges, it works well in the sim-
ulation process, as we will show in the next section; however, another distribution
could be used, for instance, the beta distribution.


4. Simulation Study
   To explore if the bivariate likelihood with random censoring improves the es-
timations of the parameters of the Weibull regression model in comparison to the
ones obtained with the Turnbull method (Turnbull 1976), the following simulation
study was carried out.
     Recall that the Weibull regression model is specified as:
                                      log(T ) = β0 + βZ + σW

   Therefore, to generate times from a Weibull model, we must generate Z and
W , maintaining β, β0 and σ fixed. Since it is assumed that T and V are highly
dependent and that their dependence could be measured with the coefficient τ , that
was fixed at τ = 0.99, and since τ is invariant under monotonic transformations,
then we must generate W in such a way it satisfies τ (W, V ) = 0.99.
     The simulation factors that will be controlled are:

     1. Sample size n: the objective of this factor is to assess the effect of the
        number of individuals in the study during the estimation process. Values of
        n = 50, 100, 200 will be taken because they can easily appear in practice.
     2. Percentage of interval censored observations p: the objective of this factor
        is to evaluate the effect of the percentage of interval censored observations
        p during the estimation process. The values of p = 0.5, 0.7, 0.9, will reflect
        situations with high interval censoring percentages; the remaining data are
        right censored.


                                               Revista Colombiana de Estadística 40 (2017) 85–103

Confidence Bands with Survival Data with Arbitrary Censororing                        95

   3. Variance of time until the event of interest σT2 : the objective of this factor
      is to assess the effect of the variance of the time until the event of interest
      during the estimation process. The values of σT2 = 4, 25, 100 because we
      want to observe the effect in the presence of small and large variances.

   4. Parameter vector β: the objective of this factor is to evaluate the effect
      of the explanatory variable Z, on the estimation process. We will consider
      the following values: β = −0.9, −0.7, −0.5, −0.3. Some simulations were
      performed with positive values of β and they yielded very similar results to
      the ones obtained using negative values.

   5. Distribution of the explanatory variable Z: the objective of this factor is
      to assess the effect of the distribution of the explanatory variable Z on the
      estimation process. For the sake of simplicity only two distributions will
      be considered, a continuous standard normal distribution Z ∼ NOR(0, 1)
      and an ordinal discrete binomial distribution with parameters n = 6 and
      p = 0.5, (Z ∼ BIN(6, 0.5)). However, more complex distributions could also
      be considered.

     Finally, with the simulated data, β0 , β and σ will be estimated to obtain
c0 , β,
β    bσ b, and the square root of the mean square errors will be calculated to observe
the accuracy of the estimation process.
    In Lawless & Babineau (2006), we find a comprehensive discussion on how to
generate interval-censored data. Ii specifically refers to the case of a longitudinal
study, in which there is a periodic follow-up of the scheduled visits, and it takes into
account that the patients could miss some of their appointments. We supposed
that there are M potential inspection times aj , j = 0, . . . , M , for instance aj = j.
The probability of patients attending each scheduled visit is p. For an individual
i, the observed interval censored (Li , Ri ] is constructed by defining Ri as the
first visit in which the event of interest is observed. Li is the previous visit, i.e.
Li = max aj : aj < Ti , δji = 1 and Ri = min aj : aj ≤ Ti , δji = 1, where δji = 1,
indicates that the visit occurred at time aj . Different values of p lead to different
interval lengths. For instance, p = 0.3 implies that 70% of the visits are missed,
which would lead to the observation of wide confidence intervals for T .
    With censored data, β0 , β and σ will be estimated using the interval-censored
                                                c0 , βbint and σ
likelihood and we will write those estimates as β int          bint , then the square
root of the mean square errors will be calculated to measure the accuracy of the
estimation process.
    With the censored data, β0 , β and σ, will be estimated by taking the likelihood
                                                                c0 , βbbiv and σ
as a bivariate likelihood and we will denote those estimates as β biv           bbiv .
The square root of the mean square errors will they be calculated to measure the
accuracy of the estimation process. This optimization process will be carried out
using the Nelder-Mead Simplex algorithm (Nelder & Mead 1965), which is one of
the options included in the maxLik package of R software. This algorithm was used
instead of the Newton-Raphson method because it showed a better performance
in the preliminary tests.


                                       Revista Colombiana de Estadística 40 (2017) 85–103

96                             Mario César Jaramillo Elorza & Juan Carlos Salazar Uribe


    Additionally, in each simulation, deviance will be calculated using two likeli-
hoods, one with interval censoring to estimate three parameters, β0 , β, σ, and the
other, the bivariate likelihood for calculating µ, β, σ, a and b of the distribution of
the V auxiliary variable, which we assumed has a UNIF(a, b) distribution. We the
calculated D = −2 × [l(β               bint ) − l(β
                          c0 , βbint , σ
                             int                               bbiv , b
                                                  c0 , βbbiv , σ
                                                    biv               a, bb)], in this case, the
approximate distribution of D is a chi-square with 2 degrees of freedom, D ∼ χ2(2) .
The number of times H0 is rejected at a α = 0.05 level will also be calculated. In
other words, this will be the number of times in which the bivariate likelihood is
better than the interval likelihood: we will call it “acceptance”.


5. Simulation Study Results
    Below, we present the square root of the mean square errors of the estimations
that were obtained using the methods based on the likelihoods for β0 , β, and σ.
For we used some combinations of the parameters and an explanatory variable
following a normal distribution (Z ∼ NOR(0, 1)).
    In Tables 3 to 6, we observe that if we take the likelihood as a bivariate likeli-
hood for random-censored data, taking into account the auxiliary variable V , and
if we estimate β0 , β, and σ, the square root of the mean square errors associated
to β0 , β, and σ are much lower than if we estimate the Weibull model param-
eters by using the traditional likelihood with random censoring without taking
into account the auxiliary variable V . Besides, we see that the square root of
the mean square errors does not significantly change when the sample size n, the
censoring percentage p, the variance of the time of interest σT2 , or the coefficient
of the explanatory variable Z, β are changed. Moreover, when we compare both
the likelihoods by using the likelihood-ratio test, we observe that the percentage
of times the bivariate likelihood is greater than the random censoring likelihood is
close to 100%.
            Table 3: MSE using Z ∼ NOR(0, 1), σT = 10, p = 0.7, β = −0.5.
                                                            n
                                                  50       100      200
                         Error(βbint , β)       0.7501   0.6522   0.5840
                         Error(βbbiv , β)       0.6215   0.6006   0.4100
                                b β)
                         Error(β,               0.2734   0.2021   0.1203
                         Error(β0 int , β0 )
                               c                2.6495   2.9158   2.9741
                               c0 , β0 )
                         Error(β   biv          0.6596   0.4370   0.3494
                               c0 , β0 )
                         Error(β                0.6327   0.3378   0.3213
                               σint , σ)
                         Error(b                0.9812   0.9816   0.9876
                               σbiv , σ)
                         Error(b                0.2715   0.2548   0.1764
                               σ , σ)
                         Error(b                0.0452   0.0175   0.0030
                         Acceptance              0.988   1.0000   1.0000




                                               Revista Colombiana de Estadística 40 (2017) 85–103

Confidence Bands with Survival Data with Arbitrary Censororing                            97

          Table 4: MSE using Z ∼ NOR(0, 1), σT = 10, n = 200, β = −0.5
                                                         p
                                               0.5      0.7          0.9
                       Error(βbint , β)      0.7810   0.5840       0.5407
                       Error(βbbiv , β)      0.7423   0.4100       0.4616
                              b β)
                       Error(β,              0.2204   0.1203       0.2445
                             c0 , β0 )
                       Error(β   int         2.3222   2.9741       2.8367
                             c0 , β0 )
                       Error(β   biv         0.9810   0.3494       0.4382
                             c0 , β0 )
                       Error(β               0.1185   0.3213       0.3658
                             σint , σ)
                       Error(b               0.9917   0.9876       0.9706
                             σbiv , σ)
                       Error(b               0.1914   0.1764       0.2712
                             σ , σ)
                       Error(b               0.0638   0.0030       0.0036
                       Acceptance            1.0000   1.0000       1.0000


          Table 5: MSE using Z ∼ NOR(0, 1), n = 200, p = 0.7, β = −0.5.
                                                        σT
                                                2        5           10
                       Error(βbint , β)      0.4735   0.4724       0.5840
                       Error(βbbiv , β)      0.1380   0.3456       0.4100
                              b β)
                       Error(β,              0.0242   0.0599       0.1203
                             c0 , β0 )
                       Error(β   int         3.2262   3.1482       2.9741
                             c0 , β0 )
                       Error(β   biv         0.4535   0.3752       0.3494
                             c0 , β0 )
                       Error(β               0.0729   0.1801       0.3213
                             σint , σ)
                       Error(b               0.9029   0.9634       0.9876
                             σbiv , σ)
                       Error(b               0.1265   0.3215       0.1764
                             σ , σ)
                       Error(b               0.0002   0.0017       0.0030
                       Acceptance            0.9995   1.0000       1.0000


           Table 6: MSE using n = 200, Z ∼ NOR(0, 1), σT = 10, p = 0.7.
                                                           β

                  Error(βbint , β)       0.7717   0.5731       0.5840   0.6325
                  Error(βbbiv , β)       0.6016   0.5366       0.4100   0.4112
                         b β)
                  Error(β,               0.1238   0.1325       0.1203   0.2221
                  Error(β0 int , β0 )
                        c                2.9750   2.9725       2.9741   2.5948
                        c0 , β0 )
                  Error(β   biv          0.5367   0.4071       0.3494   0.4292
                        c0 , β0 )
                  Error(β                0.3637   0.3727       0.3213   0.3199
                        σint , σ)
                  Error(b                0.9829   0.9808       0.9876   0.9840
                        σbiv , σ)
                  Error(b                0.2856   0.2930       0.1764   0.1718
                        σ , σ)
                  Error(b                0.0112   0.0151       0.0030   0.0110
                  Acceptance              1.00     1.00         1.00    0.9995




                                           Revista Colombiana de Estadística 40 (2017) 85–103

98                                                     Mario César Jaramillo Elorza & Juan Carlos Salazar Uribe


    Figure 1 shows that the square root of the mean square errors does not sub-
stantially change when varying the sample size. It also shows that if we take the
likelihood as a bivariate likelihood for random-censored data, taking into account
the auxiliary variable V , and if we estimate β0 , β, and σ, the square root of the
mean square errors of β0 , β, and σ are much lower than if we estimate these param-
eters of the Weibull model using a traditional likelihood with random censoring
without considering the auxiliary variable V .

                                                                                                                                 σ2T=100, p=0.7, β=−0.5
                                           σ2T=100, p=0.7, β=−0.5
                                                                                                                      3.0
                                3.0

                                                                                                                      2.5
                                2.5




                                                                                                  Mean Square Error
                                                                                                                      2.0
            Mean Square Error




                                2.0                                                                                         Error(β0int, β0)
                                      Error(βint, β)
                                                                                                                            Error(β0biv, β0)
                                      Error(βbiv, β)
                                                                                                                            Error(β0, β0)
                                      Error(β, β)                                                                     1.5
                                1.5


                                1.0                                                                                   1.0


                                0.5                                                                                   0.5


                                0.0                                                                                   0.0
                                        50          100                             200                                       50          100             200
                                                 Sample size n                                                                         Sample size n

                                                                                      σ2T=100, p=0.7, β=−0.5
                                                                           3.0


                                                                           2.5
                                                       Mean Square Error




                                                                           2.0
                                                                                 Error(σint, σ)
                                                                                 Error(σbiv, σ)
                                                                                 Error(σ, σ)
                                                                           1.5


                                                                           1.0


                                                                           0.5


                                                                           0.0
                                                                                   50          100                              200
                                                                                            Sample size n


Figure 1: MSE behavior varying the sample size n using the three estimation methods.


   Figure 2 shows that the square root of the mean square errors does not sub-
stantially change when varying the right censoring percentage p and that if we
take the likelihood as a bivariate likelihood for random-censored data, taking into
account the auxiliary variable V , and if we estimate β0 , β, and σ, the square
root of the mean square errors of β0 , β and σ are much lower than if we estimate
these parameters of the Weibull model using a traditional likelihood with random
censoring without considering the auxiliary variable V .
    Figure 3 shows that the square root of the mean square errors does not sub-
stantially change when varying the variance of the time of interest. It also shows
that if we take the likelihood as a bivariate likelihood for random-censored data,
taking into account the auxiliary variable V , and if we estimate β0 , β, and σ, the
square root of the mean square errors of β0 , β, and σ are much lower than if we
estimate these parameters of the Weibull model using a traditional likelihood with
random censoring without considering the auxiliary variable V .


                                                                                    Revista Colombiana de Estadística 40 (2017) 85–103

Confidence Bands with Survival Data with Arbitrary Censororing                                                                                                                                                                         99

                                                             σ2T=100, n=200, β=−0.5                                                                                                      σT2=100, n=200, β=−0.5
                                 3.0                                                                                                                              3.0


                                 2.5                                                                                                                              2.5




             Mean Square Error




                                                                                                                                              Mean Square Error
                                 2.0                                                                                                                              2.0
                                                      Error(βint, β)                                                                                                             Error(β0int, β0)
                                                      Error(βbiv, β)                                                                                                             Error(β0biv, β0)
                                                      Error(β, β)                                                                                                                Error(β0, β0)
                                 1.5                                                                                                                              1.5


                                 1.0                                                                                                                              1.0


                                 0.5                                                                                                                              0.5


                                 0.0                                                                                                                              0.0
                                                                     0.5       0.7      0.9                                                                                                     0.5       0.7      0.9
                                                      Percentage of interval censored p                                                                                          Percentage of interval censored p


                                                                                                                         σT2=100, n=200, β=−0.5
                                                                                                 3.0


                                                                                                 2.5
                                                                             Mean Square Error



                                                                                                 2.0
                                                                                                                  Error(σint, σ)
                                                                                                                  Error(σbiv, σ)
                                                                                                                  Error(σ, σ)
                                                                                                 1.5


                                                                                                 1.0


                                                                                                 0.5


                                                                                                 0.0
                                                                                                                                0.5       0.7      0.9
                                                                                                                 Percentage of interval censored p

Figure 2: MSE behavior varying the proportion of interval censored p using three esti-
          mation methods.

                                                                                                                                                                                         n=200, p=0.7, β=−0.5
                                                                n=200, p=0.7, β=−0.5
                                            3.0                                                                                                          3.0

                                            2.5                                                                                                          2.5
                                                                                                                                     Mean Square Error
                        Mean Square Error




                                            2.0                                                                                                          2.0
                                                                                                       Error(βint, β)                                                                                             Error(β0int, β0)
                                                                                                       Error(βbiv, β)
                                                                                                                                                                                                                  Error(β0biv, β0)
                                                                                                       Error(β, β)
                                            1.5                                                                                                          1.5                                                      Error(β0, β0)



                                            1.0                                                                                                          1.0


                                            0.5                                                                                                          0.5


                                            0.0                                                                                                          0.0
                                                  4       25                                                            100                                             4          25                                            100
                                                       Variance of time until the event σ2T                                                                                     Variance of time until the event σ2T

                                                                                                                          n=200, p=0.7, β=−0.5
                                                                                              3.0


                                                                                              2.5
                                                                          Mean Square Error




                                                                                              2.0
                                                                                                                                                                        Error(σint, σ)
                                                                                                                                                                        Error(σbiv, σ)
                                                                                                                                                                        Error(σ, σ)
                                                                                              1.5


                                                                                              1.0


                                                                                              0.5


                                                                                              0.0
                                                                                                        4           25                                                                   100
                                                                                                                 Variance of time until the event σ2T


 Figure 3: MSE behavior varying the variance of T using three estimation methods.




                                                                                                                         Revista Colombiana de Estadística 40 (2017) 85–103

100                                                      Mario César Jaramillo Elorza & Juan Carlos Salazar Uribe

                                            σ2T=100, p=0.7, n=200                                                                                     σ2T=100, p=0.7, n=200
                               3.0                                                                                             3.0


                               2.5                                                                                             2.5




           Mean Square Error




                                                                                                           Mean Square Error
                               2.0                                                                                             2.0
                                                                                Error(βint, β)                                                                         Error(β0int, β0)
                                                                                Error(βbiv, β)                                                                         Error(β0biv, β0)
                                                                                Error(β, β)                                                                            Error(β0, β0)
                               1.5                                                                                             1.5


                               1.0                                                                                             1.0


                               0.5                                                                                             0.5


                               0.0                                                                                             0.0
                                     −0.9   −0.7    −0.5      −0.3                                                                           −0.9     −0.7    −0.5      −0.3
                                              Parameter vector β                                                                                        Parameter vector β

                                                                                                 σ2T=100, p=0.7, n=200
                                                                          3.0


                                                                          2.5
                                                      Mean Square Error




                                                                          2.0
                                                                                                                                     Error(σint, σ)
                                                                                                                                     Error(σbiv, σ)
                                                                                                                                     Error(σ, σ)
                                                                          1.5


                                                                          1.0


                                                                          0.5


                                                                          0.0
                                                                                        −0.9     −0.7    −0.5      −0.3
                                                                                                   Parameter vector β

Figure 4: MSE behavior varying the coefficient of the explanatory variable β0 using
          three estimation methods.



    Figure 4 shows that the square root of the mean square errors does not sub-
stantially change when varying the coefficient of the explanatory variable β. It also
shows that if we take the likelihood as a bivariate likelihood for random-censored
data, taking into account the auxiliary variable V , and if we estimate β0 , β, and
σ, the square root of the mean square errors of β0 , β, and σ are much lower than if
we estimate these parameters of the Weibull model using a traditional likelihood
with random censoring without considering the auxiliary variable V .
    In Figure 5 simultaneous parametric confidence bands (Escobar et al. 2009)
are shown. To construct these, we used both data with arbitrary censored, and a
bivariate likelihood functions with arbitrary censored data that has an auxiliary
variable V that is highly correlated with the response variable. On the right side
of the graph, we can see that when the cumulative distribution function with the
bivariate likelihood is estimated, taking into account the auxiliary variable V , the
cumulative distribution is fairly close to the real cumulative distribution. However,
if we do not take into account the auxiliary variable V , the estimated cumulative
distribution is not that close to the real cumulative distribution. In the graph
on the left, we can observe that the confidence parametric bands proposed by
Escobar et al. (2009), in the case of the auxiliary variable, contain all the straight
lines. These represent the real cumulative distribution function, whereas when if
we do not take into account the auxiliary variable, this straight line is out of the


                                                                                                 Revista Colombiana de Estadística 40 (2017) 85–103

Confidence Bands with Survival Data with Arbitrary Censororing                                                               101

confidence bands. In summary, the use of the bivariate likelihood, the construction
of which is undertaken considering the auxiliary variable, is recommended.

                                         Gráfico Weibull con n=200                            Gráfico Weibull con n=200




                                  0.99




                                                                                       0.99
                                                  auxiliar                                             auxiliar
                                                  no auxiliar                                          no auxiliar
                                                  real                                                 real




                                  0.63




                                                                                       0.63
                   Probabilidad




                                                                        Probabilidad
                                  0.3




                                                                                       0.3
                                  0.1




                                                                                       0.1
                                             35      40    45   50 55                             35      40    45   50 55

                                                     Datos                                                Datos

Figure 5: Extension of the simultaneous confidence bands of Escobar et al. (2009) for
          F (t) to the interval censorored case, using the two likelihoods.




6. Conclusions and Recommendations
    When the goal is to study the lapse of time until the occurrence of an event
of interest, and to detect whether such event occurred, it is necessary to measure
a variable that could be and index. This index which is known as an auxiliary
variable, is correlated to the time of occurrence of the event, and this occurrence
time could exhibit left, right, or interval censoring. In addition, if some covariates
are available and we want to adjust a parametric regression model to determine
which of these covariates are related to the time of occurrence of an event, we can
not only use a likelihood with the three censoring types, but also the proposed
bivariate likelihood. To obtain the maximum-likelihood estimators of β0 , β, σ, the
maxLik package of the R software was used as this package maximizes the likelihood
functions. After this, the Nelder-Mead method was applied since it showed greater
stability during the estimation process.
    According to the results from the simulation study, we can conclude that the
estimated parameters of the Weibull model using the proposed methodology (the
bivariate likelihood) are closer to the real values of the parameters than the ones
obtained only taking into consideration the three types of censoring. However,
it is worth noting that the standard errors associated with the proposed method
are consistently higher than the ones from the conventional methods in all the
simulation scenarios.
    Also, from the simulation study, we can see that, according to the likelihood
ratio test, the proposed model (that uses the auxiliary variable in addition to


                                                                  Revista Colombiana de Estadística 40 (2017) 85–103

102                        Mario César Jaramillo Elorza & Juan Carlos Salazar Uribe


the three types of censoring) performs better than the model that only takes into
consideration the three censoring types. This is because a higher percentage of
acceptance was obtained.
    According to these conclusions, when interval-censored data are available, for
which the interval censoring is determined by the measurement of a variable that
indicates whether the event of interest occurred or not, and when the goal is to
adjust a Weibull regression model, the use of the bivariate likelihood proposed in
this paper is recommended. This is because it produces closer estimations to the
real parameters than the estimations obtained when the likelihood for interval-
censored data is used.
   In terms of future work, this methodology could be implemented as a package
of R-project and this work could be applied to other members of the localization
and scale family.
                                                               
                 Received: April 2015 — Accepted: February 2016


References
Allison P D. Survival Analysis Using the SAS System: A Practical Guide.(1995). Springer-Verlag.
Chang C H, Weissfeld L A. Normal aproximation diagnostics for the Cox model.(1999). Biometrics.
Cheng R, Iles T. Confidence bands for cumulative distribution functions of continuous random variables.(1983). Technometrics.
Cheng R, Iles T. One-sided confidence bands for cumulative distribution functions.(1988). Technometrics.
Dorey F, J, Little R, Schenker N. Multiple imputation for threshold crossing data with interval censoring.(1993). Statistics in Medicine.
Efron B. The two sample problem with censored data.(1967). University of California Press.
Escobar L A, Hong Y, Meeker W Q. Simultaneous confidence bands and regions for log-location-scale distributions with censored data.(2009). Journal of Statistical Planning and Inference.
Gentleman R, Vandal A C. Computational algorithms for censoreddata problems using intersection graphs.(2001). Journal of Computational and Graphical Statistics.
Jeng S, Meeker W Q. Parametric simultaneous confidence bands for cumulative distributions from censored data.(2001). Technometrics.
Joly P, Commenges D. A penalized likelihood approach for a progressive three-state model with censored and truncated data: Application to AIDS.(1999). Biometrics.
Kaplan E L, Meier P. Nonparametric estimation from incomplete observations.(1958). Journal of the American statistical association.
Lawless J, Babineau D. Models for interval censoring and simulationbased inference for lifetime distributions.(2006). Biometrika.
Meeker W, Escobar L. Assessing influence in regression analysis with censored data.(1992). Biometrics.
Nair V N. Confidence bands for survival functions with censored data: A comparative study.(1984). Technometrics.
Nelder J, Mead R. A simplex method for function minimization.(1965). Computer Journal.
Odell P, Anderson K, D’Agostinho R. Maximum likelihood estimation for interval censored data using a Weibull based accelerated failure time model.(1992). Biometrics.
Peto R. Experimental survival curves for interval-censored data.(1973). Journal of the Royal Statistical Society.
Rojas A, Diaz F J, Calvo E, Salazar, J C, Iglesias A, Mantilla R D, Anaya J M. Familial disease the HLA-DRB1 shared epitope and anti-CCP antibodies influence time at appearance of substantial joint damage in rheumatoid arthritis.(2009). Journal of Autoimmunity.
Rosales L F, Salazar J C. Estimaciones de funciones de intensidad en un modelo de 3 estados en presencia de doble censura .(2006). Universidad Nacional De Colombia
Rucker G, Messerer D. Remission duration: an example of intervalcensored observation.(1988). Statistics in Medicine.
Turnbull B W. Nonparametric estimation of a survivorship function with doubly censored data.(1974). Journal of the American statistical association.
Turnbull B W. The empirical distribution function with arbitrarily grouped censored and truncated data.(1976). Journal of the Royal Statistical Society.
Waller L A, Turnbull B W. Probability Plotting with censored data.(1992). The American Statistician.
