Análisis bivariado de confiabilidad basado en cópulas.Reliability Bivariate Analysis Based on Copulas
Centro de Investigación en Matemáticas A C
Resumen
En la industria se requieren estudios de confiabilidad para asegurar el nivel de calidad de los productos que se fabrican. Algunas veces tales productos tienen varios modos de falla que deben considerarse en el análisis de confiabilidad. Este análisis se complica cuando se incluye el patrón de dependencia de los modos de falla. En este artículo se muestra el análisis de confiabilidad de componentes que presentan dos modos de falla dependientes, expresando el patrón de dependencia de ambos modos de falla por medio de una función de cópula. Esta representación es adecuada, debido a que las distribuciones de los tiempos de falla son diferentes, Lognormal y Weibull. Se presenta un ejemplo donde se ilustra el análisis de confiabilidad de componentes con dos modos de falla.
Palabras clave: cópula, distribución bivariada, estimación en dos etapas, función de confiabilidad, función de verosimilitud.
Abstract
In industry, reliability studies are done to assure the quality level of products manufactured. Sometimes these products have several failure modes that must be considered in reliability analysis. This analysis is complicated when the dependence pattern is included. In this article a reliability analysis of components that have two dependent failure modes is proposed. The dependence pattern is expressed through a copula function, this representation is appropriate, because the marginal distributions of failure times are from different families, Lognormal and Weibull. We provide an example which illustrates the reliability analysis of components with two failure modes.
Key words: Bivariate distribution, Copula, Likelihood function, Reliability function, Two-stage estimation.


1. Introducción
    En la industria existe la preocupación de mejorar los procesos de producción
y aumentar la calidad de sus productos, lo que se busca es disminuir costos e
incrementar la conﬁabilidad de los equipos o componentes que producen. Para el
segundo objetivo se realizan estudios de conﬁabilidad para veriﬁcar si el producto
satisface los requerimientos del cliente. En este trabajo comentamos una forma de
analizar la conﬁabilidad de un producto que tiene dos modos de falla. Usualmente
los equipos están formados por varios componentes, y cuando falla uno de los
componentes, falla el equipo (o el desempeño del mismo disminuye), a esto se
le puede llamar un sistema con varios modos de falla, de hecho un componente
también puede tener varios modos de falla. Como los componentes de un sistema o
producto operan bajo las mismas condiciones, se espera que sus tiempos a la falla
sean dependientes. Para el análisis de este tipo de información se pueden utilizar
técnicas de riesgos en competencia. En estas técnicas, los diferentes modos de falla
están en competencia, esto es, solo se observa el primero que ocurre, ya que una
vez que la unidad falla por alguno de los modos de falla, deja de ser observada. El
tiempo a la falla de una unidad que tiene varios modos de falla, sera el mínimo
de los tiempos de falla potenciales asociados a cada modo de falla. En algunos
estudios de conﬁabilidad, sobre todo en los que se realizan en laboratorio, es posible
corregir los modos de falla que se van presentando, esto permite continuar con el
estudio hasta que se observen todos los modos de falla. En este caso, los datos son
multivariados y se pueden usar modelos multivariados para su análisis, los datos
que analizamos en este trabajo son de este tipo.
    En este artículo se presenta un estudio de conﬁabilidad de encendedores de
horno de estufa a gas, que tienen dos modos de falla, que se describen posterior-
mente en la sección 4. En este estudio, se observan ambos modos de falla y se
registran sus tiempos representados por las variables aleatorias T1 y T2 , respecti-
vamente. Como la falla de un componente no censura la ocurrencia de una falla
en el otro componente, los datos en este estudio son bivariados.
   El objetivo en este estudio consiste en conocer diferentes puntos de interés
como son: el patrón de dependencia de los dos tiempos a la falla, la conﬁabilidad
en dos tiempos de referencia importantes, uno y diez años, asíŋ como los cuantiles
para diferentes probabilidades.
   Las distribuciones identiﬁcadas para ambas variables aleatorias, son de dife-
rentes familias: Weibull y Lognormal. Esto nos lleva a usar el enfoque de cópulas
para modelar la dependencia entre ambas variables. Las cópulas separan la estruc-
tura de dependencia de los efectos de las marginales, por esta razón, es posible
considerar marginales de familias de diferentes distribuciones, como ocurre en el
presente trabajo.
   En la sección 2, se discute la relación entre función de supervivencia y cópulas,
también se presentan algunas de las cópulas arquimedeanas comunes. Se presenta
además una técnica para identiﬁcar una copula que modele el patrón de depen-
dencia de los datos. En la sección 3, se describe la manera de hacer inferencia,
cuando tenemos funciones de supervivencia basadas en cópulas. En la sección 4, se

                                     Revista Colombiana de Estadística 34 (2011) 267–285

Análisis bivariado de confiabilidad basado en cópulas                                    269

discuten los detalles del análisis de los datos de tiempos de falla bivariados, para
los dos modos de falla de los encendedores de horno. En la sección 5 se presentan
las conclusiones del presente trabajo.


2. Función de confiabilidad bivariada y cópulas
   El objetivo de un estudio de conﬁabilidad es estimar cantidades de interés co-
mo cuantiles para diferentes probabilidades y niveles de conﬁabilidad en diferentes
tiempos. Con frecuencia, en la industria la conﬁabilidad bivariada se estima asu-
miendo independencia entre los tiempos a la falla T1 y T2 de los modos de falla.
Por supuesto que esto no es del todo correcto, ya que al trabajar bajo las mismas
condiciones, los modos de falla generalmente son dependientes. Así, es necesario
considerar modelos que tomen en cuenta la estructura de dependencia que pueden
tener los datos. Además de esto, la censura puede estar presente. De manera más
precisa, si hay censura por la derecha y si C1 y C2 son las variables de censura
para T1 y T2 , respectivamente, los datos que se observan son parejas (X, Y ) e indi-
cadores de censura (δ1 , δ2 ), con X = mı́n(T1 , C1 ), Y = mı́n(T2 , C2 ), δ1 = 11[X=T1 ]
y δ2 = 11[Y =T2 ] , donde 11A es la función indicadora del evento A.
   Si las distribuciones marginales de T1 y T2 son continuas, podemos unirlas con
una función para formar una función de conﬁabilidad bivariada como sigue (e. g.
Wang    Wells 2000).
                              S(t1 , t2 ) = Cθ [S1 (t1 ), S2 (t2 )]                  (1)
donde Sj (·), j = 1, 2, son las funciones de conﬁabilidad marginales de T1 y T2 ,
Cθ (·, ·) es una función que une a las funciones de conﬁabilidad marginales, llamada
función cópula, y θ ∈ IR es un parámetro de asociación desconocido. Algunos
ejemplos de estas funciones de conﬁabilidad bivariada se encuentran en Clayton
(1978), Frank (1979), Joe (1993) y Hougaard (1986). Note que la función de cópula
Cθ (·, ·) es una función de supervivencia en [0, 1] × [0, 1]. En la literatura, existen
una gran cantidad de trabajos relacionados con las propiedades de las funciones
cópulas y el modelado de variables aleatorias usando éstas (e.g. Roger (2006),
Joe (1997), Escarela    Hernández (2009), Jaworski, Durante, Hädel    Rychlik
(2010)). Una característica especial de las funciones cópula es que la estructura
de dependencia es separada de los efectos de las marginales, así que la relación de
dependencia se puede estudiar sin especiﬁcar las distribuciones marginales.
   La función de densidad conjunta correspondiente a la función de conﬁabilidad
dada en la ecuación (1) está dada por

                     f (t1 , t2 ) = f1 (t1 )f2 (t2 ) × cθ [S1 (t1 ), S2 (t2 )]
                    d
donde fj (z) = − dz   Sj (z), j = 1, 2, son las densidades de los tiempos a la falla y
               2
             ∂
cθ (u, v) = ∂u∂v Cθ (u, v).




                                          Revista Colombiana de Estadística 34 (2011) 267–285

270                                 Enrique Raúl Villa-Diharce    Pedro Enrique Monjardin

    El parámetro θ se puede ver como un parámetro de asociación global, y está
relacionado con la τ de Kendall a través de la ecuación (ver Escarela    Hernández
2009)
                         Z 1Z 1
                    τ =4         Cθ (u, v) dCθ (u, v) − 1 ≡ Λ(θ)              (2)
                               0     0

    Dado un nivel de asociación medido por τ o θ, Cθ (u, v) determina el grado de
dependencia local en (u, v) ∈ [0, 1] × [0, 1]. Cuando la asociación se aproxima a los
niveles extremos, todos los modelos toman la misma forma: bajo independencia
(τ = 0), Cθ (u, v) = uv ≡ C ⊥ (u, v) y bajo la máxima dependencia positiva (τ = 1),
Cθ (u, v) = mı́n(u, v) ≡ C + (u, v).
    Existe una clase de cópulas que engloba a la mayoría de las cópulas bivariadas
más comunes, su característica principal es que es indexada por una función univa-
riada, por lo que sus propiedades matemáticas y computacionales son fáciles, esta
es la llamada clase de cópulas arquimedeanas. Una función cópula es arquimedeana
si puede expresarse como

                Cθ (u, v) = ϕ−1
                             θ [ϕθ (u) + ϕθ (v)] ,       (u, v) ∈ [0, 1] × [0, 1]

donde ϕθ (·) es una función convexa deﬁnida en [0, 1] tal que ϕθ (1) = 0 y ϕ−1
                                                                            θ (·)
denota la seudoinversa de ϕθ (·). A ϕθ se le llama la función generadora de la
cópula.
   Algunas de las familias de cópulas más comunes que se pueden expresar en una
representación de cópulas arquimedeanas se muestran en la tabla 1.

                      Tabla 1: Ejemplos de cópulas arquimedeanas.
      Familia                         Cθ (u, v)                                ϕθ (t)
                                                                            1 −θ
      Clayton                  (u−θ + v −θ − 1)−1/θ                         (t
                                                                            θ  − 1) 
                         − 1θ ln 1 + (e −1)(e         −1)
                                         −θu      −θv
                                                                           − ln ee−θ −1
                                                                                      −1
                                                                                  −θt
      Frank                                  e− θ−1
                          n                            1/θ o
      Gumbel           exp − (− ln u)θ + (− ln v)θ                           (− ln t)θ
       Joe        1 − [(1 − u)θ + (1 − v)θ − (1 − u)θ (1 − v)θ ]       − ln[1 − (1 − t)θ ]

   Una función de conﬁabilidad bivariada modelada con una función cópula ar-
quimedeana toma la forma

                        S(t1 , t2 ) = ϕ−1
                                       θ {ϕθ [S1 (t1 )] + ϕθ [S2 (t2 )]}

    Para poder usar el modelo dado en (1) es necesario elegir una cópula. Genest
& Riverst (1993) proponen un método no-paramétrico que sin tomar en cuenta las
marginales, estima una función que identiﬁca a una cópula arquimedeana. Ellos
prueban, cuando no hay datos censurados, que la función generadora ϕθ (·) de una
cópula arquimedeana se puede identiﬁcar usando la función K(z) = Pr[S(T1 , T2 ) ≤
z] a través de la ecuación diferencial
                                                        ϕθ (z)
                                   λ(z) = z − K(z) =
                                                        ϕ′θ (z)

                                         Revista Colombiana de Estadística 34 (2011) 267–285

Análisis bivariado de confiabilidad basado en cópulas                                      271

                   d
donde ϕ′θ (z) = dz   ϕθ (z). Este método se usa en Arcila, Jaramillo    Lopera (2009)
para analizar datos de seguros.
    Esta propuesta no considera la censura en los datos, lo cual se tiene con gran
frecuencia en estudios de conﬁabilidad. Wang    Wells (2000) proponen una téc-
nica similar a la de Genest    Riverst (1993), pero para el caso en que hay datos
censurados por la derecha, el método es el siguiente: Sean x(1) ≤ · · · ≤ x(n) y
y(1) ≤ · · · ≤ y(n) las observaciones ordenadas de los datos {(Xi , Yi ) : i = 1, . . . , n}.

                            e
   1. Calcular el estimador K(z) de K(z) = 1 − Pr[S(T1 , T2 ) > z] como
                                       n
                                     n X
                                     X
                     e
                     K(z) =1−                  11[S(x              e
                                                  e (i) ,y(j) )>z] S(∆x(i) , ∆y(j) )
                                     i=1 j=1

            e es un estimador no-paramétrico de S y
      donde S
                 e
                 S(∆x                e                 e
                     (i) , ∆y(j) ) = S(x(i) , y(j) ) − S(x(i−1) , y(j) )
                                                             e (i−1) , y(j−1) )
                                         e (i) , y(j−1) ) + S(x
                                       − S(x
      es la masa estimada en (x(i) , y(j) ). Existen varias propuestas de estimadores
      no paramétricos de S(t1 , t2 ) cuando los datos son censurados, por ejemplo
      Dabrowska (1988), Lin    Ying (1993), Prentice    Cai (1992), Wang    Wells
      (1997) y Batún-Cutz (2005). Luego calcular λ(z) e          e
                                                           = z − K(z)            e i)
                                                                       y graﬁcar λ(z
                e
      para zi = S(xi , yi ), i = 1, . . . , n.
   2. Sean Cθl (·, ·), l = 1, . . . , m las m funciones cópulas bajo consideración. Ob-
      tener un valor θl , digamos θel , tal que τb0 = Λ(θel ) donde τb0 es un estimador
      de τ . Si τ = Λ(θ) es una función uno a uno, θel = Λ−1 (b    τ0 ). Podemos usar el
      estimador de τ propuesto por Wang y Wells,
                                   n
                                 n X
                                 X                                      
                       τb0 = 4             e x(i) , y(j) S
                                           S              e ∆x(i) , ∆y(j) − 1              (3)
                                 i=1 j=1

      Si x(n) y y(n) son no censuradas, τb0 es un estimador consistente de τ . Para
      cada θel , obtener el estimador paramétrico λθel (z).

   3. Comparar la gráﬁca de (zi , λ(ze i )) con las gráﬁcas teóricas λ e (z) para los
                                                                      θl
      modelos bajo consideración. Elegir el modelo que mejor ajuste los puntos
            e i )), por ejemplo el que tenga menor suma de cuadrados
      (zi , λ(z
                                       n h
                                       X                    i2
                                           e i ) − λ e (zi )
                                          λ(z       θl
                                       i=1



3. Inferencia
    Lo primero que hay que hacer para ajustar un modelo basado en cópulas es
elegir la función cópula que usaremos en el modelo (1); para esto se puede usar

                                            Revista Colombiana de Estadística 34 (2011) 267–285

272                                      Enrique Raúl Villa-Diharce    Pedro Enrique Monjardin

el método propuesto por Wang y Wells, descrito anteriormente. El siguiente paso
es determinar las distribuciones marginales apropiadas, una buena referencia para
el ajuste de modelos paramétricos univariadas es el libro de Meeker    Escobar
(1998).
   Para estimar los parámetros θ de la conﬁabilidad bivariada S usaremos el
método de máxima verosimilitud. Con el modelo basado en cópulas
                                                                               
                           S(t1 , t2 ; θ) = Cθ S1 (t1 ; θ(1) ), S2 (t2 ; θ (2) )

donde θ = (θ(1) , θ (2) , θ), siendo, θ(1) y θ (2) los parámetros correspondientes a las
conﬁabilidades marginales, y θ es el parámetro de la función cópula.
    Sea d = {(xi , δi1 , yi , δi2 ) : i = 1, . . . , n} el conjunto de datos. Para especiﬁcar
la función de verosimilitud es necesario distinguir entre las observaciones que son
tiempos de falla y las que son censuradas.
    Si ambas observaciones (xi , yi ) son tiempos de falla (δi1 = 1, δi2 = 1), la con-
tribución de esta pareja a la función de verosimilitud es
                                                                             
                    cθ S1 (xi ; θ (1) ), S2 (yi θ(2) ) f1 xi ; θ(1) f2 yi ; θ (2)

donde fj (z; θ(j) ) = − ∂z
                         ∂
                           Sj (z; θ(j) ), j = 1, 2, son las densidades de los tiempos de
                     ∂2
falla y cθ (u, v) = ∂u∂v Cθ (u, v).
   Observar que xi es tiempo de falla y yi es censurada (δi1 = 1, δi2 = 0), es
equivalente a observar el evento {xi < T1 ≤ xi + h, T2 > yi }, para h pequeña.
Pero

               Pr(xi < T1 ≤ xi + h, T2 > yi ) = S(xi , yi ; θ) − S(xi + h, yi ; θ)
                                                                          
                                                         ∂
                                              ≈h· −          S(xi , yi ; θ)
                                                       ∂xi

y la contribución a la verosimilitud por esta pareja es

        ∂                         ∂                                                   
                                                              (1)                 (2)
   −       S(xi , yi ; θ) =                   Cθ  S 1 (xi ; θ     ), S 2 (y i ; θ     )  f1 (xi ; θ(1) )
       ∂xi                  ∂S1 (xi ; θ (1) )

   De la misma forma, si xi es una censura y yi es tiempo de falla, la contribución
de esta pareja a la verosimilitud es

          ∂                         ∂                                                   
                                                                (1)                 (2)
      −      S(xi , yi ; θ) =                  Cθ   S 1 (xi ; θ     ), S 2 (y i ; θ     )  f2 (yi ; θ(2) )
          ∂y                  ∂S2 (yi ; θ(2) )

   Por último, si xi y yi son censuras, su contribución a la verosimilitud es
                                                                                         
           Pr(T1 > xi , T2 > yi ) = S(t1 , t2 ; θ) = Cθ S1 (xi ; θ (1) ), S2 (yi ; θ (2) )


                                                 Revista Colombiana de Estadística 34 (2011) 267–285

Análisis bivariado de confiabilidad basado en cópulas                                           273

   Por lo tanto, la función de verosimilitud es
                n n
                Y                                                                  oδ1 δ2
   L(θ; d) =       cθ S1 (xi ; θ(1) ), S2 (yi ; θ(2) ) f1 (xi ; θ(1) )f2 (yi ; θ(2) )
                i=1
                                                                            δi1 (1−δi2 )
                 ∂Cθ S1 (xi ; θ (1) ), S2 (yi ; θ(2) )                        
            ×                                                   f1 (xi ; θ(1) )
                              ∂S1 (xi ; θ(1) )                                
                                                                                                (4)
                                                                           (1−δi1 )δi2
                 ∂Cθ S1 (xi ; θ (1) ), S2 (yi ; θ(2) )                       
                                                                          (2)
            ×                                                   f2 (yi ; θ )
                              ∂S2 (xi ; θ(2) )                               
                                                (1−δi1 )(1−δi2 )
            × Cθ S1 (xi ; θ(1) ), S2 (yi ; θ(2) )

   El estimador máximo verosimil para θ es
                                    bMV = arg máx L(θ; d)
                                    θ
                                                    θ∈Θ

con Θ el espacio paramétrico. Equivalentemente
                                    bMV = arg máx ℓ(θ; d)
                                    θ                                                           (5)
                                                    θ∈Θ

donde ℓ(θ; d) = ln L(θ; d) es la función log-verosimilitud. Si la función log-
verosimilitud alcanza su máximo en un punto interior de Θ, el estimador máximo
verosimil es la solución de la ecuación
                                          ∂
                                         ∂θ ℓ(θ; d) = 0.

   Sea θ0 el vector de valores reales. Bajo ciertas condiciones de regularidad,
                                   bMV − θ0 ) ∼ N (0, I−1 (θ0 ))
                             n1/2 (θ
                                                      as.

donde I(θ0 ) es la matriz información.
    Con este método (la estimación máxima verosimilitud completa), los paráme-
tros θ se estiman simultáneamente. Sin embargo, el enfoque con cópulas sugiere
hacer la estimación en dos pasos:

   1. primero estimar θ(1) y θ (2) separadamente maximizando las verosimilitudes
                                             n
                                             Y
                      L1 (θ (1) ; d(1) ) =         f1 (xi ; θ(1) )δi1 S1 (xi ; θ(1) )(1−δi1 )
                                             i=1
                                             Yn
                      L2 (θ (2) ; d(2) ) =         f2 (yi ; θ(2) )δi2 S2 (xi ; θ(2) )(1−δi2 )
                                             i=1

      de los datos univariados. Equivalentemente, se puede maximizar ℓj (θ (j) ; d(j) ) =
      ln Lj (θ (j) ; d(j) ), j = 1, 2.

                                             Revista Colombiana de Estadística 34 (2011) 267–285

274                            Enrique Raúl Villa-Diharce    Pedro Enrique Monjardin

                                               b(2) d) dadas las estimaciones θ
                                        b(1) , θ
   2. luego, estimar θ maximizando L(θ; θ                                     b(1) y
      b(2)
      θ

   Este método es llamado inferencia por funciones marginales (IFM) por Joe   
                                  b(2) están dados por
                           b(1) y θ
Xu (1996). Los estimadores θ   IFM      IFM


                            b(1) = arg máx ℓ1 (θ(1) ; d(1) )
                            θ IFM
                                                                                     (6)
                            b(2) = arg máx ℓ2 (θ(2) ; d(2) )
                            θ IFM

y se sigue que el estimador para el parámetro de la cópula es

                                                      b(2) , d)
                                               b(1) , θ
                         θbIFM = arg máx ℓ(θ; θ                                     (7)
                                                 IFM    IFM


   Este método es computacionalmente más simple que la estimación simultánea
de todos los parámetros. Una optimización numérica con muchos parámetros es
más costosa en tiempo de computo comparada con varias optimizaciones con pocos
parámetros (Joe 1997, pp. 300).
   Quizás el parámetro de mayor interés es el parámetro θ, ya que reﬂeja la de-
pendencia que hay en los datos. La verosimilitud relativa del parámetro θ se deﬁne
como
                                        b(1) , θ
                                   L(θ; θ        b(2) , d)
                                          IFM     IFM
                         R(θ) =              (1)
                                    b      b
                                 L(θIFM ; θIFM , θ b(2) , d)
                                                    IFM

y asintóticamente r∗ (θ) = −2 ln[R(θ)] tiene una distribución ji-cuadrada con un
grado de libertad, cuando se evalúa en el valor real de θ. Al hacer una prueba de
razón de verosimilitudes, se rechaza la hipótesis nula θ = θ0 , al nivel de signiﬁcancia
α, si
                           r∗ (θ) = −2 ln[R(θ)] > χ2(1−α,1)

con χ2(1−α,1) el cuantil 1−α de la distribución ji-cuadrada con un grado de libertad.
También es posible, usando esta aproximación asintótica, construir intervalos de
conﬁanza aproximada del 100(1 − α) %.
   La principal ventaja del método IFM es la simpliﬁcación de los cálculos nu-
méricos. Sin embargo los estimadores IFM tienen otras propiedades deseables. Al
igual que los estimadores de máxima verosimilitud, los estimadores IFM también
son asintóticamente eﬁcientes, y se tiene que
                                bIFM − θ 0 ) ∼ N (0, B(θ 0 ))
                          n1/2 (θ
                                              as.

donde B(θ 0 ) es llamada inversa de la matriz de información de Godambe. Si se
deﬁne                                                          
                                       ∂           (1)    (1) T
                                        (1) ℓ 1 (θ     ; d   )
                                  ∂θ                           
                       g(θ; d) =  ∂θ∂(2) ℓ2 (θ (2) ; d(2) )T 
                                     ∂            (1)    (2)
                                    ∂θ ℓ(θ; θ         , θ , d)

                                      Revista Colombiana de Estadística 34 (2011) 267–285

Análisis bivariado de confiabilidad basado en cópulas                                  275

entonces
                         B(θ 0 ) = D −1 M (D −1 )T
           ∂                                    
donde D = E ∂θ g(θ; d)T y M = E g(θ; d)g(θ; d)T .
    Para estimar la matriz de                                −1           b
                   ∂             T
                                    covarianzas asintóticas n B(θ 0 ) de θIFM es nece-
sario calcular E ∂θ g(θ; d) , lo cual puede ser tedioso y complicado. Para evitar
esto se pueden usar métodos de remuestreo como jackknife y bootstrap, en este
trabajo decidimos usar jackknife, ya que, de acuerdo con Shao    Tu (1995), el
procedimiento bootstrap no da mejores estimadores de la varianza que el proce-
dimiento jackknife y además este último es computacionalmente más sencillo. Sea
θb(−i)IFM el estimador de θ = (θ (1) , θ(2) , θ) con la i-ésima observación di excluida
de los datos, i = 1, . . . , n. Si θb(−i)IFM y θbIFM son vectores renglones, el estimador
jackknife de n−1 B(θ 0 ) es (ver Joe 1997)
                    n 
                    X                    T                   
                       θb(−i)IFM − θbIFM     θb(−i)IFM − θbIFM
                    i=1


    El método jackknife también se puede usar para calcular los errores estándar
de funciones de los parámetros. El método delta requiere las derivadas de las
funciones respecto a los parámetros, el método jackknife evita la necesidad de
estas. Sea h(θ) la cantidad de interés (de valores reales), el estimador del error
estándar de h(θbIFM ) es
                          ( n                          )
                           Xh                        i2 1/2
                                b              b
                              h(θ(−i)IFM ) − h(θIFM )                                  (8)
                           i=1


    Ya que la unidad falla cuando ocurre por primera vez alguno de los modos de
falla, la función de conﬁabilidad de la unidad está dada por

                           S(t) = Pr(T1 > t, T2 > t)
                                = S(t, t) = Cθ (S1 (t), S2 (t))

si se usa el modelo (1). Entonces, un estimador de la función de conﬁabilidad de
la unidad es                                                    
                      b = Cb
                     S(t)                                  b(2) )
                                            b(1) ), S2 (t; θ
                                     S1 (t; θ
                                 θIFM          IFM           IFM


    Usando el método jackknife, especíﬁcamente la ecuación (8), podemos encon-
trar intervalos de conﬁanza para la función de conﬁabilidad estimada de la unidad
b
S(t).
                                                    b p ) para tp se obtiene una
    Dado p ∈ [0, 1], si resolvemos la ecuación p = S(t
estimación del tiempo en el que la unidad tiene una conﬁabilidad del 100p %. Ya
que la función de conﬁabilidad es una función monótona, un intervalo de conﬁanza
aproximado del 100(1 − α) % para tp es el conjunto {t : A(p) ≤ S(t)b    ≤ B(p)},
donde (A(p), B(p)) es un el intervalo de conﬁanza aproximado del 100(1 − α) %
      b p ).
para S(t

                                        Revista Colombiana de Estadística 34 (2011) 267–285

276                           Enrique Raúl Villa-Diharce    Pedro Enrique Monjardin

4. Aplicación a un estudio de encendedores
    Se considera un estudio de conﬁabilidad de encendedores de hornos de estufas
a gas, que tienen dos modos de falla. El motivo del estudio fue conocer la con-
ﬁabilidad en dos tiempos de referencia, un año y diez años. Estos tiempos son de
interés, debido a que las unidades donde se instalan los encendedores, tienen un
tiempo de garantía de un año y un tiempo de vida de diez años. El fabricante del
electrodoméstico donde se instalan los encendedores, planea cambiar los encende-
dores con el ﬁn de reducir el número de reclamos de los usuarios, por fallas de los
electrodomésticos debidas a la falla del encendedor. El fabricante planea introducir
un nuevo encendedor que satisfaga las conﬁabilidades objetivo a uno y diez años,
de 0.992 y 0.974, respectivamente. Un proveedor asegura que su producto cumple
con estas exigencias, así que se llevó a cabo un estudio de conﬁabilidad de los
encendedores que oferta el proveedor.
    Los datos constan de 27 parejas de tiempos a la falla (xi , yi ), donde xi corres-
ponde a una falla debida a que el encendedor no alcanza el amperaje necesario
para que se active el control electrónico del horno y yi corresponde a la falla de-
bida a que el encendedor no alcanza en el tiempo reglamentario (20 segundos) la
temperatura minima de operación. Los encendedores que se estudian, son resis-
tencias de graﬁto en las que se aplica un voltaje determinado y su temperatura
va creciendo hasta alcanzar un nivel estable determinado. Consideramos aquí dos
modos de falla. Un modo de falla se presenta cuando la corriente que circula por
el encendedor en operación es menor que el nivel mínimo de la corriente necesaria
para activar la tarjeta de control electrónico. El otro modo de falla se presenta
cuando la temperatura del encendedor a los 20 segundos de operación es menor a
la temperatura minima de operación, de 1050 ◦C.
    Con el envejecimiento de los encendedores, ocurre que al aplicar un nivel de-
terminado de voltaje, el crecimiento de su temperatura es cada vez más lento, y la
corriente que circula por él, es cada vez menor. En este conjunto de datos tenemos
varias censuras por la derecha, debido a que el proceso de medición de la corriente
o la temperatura se interrumpió. Para acelerar las fallas en este estudio, no se
llevó a cabo un estudio de vida acelerada, sino que se incremento la tasa de uso de
los componentes. Después de hacer un estudio de campo, se determinó el patrón
de operación y el número promedio de horas de uso del encendedor al año. Pos-
teriormente, en el laboratorio las unidades se mantuvieron en operación, con una
frecuencia de uso mayor a la real y los tiempos a la falla registrados se expresaron
en años de operación real. La gráﬁca de los datos se muestra en la ﬁgura 1. En
ella se observa que hay una dependencia moderada entre ambos tiempos de falla.
    Lo primero que hacemos es seleccionar la función cópula que se usará en el
modelo (1). Recurrimos al método propuesto por Wang    Wells (2000) descrito
en la sección 2 para elegir una de las funciones cópula mostradas en la tabla 1, para
lo cual es necesario tener una estimación no-paramétrica de la función de conﬁa-
bilidad bivariada S(·, ·). El estimador de Dabrowska (1988) es el más común, aun
cuando en algunas ocasiones el resultado obtenido no es una conﬁabilidad propia.
Esto es lo que ocurre para los datos de encendedores, por lo que optamos por
usar el estimador de S(·, ·) propuesto por Batún-Cutz (2005) en su tesis doctoral.

                                     Revista Colombiana de Estadística 34 (2011) 267–285

Análisis bivariado de confiabilidad basado en cópulas                                         277

Este estimador de la conﬁabilidad bivariada es una modiﬁcación del estimador de
Dabrowska (1988) que corrige este problema.




                     5



                     4



                     3
                T2




                     2



                     1



                     0

                         0.0         0.5           1.0                  1.5

                                             T1

Figura 1: Tiempos de falla observados para los encendedores. La flecha indica el tiempo
          censurado.


     Con el estimador S(t                                               e i ) para zi =
                            e 1 , t2 ) de Batún-Cutz (2005) calculamos λ(z
e i , yi ), i = 1 . . . , 27. El estimador de la τ de Kendall dado por la ecuación (3)
S(x
es τe = 0.3939, con éste obtenemos los estimadores θ’s      e de los parámetros de las
cópulas en la tabla 1 como se describe en el punto 2 del método para elegir una
función cópula. Luego construimos los estimadores λθe (z) de las funciones λ(z). La
gráﬁca de las curvas λθe (z) y de los puntos (zi , λ(ze i )) se muestran en la Figura 2
y en la tabla 2 se dan las distancias de los puntos a las curvas. Como los puntos
      e i )) están más cerca de la curva λ e (z) que corresponde a la función cópula
(zi , λ(z                                      θ
de Gumbel, elegimos esta función cópula para hacer la inferencia.

                                                         Pn      h                       i2
        Tabla 2: Suma de las diferencias al cuadrado,                e i ) − λ b (zi )
                                                                     λ(z
                                                           i=1                θ

                               Cópula      Distancia×103
                                Frank         34.5867
                                 Joe          28.0921
                               Clayton        96.7035
                               Gumbel         25.8142

    Cuando se analizan los modos de falla por separado, se encuentra que las
distribuciones más adecuadas para los tiempos de falla T1 y T2 son la Lognormal y
la Weibull, respectivamente. Luego, las funciones de conﬁabilidad marginales para

                                      Revista Colombiana de Estadística 34 (2011) 267–285

278                                    Enrique Raúl Villa-Diharce    Pedro Enrique Monjardin




                  0.00

                                                                  ~
                                                                  λ(z)
                 −0.05                                            Frank
                                                                  Joe
                                                                  Clayton
                                                                  Gumbel
                 −0.10
               λ(z)


                 −0.15



                 −0.20



                 −0.25


                         0.0     0.1      0.2     0.3       0.4   0.5       0.6   0.7

                                                        z

                                e
           Figura 2: Gráfica de λ(z) y λθe (z) para las cópulas consideradas.


los tiempos de falla serán
                                                                           
                                                      ln t1 − µ
                               S1 (t1 ; µ, σ) = 1 − Φ
                                                           σ
                                                    "   #                                    (9)
                                                             β
                                                        t2
                               S2 (t2 ; β, η) = exp −
                                                        η

donde Φ(·) es la función de distribución normal estándar. En la notación de la
sección anterior, θ (1) = (µ, σ) y θ (2) = (β, η) son los parámetros de las marginales.
    La calidad del ajuste de las distribuciones marginales puede examinarse con
una comparación gráﬁca de las conﬁabilidades ajustadas y de sus versiones empí-
ricas como se muestra en la ﬁgura 3. Debido a la censura usamos el estimador de
Kaplan-Meier para las conﬁabilidades empíricas. Note que la conﬁabilidad del pri-
mer modo de falla es menor, es decir, el primer modo de falla es el que determina
el comportamiento de la unidad.
   Entonces la función de conﬁabilidad bivariada de la unidad toma la forma
                        (                                                 )
                                             θ                  θ 1/θ
                                          (1)                  (2)
    S(t1 , t2 ; θ) = exp − − ln S1 (t1 ; θ ) + − ln S2 (t2 ; θ )


donde Sj (tj ; θ(j) ), j = 1, 2 están dadas por las ecuaciones (9).
   Los valores de los estimadores IFM de los parámetros θ = (µ, σ, β, η, θ) se dan
en la tabla 3, y la gráﬁca de contornos de la conﬁabilidad bivariada estimada se
muestra en la ﬁgura 4. De la gráﬁca vemos que hay indicios de una dependencia
entre los tiempos a la falla.

                                                Revista Colombiana de Estadística 34 (2011) 267–285

Análisis bivariado de confiabilidad basado en cópulas                                   279




                      1.0
                                                     S1(t)
                                                     ^




                      0.8
                                                     S2(t)
                                                     ^
                                                     Est. KM




                      0.6
               S(t)
               ^

                      0.4
                      0.2
                      0.0




                            0        1          2          3            4

                                                t

Figura 3: Funciones de confiabilidad univariadas estimadas de los modos de falla. La
          línea punteada corresponde a los estimadores Kaplan-Meier.



Tabla 3: Estimadores IFM, errores estándar e intervalos de confianza aproximados del
         95 % para los datos de encendedores.
                                               Error              Intervalo de
             Parámetro          Estimación    Estándar          conﬁanza 95 %
                 µ                 −0.2160     0.0566          (−0.327, −0.105)
                 σ                  0.2806     0.0334           (0.2152, 0.3461)
                 β                  1.9561     0.5591           (0.8603, 3.0519)
                 η                  1.7932     0.2126           (1.3765, 2.2100)
                 θ                  1.4732     0.2862           (0.9123, 2.0341)



   Usamos la técnica jackknife para calcular la matriz de covarianzas asintótica de
Godambe de las estimaciones IFM de los parámetros, la matriz de correlaciones
correspondiente se da en la tabla 4. También es posible calcular intervalos de
conﬁanza aproximados del 95 % para las estimaciones de los parámetros, que se
muestran en la tabla 3.
    Como ya comentamos, el método IFM facilita los cálculos numéricos para es-
timar los parámetros. Esto es cierto sobre todo si el número de parámetros es
grande. En el ejemplo aquí tratado sólo es necesario estimar cinco parámetros, y
es posible estimarlos conjuntamente sin mucho esfuerzo. Los estimadores máximo
verosímiles dados al resolver la ecuación (5) se dan en la tabla 5, observe que bá-
sicamente no hay diferencias en las estimaciones obtenidas por los dos métodos.



                                         Revista Colombiana de Estadística 34 (2011) 267–285

280                                 Enrique Raúl Villa-Diharce    Pedro Enrique Monjardin




                        4
                                                                          1.0




                        3                                                 0.8




                                                                          0.6
                  T2



                        2


                                                                          0.4


                        1
                                                                          0.2




                        0                                                 0.0
                            0.0    0.5        1.0        1.5      2.0

                                              T1


Figura 4: Gráfica de contornos de la densidad conjunta estimada de los tiempos a la
          falla de los encendedores.


      Tabla 4: Matriz de correlaciones de las estimaciones IFM de los parámetros
                          µ          σ                 β          η         θ
              µ         1.0000    −0.1682           −0.0451     0.6445   −0.2240
              σ        −0.1682     1.0000           −0.4964    −0.0648    0.6323
              β        −0.0451    −0.4964            1.0000    −0.3953   −0.7322
              η         0.6445    −0.0648           −0.3953     1.0000    0.1373
              θ        −0.2240     0.6323           −0.7322     0.1373    1.0000


Tabla 5: Estimadores máximo verosímiles, errores estándar e intervalos de
         verosimilitud-confianza aproximados del 95 % para los datos de encen-
         dedores.
                                                             Intervalo del
                       Parámetro         Estimación       95 % de conﬁanza
                           µ                −0.2078      (−0.3165, −0.0939)
                           σ                 0.2802        (0.2216, 0.3720)
                           β                 1.9613        (1.4248, 2.5539)
                           η                 1.8033        (1.4351, 2.2473)
                           θ                 1.4687        (1.0429, 2.3307)


    En la cópula de Gumbel tenemos el caso de independencia cuando θ = 1, por
lo que podemos probar la hipótesis de modos de falla independientes, probando la

                                            Revista Colombiana de Estadística 34 (2011) 267–285

Análisis bivariado de confiabilidad basado en cópulas                                281

hipótesis θ = 1. El estadístico de la prueba de la razón de verosimilitudes r∗ (θ)
toma el valor r∗ (1) = 9.6808 que es mayor que χ2(0.95,1) = 3.84, por lo que debemos
rechazar la hipótesis nula θ = 1, ya que tenemos una fuerte evidencia en contra de
la independencia de los modos de falla.
   Por la ecuación (2), la relación entre la τ de Kendall y el parámetro de la función
cópula de Gumbel es τ = 1 − θ−1 . Entonces, es posible calcular una estimación de
τ como τb = 1 − (θbIFM )−1 . Para los datos de ejemplo obtenemos τb = 0.3212, lo que
indica que existe una dependencia moderada entre los modos de falla, como ya lo
vimos en la prueba de hipótesis anterior.
    En la ﬁgura 5 se muestran las estimaciones de la función de conﬁabilidad
 b                    b(2) , θ) considerando el modelo con la cópula de Gumbel. Si
               b(1) , θ
S(t) = S(t, t; θ
se asume que los modos de falla son independientes, la función de conﬁabilidad de
                                                   (1)         (2)
los encendedores toma la forma Sb⊥ (t) = S1 (t; θIFM )S2 (t; θIFM ). Su gráﬁca tam-
                                                    b
bién se muestra en la ﬁgura 5. Note que Sb⊥ (t) ≤ S(t),  lo cual indica que al asumir
independencia se subestima la función de conﬁabilidad del encendedor.




                   1.0



                   0.8
                                                        Asumiendo:
                                                         Cópula de Gumbel
                                                         Independencia
                   0.6
            S(t)
            ^




                   0.4



                   0.2



                   0.0

                         0.0    0.5         1.0             1.5             2.0

                                             t

Figura 5: Confiabilidades estimadas de encendedores, se muestra la función de con-
          fiabilidad estimada con la cópula de Gumbel y la confiabilidad asumiendo
          independencia.


   Con el ﬁn de veriﬁcar las aﬁrmaciones del proveedor, usamos la función de
                       b para calcular estimaciones de la conﬁabilidad del en-
conﬁabilidad estimada S(t)
cendedor en los tiempos de uno y diez años. Las estimaciones de la conﬁabilidad
para estos tiempos, además de un mes y dos años, se dan en la tabla 6. Vemos
que las conﬁabilidades estimadas están muy por debajo de las conﬁabilidades ob-

                                      Revista Colombiana de Estadística 34 (2011) 267–285

282                           Enrique Raúl Villa-Diharce    Pedro Enrique Monjardin

jetivos. Al estimar el intervalo de conﬁanza de la conﬁabilidad a los 10 años con
el método jackknife, encontramos que las estimaciones de la conﬁabilidad a los
10 años prácticamente no cambian, al excluir cualquiera de las observaciones. En
consecuencia la desviación estándar calculada con este método es cero. Así, el in-
tervalo de conﬁanza aproximado del 95 % para la conﬁabilidad a 10 años consta
sólo del punto cero.


              Tabla 6: Confiabilidades estimadas para tiempos dados.
                        Conﬁabilidad     Desviación         Intervalo
               tp        Estimada        Estándar       Conﬁanza 95 %
            Un mes         0.9975         0.0027        (0.9923, 1.0000)
            Un año         0.1992         0.0580        (0.0856, 0.3129)
            Dos años       0.0004         0.0006        (0.0000, 0.0154)
            10 años        0.0000            –                  –



    Para ver los tiempos en que se consiguen las conﬁabilidades objetivo que plantea
el cliente, resolvemos la ecuación c = S(tb c ) donde c es una conﬁabilidad dada.
Así mismo, podemos dar un intervalo de conﬁanza aproximado del 95 % para el
tiempo tc como se describe al ﬁnal de la sección anterior. Los resultados para estas,
y algunas otras, se muestran en la tabla 7. En ella observamos que los tiempos a
los que se consiguen las conﬁabilidades objetivos son muy bajos. Por ejemplo, la
conﬁabilidad de 0.992 se alcanza en tc = 0.1522; esto signiﬁca que se esperan ocho
fallas, de cada 1000 unidades, a los 55 días, aproximadamente. Más grave aún es
lo que indica el último renglón en la tabla, el 20 % de las unidades fallarán antes
de 7.3 meses.


              Tabla 7: Cuantiles obtenidos para confiabilidades dadas.
                     Conﬁabilidad                  Intervalo
                        dada           tc      Conﬁanza 95 %
                        0.992        0.1522    (0.0000, 0.1818)
                        0.974        0.2794    (0.0000, 0.2931)
                        0.950        0.3887    (0.0000, 0.3576)
                        0.900        0.5014    (0.1408, 0.4012)
                        0.800        0.6005    (0.3159, 0.6811)



    El análisis de conﬁabilidad de estos encendedores, muestra que éstos no cum-
plen con los niveles requeridos por el fabricante de electrodomésticos que planea
hacer el cambio. Los resultados del estudio se enviaron al proveedor con la inten-
ción de que modiﬁcara el diseño del encendedor, para que su conﬁabilidad satisfaga
los requerimientos del cliente.

                                    Revista Colombiana de Estadística 34 (2011) 267–285

Análisis bivariado de confiabilidad basado en cópulas                                283

5. Conclusiones
    Los fabricantes siempre han estado preocupados por incrementar la conﬁabi-
lidad de sus productos. Para lo cual se ven en la necesidad de hacer estudios de
conﬁabilidad de los artículos que producen, así como de exigir estudios que avalen
la conﬁabilidad de aquellos que adquieren. En este trabajo se ha mostrado el uso
de la función cópula para modelar la conﬁabilidad de un artículo con dos modos de
falla. Este enfoque es muy útil en la industria ya que es muy ﬂexible con respecto
a la selección de las distribuciones marginales.
   Hemos utilizado funciones de cópula para modelar la estructura de dependencia
para dos distribuciones marginales provenientes de diferentes familias, lognormal
y Weibull. Lo cual no es posible con los procedimientos tradicionales que suponen
marginales de la misma familia. Además, utilizamos el procedimiento de Wang
y Wells para seleccionar la función de cópula entre un conjunto de cópulas pro-
puestas. Esta selección se basa en las discrepancias entre la cópula empírica y las
cópulas propuestas.
   Hemos estimado los parámetros con dos métodos, IFM y máxima verosimili-
tud, y hemos obtenido resultados similares. Esto nos lleva a proponer el uso del
método IFM debido a que es computacionalmente más simple que el de máxima
verosimilitud y tiene propiedades similares a este como lo han demostrado Joe   
Xu (1996).
   Comparamos gráﬁcamente las conﬁabilidades estimadas suponiendo indepen-
dencia y dependencia modelada con la cópula de Gumbel. En esta comparación
observamos que sistemáticamente es menor la conﬁabilidad en el caso de indepen-
dencia.
   Hemos ilustrado el método propuesto con un conjunto de datos reales, prove-
nientes de la industria de electrodomésticos.
    Como trabajo futuro consideramos hacer una comparación más exhaustiva en-
tre los modelos que asumen dependencia e independencia. Esta comparación es
interesante debido a que el análisis bajo el modelo de independencia es más simple
que cuando suponemos un determinado patrón de dependencia, y es conveniente
conocer cuanto se pierde al usar el modelo de independencia.



Agradecimientos
   Agradecemos al Dr. Luis A. Escobar R. (Louisiana State University) sus co-
mentarios y sugerencias, ya que fueron de gran utilidad para mejorar nuestra
presentación; así mismo, queremos expresar nuestra gratitud al Editor invitado
y a los árbitros por su lectura cuidadosa y recomendaciones que contribuyeron a
mejorar el trabajo.

Referencias
Arcila L D, Jaramillo M C, Lopera C M. Selección de un modelo cópula para el ajuste de datos bivariados dependientes.(2009). Dyna.
Batún Cutz J L.Algunos problemas en inferencia no paramétrica: estimación de distribuciones ordenadas por picudez y supervivencia bivariada con censura.(2005).Centro de Investigación en Matemáticas.
Clayton D G.A model for association in bivariate life tables and its application in epidemiological studies of familial tendency in chronic disease incidence.(1978).Biometrika.
Dabrowska D M. Kaplan-Meier estimates on the plane.(1988).The Annals of Statistics.
Escarela G, Hernández A. Modelado de parejas aleatorias usando cópulas.(2009). Revista Colombiana de Estadística.
Frank M J. On the simultaneous associativity of f (x, y) and 1 − x + y − f (x, y).(1979). Aequationes Mathematicae.
Genest C, Riverst L P. Statistical inference procedures for bivariate Archimedean copulas. (1993). Journal of the American Statistical Association.
Hougaard P. A class of multivariate failure time distributions.(1986). Biometrika.
Jaworski P, Durante F, Hädel W, Rychlik T. Copula Theory and its Applications.(2010). Springer.
Joe H. Parametric families of multivariate distributions with given margins.(1993). Journal of Multivariate Analysis.
Joe H. Multivariate Models and Dependence Concepts. (1997). Chapman Hall.
Joe H, Xu J J. The estimation method of inference functions for margins for multivariate models. (1996). University of British Columbia.
Lin D Y, Ying Z. A simple nonparametric estimator of the bivariate survival function under univariate censoring. (1993). Biometrika.
Meeker W L, Escobar L A. Statistical Methods for Reliability Data. (1998). John Wiley and Sons.
Prentice R L, Cai J. Covariance and survivor function estimation using censored multivariate failure time data. (1992). Biometrika.
Roger B N. An Introduction to Copulas.(2006).Springer.
Shao J, Tu D. The Jackknife and Bootstrap.(1995).Springer-Verlag.
Wang W, Wells M T. Nonparametric estimation of the bivariate survival function under simpliﬁed censoring conditions.(1997).Biometrika.
Wang W, Wells M T.Model selection and semiparametric inference for bivariate failure-time data.(2000).Journal of the American Statistical Association Theory and Methods.