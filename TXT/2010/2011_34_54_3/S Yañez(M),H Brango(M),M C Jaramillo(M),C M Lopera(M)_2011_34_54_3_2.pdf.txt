Comparación entre riesgos competitivos vía el estimador cópula-gráfico. Comparison between Competing Risks via the Copula-Graphic Estimator
Universidad Nacional de Colombia, Medellín, Colombia.  Universidad de Córdoba, Montería, Colombia
Resumen
En riesgos competitivos, el problema de identificabilidad asociado a la dependencia entre los modos de falla, se puede resolver utilizando el estimador cópula-gráfico que asume la forma de la cópula conocida. En este trabajo se compara, mediante simulación, este estimador para un modelo de riesgos competitivos dependientes con el estimador tradicional que asume independencia. Se muestra que ignorar la dependencia puede causar subestimación significativa de la función de confiabilidad. Se ilustra la temática con un ejemplo y se visualiza a futuro la posible utilidad del estimador cópulagráfico en confiabilidad industrial para predecir en experimentos acelerados.
Palabras clave: confiabilidad, cópula, identificabilidad, riesgos competitivos.
Abstract
The identifiability problem in competing risks associated to the dependence measure between the failure modes, can be solved by means of the copula-graphic estimator which assumes the copula function known. This paper compares, through a simulation study, the copula-graphic estimator for a dependent competing risks model with the traditional one under the assumption of independence. It is shown that a significant subestimation of the reliability function can be made when the dependence is not taken into account. An example ilustrates this point and as a future work it is seen the possibility of using copula-graphic in industrial reliability to predict in accelerated life tests.
Key words: Competing risks, Copula, Identifiability, Reliability.




                                            231

232               Sergio Yáñez, Hugo Brango, Mario C. Jaramillo   Carlos M. Lopera

1. Introducción

    Las causas o las diferentes maneras en que puede fallar un sistema o compo-
nente, reciben el nombre de modos de falla. Existen muchos sistemas, subsistemas
y componentes que tienen más de un modo de falla; en ciertas aplicaciones y para
algunos propósitos es importante distinguir entre esos diferentes modos de falla,
con el objeto de mejorar la confiabilidad (Meeker   Escobar 1998). El tiempo de
falla de un sistema con varios modos de falla puede ser modelado considerando un
sistema en serie o un modelo de riesgos competitivos (“competing risks”), donde
cada modo de falla es una componente del sistema en serie, y cada componente
tiene un tiempo de vida aleatorio; por lo tanto, el sistema fallará cuando el modo
de falla con el tiempo de vida más corto falle de manera que censura así a los otros
modos de falla.
    Muchas son las aplicaciones de riesgos competitivos en confiabilidad. Basu &
Klein (1982) obtuvieron algunos resultados en la teoría de riesgos competitivos;
Nelson (1990) presenta datos para el tiempo de falla en horas de calentadores indus-
triales, los cuales tienen dos modos de falla; Bedford   Lindqvist (2004) trataron
el problema de la identificabilidad en sistemas reparables cuando se presentan los
riesgos competitivos; Bedford (2005) muestra como modelar la confiabilidad en
presencia de riesgos competitivos; Manotas, Yáñez, Lopera   Jaramillo (2008),
estudiaron el efecto en la estimación de la confiabilidad, cuando se asume el su-
puesto de independencia entre los tiempos de falla que compiten, que realmente
son dependientes; Meeker, Escobar   Hong (2009) usaron pruebas de vida acele-
radas para predecir la distribución del tiempo de falla de un nuevo producto con
dos modos de falla.
    En el caso no-paramétrico, la distribución conjunta en un problema con múlti-
ples modos de falla no puede ser completamente identificada en la situación usual
cuando sólo se conocen los tiempos mínimos de falla (Tsiatis 1975). Inclusive en el
caso paramétrico, los datos pueden contener poca información sobre el coeficiente
de asociación entre las variables y es necesario hacer algunos supuestos al respecto
(Meeker et al. 2009). Para el caso no-paramétrico el estimador cópula-gráfico de
Zheng   Klein (1995) resuelve el problema bajo el supuesto del conocimiento de
la forma funcional de la cópula que da cuenta de la estructura de asociación en-
tre los riesgos competitivos. Es de anotar que bajo independencia el problema de
identificabilidad no existe.
    Yáñez, Manotas   Lopera (2006) y Manotas et al. (2008), estudiaron, para
el caso Weibull y lognormal, el efecto en la estimación de la sobrevivencia cuan-
do se asume el supuesto de independencia entre tiempos de falla que realmente
son dependientes. Encontraron que bajo el supuesto de independencia, que es la
metodología tradicional utilizada en muchos campos de la ciencia (Pintilie 2006),
no genera errores significativos en la estimación de la función de confiabilidad
del tiempo mínimo. Puesto que la literatura reciente reporta que el supuesto de
independencia en riesgos competitivos generalmente da una visión pesimista del
comportamiento del sistema, ellos comentan la importancia de estudiar en más
detalle la temática.

                                    Revista Colombiana de Estadística 34 (2011) 231–248

Comparación entre riesgos competitivos vía el estimador cópula-gráfico               233

    En este trabajo se estima la función de confiabilidad bajo dependencia mediante
el estimador cópula-gráfico propuesto en Zheng   Klein (1995). Se hace un estudio
de simulación para comparar este estimador que permite incorporar la dependencia
con el que considera independencia entre los modos de falla.
    En la sección 2 se presentan los conceptos básicos de riesgos competitivos y se
detalla el ejemplo que se usará como ilustración. El estimador cópula-gráfico se
discute en la sección 3, con una ilustración que determina la cópula a usar en este
artículo. En la sección 4 se presenta el esquema de simulación utilizado. El análisis
de resultados se hace en la sección 5. Finalmente, en la sección 6 se presentan las
conclusiones y posible trabajo futuro, donde se muestra que ignorar la dependencia
puede causar una subestimación representativa de la función de confiabilidad.


2. Riesgos competitivos
    En este artículo se trabaja con dos modos de falla. El tiempo de falla de un
sistema con dos modos de falla puede ser modelado como un sistema en serie o un
modelo de riesgos competitivos, como se ilustra en la figura 1. Cada unidad tiene
un tiempo potencial de falla. El tiempo de falla observado es el mínimo de esos
tiempos potenciales individuales.




                  Figura 1: Sistema con dos componentes en serie.


    Así por ejemplo, para un sistema con dos modos de falla, sean X y Y los
respectivos tiempos potenciales, entonces lo que se observa en la práctica son
parejas de la forma (T, δ), donde T = mı́n(X, Y ) y δ es una variable discreta que
toma valores de 0 cuando se presenta una censura a derecha, 1 cuando falla debido
al primer modo de falla y 2 cuando falla debido al segundo modo de falla.
   Para estudiar este modelo de riegos competitivos, es necesario presentar algunas
funciones básicas. La función de subdistribución o función de incidencia acumulada
(FIA), para el modo de falla i, i = 1, 2, está dada por:

                               Gi (t) = P (T ≤ t, δ = i)                             (1)

    La función de distribución total es la probabilidad que un evento de cualquier
tipo ocurra en, o antes del tiempo t, es decir es igual a la suma de las FIA para
los dos tipos de eventos, así:
                                      2
                                      X                          2
                                                                 X
                F (t) = P (T ≤ t) =         P (T ≤ t, δ = i) =         Gi (t)        (2)
                                      i=1                        i=1


                                      Revista Colombiana de Estadística 34 (2011) 231–248

234               Sergio Yáñez, Hugo Brango, Mario C. Jaramillo   Carlos M. Lopera

    Nótese que cuando no hay riesgos competitivos la función de distribución total
se encuentra en el intervalo [0, 1]. En contraste, en presencia de riesgos competitivos
la FIA sólo puede tomar valores hasta P (δ = i) debido a que

                                lı́m Gi (t) = P (δ = i)                                (3)
                                t→∞


   Por lo tanto, la función Gi (t) no es una función de distribución propia.
   La función de subsobrevivencia es la probabilidad que el modo de falla i no
ocurra antes del tiempo t

                               Gi (t) = P (T > t, δ = i)                               (4)

   La función de subdensidad para el modo de falla i y T continuo, se define como

                                        dGi (t)    dGi (t)
                             gi (t) =           =−                                     (5)
                                          dt         dt

2.1. El problema de identificabilidad
    La aproximación tradicional para especificar el modelo de riesgos competitivos
es vía tiempos de falla latentes. En este contexto surge el denominado problema
de identificabilidad. Para el caso bivariado tenemos dos tiempos de falla poten-
ciales X, Y asociados a dos modos de falla, de manera que si ocurre el primero,
el segundo no puede ser observado. En este sentido, se dice que los tiempos son
latentes. Se supone que la pareja (X, Y ) tiene una distribución multivariada de la
forma F (x, y) = P (X ≤ x, Y ≤ y). Así T = mı́n(X, Y ) determina el tiempo de
falla del sistema completo. De manera que una vez que el sistema haya fallado, el
otro tiempo de falla no puede ser observado. Las funciones de distribución mar-
ginales para los dos modos de falla son F1 (t) = P (X ≤ t) y F2 (t) = P (Y ≤ t),
respectivamente.
    El problema de identificabilidad (Tsiatis 1975) establece que para el caso de
modelos de tiempos de falla latentes, dada una función de distribución conjunta
con dependencia arbitraria entre las componentes, existe siempre una función de
distribución conjunta en la cual las variables son independientes, y la cual repro-
duce las subdensidades gi (t) de manera precisa. Así, uno no puede conocer a partir
solamente de los datos observados (T, δ), cuál de los dos modelos es correcto, pues-
to que ambos se ajustan muy bien a los datos. Crowder (2001) da detalles técnicos
sobre este problema que él denomina “El impase de Cox-Tsiatis”. En resumen,
podemos decir que en la práctica se pueden encontrar las subdistribuciones mar-
ginales, asociados con datos de riesgos competitivos, y ese conjunto es consistente
con un número infinito de distribuciones conjuntas de tiempos de falla potenciales.
Esto quiere decir que es imposible identificar las distribuciones marginales a partir
solamente de los datos de riesgos competitivos.
   Supongamos que se tienen datos de la forma (T, δ) y es necesario identificar
el modelo conjunto F (x, y). Algunas posibles soluciones son: i) Asuma indepen-
dencia, lo cual es frecuentemente no realista (ver subsección 2.2.1); ii) Asuma una

                                        Revista Colombiana de Estadística 34 (2011) 231–248

Comparación entre riesgos competitivos vía el estimador cópula-gráfico                      235

estructura de dependencia conocida usando una cópula específica para la distri-
bución conjunta de los modos de falla; Zheng   Klein (1995) proponen el llamado
estimador cópula-gráfico, el cual es un estimador máximo verosímil y trabaja muy
bien independiente de la cópula escogida (ver sección 3); iii) Especifique un mo-
delo paramétrico. En este último caso, a pesar del fuerte supuesto, los datos de
confiabilidad pueden contener poca información acerca de la asociación entre ries-
gos competitivos debido, a veces, a la alta censura y a la cantidad limitada de
datos. Meeker et al. (2009) muestran un caso de este tipo donde el problema de
identificabilidad prevalece.
    En este artículo se van a comparar las soluciones i) y ii). También, como trabajo
futuro se propone en la sección 6 incorporar los resultados de este artículo a la
solución iii).


2.2. Metodología tradicional: un ejemplo en ingeniería
    Se ilustra con un ejemplo de Meeker   Escobar (1998), la metodología tradi-
cional en el análisis de modelos de riesgos competitivos, que supone independencia
entre los dos modos de falla.
    Se tienen tiempos de falla de un cierto tipo de equipos, los cuales de deben
principalmente a dos modos o causas de falla, una asociada a fallas por descargas
por acumulación de daños producidos por altos picos de voltaje durante tormentas
eléctricas (se denota S), y la otra falla debida al desgaste normal de los equipos (se
denota W ). La tabla 1 presenta los tiempos y los modos de falla de 30 unidades
que fueron instaladas en un ambiente de servicio estándar. Los tiempos de falla
asociados al modo de falla S ocurren de forma temprana en la vida de los equipos.
El modo de falla W empieza a aparecer después de los 100 kilociclos de uso.

       Tabla 1: Tiempos de falla y modos de falla para los datos del ejemplo.
     Kilociclos   Modo de falla   Kilociclos   Modo de falla   Kilociclos   Modo de falla
        275           W              106            S             88             S
        13             S             300            –             247            S
        147           W              300            –             28             S
        23             S             212           W              143            S
        181           W              300            –             300            –
        30             S             300            –             23             S
        65             S             300            –             300            –
        10             S              2             S             80             S
        300            –             261            S             245           W
        173            S             293           W              266           W


    En la figura 2 se muestran los estimadores de Kaplan Meier, para cada modo de
falla, considerando el otro modo de falla como censura. Se debe aclarar que cuando
hay dependencia entre los modos de falla, los estimadores de Kaplan Meier no son
estimadores consistentes de las distribuciones marginales.
    En la figura 3 se muestra el estimador de Kaplan Meier, para el tiempo mínimo
de los dos modos de falla.
    Este ejemplo se usa más adelante en la subsección 5.4, bajo el supuesto de
dependencia entre los dos modos de falla.

                                         Revista Colombiana de Estadística 34 (2011) 231–248

236                                                               Sergio Yáñez, Hugo Brango, Mario C. Jaramillo   Carlos M. Lopera




                                             1.0




                                                                                                                                                                                                     1.0
 Proporción de unidades que no han fallado




                                                                                                                                                         Proporción de unidades que no han fallado
                                             0.9




                                                                                                                                                                                                     0.9
                                             0.8




                                                                                                                                                                                                     0.8
                                             0.7




                                                                                                                                                                                                     0.7
                                             0.6




                                                                                                                                                                                                     0.6
                                             0.5
                                             0.4




                                                                                                                                                                                                     0.5
                                                     0    50    100     150                                                 200       250    300                                                             0    50    100      150       200   250   300

                                                                      Kilociclos                                                                                                                                              Kilociclos


                                                   Figura 2: Estimación de la función de sobrevivencia de cada modo de falla.
                                                                                                                      1.0
                                                                          Proporción de unidades que no han fallado

                                                                                                                      0.8
                                                                                                                      0.6
                                                                                                                      0.4
                                                                                                                      0.2




                                                                                                                                  0     50     100      150                                                200   250   300

                                                                                                                                                     Kilociclos


Figura 3: Estimación de la función de sobrevivencia del tiempo mínimo ignorando los
          modos de falla.



2.2.1. Estimador bajo independencia

   Una estructura en serie con s componentes funciona, si y sólo si todas las com-
ponentes funcionan. Para un sistema en serie con dos componentes independientes
en serie, la función de distribución es

                                                         F (t) = P (T ≤ t) = 1 − P (T > t)
                                                               = 1 − P (X > t, Y > t)
                                                                                                                                                                                                                                                             (6)
                                                               = 1 − P (X > t)P (Y > t)
                                                               = 1 − [1 − F1 (t)][1 − F2 (t)] = F1 (t) + F2 (t) − F1 (t)F2 (t)


                                                                                                                                             Revista Colombiana de Estadística 34 (2011) 231–248

Comparación entre riesgos competitivos vía el estimador cópula-gráfico               237

donde (X, Y ) son los tiempos de vida asociados a las dos componentes y Fi , i =
1, 2 son, respectivamente, las funciones de distribución para las componentes, y
T = mı́n(X, Y ) es el tiempo de falla observado del sistema.
    La función de confiabilidad S(t) = 1 − F (t) para el caso de independencia es

                         S(t) = P (T > t) = P (X > t, Y > t)
                                                                                     (7)
                              = S1 (t)S2 (t)

donde Si (t), i = 1, 2 son las funciones de confiabilidad para las dos componentes.
   Para un sistema con dos componentes en serie y tiempos de falla dependientes,

                          F (t) = P (T ≤ t) = 1 − P (T > t)
                                                                                     (8)
                                = 1 − P (X > t, Y > t)

   En este caso, la evaluación debe hacerse con respecto a la distribución conjunta
de X y Y , que incluye los parámetros de dependencia.
   La función de confiabilidad para este caso es

                         S(t) = P (T > t) = P (X > t, Y > t)                         (9)

   Para dos modos de falla en riesgos competitivos, se sabe que (Barlow   Proschan
1975)

                   S(t) = P (X > t, Y > t) ≥ P (X > t)P (Y > t)
                                                                                    (10)
                        = S ∗ (t) = S1 (t)S2 (t)

donde S ∗ (t) es la función de confiabilidad asumiendo independencia. Por lo tan-
to S ∗ (t) es pesimista en relación con S(t), esto es para un mismo tiempo t, la
probabilidad de sobrevivencia bajo el supuesto de independencia está siempre por
debajo de la probabilidad conjunta que incluye la dependencia.
     El estimador de S ∗ (t) se denotará Sb∗ (t), que es un estimador de la confiabilidad
del tiempo mínimo de falla de un sistema con dos modos de falla que compiten.
Éste se obtiene como el producto de las funciones de confiabilidad estimadas bajo
una distribución específica, donde para cada función marginal se estiman los pará-
metros, considerando los tiempos del otro modo de falla como tiempos de censura,
así:
                                   Sb∗ (t) = Sb1 (t)Sb2 (t)                          (11)
donde Sb1 (t) y Sb2 (t) se suponen son las funciones de confiabilidad marginales esti-
madas para cada modo de falla.


3. Estimador cópula-gráfico
    Zheng   Klein (1995) proponen un estimador no paramétrico para las distribu-
ciones marginales, al cual denominan estimador cópula-gráfico, como una solución
al problema de identificabilidad, descrito en la subsección 2.1. Para ello utilizan

                                      Revista Colombiana de Estadística 34 (2011) 231–248

238               Sergio Yáñez, Hugo Brango, Mario C. Jaramillo   Carlos M. Lopera

cópulas como una función no paramétrica que captura la dependencia entre dos
variables aleatorias. Bajo el supuesto que la cópula entre X y Y con su paráme-
tro de asociación conocido y con los datos de riesgos competitivos disponibles, se
resuelve el problema de identificabilidad.
   Siguiendo a Zheng   Klein (1995), suponga que se tiene, en el contexto de ries-
gos competitivos, una muestra de tamaño n de tiempos de vida Tj = mı́n(Xj , Yj ).
Si F1 (t) y F2 (t) son las distribuciones marginales de X y Y , respectivamente,
entonces, para cualquier cópula, tenemos

                                 µc (At ) = P (X > t, Y > t)                               (12)

donde                            Z
                                             
                    µc (At ) =            1Et F1−1 (x), F2−1 (y) dC(x, y)
                                     I2

con Et = {(x, y) : x > t, y > t} y At = {(x, y) : F1 (t) < x ≤ 1, F2 (t) < y ≤ 1}

                             µc (Bt ) = P (X ≤ t, X < Y )                                  (13)
donde                            Z
                                             
                    µc (Bt ) =            1Dt F1−1 (x), F2−1 (y) dC(x, y)
                                  I2
                                           
con Dt = {(x, y) : x < y, 0 < x < t} y Bt = (x, y) : 0 < x ≤ F1 (t), F2 F1−1 (x) <
y≤1 .
    Estas dos relaciones determinan de manera única a F1 (t) y F2 (t). Por tanto,
se pueden encontrar estimadores Fb1 (t) y Fb2 (t) para F1 (t) y F2 (t) respectivamente,
que preservan estas relaciones sobre una rejilla seleccionada de m puntos 0 < t1 <
t2 < · · · < tm < máx {Tj , j = 1, . . . , n}.
    Para construir el estimador cópula-gráfico, sean
                         n                                         o
                   Abt = (x, y) : Fb1 (t) < x ≤ 1, Fb2 (t) < y ≤ 1
                       n                                             o
                 bt = (x, y) : 0 < x ≤ Fb1 (t), Fb2 Fb−1 (x) < y ≤ 1
                 B                                    1

y
                                                   1X
                       est. P(X > t, Y > t) =            1(Tj > t)
                                                   n
                                                 1X
                        est. P(X ≤ t, X < Y ) =       1(Tj ≤ t, δ = 1)
                                                 n
las estimaciones empíricas de P (X > t, Y > t) y P (X ≤ t, X < Y ) respectivamen-
te.
    Fb1 (ti ) y Fb2 (ti ) son la soluciones simultáneas de (14) y (15), siendo Fb1 y Fb2
líneas rectas en cada intervalo (ti , ti+1 ).

                            bti ) − est. P(X > ti , Y > ti ) = 0
                        µc (A                                                              (14)

                            bti ) − est. P(X ≤ ti , X < Y ) = 0
                        µc (B                                                              (15)

                                             Revista Colombiana de Estadística 34 (2011) 231–248

Comparación entre riesgos competitivos vía el estimador cópula-gráfico              239

    El estimador cópula-gráfico es de máxima verosimilitud y además bajo con-
diciones de independencia, coincide con el estimador de Kaplan Meier (Zheng &
Klein 1995).
    El algoritmo cópula-gráfico para la construcción de Fb1 y Fb2 , basado en un
algoritmo de bisección para encontrar raíces, se puede ver en detalle en Zheng &
Klein (1995).


3.1. Ilustración
   Se estimará S(t) asumiendo la cópula Gama, la cual se muestra a continuación

C(F1 (x), F2 (y))   = F1 (x) + F2 (y) − 1
                      (             α−1             α−1    )− α−1
                                                                   1

                              1                 1
                    +                     +                 −1        , α>1
                          1 − F1 (x)        1 − F2 (y)

donde F1 (t) y F2 (t) son las funciones de distribución marginales para los tiempos
de falla X y Y , respectivamente, α es el parámetro de dependencia de la cópula
que mide el grado de asociación entre los tiempos de falla X y Y . Este parámetro
se relaciona con el coeficiente de correlación τ de Kendall de la siguiente forma:
      1
τ = α−1  . Para estimar F1 (t) y F2 (t), se aplica el algoritmo cópula-gráfico.
    A partir de la ecuación de la cópula, se puede encontrar la función de confia-
bilidad,
                     (            α−1               α−1    )− α−1
                                                                   1

                            1                   1
             S(t) =                    +                    −1               (16)
                        1 − F1 (t)          1 − F2 (t)

    Remplazando los estimadores Fb1 (t) y Fb2 (t) obtenidos del algoritmo cópula-
                   b cópula . Este último estimador es el que se utilizará en el
gráfico se obtiene S(t)
estudio comparativo de la siguiente sección, puesto que la cópula Gama permite
variables con rango (0, ∞) como es el caso de la Weibull que es de amplio uso
en confiabilidad. Además, Zheng   Klein (1995) muestran que este estimador es
razonablemente robusto a la escogencia de la cópula.
   La programación del algoritmo cópula-gráfico se realizó usando el paquete es-
tadístico R (R Development Core Team 2010). El código utilizado se suministra
bajo pedido a los autores.


                                      b cópula
                             b∗ (t) y S(t)
4. Estudio comparativo entre S
    Yáñez et al. (2006) y Manotas et al. (2008) estudiaron, para el caso Weibull y
lognormal, el efecto en la estimación de la confiabilidad S(t), cuando se asume el
supuesto de independencia entre los tiempos de falla que compiten, que realmente
son dependientes. Ellos encontraron que el estimador Sb∗ (t) bajo el supuesto de
independencia, que es la metodología tradicional, no genera errores significativos
en la estimación de la función de confiabilidad del tiempo mínimo. Puesto que la

                                     Revista Colombiana de Estadística 34 (2011) 231–248

240               Sergio Yáñez, Hugo Brango, Mario C. Jaramillo   Carlos M. Lopera

literatura reciente reporta que el supuesto de independencia en riesgos competi-
tivos generalmente da una visión pesimista del comportamiento del sistema, ellos
comentan la importancia de estudiar en más detalle las propiedades del estimador
Sb∗ (t).
    En este trabajo se estima S(t) bajo dependencia mediante el estimador cópula-
                        b cópula propuesto en Zheng   Klein (1995). Se hace un
gráfico, denotado por S(t)
estudio de simulación para comparar este estimador con el estimador de la confia-
bilidad Sb∗ (t).


4.1. Esquema de simulación
    Puesto que el estimador cópula-gráfico estima las funciones de distribución
marginales, haremos el estudio comparativo entre las funciones de distribución, lo
cual es equivalente a trabajar con las funciones de sobrevivencia.
    En el estudio de simulación se utiliza la distribución Weibull bivariada para
dos variables X y Y , la cual se puede visualizar en varios contextos, tales como los
tiempos hasta la primera y segunda falla de un equipo reparable, los tiempos de
falla “breakdown” de generadores duales en una planta de energía, o los tiempos
de sobrevivencia en un sistema de dos órganos tal como los pulmones o riñones,
en el cuerpo humano (Lu   Bhattacharyya 1990).
   Para simular los tiempos de falla Weibull bivariados se usó un algoritmo cópula
(Frees   Valdez 1998, Jaramillo, Lopera, Manotas   Yañez 2008). La función de
confiabilidad conjunta de la Weibull bivariada utilizada es (Lu   Bhattacharyya
1990)                                                    1−λ 
                              
                                     1−λβ1      1−λβ2      
                                                                
                                      x             y
                S(x, y) = exp −               +                             (17)
                              
                                     θ1           θ2           
                                                                

donde x > 0 y y > 0 son los tiempos de falla Weibull con funciones de distribución
F1 (x) y F2 (y), β1 > 0 y β2 > 0 son los parámetros de forma, θ1 > 0 y θ2 > 0
son los parámetros de escala asociados a X y Y respectivamente, y 0 ≤ λ < 1 es
el parámetro de dependencia entre X y Y . Cuando el parámetro de dependencia
λ es 0, entonces hay independencia entre X y Y . A medida que λ aumenta, la
dependencia entre X y Y aumenta.
    Se consideran 24 escenarios con tiempos de falla Weibull, cada uno de los cuales
corresponde a la llamada función de confiabilidad del tiempo mínimo de falla del
sistema S(t), donde T = mı́n(X, Y ). Los parámetros de escala de la distribución
Weibull bivariada se fijan en θ1 = θ2 = 1 ya que el parámetro de dependencia λ no
depende de los parámetros de escala (Lu   Bhattacharyya 1990). Los escenarios
presentan situaciones donde compiten distribuciones Weibull con tasas de falla
decrecientes y crecientes. Cuando el parámetro β < 1, la tasa de falla es decreciente,
y cuando β > 1, la tasa de falla es creciente. Los escenarios toman como base las
distintas combinaciones posibles de dicha tasa.




                                     Revista Colombiana de Estadística 34 (2011) 231–248

Comparación entre riesgos competitivos vía el estimador cópula-gráfico              241

   Los casos de tiempos Weibull a estudiar son:

   1. Tiempos de falla con parámetros de forma βi diferentes. Modo de falla con
      tasa de falla decreciente versus Modo de falla con tasa de falla creciente:
      β1 = 0.5 y β2 = 2.

   2. Tiempos de falla con parámetros de forma βi diferentes. Modo de falla con
      tasa de falla decreciente versus Modo de falla con tasa de falla constante:
      β1 = 0.5 y β2 = 1.

   3. Tiempos de falla con parámetros de forma βi iguales. Modo de falla con
      tasa de falla decreciente versus Modo de falla con tasa de falla decreciente:
      β1 = 0.5 y β2 = 0.5.

   4. Tiempos de falla con parámetros de forma βi diferentes. Modo de falla con
      tasa de falla creciente versus Modo de falla con tasa de falla constante: β1 = 2
      y β2 = 1.

    En cada uno de estos casos se toman valores del parámetro de dependencia: λ =
0.0, 0.2, 0.4, 0.6, 0.8, 0.9. De manera que en total se tienen 24 escenarios distintos
para la distribución Weibull bivariada.
   Para efectos de comparación se obtienen los intervalos de confianza empíri-
cos basados en simulación montecarlo para S(t), usando los estimadores Sb∗ (t) y
b cópula . El procedimiento se resume como sigue:
S(t)

   • Para cada uno de los escenarios descritos, se generaron 1000 muestras de
     tamaño n = 50, de tiempos bivariados Weibull. Se elige este tamaño mues-
     tral, ya que en general en experimentos de confiabilidad se manejan bases
     de datos no muy grandes, estos estudios son costosos y los datos de falla son
     difíciles de obtener.

   • Luego, en cada escenario se obtienen 1000 estimaciones de S(tp ) usando
                                    b p )cópula en cada percentil tp con p = 0.05,
     ambos estimadores Sb∗ (tp ) y S(t
     0.25, 0.50, 0.75, 0.95. De esta forma se obtiene la distribución empírica de
     las estimaciones de S(tp ) en cada uno de los percentiles considerados.

   • Finalmente, de estas distribuciones se obtienen los límites puntuales de con-
     fianza empíricos aproximados del 95 %.


5. Análisis de resultados
    En aplicaciones de confiabilidad generalmente se tienen pocas fallas y muchos
datos censurados. Bajo estas características, las pruebas formales de bondad de
ajuste no son útiles (Meeker et al. 2009). En lugar de ello se realizaron pruebas
de hipótesis empíricas en cada percentil, utilizando como región de aceptación los
intervalos de confianza empíricos, descritos en la sección anterior.

                                     Revista Colombiana de Estadística 34 (2011) 231–248

242                                                                 Sergio Yáñez, Hugo Brango, Mario C. Jaramillo   Carlos M. Lopera

5.1. Intervalos de confianza para S(t)
   Note que en la generación de la Weibull bivariada, el parámetro λ es una medida
de dependencia entre los tiempos de falla.
   La figura 4 muestra los límites de confianza aproximados para los casos Wei-
bull en que los parámetros de forma son β1 = 0.5; β2 = 2.0, y parámetros de
dependencia λ = 0.6 y 0.9.

                                                                        λ= 0.6                                                                                                             λ= 0.9
                                            1.0




                                                                                                                                                               1.0
                                                                                            S(t)                                                                                                               S(t)
Proporción de unidades que no han fallado




                                                                                                                   Proporción de unidades que no han fallado
                                                                                            LI.S(t)Copula                                                                                                      LI.S(t)Copula
                                                                                            LS.S(t)Copula                                                                                                      LS.S(t)Copula
                                            0.8




                                                                                                                                                               0.8
                                                                                            LI.Sx(t)                                                                                                           LI.Sx(t)
                                                                                            LS.Sx(t)                                                                                                           LS.Sx(t)
                                            0.6




                                                                                                                                                               0.6
                                            0.4




                                                                                                                                                               0.4
                                            0.2




                                                                                                                                                               0.2
                                            0.0




                                                                                                                                                               0.0



                                                  0.0   0.5       1.0       1.5        2.0         2.5                                                               0.0   0.5      1.0      1.5      2.0         2.5          3.0

                                                              Percentil del tiempo mínimo                                                                                        Percentil del tiempo mínimo


Figura 4: Intervalos de confianza empíricos aproximados del 95 % para S(tp ) en el caso
          Weibull β1 = 0.5 y β2 = 2 en los percentiles tp con p = 0.05, 0.25, 0.50, 0.75 y
          0.95 para λ = 0.6 y 0.9.


     En estas figuras, en cada percentil tp se tiene el valor verdadero de S(tp ), los
límites inferior y superior de confianza aproximados para S(tp ) calculados con
S ∗ (tp ) (denotados como LI.S ∗ (tp ) y LS.S ∗ (tp ), respectivamente), y calculados con
S(t)cópula (denotados LI.S(t)cópula y LS.S(t)cópula , respectivamente). Note que las
escalas en el eje de las abscisas son distintas.
     Observe que los intervalos para S(t) basados en Sb∗ (tp ) son más amplios que
aquellos basados en S(t                                            b cópula tiene mayor
                       b p )cópula , indicando que el estimador S(t)
precisión a la hora de estimar S(t). La amplitud de estos intervalos se hace más
evidente a medida que aumenta la dependencia λ. Al ser tan amplios los límites
de confianza, la estimación de S(t) con Sb∗ (t) puede tomar diferentes comporta-
mientos, sobreestimando o subestimado la confiabilidad verdadera.


5.2. Estimación marginal
    Se compara la función de distribución marginal para el tiempo X, S1 (t), con
las funciones de distribución marginales estimadas, Sb1 (t)cópula y Sb1 (t).
    La figura 5 muestra los intervalos de confianza puntuales empíricos de la dis-
tribución marginal S1 (t), basados en el método de simulación montecarlo, para
tiempos de falla bivariados Weibull con parámetros de forma β1 = 0.5; β2 = 2 y

                                                                                                            Revista Colombiana de Estadística 34 (2011) 231–248

Comparación entre riesgos competitivos vía el estimador cópula-gráfico                                                                                                                                                  243

dependencia λ = 0.6 estimados mediante el algoritmo cópula-gráfico (a la izquier-
da) y mediante la distribución “marginal” estimada S1 (t), que asume independencia
entre los tiempos de falla X y Y (a la derecha).

                                                                     λ= 0.6                                                                                                          λ= 0.6
                                            1.0




                                                                                                                                                            1.0
                                                                                        S(t)                                                                                                                S(t)
Proporción de unidades que no han fallado




                                                                                                                Proporción de unidades que no han fallado
                                                                                        LS.S(t)Copula                                                                                                       LS.Sx(t)
                                                                                        LI.S(t)Copula                                                                                                       LI.Sx(t)
                                            0.8




                                                                                                                                                            0.8
                                            0.6




                                                                                                                                                            0.6
                                            0.4




                                                                                                                                                            0.4
                                            0.2




                                                                                                                                                            0.2
                                            0.0




                                                                                                                                                            0.0
                                                  0   2          4            6         8          10                                                             0   2          4            6         8          10

                                                          Percentil del tiempo mínimo                                                                                     Percentil del tiempo mínimo


Figura 5: Intervalos de confianza empíricos aproximados del 95 % para la distribución
          marginal S1 (t) en el caso Weibull β1 = 0.5; β2 = 2.0 y λ = 0.6 en los
          percentiles tp con p = 0.05, 0.25, 0.50, 0.75 y 0.95.


    Se observa como el estimador que emplea el algoritmo cópula-gráfico estima la
marginal ya que S1 (tp ) cae dentro de los límites del intervalo empírico, mientras
que el otro estimador realmente no estima marginales puesto que los límites del
intervalo construido no contiene la distribución marginal S1 (t) como era de espe-
rarse, ya que el algoritmo cópula-gráfico resuelve el problema de identificabilidad
al asumir una cópula y la dependencia.


5.3. Predicción
    En problemas de ingeniería donde se estudia la confiabilidad de algún sistema,
es de interés evaluar el efecto sobre la sobrevivencia debido a un cambio en una
marginal. En esta sección se realizan cambios en uno de los parámetros de forma de
la distribución Weibull y el mismo cambio se le hace al estimador de ese parámetro
en Sb∗ (t), y se estima el cambio porcentual con relación a la confiabilidad verdadera
en los percentiles p = 0.05, 0.25, 0.50, 0.75, 0.95.
    Meeker et al. (2009) señalan: “Los ingenieros de diseño tienen herramientas
que les permiten obtener predicciones razonables acerca de los efectos de un sim-
ple cambio geométrico o cambios de tamaño que una pieza de un producto me-
cánico tendrá sobre la confiabilidad”, y esto se puede traducir en cambios en los
parámetros de las marginales.
    Se realizó un estudio de simulación para mostrar el efecto de un cambio en
el parámetro β2 de la distribución Weibull para predecir la nueva confiabilidad
de acuerdo a dicho cambio. El esquema de simulación se diseñó como una répli-

                                                                                                        Revista Colombiana de Estadística 34 (2011) 231–248

244                  Sergio Yáñez, Hugo Brango, Mario C. Jaramillo   Carlos M. Lopera

ca de lo realizado por Meeker et al. (2009). La función de confiabilidad conjunta
de la Weibull S(t) depende de los parámetros (β1 , β2 , λ) (con θ1 = θ2 = 1, de
acuerdo a lo fijado en la subsección 4.1) y se realiza un cambio en β2 multiplicán-
dolo por 0.3, obteniendo una función de confiabilidad nueva que denotamos por
S(t)nuevo = S(t; β1 , 0.3β2 , λ). Ahora bien, el estimador bajo independencia nuevo
(i.e. con el cambio en 0.3β2 ) se obtiene de Sb∗ (t)nuevo = Sb1 (t)Sb2 (t)nuevo (t; θb2 , 0.3βb2 ),
donde Sb2 (t)nuevo se obtiene al reemplazar el estimador βb2 por 0.3βb2 , donde βb2 es
obtenido de los datos de la distribución marginal 2 y el estimador θb2 se deja igual;
como se describió en la subsección 2.2.1. Para comparar se obtuvieron los cambios
porcentuales (CPp ) en los percentiles tp , así

                                        |S(tp ) − Sb∗ (tp )|
                               CPp =                         × 100                            (18)
                                              S(tp )

que corresponde al cambio relativo entre el valor verdadero S(t) y el valor estimado
Sb∗ (t) antes de hacer cambios en el parámetro β2 , lo que se interpreta como el
sesgo relativo del estimador Sb∗ (t). El cambio porcentual nuevo CPp (nuevo) en los
percentiles tp se obtiene, así

                                       |S(tp )nuevo − Sb∗ (tp )nuevo |
                    CPp (nuevo) =                                      × 100.                 (19)
                                                S(tp )nuevo

    En la tabla 2 se muestran los cambios porcentuales CPp y CPp (nuevo).

Tabla 2: Cambios porcentuales CPp y CPp (nuevo) para S(t) y S(t)nuevo en tiempos de
         falla Weibull con parámetros β1 = 0.5; β2 = 2 y θ1 = θ2 = 1.
                     p = 0.05                   p = 0.25                    p = 0.5
        λ     CPp (nuevo)      CPp       CPp (nuevo)      CPp        CPp (nuevo)      CPp
       0.0      1.14279       1.2891      1.12186        1.1097        1.0822        1.0714
       0.2      71.8997      49.3511      16.3558       15.2779        7.4906        3.7173
       0.4     147.1947      79.6577      34.1554       31.4991       15.9938        5.8585
       0.6     226.0480      97.6448      51.7345       49.1091       20.1146        7.5282
       0.8     348.2726      99.9365      78.7846       74.7928       22.5856       11.5464
       0.9     379.5557      99.9736      83.7510       81.8147       31.7949       12.1519
       0.98    389.0409      99.9731      93.4373       82.6682       35.2286       15.7612

                     p = 0.75                   p = 0.95
        λ     CPp (nuevo)      CPp       CPp (nuevo)      CPp
       0.0      0.4668        0.3255       1.0234        0.9419
       0.2      0.9193        0.8953       2.3615        2.1102
       0.4      1.3844        1.2676       5.3259        2.8302
       0.6      1.8549        1.5949       3.6267        3.5698
       0.8      1.9075        1.8547       6.5551        3.7108
       0.9      3.0218        2.9878       8.3761        4.0974
       0.98     3.8366        3.7381      11.8975        6.0977


   Analizando por columna para cada percentil, se observa que a medida que
aumenta la dependencia λ entre los tiempos de falla Weibull, el cambio porcentual

                                          Revista Colombiana de Estadística 34 (2011) 231–248

Comparación entre riesgos competitivos vía el estimador cópula-gráfico                                                                                                                            245

CPp es siempre menor que el cambio porcentual CPp (nuevo). En el percentil t0.05
la diferencia entre los dos llega a ser hasta de casi cuatro veces. De lo cual se
puede decir que en la práctica el estimador Sb∗ (t)nuevo , que es el estimador de
la confiabilidad bajo independencia, no logra captar correctamente el cambio en
el parámetro β2 , luego para efectos de predicción en este contexto es muy mal
estimador. En esta situación lo que ocurre es que Sb2 (t)nuevo se calcula cambiando
βb2 obtenido de los datos simulados para la marginal del modo de falla 2, por 0.3βb2 ,
pues al no tener datos nuevos, se tienen una estimación inapropiada de S2 (t)nuevo .
Por ello afirmamos que Sb∗ (t)nuevo no es útil para predecir cuando hay cambios en
los parámetros.
                                         b cópula no sirve para fines de predicción,
    Obsérvese además, que el estimador S(t)
ya que este estimador es no paramétrico y al hacer cambios en los parámetros de
la marginales no hay forma de incluir dicho cambio en el estimador. Pero se puede
pensar que con las estimaciones de las distribuciones marginales obtenidas con
el estimador cópula-gráfico se puede hacer un modelamiento paramétrico, como
paso previo al proceso de predicción de la confiabilidad bajo cambios en los pará-
metros, lo cual mejoraría el análisis exploratorio, ya que se utilizan estimaciones
adecuadas de las distribuciones marginales en lugar de las estimaciones basadas en
asumir independencia. Estos ajustes paramétricos permitirían hacer predicciones
en experimentos acelerados como los descritos en Meeker et al. (2009).


5.4. Ejemplo utilizando los datos de la subsección 2.2.
    En la figura 6, las distribuciones marginales bajo dependencia son diferentes a
las obtenidas bajo independencia.

                                                              Modo S                                                                                                     Modo W
                                             1.0




                                                                                                                                             1.0




                                                                               Independencia
 Proporción de unidades que no han fallado




                                                                                                 Proporción de unidades que no han fallado




                                                                               τ= 0.6
                                                                               τ= 0.9
                                             0.8




                                                                                                                                             0.8
                                             0.6




                                                                                                                                             0.6




                                                                                                                                                         Independencia
                                                                                                                                                         τ= 0.6
                                             0.4




                                                                                                                                             0.4




                                                                                                                                                         τ= 0.9
                                             0.2




                                                                                                                                             0.2




                                                   0   50   100          150   200       250                                                       150           200                  250   300

                                                                  Kilociclos                                                                                             Kilociclos


Figura 6: Estimación de las funciones de distribución marginales con independencia y
          con τ = 0.6 y 0.9.


    De ahí, como se muestra en la figura 7 las funciones de distribución acumuladas
del sistema (tiempo mínimo) con independencia generan una sobrestimación de las

                                                                                           Revista Colombiana de Estadística 34 (2011) 231–248

246               Sergio Yáñez, Hugo Brango, Mario C. Jaramillo   Carlos M. Lopera

funciones de distribución, lo cual tiene graves implicaciones en la determinación,
por ejemplo, del esquema de mantenimiento preventivo de los equipos, con las
consecuencias económicas que tales equivocaciones generarían.




                                                                 1.0
                                                                                                      Independencia




                     Proporción de unidades que no han fallado
                                                                                                      τ= 0.6
                                                                                                      τ= 0.9




                                                                 0.8
                                                                 0.6
                                                                 0.4
                                                                 0.2




                                                                       0   50    100      150       200    250        300

                                                                                       Kilociclos


Figura 7: Estimación de la función de distribución del tiempo mínimo considerando
          independencia y con τ = 0.6 y 0.9.




6. Conclusiones y trabajo futuro
                 b cópula , es mucho mejor estimador que Sb∗ (t). Por ello recomen-
   El estimador S(t)
damos para trabajos de confiabilidad en ingeniería, utilizar el estimador cópula-
gráfico, cuando no se tenga certeza sobre el supuesto de independencia, ya que tal
supuesto puede generar sobrecostos y mala planeación en diseño, por ejemplo, en
mantenimiento de equipos.
    Para efectos de predicción en problemas de ingeniería, que implican cambios en
los parámetros de las marginales para mejorar la confiabilidad conjunta, ninguno
de los dos estimadores funciona. Este sería un tópico de importancia para trabajo
futuro tratando de adecuar el estimador cópula-gráfico para tales efectos, y compa-
rar con resultados como los reportados por Meeker et al. (2009). Se piensa que con
las distribuciones marginales estimadas se pueden hacer ajustes paramétricos que
permitan incluir la dependencia en la estimación de la predicción de la vida útil de
un equipo sujeto a cambios en su diseño original, en el contexto de experimentos
acelerados.
    También, de acuerdo a lo sugerido por uno de los árbitros, se planteará un
estudio de simulación haciendo uso de la distribución lognormal bivariada generada
por cópulas, siguiendo los lineamientos de Johnson (1987) y Nelsen (2006).




                                                                                Revista Colombiana de Estadística 34 (2011) 231–248

Comparación entre riesgos competitivos vía el estimador cópula-gráfico              247

Agradecimientos
    Los autores agradecen a la Dirección de Investigaciones de la Universidad Na-
cional de Colombia, sede Medellín (DIME) por la financiación. Además, agradecen
a los árbitros y al editor por sus valiosos comentarios que enriquecieron el texto
del manuscrito.
    Este trabajo es parte del proyecto “Riesgos competitivos en la modelación de la
confiabilidad de un sistema con dos modos de falla”, código Quipu: 20101007773.
                                                                   
               Recibido: agosto de 2010 — Aceptado: febrero de 2011


Referencias
Barlow R, Proschan F. Statistical Theory of Reliability and Life Testing Holt.(1975). Rinehart and Winston.
Basu A, Klein P. Some recent results in competing risks theory.(1982). Proceedings on Survival Analysis IMS monograph.
Bedford T. Competing risk modelling in reliability in Modern Statistical and Mathematical Methods in Reliability.(2005). World Scientific Books.
Bedford T, Lindqvist B. The identifiability problem for repairable systems subject to competing risks.(2004). Advances in Applied Probability.
Crowder M. Classical Competing Risks.(2001). Chapman Hall.
Frees E, Valdez E. Understanding relationships using copulas.(1998). North American Actuarial Journal.
Jaramillo M C, Lopera C M, Manotas E C, Yañez S. Generación de Tiempos de Falla Dependientes Weibull Bivariados Usando Cópulas.(2008). Revista Colombiana de Estadística.
Johnson M. Multivariate Statistical Simulation.(1987). John Wiley and Sons.
Lu J, Bhattacharyya G. Some new constructions of bivariate weibull models.(1990). Annals of the Institute of Statistical Mathematics.
Manotas E C, Yáñez S, Lopera C M, Jaramillo M C. Estudio del Efecto de la Dependencia en la Estimación de la Confiabilidad de un Sistema con Dos Modos de Falla Concurrentes.(2008). DYNA.
Meeker W, Escobar L. Statistical Methods for Reliability Data. (1998). John Wiley and Sons.
Meeker W, Escobar L A, Hong Y. Using accelerated life tests results to predict product field reliability.(2009). Technometrics.
Nelsen R B. An Introduction to Copulas.(2006). Springer.
Nelson W. Accelerated Testing: Statistical Models Test Plans and Data Analyses. (1990). John Wiley and Sons.
Pintilie M. Competing Risks: A Practical Perspective.(2006). John Wiley and Sons.
R Development Core Team.  R: A Language and Environment for Statistical Computing.(2010). R Foundation for Statistical Computing.
Tsiatis A. A nonidentifiability aspect of the problem of competing risks.(1975). Proceedings of the National Academy of Sciences.
Yáñez S, Manotas E C, Lopera C M. Estudio de la Dependencia en la Estimación de la Confiabilidad de un Sistema con Dos Modos de Falla. (2006).Simposio de Estadística.
Zheng M, Klein J P. Estimates of marginal survival for dependent competing risks based on an assumed copula. (1995). Biometrika.