A modified Cucconi Test for Location and Scale Change Alternatives. Un prueba de Cucconi modificada para alternativas de cambio en localización y escala
Università della Calabria, Italia
Abstract
The most common approach to develop a test for jointly detecting location and scale changes is to combine a test for location and a test for scale. For the same problem, the test of Cucconi should be considered because it is an alternative to the other tests as it is based on the squares of ranks and contrary-ranks. It has been previously shown that the Cucconi test is robust in level and is more powerful than the Lepage test, which is the most commonly used test for the location-scale problem. A modification of the Cucconi test is proposed. The idea is to modify this test consistently with the familiar approach which develops a location-scale test by combining a test for location and a test for scale. More precisely, we will combine the Cucconi test with the Wilcoxon rank test for location and a modified Levene test following the theory of the nonparametric combination. A power comparison of this modified Cucconi test with the original one, the Lepage test and the Podgor-Gastwirth P G2 test, shows that the modified Cucconi test is robust in size and markedly more powerful than the other tests for every considered type of distributions, from short- to normal- and long-tailed ones. A real data example is discussed.
Key words: Combining tests, Location-scale model, Rank tests.
Resumen
La alternativa más común para implementar una prueba que detecta cambios en localización y escala conjuntamente es combinar una prueba de localización con una de escala. Para este problema, la prueba de Cucconi es considerada como una alternativa de otras pruebas que se basan en los cuadrados de los rangos y los contrarangos. Esta prueba es robusta en nivel y es más poderosa que la prueba de Lepage la cual es la más usada para el problema de localización-escala. En este artículo se propone una modificación de la prueba de Cucconi. La idea es modificar la prueba mediante la combinación de una prueba de localización y uno de escala. Mas precisamente, se sugiere combinar la prueba de Cucconi con la prueba de rangos de Wilcoxon para localizacion y una prueba modificada de Levene siguiendo la teoría de la combinación no paramétrica. Una comparación de la potencia de esta prueba modificada de Cucconi con la prueba original, la prueba de Lepage y la prueba P G2 de Podgor-Gastwirth muestran que la prueba de Cucconi modificada es robusta en tamaño y mucho más poderosa que las anteriores para todas las distribuciones consideradas desde la normal hasta algunas de colas largas. Se hace una aplicación a datos reales.
Palabras clave: combinación de pruebas, modelo de localización y escala, pruebas de rangos.



1. Introduction
    The two sample Behrens-Fisher problem is to test that the locations, but not
necessarily the scales, of the distribution functions associated to the populations
behind the samples are equal. There exist situations of practical interest, how-
ever, when it is appropriate to jointly test for change in locations and change in
scales. For example, Snedecor & Cochran (1989) emphasize that the application
of a treatment (e.g. a drug) to otherwise homogeneous experimental units often
results in the treated group differing not only in location but also in scales. The
practitioner generally has no a prior knowledge about the distribution functions
from which the data originate. Therefore, in such situations, an appropriate test
does not require distributional assumptions. The test proposed by Perng & Littel
(1976) for the equality of means and variances is not appropriate because is a
combination of the t test and the F test, as the F test is not α robust for data
from heavier than normal tailed distributions. According to Conover, Johnson &
Johnson (1981) a test is α robust if its type one error rate is less than 2α. The cut
off point is set to 1.5α by Marozzi (2011). As the Perng & Littel (1976) test which
uses the Fisher combining function, the tests for the location-scale problem are
generally expressed as functions of two tests, one sensitive to location changes and
the other to scale changes. The corresponding statistics are generally obtained
as direct combination of (i.e. by summing) a standardized statistic sensitive to
location changes and a standardized statistic sensitive to scale changes. The most
familiar test statistic for the location-scale problem, due to Lepage (1971), which
is a direct combination of the squares of the standardized Wilcoxon and Ansari-
Bradley statistics. It is important to note that Lepage-type tests can be obtained
following Podgor & Gastwirth (1994). Marozzi (2009) compared several Podgor
& Gastwirth (1994) efficiency robust tests and found that the P G2 test is the
most powerful one. To perform the P G2 test it is necessary to regress the group
indicator on the ranks and on the squares of the ranks of the data and to test that
the two regression coefficients are zero. The P G2 test can be recast as a quadratic
combination of the Wilcoxon test and the Mood squared rank test. For the same
problem, the test of Cucconi (1968) should be considered because it is different
from the other tests being not based on the combination of a test for location
and a test for scale. It is a nonparametric test based on the squares of ranks


                                     Revista Colombiana de Estadística 35 (2012) 371–384

Modified Cucconi Test                                                                 373

and contrary-ranks. Marozzi (2009) computed for the very first time exact criti-
cal values for this test, compared its power to that of the Lepage and other tests
that included several Podgor-Gastwirth tests and showed that the test of Cucconi
maintains the size very close to the nominal level and is more powerful than the
Lepage test. In this paper we are not interested in the general two sample problem,
and therefore we do not consider tests like the Kolmogorov-Smirnov, Cramer-Von
Mises or Anderson-Darling tests. In Section 2 we introduce a modification of the
Cucconi test developed within the framework of the nonparametric combination
of dependent tests (Pesarin 2001). A power comparison of this modified Cucconi
test with the original one, the Lepage test and the Podgor-Gastwirth P G2 test is
carried out in Section 3. These tests are applied to a real data set in Section 4.
The conclusions are reported in Section 5.


2. The Modified Cucconi Test
    In this section we introduce a modification of the Cucconi (Cucconi 1968)
test. The idea is to modify this test consistently with the familiar approach which
develops a location-scale test by combining a test for location and a test for scale.
More precisely, following the theory of the nonparametric combination (Pesarin
2001) we will combine the Cucconi test with the Wilcoxon test for location and
the modified Levene test for scale proposed by Brown & Forsythe (1974). We
consider the Wilcoxon test and the modified Levene test because they have good
properties in addressing the location and the scale problem respectively. Among
other things, they are robust against non normality and they have good power,
see Hollander & Wolfe (1999) and Marozzi (2011).
    Let X 1 = (X11 , . . . , X1n1 ) and X 2 = (X21 , . . . , X2n2 ) be independent random
samples of iid observations. Let F1 and F2 denote the absolutely continuous dis-
tribution functions associated to the populations underlying the samples. We wish
to test
                             H0 : F1 (g) = F2 (g) for all g ∈ R                        (1)
versus the location-scale alternative
                                          g−ϑ
                     H1 : F2 (g) = F1 (       ) with ϑ ∈ R, τ > 0                     (2)
                                           τ
Note that for ϑ = 0, H1 reduces to a pure scale alternative and for τ = 1 to a pure
location alternative. Let µj and σj denote the location and scale of Fj , j = 1, 2.
H0 can be equivalently represented as

    H0 = H0l ∩ H0s where H0l : ϑ = µ1 − µ2 = 0 and H0s : τ = σ1 /σ2 = 1               (3)

H1 can be equivalently represented as

           H1 = H1l ∪ H1s where H1l : µ1 − µ2 6= 0 and H1s : σ1 /σ2 6= 1              (4)

   This representation of the system of hypotheses emphasizes that it is composed
by two partial systems of hypotheses: the location and the scale one.

                                       Revista Colombiana de Estadística 35 (2012) 371–384

374                                                                                                   Marco Marozzi


      The test of Cucconi (1968) is based on

                                                                   U 2 + V 2 − 2ρU V
                                     C = C (U, V ) =
                                                                       2(1 − ρ2 )

where
                                                           n1
                                                                  2
                                                           P
                                                       6         S1i − n1 (n + 1)(2n + 1)
                                                           i=1
                          U = U (S 1 ) = p                                                      ,
                                                      n1 n2 (n + 1)(2n + 1)(8n + 11)/5
                                                 n1
                                                  (n + 1 − S1i )2 − n1 (n + 1)(2n + 1)
                                                 P
                                             6
                                                 i=1
                     V = V (S 1 ) =              p
                                                   n1 n2 (n + 1)(2n + 1)(8n + 11)/5

                                     n = n1 + n2 ,               S 1 = (S11 , . . . , S1n1 )
S1i denotes the rank of X1i in the pooled sample

X = (X 1 , X 2 ) = (X11 , . . . , X1n1 , X21 , . . . , X2n2 ) = (X1 , . . . , Xn1 , Xn1 +1 , . . . , Xn )
                      2
            2(n −4)
and ρ = (2n+1)(8n+11) − 1. Note that U is based on the squares of the ranks S1i ,
while V is based on the squares of the contrary-ranks (n + 1 − S1i ) of the first
sample. Cucconi (1968) showed that under H0 (U, V ) has mean (0,0) because
   n1
       2
  P
E( S1i   ) = n1 (n + 1)(2n + 1)/6, and that V AR(U ) = V AR(V ) = 1 because
     i=1
           n1                                                                                               n1
                  2
           P                                                                                                P
V AR(            S1i ) = n1 n2 (n + 1)(2n + 1)(8n + 11)/180. Of course, it is E(                                 (n +
           i=1                                                                                              i=1
                          n1                               n1                                  n1
1 − S1i )2 ) = E(                2
                                                                 (n + 1 − S1i )2 ) = V AR(            2
                          P                                P                                   P
                                S1i ) and V AR(                                                      S1i ). U and V
                          i=1                              i=1                                 i=1
are negatively correlated, more precisely, since CORR(U, V ) = COV AR(U, V ) =
   2(n2 −4)
(2n+1)(8n+11) −1 = ρ then −1 ≤ CORR(U, V ) < −7/8, where the minimum occurs
when n = 2 and the supremum is reached when n → ∞. It has been also shown
that under H0 if n1 , n2 → ∞ and n1 /n → λ ∈]0, 1[ then P r(U ≤ u) → Φ(u)
and P r(U ≤ v) → Φ(v), where Φ is the standard normal distribution function,
moreover (U, V ) converges in distribution to the bivariate normal with mean (0,0)
and correlation ρ0 = −7/8
                          Z u Z v                     2
                                                         q + r2 − 2ρ0 qr
                                                                         
                                         1
    Pr(U ≤ u, V ≤ v) →                           exp −                     dqdr
                                                            2 (1 − ρ20 )
                                       p
                                               2
                           −∞ −∞ 2π 1 − ρ0

Therefore thepoints (u, v) outside
                                   the rejection region are close to (0,0), i.e. satisfy
                           2     2
                           −2ρ0 uv
     √1         exp − u +v    ≥ k, where the constant k is chosen so that the
                        2(1−ρ20 )
2π    1−ρ20
                                    p         −1
type-one error rate is α. Let k = α 2π 1 − ρ20     , then it follows that if the
                                         2       2
                                  −2ρ0 uv
point (u, v) is such that u +v2(1−ρ20 )
                                          < − ln α then we failed to have evidence
against H0 . It is interesting to note that the rejection region E of the test is the


                                                           Revista Colombiana de Estadística 35 (2012) 371–384

Modified Cucconi Test                                                                        375

set of points (u, v) outside the ellipse u2 +  2
                                             v − 2ρ0 uv =
                                                                          2
                                                                 −2(1 − ρ0 ) ln α. The
                                                 2    2
                                                        −2ρ0 qr
                                 √1      exp − q +r
                          RR
test has size α because                                           dqdr = α. Note that
                             E 2π 1−ρ2
                                       0
                                                   2(1−ρ  0)
                                                          2

in practice, unless you have large samples, ρ0 should be replaced by ρ. Cucconi
(1968) proved also that the test is unbiased and consistent for the location-scale
problem.
    We develop the modified Cucconi M C ∗ test following the nonparametric com-
bination of dependent tests theory, which operates within the permutation frame-
work, by combining the permutation version of the Cucconi test with the permuta-
tion version of the Wilcoxon W test for comparing locations and the Levene W 50
test for comparing scales. The Wilcoxon W test is based on
                                Pn2
                               | i=1 S2i − n2 (n + 1) /2|
                         W =
                                    n1 n2 (n + 1) /12

    The Levene W 50 test is based on the Student t statistic computed on Rji =
|Xji − X ej | where X    ej is the median of the jth sample. Let us denote the mean of
Rji , i = 1, . . . , nj by Rj , j = 1, 2, the Levene statistic is

                                                  R1 − R2
                    W 50 = r              Pn1                2   Pn2                  2
                                1    1        i=1   (R1i −R1 ) +     i=1   (R2i −R2 )
                                n1 + n2                        n−2


Large values of W and W 50 are evidence of difference in locations and scales
respectively. It is desirable that the good performance in detecting separately
location and scale changes shown by the W and the W 50 tests are transferred to
the combined test resulting in an improved power for jointly detecting location
and scale changes with respect to the original Cucconi test. It has been shown
that the nonparametric combination of dependent tests theory is very useful to
address the location problem, see Marozzi (2004b), Marozzi (2004a) and Marozzi
(2007), and the scale problem, see Marozzi (2011) and Marozzi (2012). We would
like to see whether this theory is also useful to address the location-scale problem.
    We describe now the permutation version C ∗ of the Cucconi test. Let X ∗ =
(X ∗1 , X ∗2 ) = (Xu∗1 , . . . , Xu∗n ) = (X1∗ , . . . , Xn∗ ) denote a random permutation of the
combined sample, where (u∗1 , . . . , u∗n ) is a permutation of (1, . . . , n), and so X ∗1 =
(Xu∗1 , . . . , Xu∗n ) and X ∗2 = (Xu∗n +1 , . . . , Xu∗n ) are the two permuted samples. The
                1                     1
permutation version of the C statistic is
                                                           2             2
                                                      (U ∗ ) + (V ∗ ) − 2ρU ∗ V ∗
               C ∗ = C (X ∗1 ) = C (U ∗ , V ∗ ) =
                                                               2(1 − ρ)

where U ∗ = U (S ∗1 ), V ∗ = V (S ∗1 ) and S ∗1 contains the ranks of X ∗1 elements. The
observed value of C ∗ is 0 C = C(U, V ). To compute the p-value we compute the
permutation null distribution of the C statistic as the distribution function of its
permutation values: 1 C ∗ , . . . ,k C ∗ , . . . ,K C ∗ where k C ∗ = C (k X ∗1 ), k X ∗1 contains
the first n1 elements of the kth permutation of X and k = 1, . . . , K = n!/(n1 !n2 !).


                                          Revista Colombiana de Estadística 35 (2012) 371–384

376                                                                          Marco Marozzi


Therefore the p-value is
                                                  K
                                             1 X
                            LC ∗ (0 C) =         I (k C ∗ ≥0 C)
                                             K
                                                  k=1

where I(.) denotes the indicator function.
   We briefly describe now the permutation version of the W and W 50 tests. Let

                        Y = (X 1 /SD (X 1 ) , X 2 /SD (X 2 ))
                           = (X1 /SD (X 1 ) , . . . , Xn /SD (X 2 ))
                           = (Y1 , . . . , Yn )

be the standardized pooled sample, and let

                        Z = (X 1 − E (X 1 ) , X 2 − E (X 2 ))
                           = (X1 − E (X 1 ) , . . . , Xn − E (X 2 ))
                           = (Z1 , . . . , Zn )

be the mean aligned pooled sample. Let Y ∗ and Z ∗ be a random permutation
of Y and Z respectively, it is important to emphasize that the Y and Z ele-
ments are not exactly exchangeable under H0 and so the permutation solution
is approximate; however it becomes asymptotically exact. Z elements would be
exchangeable if µ1 and µ2 were known and used in place of E(X 1 ) and E(X 2 ),
see Pesarin & Salmaso (2010, pp. 73-74) and Good (2000, pp. 38-41). Y el-
ements would be exchangeable if σ1 and σ2 were known and used in place of
SD(X 1 ) and SD(X 2 ), see Pesarin & Salmaso (2010, pp. 25 and 166-167). Al-
ternatively, we considered also the median absolute deviation and the median
in place of the standard deviation and the mean respectively in transforming
X and we obtained very similar results to those presented in section 3. It is
also to be emphasized that, in order to preserve the within individual depen-
dence on the transformed data [X, Y , Z], the permutations must be carried on
the n three-dimensional individual vectors [(X1 , Y1 , Z1 ), . . . , (Xn , Yn , Zn )]. So that
[X ∗ , Y ∗ , Z ∗ ] = [(Xu∗i , Yu∗i , Zu∗i ), i = 1, . . . , n].
    In the permutation
                   PK version     W ∗ of the W test, the p-value is computed as
                 1             ∗
LW ∗ (0 W ) = K k=1 I (k W ≥0 W ), where 0 W is the observed value of the
Wilcoxon statistic (that is computed on Y ) and k W ∗ is the Wilcoxon statistic com-
puted on the kth permutation k Y ∗ of Y . In the permutation                  ∗
                                                            PK version W∗50 of the
                                                          1
W 50 test, the p-value is computed as LW 50∗ (0 W 50) = K k=1 I (k W 50 ≥0 W 50),
where 0 W 50 is the observed value of the W 50 statistic (that is computed on Z)
and k W 50∗ is the W 50 statistic computed on the kth permutation k Z ∗ of Z.
    To obtain the M C ∗ test we combine the p-values of the C ∗ , W ∗ and W 50∗
tests. This is equivalent to combine the test statistics being one to one decreasingly
related to the p-values. Pesarin (2001, pp. 147-149) reports several combining
functions, with the most familiar being

   • the Fisher combining function ln (1/LC ∗ ) + ln (1/LW ∗ ) + ln (1/LW 50∗ );


                                          Revista Colombiana de Estadística 35 (2012) 371–384

Modified Cucconi Test                                                                       377

    • the Tippett combining function max(1 − LC ∗ , 1 − LW ∗ , 1 − LW 50∗ );
    • the Liptak combining function

                    Φ−1 (1 − LC ∗ ) + Φ−1 (1 − LW ∗ ) + Φ−1 (1 − LW 50∗ ) ;

and noted that the Tippett combining function has a good power behavior when
only one among the partial alternatives is true; that the Liptak combining function
is generally good when the partial alternatives are jointly true; that the Fisher
combining function has an intermediate behavior with respect to the Tippett and
Liptak ones and therefore it is suggested when nothing is expected about the
partial alternatives. Since we would like a combined test that is sensitive in all
the three alternative situations: that are when H1l alone is true, when H1s alone
is true, when H1l and H1s are jointly true, we use the Fisher combining function
to obtain the test statistic for the null hypothesis H0 = H0l ∩ H0s

                   M C ∗ = ln (1/LC ∗ ) + ln (1/LW ∗ ) + ln (1/LW 50∗ )

Note that the Fisher combining function is used also by Perng & Littel (1976). The
observed value of the M C ∗ statistic is 0 M C = ln (1/LC ∗ (0 C))+ln (1/LW ∗ (0 W ))+
ln (1/LW 50∗ (0 W 50)). The null distribution of the M C ∗ statistic is the distribu-
tion function of 1 M C ∗ , . . . ,k M C ∗ , . . . ,K M C ∗ where k M C ∗ = ln (1/LC ∗ (k C ∗ )) +
ln (1/LW ∗ (k W ∗ )) + ln (1/LW 50∗ (k W 50∗ )). Large values of 0 M C are evidence
against H0 , that should be rejected if LM C ∗ (0 M C) ≤ α where LM C ∗ (0 M C) =
 1
   PK              ∗
K     k=1 I (k M C ≥0 M C). According to Pesarin (2001) it is possible to combine
even a large, although finite, number of tests. In our case, we limit the number
of tests to be combined to avoid the possibility that the type one error rate of
the combined test may inflate too much, because under H0 Y and Z elements are
only approximately exchangeable.


3. Size and Power Study
    We investigate via Monte Carlo simulation (5000 replications) the robustness of
the significance level and the power of the modified Cucconi M C ∗ test in detecting
location and scale changes, and we made comparisons with the classical Cucconi
C test, the Lepage L test and the P G2 test. The Lepage test is based on
                                                             2
                                               (A − E(A))
                                  L = W2 +
                                                 V AR(A)
              Pn2
where A =       i=1 A2i is the Ansari-Bradley statistic, Aji denotes the Ansari-
Bradley score of Xji in the combined sample. To compute the Aji s assign the
score 1 to both the smallest and largest observations in the pooled sample, the
score 2 to the second smallest and second largest, and so on. E(A) and V AR(A)
denote the expected value and variance of A under H0 . Since the scoring de-
pends on whether n is even or odd, two cases should be distinguished, E(A) =
n2 (n + 2)/4 and V AR(A) = n1 n2 (n + 2) (n − 2)/ (48 (n − 1)) when n is even, and


                                          Revista Colombiana de Estadística 35 (2012) 371–384

378                                                                           Marco Marozzi

                                                                     
E(A) = n2 (n + 1)2 / (4n) and V AR(A) = n1 n2 (n + 1) (3 + n2 )/ 48n2 when n is
odd.
    Let Ii i = 1, . . . , n be a group indicator so that Ii = 1 when the ith element
of the combined sample belongs to the first sample, Ii = 0 otherwise. The P G2
test statistic is the F statistic with 2 and n − 3 df computed by regressing group
                                                           2
indicators Ii on the ranks Sji and the squared ranks Sji     of the observations in the
combined sample                                         
                                        bT S T I − n21 /n /2
                             P G2 =               
                                      n1 − bT S T I / (n − 3)

where T denotes the transpose operator, b is the 3 × 1 column vector of the OLS
estimate of the intercept term and the regression coefficients, S is a n × 3 matrix
                                                                                            2
with the first column of 1s, the second column of Sji and the third column of Sji             ,
i = 1, . . . , nj , j = 1, 2, I is the nx1 column of the group indicators I1 , . . . , In .
    The nominal 5% level is used throughout. We consider the following distribu-
tions that cover a wide range from short-tailed to very long-tailed distributions:

   1. standard normal N(0,1);
                       √      √
   2. uniform between − 3 and 3;

   3. bimodal obtained as a mixture of a N(-1.5,1) with probability 0.5 and a
      N(1.5,1) with 0.5;
                                                           √
   4. Laplace double exponential with scale parameter of 1/ 2;

   5. 10% outlier obtained as a mixture of a N(0,1) with probability 0.9 and a
      N(1,10) with 0.1;

   6. 30% outlier obtained as a mixture of a N(0,1) with probability 0.7 and a
      N(1,10) with 0.3;

   7. Student’s t with 2 df;

   8. standard Cauchy, which corresponds to a Student’s t with 1 df.

Note that distributions 7 and 8 have infinite second moment, and that distribu-
tion 8 has an undefined first moment. We consider only symmetric distributions
because if one considers skewed distributions, a change in location is not qualita-
tively different with respect to a change in scale and therefore the location-scale
alternative is not well specified in terms of µ1 − µ2 and σ1 /σ2 . We consider the
balanced cases (n1 , n2 ) = (10, 10) and (30, 30) as well as the unbalanced cases
(n1 , n2 ) = (10, 30) and (30, 10). We emphasize that p-values of the P G2 test have
been computed exactly for all the sample size settings. p-values of the Lepage
and Cucconi tests have been computed exactly for (n1 , n2 ) = (10, 10) and have
been estimated by considering a random sample of 1 million permutations in the
remaining settings. p-values of the M C ∗ test have been estimated by considering
a random sample of 1000 permutations. The results in terms of the proportion of


                                         Revista Colombiana de Estadística 35 (2012) 371–384

Modified Cucconi Test                                                                379

times H0 is rejected are reported in Table 1 and Table 2 for the estimates of the
size and power. The first two lines of the tables display the parameter choice: in
the first column we are under H0 , while in the others we are under H1 . Note that
all the tests are robust in size because their maximum estimated significance level
(MESL) does not exceed 0.07. More precisely the MESL is 0.067, 0.058, 0.057 and
0.058 for the M C ∗ , L, C and P G2 tests respectively. It is important to note that
the MESL of all the tests is greater than .05 and that the MESL of the M C ∗ test is
the greatest one. Note that the cut-off point for the robustness in size is set to 0.1
by Conover et al. (1981) and more stringently to 0.075 by Marozzi (2011). Even if
we caution that the results are obtained via simulations, they are very clear and
show that the M C ∗ test is more powerful than the other tests for all distribution
and sample size settings considered here. The results show that the combination of
the Cucconi test with the Wilcoxon test for location and the modified Levene test
for scale markedly improve the power of the Cucconi test in detecting separately
location and scale changes, and in jointly detecting location and scale changes,
for distributions that range from light-, to normal- and heavy-tailed distributions.
The cost to be paid is the slightly liberality of the test that has a MESL of .067
(the other tests have a MESL between .057 and .058).


4. Application
   Table 3 shows expenditure in Hong Kong dollars of 20 single men and 20 single
women on the commodity group housing including fuel and light. This real data
example is taken from Hand, Daly, Lunn, McConway & Ostrowski (1994, p. 44).
Figure 1 presents the box plots of the data.
                                500      1000      1500      2000
                        Men
                        Women




                   Figure 1: Box-plot of household expenditures.


   We see from the box plots that the distributions of the data in the two groups
seem to have different locations as well as different scales. This example illustrates

                                      Revista Colombiana de Estadística 35 (2012) 371–384

380                                                                                    Marco Marozzi


Table 1: Size and power of some tests for location and scale changes, (n1 , n2 ) = (10, 10)
         and (10, 30).
               (n1 , n2 ) = (10, 10)                       (n1 , n2 ) = (10, 30)
                      Normal                                      Normal
  µ1 − µ2       0        0       1     1       1   µ1 − µ2        0       0    0.75      0.75    0.75
   σ1 /σ2       1        2       2     1       3    σ1 /σ2        1     1.5      1.5        1     2.5
    M C∗    0.055 0.423 0.646 0.595        0.821     M C ∗ 0.057 0.349 0.628            0.544   0.896
        L   0.050 0.249 0.383 0.415        0.585         L 0.044 0.201 0.427            0.383   0.690
        C   0.052 0.281 0.414 0.410        0.639         C 0.048 0.257 0.473            0.388   0.780
     P G2   0.053 0.286 0.418 0.413        0.642      P G2 0.046 0.253 0.467            0.381   0.775
                     Uniform                                     Uniform
  µ1 − µ2       0        0       1     1       1   µ1 − µ2        0       0    0.75      0.75    0.75
   σ1 /σ2       1        2       2     1       3    σ1 /σ2        1     1.5      1.5        1     2.5
    M C∗    0.065 0.582 0.730 0.533        0.912     MC  ∗
                                                            0.063 0.519 0.688           0.518   0.966
        L   0.053 0.381 0.435 0.348        0.683         L 0.051 0.324 0.430            0.340   0.778
        C   0.053 0.456 0.489 0.327        0.764         C 0.050 0.430 0.503            0.343   0.882
     P G2   0.054 0.462 0.494 0.331        0.767      P G2 0.049 0.424 0.497            0.339   0.879
                     Bimodal                                     Bimodal
  µ1 − µ2       0        0     2.5   1.5     1.5   µ1 − µ2        0       0        2        1       1
   σ1 /σ2       1      1.5     1.5     1     2.5    σ1 /σ2        1     1.5      1.5        1     1.5
    M C∗    0.062 0.285 0.718 0.431        0.824     M C ∗ 0.061 0.489 0.801            0.356   0.634
        L   0.048 0.174 0.453 0.261        0.587         L 0.051 0.305 0.555            0.222   0.379
        C   0.047 0.203 0.441 0.251        0.652         C 0.053 0.396 0.611            0.222   0.459
     P G2   0.048 0.206 0.446 0.253        0.657      P G2 0.050 0.389 0.605            0.216   0.453
                      Laplace                                     Laplace
  µ1 − µ2       0        0       1     1       1   µ1 − µ2        0       0    0.75      0.75    0.75
   σ1 /σ2       1        2       2     1       3    σ1 /σ2        1     1.5      1.5        1     2.5
    M C∗    0.064 0.293 0.616 0.689        0.741     M C ∗ 0.054 0.243 0.681            0.690   0.844
        L   0.057 0.164 0.435 0.543        0.539         L 0.058 0.144 0.537            0.563   0.682
        C   0.055 0.175 0.449 0.547        0.572         C 0.053 0.177 0.554            0.560   0.739
     P G2   0.056 0.176 0.452 0.549        0.576      P G2 0.051 0.174 0.548            0.554   0.735
                   10% outlier                                 10% outlier
  µ1 − µ2       0        0     1.5     1       1   µ1 − µ2        0       0        1     0.75    0.75
   σ1 /σ2       1      2.2     2.2     1     3.5    σ1 /σ2        1       2        2        1     2.2
    M C∗    0.056 0.306 0.542 0.434        0.593     MC  ∗
                                                            0.063 0.355 0.606           0.443   0.557
        L   0.055 0.225 0.408 0.303        0.493         L 0.054 0.331 0.513            0.289   0.482
        C   0.050 0.235 0.423 0.310        0.501         C 0.053 0.370 0.549            0.294   0.526
     P G2   0.051 0.238 0.427 0.312        0.505      P G2 0.051 0.365 0.541            0.288   0.521
                   30% outlier                                 30% outlier
  µ1 − µ2       0        0     3.6   1.3     1.3   µ1 − µ2        0       0      1.8        1       1
   σ1 /σ2       1        3       3     1       6    σ1 /σ2        1     2.2      2.2        1       3
    M C∗    0.055 0.296 0.617 0.351        0.618     M C ∗ 0.057 0.306 0.608            0.350   0.569
        L   0.047 0.238 0.491 0.260        0.520         L 0.052 0.242 0.503            0.239   0.464
        C   0.046 0.224 0.502 0.270        0.488         C 0.052 0.259 0.506            0.243   0.480
     P G2   0.047 0.227 0.504 0.271        0.494      P G2 0.049 0.255 0.500            0.238   0.475
                      Student                                     Student
  µ1 − µ2       0        0       2     1       1   µ1 − µ2        0       0      1.1      0.8     0.8
   σ1 /σ2       1      2.4     2.4     1     3.6    σ1 /σ2        1     1.8      1.8        1     2.2
    M C∗    0.055 0.369 0.669 0.376        0.671     M C ∗ 0.058 0.310 0.608            0.410   0.605
        L   0.046 0.242 0.506 0.252        0.490         L 0.049 0.234 0.474            0.264   0.464
        C   0.047 0.255 0.521 0.262        0.509         C 0.050 0.272 0.500            0.274   0.515
     P G2   0.048 0.258 0.525 0.263        0.514      P G2 0.047 0.267 0.495            0.267   0.508
                      Cauchy                                      Cauchy
  µ1 − µ2       0        0       3   1.5     1.5   µ1 − µ2        0       0      1.5        1       1
   σ1 /σ2       1        3       3     1       5    σ1 /σ2        1       2        2        1       3
    M C∗    0.053 0.320 0.591 0.425        0.577     MC  ∗
                                                            0.062 0.218 0.536           0.395   0.521
        L   0.046 0.255 0.490 0.318        0.495         L 0.051 0.195 0.457            0.249   0.483
        C   0.048 0.250 0.494 0.321        0.488         C 0.051 0.217 0.466            0.244   0.503
     P G2   0.049 0.255 0.498 0.324        0.493      P G2 0.050 0.214 0.460            0.239   0.496




                                           Revista Colombiana de Estadística 35 (2012) 371–384

Modified Cucconi Test                                                                                 381

Table 2: Size and power of some tests for location and scale changes, (n1 , n2 ) = (30, 10)
         and (30, 30).
                     (n1 , n2 ) = (30, 10)                               (n1 , n2 ) = (30, 30)
                            Normal                                              Normal
  µ1 − µ2       0       0         1    0.75    0.75   µ1 − µ2       0       0       0.5     0.5     0.5
   σ1 /σ2       1     1.8       1.8       1     2.5    σ1 /σ2       1     1.3       1.3       1    1.75
    M C∗    0.059   0.416 0.726 0.512         0.854     M C∗    0.060   0.256 0.578 0.470         0.858
        L   0.046   0.240 0.427 0.391         0.579         L   0.050   0.144 0.374 0.357         0.641
        C   0.045   0.240 0.431 0.397         0.612         C   0.053   0.164 0.394 0.353         0.715
     P G2   0.042   0.230 0.417 0.390         0.599      P G2   0.053   0.165 0.396 0.355         0.716
                           Uniform                                             Uniform
  µ1 − µ2       0       0         1    0.75    0.75   µ1 − µ2       0       0       0.5     0.5     0.5
   σ1 /σ2       1     1.8       1.8       1     2.5    σ1 /σ2       1     1.3       1.3       1    1.75
    M C∗    0.059   0.600 0.808 0.472         0.954     M C∗    0.053   0.450 0.662 0.464         0.957
        L   0.053   0.395 0.488 0.343         0.782         L   0.049   0.272 0.425 0.340         0.796
        C   0.053   0.458 0.470 0.345         0.844         C   0.051   0.376 0.478 0.327         0.896
     P G2   0.052   0.446 0.458 0.339         0.836      P G2   0.052   0.379 0.480 0.330         0.896
                           Bimodal                                             Bimodal
  µ1 − µ2       0       0         2       1       1   µ1 − µ2       0       0       1.1    0.75    0.75
   σ1 /σ2       1     1.5       1.5       1    1.75    σ1 /σ2       1     1.3       1.3       1     1.4
    M C∗    0.067   0.328 0.740 0.318         0.671     M C∗    0.054   0.385 0.742 0.356         0.724
        L   0.057   0.218 0.487 0.217         0.403         L   0.047   0.242 0.512 0.246         0.493
        C   0.056   0.216 0.421 0.212         0.391         C   0.048   0.298 0.547 0.231         0.555
     P G2   0.054   0.209 0.410 0.208         0.378      P G2   0.049   0.301 0.549 0.234         0.558
                            Laplace                                             Laplace
  µ1 − µ2       0       0         1    0.75    0.75   µ1 − µ2       0       0       0.5     0.5     0.5
   σ1 /σ2       1     1.8       1.8       1     2.5    σ1 /σ2       1     1.3       1.3       1    1.75
    M C∗    0.055   0.285 0.727 0.648         0.734     M C∗    0.055   0.184 0.637 0.632         0.783
        L   0.048   0.145 0.515 0.561         0.446         L   0.050   0.108 0.481 0.519         0.593
        C   0.048   0.129 0.531 0.554         0.469         C   0.052   0.118 0.482 0.514         0.624
     P G2   0.046   0.124 0.522 0.550         0.455      P G2   0.052   0.119 0.485 0.517         0.627
                         10% outlier                                         10% outlier
  µ1 − µ2       0       0       1.5    0.75    0.75   µ1 − µ2       0       0      0.75     0.5     0.5
   σ1 /σ2       1       2         2       1       3    σ1 /σ2       1     1.5       1.5       1     1.8
    M C∗    0.066   0.329 0.646 0.365         0.632     M C∗    0.059   0.234 0.599 0.383         0.560
        L   0.053   0.240 0.524 0.290         0.557         L   0.048   0.217 0.509 0.269         0.511
        C   0.052   0.218 0.523 0.295         0.514         C   0.051   0.233 0.514 0.272         0.518
     P G2   0.050   0.211 0.514 0.288         0.507      P G2   0.051   0.235 0.516 0.273         0.520
                         30% outlier                                         30% outlier
  µ1 − µ2       0       0         3       1       1   µ1 − µ2       0       0       1.2     0.7     0.7
   σ1 /σ2       1     2.5       2.5       1     4.5    σ1 /σ2       1     1.8       1.8       1     2.3
    M C∗    0.054   0.283 0.664 0.324         0.617     M C∗    0.057   0.315 0.610 0.334         0.603
        L   0.047   0.249 0.513 0.258         0.541         L   0.055   0.261 0.500 0.240         0.521
        C   0.047   0.189 0.513 0.260         0.454         C   0.057   0.246 0.487 0.241         0.487
     P G2   0.046   0.184 0.506 0.254         0.447      P G2   0.058   0.247 0.491 0.244         0.489
                            Student                                             Student
  µ1 − µ2       0       0       1.7     0.8     0.8   µ1 − µ2       0       0       0.8     0.6     0.6
   σ1 /σ2       1     2.2       2.2       1       3    σ1 /σ2       1     1.6       1.6       1     1.8
    M C∗    0.060   0.414 0.712 0.344         0.703     M C∗    0.056   0.331 0.660 0.406         0.632
        L   0.048   0.278 0.506 0.260         0.515         L   0.051   0.248 0.512 0.300         0.502
        C   0.050   0.244 0.527 0.263         0.500         C   0.049   0.262 0.521 0.298         0.515
     P G2   0.048   0.238 0.515 0.258         0.493      P G2   0.049   0.265 0.525 0.299         0.518
                            Cauchy                                              Cauchy
  µ1 − µ2       0       0       2.5       1       1   µ1 − µ2       0       0       1.2     0.8     0.8
   σ1 /σ2       1     2.5       2.5       1       4    σ1 /σ2       1     1.8       1.8       1     2.2
    M C∗    0.063   0.322 0.588 0.297         0.567     M C∗    0.055   0.269 0.608 0.424         0.557
        L   0.050   0.258 0.457 0.238         0.511         L   0.046   0.250 0.530 0.302         0.520
        C   0.048   0.208 0.473 0.238         0.441         C   0.044   0.245 0.519 0.300         0.505
     P G2   0.046   0.202 0.465 0.232         0.435      P G2   0.044   0.246 0.522 0.302         0.508




                                              Revista Colombiana de Estadística 35 (2012) 371–384

382                                                                    Marco Marozzi


Table 3: Household expenditures (Honk Kong dollars) of a group of men and a group
         of women.
                                        Men
           497   839   798    892   1585   755     388   617    248    1641
          1180   619   253    661   1981  1746    1865   238   1199    1524
                                       Women
           820   184   921    488    721    614    801   396    864     845
           404   781   457   1029   1047    552    718   495    382    1090



that in practice we may have situations where F1 and F2 are different in both
location and scale. With the aim at finding out whether household expenditures
differ from men to women, we use the modified Cucconi test. By considering a
random sample of 1 million permutations, the estimated p-value of the M C ∗ test
is 0.0105, that suggests to reject the null hypothesis at level 5%. This result is
consistent with the results obtained using the original Cucconi test and the P G2
test whose p-values are 0.0446 (estimated by considering a random sample of 1
million permutations) and 0.0441 (exact computation) respectively. The estimated
p-value of the Lepage test is 0.0896 and suggests to reject H0 at level 10%. At the
basis of these results we conclude that household expenditures of men and women
differ. It is worth noting that, with respect to the M C ∗ test, the other tests need
a higher level in order to reject H0 . This might suggest a gain in power of the
modified Cucconi test with respect to the original one and to the other tests.




5. Conclusion

    We introduced a modification of the Cucconi test. The main objetive was to
modify this test consistently with the familiar approach which develops a location-
scale test by combining a test for location and a test for scale. More precisely we
combined the Cucconi test with the Wilcoxon test for location and the modified
Levene test for scale proposed by Brown & Forsythe (1974) following the theory of
the nonparametric combination (Pesarin 2001). We compared the performance of
the modified Cucconi test with the original one, the Lepage test and the Podgor-
Gastwirth P G2 test in separately detecting location and scale changes as well as in
jointly detecting location and scale changes. The results show that the combination
of the Cucconi test with the Wilcoxon test for location and the modified Levene
test for scale gives rise to a test which is slightly more liberal and markedly more
powerful than the other tests for all the considered distributions, from short- to
normal- and long-tailed ones. In the light of our findings, we recommend the
practitioner to use the modified Cucconi test to address the location-scale problem,
with caution on its type-one error rate.

                                                                   
             Recibido: diciembre de 2011 — Aceptado: agosto de 2012


                                    Revista Colombiana de Estadística 35 (2012) 371–384

Modified Cucconi Test                                                              383

References
Brown, M. B. & Forsythe, A. B. (1974), ‘Robust tests for the equality of variantes’, Journal of the American Statistical Association 69, 364–367.
Conover, W. J., Johnson, M. E. & Johnson, M. M. (1981), ‘A comparative study of tests for homogeneity of variances, with applications to the outer continental shelf bidding data’, Technometrics 23, 351–361.
Cucconi, O. (1968), ‘Un nuovo test non parametrico per il confronto tra due gruppi campionari’, Giornale degli Economisti 27, 225–248.
Good, P. (2000), Permutation Tests, a Practical Guide to Resampling Methods for Testing Hypotheses, 2 edn, Springer-Verlag, New York.
Hand, D. J., Daly, F., Lunn, A. D., McConway, K. J. & Ostrowski, E. (1994), A Handbook Of Small Data Sets, Chapman and Hall, London.
Hollander, M. & Wolfe, D. A. (1999), Nonparametric Statistical Methods, 2 edn, Wiley, New York.
Lepage, Y. (1971), ‘A combination of Wilcoxon and Ansari-Bradley statistics’, Biometrika 58, 213–217.
Marozzi, M. (2004a), ‘A bi-aspect nonparametric test for the multi-sample location problem’, Computational Statistics and Data Analysis 46, 81–92.
Marozzi, M. (2004b), ‘A bi-aspect nonparametric test for the two-sample location problem’, Computational Statistics and Data Analysis 44, 639–648.
Marozzi, M. (2007), ‘Multivariate tri-aspect non-parametric testing’, Journal of Nonparametric Statistics 19, 269–282.
Marozzi, M. (2009), ‘Some notes on the location-scale Cucconi test’, Journal of Nonparametric Statistics 21, 629–647.
Marozzi, M. (2011), ‘Levene type tests for the ratio of two scales’, Journal of Statistical Computation and Simulation 81, 815–826.
Marozzi, M. (2012), ‘Combined interquantile range tests for differences in scale’, Statistical Papers 53, 61–72.
Perng, S. K. & Littel, R. C. (1976), ‘A test of equality of two normal population means and variances’, Journal of the American Statistical Association 71, 968–971.
Pesarin, F. (2001), Multivariate Permutation Tests With Applications In Biostatistics, Wiley, Chichester.
Pesarin, F. & Salmaso, S. (2010), Permutation Tests for Complex Data, Wiley, Chichester.
Podgor, M. J. & Gastwirth, J. L. (1994), ‘On non-parametric and generalized tests for the two-sample problem with location and scale change alternatives’, Statistics in Medicine 13, 747–758.
Snedecor, G. W. & Cochran, W. G. (1989), Statistical Methods, 8 edn, Iowa State University Press, Ames.
