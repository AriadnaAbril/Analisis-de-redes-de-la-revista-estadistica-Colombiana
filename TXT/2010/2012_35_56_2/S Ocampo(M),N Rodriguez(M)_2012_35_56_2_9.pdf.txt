An Introductory Review of a Structural VAR-X Estimation and Applications. Una revisión introductoria de la estimación y aplicaciones de un VAR-X estructural
Inter-American Development United States of America. Banco de la República, Bogotá, Colombia. Universidad Nacional de Colombia, Bogotá, Colombia
Abstract
This document presents how to estimate and implement a structural VAR-X model under long run and impact identification restrictions. Estimation by Bayesian and classical methods are presented. Applications of the structural VAR-X for impulse response functions to structural shocks, multiplier analysis of the exogenous variables, forecast error variance decomposition and historical decomposition of the endogenous variables are also described, as well as a method for computing higher posterior density regions in a Bayesian context. Some of the concepts are exemplified with an application to US data.
Key words: Econometrics, Bayesian time series, Vector autoregression, Structural model.
Resumen
Este documento cubre la estimación e implementación del modelo VAR-X estructural bajo restricciones de identificación de corto y largo plazo. Se presenta la estimación tanto por métodos clásicos como Bayesianos. También se describen aplicaciones del modelo como impulsos respuesta ante choques estructurales, análisis de multiplicadores de las variables exógenas, descomposición de varianza del error de pronóstico y descomposición histórica de las variables endógenas. Así mismo se presenta un método para calcular regiones de alta densidad posterior en el contexto Bayesiano. Algunos de los conceptos son ejemplificados con una aplicación a datos de los Estados Unidos.
Palabras clave: econometría, modelo estructural, series de tiempo Bayesianas, vector autoregresivo.

1. Introduction
    The use of Vector Autoregression with exogenous variables (VAR-X) and struc-
tural VAR-X models in econometrics is not new, yet textbooks and articles that
use them often fail to provide the reader a concise (and moreover useful) descrip-
tion of how to implement these models (Lütkepohl (2005) constitutes an exception
of this statement). The use of Bayesian techniques in the estimation of VAR-X
models is also largely neglected from the literature, as is the construction of the
historical decomposition of the endogenous variables. This document builds upon
the Structural Vector Autoregression (S-VAR) and Bayesian Vector Autoregres-
sion (B-VAR) literature and its purpose is to present a review of some of the basic
features that accompany the implementation of a structural VAR-X model.
    Section 2 presents the notation and general setup to be followed throughout
the document. Section 3 discusses the identification of structural shocks in a VAR-
X, with both long run restrictions, as in Blanchard & Quah (1989), and impact
restrictions, as in Sims (1980, 1986). Section 4 considers the estimation of the
parameters by classical and Bayesian methods. In Section 5, four of the possi-
ble applications of the model are presented, namely the construction of impulse
response functions to structural shocks, multiplier analysis of the exogenous vari-
ables, forecast error variance decomposition and historical decomposition of the
endogenous variables. Section 6 exemplifies some of the concepts developed in
the document using Galí’s (1999) structural VAR augmented with oil prices as an
exogenous variable. Finally Section 7 concludes.


2. General Set-up
    In all sections the case of a structural VAR-X whose reduced form is a VAR-
X(p, q) will be considered. It is assumed that the system has n endogenous vari-
ables (yt ) and m exogenous variables (xt ). The variables in yt and xt may be in
levels or in first differences, this depends on the characteristics of the data, the
purpose of the study, and the identification strategy, in all cases, no co-integration
is assumed. The reduced form of the structural model includes the first p lags
of the endogenous variables, the contemporaneous values and first q lags of the
exogenous variables and a constant vector.1 Under this specification it is assumed
that the model is stable and presents white-noise Gaussian residuals (et ), i.e.
   iid
et ∼ N (0, Σ), moreover, xt is assumed to be uncorrelated with et for all leads
and lags.
    The reduced form VAR-X(p, q) can be represented as in equation (1) or equa-
tion (2), where v is a n-vector, Bi are n × n matrices, with i ∈ {1, . . . , p}, and
Θj are n × m matrices, with j ∈ {1, . . . , q}. In equation (2) one has B (L) =
B1 L + · · · + Bp Lp and Θ (L) = Θ0 + · · · + Θq Lq , both matrices of polynomials in
   1 The lag structure of the exogenous variables may be relaxed allowing different lags for each

variable. This complicates the estimation and is not done here for simplicity. Also, the constant
vector or intercept may be omitted according to the characteristics of the series used.


                                          Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications                       481

the lag operator L.

          yt = v + B1 yt−1 + · · · + Bp yt−p + Θ0 xt + · · · + Θq xt−q + et                    (1)
          yt = v + B (L) yt + Θ (L) xt + et                                                    (2)

                                                              −1
   Defining Ψ (L) = Ψ0 + Ψ1 L + . . . = [I − B (L)] with Ψ0 = I as an infinite
polynomial on the lag operator L, one has the VMA-X representation of the model,
equation (3).2
                    yt = Ψ (1) v + Ψ (L) Θ (L) xt + Ψ (L) et                (3)

    Finally, there is a structural VAR-X model associated with the equations above,
most of the applications are obtained from it, for example those covered in Section
5. Instead of the residuals (e), which can be correlated among them, the structural
model contains structural disturbances with economic interpretation (), this is
what makes it useful for policy analysis. It will be convenient to represent the
model by its Vector Moving Average (VMA-X) form, equation (4),

                              yt = µ + C (L) t + Λ (L) xt                                     (4)

where the endogenous variables are expressed as a function of a constant n-vector
(µ), and the current and past values of the structural shocks () and the exogenous
variables. It is assumed that  is a vector of white noise Gaussian disturbances
                                           iid
with identity covariance matrix, i.e. t ∼ N (0, I). Both C (L) and Λ (L) are
infinite polynomials in the lag operator L, each matrix of C (L) (C0 , C1 , . . .) is of
size n × n, and each matrix of Λ (L) (Λ0 , Λ1 , . . .) is of size n × m.


3. Identification of Structural Shocks in a VAR-X
    The identification of structural shocks is understood here as a procedure which
enables the econometrician to obtain the parameters of a structural VAR-X from
the estimated parameters of the reduced form of the model. As will be clear from
the exposition below, the identification in presence of exogenous variables is no
different from what is usually done in the S-VAR literature. Equating (3) and (4)
one has:

          µ + Λ (L) xt + C (L) t = Ψ (1) v + Ψ (L) Θ (L) xt + Ψ (L) et

then the following equalities can be inferred:

                                         µ = Ψ (1) v                                           (5)
                                    Λ (L) = Ψ (L) Θ (L)                                        (6)
                                 C (L) t = Ψ (L) et                                           (7)
                                                             p
                                                                   −1
  2 The models stability condition implies that Ψ (1) =
                                                              P
                                                           I−   Bi     exists and is finite.
                                                              i=1



                                        Revista Colombiana de Estadística 35 (2012) 479–508

482                                                  Sergio Ocampo & Norberto Rodríguez


    Since the parameters in v, B (L) and Θ (L) can be estimated from the reduced
form VAR-X representation, the values of µ and Λ (L) are also known.3 Only the
parameters in C (L) are left to be identified, the identification depends on the type
of restrictions to be imposed. From equations (5), (6) and (7) is clear that the
inclusion of exogenous variables in the model has no effect in the identification of
the structural shocks. Equation (7) also holds for a structural VAR model.
     The identification restrictions to be imposed over C (L) may take several forms.
Since there is nothing different in the identification between the case presented here
and the S-VAR literature, we cover only two types of identification procedures,
namely: impact and long run restrictions that allow the use of the Cholesky de-
composition. It is also possible that the economic theory points at restrictions
that make impossible a representation in which the Cholesky decomposition can
be used, or that the number of restrictions exceeds what is needed for exact iden-
tification. Both cases complicate the estimation of the model, and the second
one (over-identification) makes it possible to carry out the tests over the restric-
tions imposed. For a more comprehensive treatment of these problems we refer to
Amisano & Giannini (1997).
    There is another identification strategy that will not be covered in this docu-
ment: identification by sign restrictions over some of the impulse response func-
tions. This kind of identification allows us to avoid some puzzles that commonly
arise in the VAR literature. Reference to this can be found in Uhlig (2005), Mount-
ford & Uhlig (2009), Canova & De Nicolo (2002), Canova & Pappa (2007) and
preceding working papers of those articles originally presented in the late 1990’s.
More recently, the work of Moon, Schorfheide, Granziera & Lee (2011) present
how to conduct inference over impulse response functions with sign restrictions,
both by classical and Bayesian methods.


3.1. Identification by Impact Restrictions
    In Sims (1980, 1986) the identification by impact restrictions is proposed, the
idea behind is that equation (7) is equating two polynomials in the lag operator
L, for them to be equal it must be the case that:

                                    Ci Li t = Ψi Li et
                                       Ci t = Ψi et                                     (8)

   Equation (8) holds for all i, in particular it holds for i = 0. Recalling that
Ψ0 = I, the following result is obtained:

                                        C0 t = et                                       (9)

then, by taking the variance on both sides we get:
                                             0
                                        C0 C0 = Σ                                       (10)
   3 Lütkepohl (2005) presents methods for obtaining the matrices in Ψ (L) and the product

Ψ (L) Θ (L) recursively in Sections 2.1.2 and 10.6, respectively. Ψ (1) is easily computed by
taking the inverse on I − B1 − . . . − Bp .


                                        Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications            483

Algorithm 1 Identification by Impact Restrictions

  1. Estimate the reduced form of the VAR-X.
  2. Calculate the VMA-X representation of the model (matrices Ψi ) and the
     covariance matrix of the reduced form disturbances e (matrix Σ).
  3. From the Cholesky decomposition of Σ calculate matrix C0 .

                                      C0 = chol (Σ)

  4. For i = 1, . . . , R, with R given, calculate the matrices Ci as:

                                       Ci = Ψi C0

Identification is completed since all matrices of the structural VMA-X are known.


    Since Σ is a symmetric, positive definite matrix, it is not possible to infer in
a unique form the parameters of C0 from equation (10), restrictions over the pa-
rameters of C0 have to be imposed. Because C0 measures the impact effect of the
structural shocks over the endogenous variables, those restrictions are named here
‘impact restrictions’. Following Sims (1980), the restrictions to be imposed ensure
that C0 is a triangular matrix, this allows to use the Cholesky decomposition of
Σ to obtain the non-zero elements of C0 . This amount of restrictions account
n × (n − 1)/2 and make the model just identifiable.
    In econometrics the use of the Cholesky decomposition with identifying impact
restrictions is also reffered to as recursive identification. This is because the pro-
cedure implies a recursive effect of the shocks over the variables, thus making the
order in which the variables appear in the model a matter for the interpretation
of the results. Since the matrix C0 is restricted to be triangular, e.g. lower trian-
gular, the first variable can only be affected at impact by the first shock ( first
element), whereas the second variable can be affected at impact by both the first
and second shocks. This is better illustrated in Christiano, Eichenbaum & Evans
(1999) where the recursive identification is applied to determine the effects of a
monetary policy shock.
   Once C0 is known, equations (8) and (9) can be used to calculate Ci for all i:

                                    Ci = Ψi C0                                     (11)

   Identification by impact restrictions is summarized in Algorithm 1.


3.2. Identification by Long Run Restrictions
    Another way to identify the matrices of the structural VMA-X is to impose re-
strictions on the long run impact of the shocks over the endogenous variables. This


                                     Revista Colombiana de Estadística 35 (2012) 479–508

484                                                                        Sergio Ocampo & Norberto Rodríguez


method is proposed in Blanchard & Quah (1989). For the model under considera-
                                                                    ∞
                                                                    P
tion, if the variables in yt are in differences, the matrix C (1) =   Ci measures the
                                                                                               i=0
long run impact of the structural shocks over the levels of the variables.4 Matrix
C (1) is obtained by evaluating equation (7) in L = 1. As in the case of impact
restrictions, the variance of each side of the equation is taken, the result is:
                                                       0                        0
                                      C (1) C (1) = Ψ (1) ΣΨ (1)                                                  (12)
                                      0
    Again, since Ψ (1) ΣΨ (1) is a symmetric, positive definite matrix it is not
possible to infer the parameters of C (1) from equation (12), restrictions over
the parameters of C (1) have to be imposed. It is conveniently assumed that
those restrictions make C (1) a triangular matrix, as before, this allows to use the
Cholesky decomposition to calculate the non-zero elements of C (1). Again, this
amount of restrictions account n × (n − 1)/2 and make the model just identifiable.
It is important to note that the ordering of the variables matters as before. If, for
example, C (1) is lower triangular, the first shock will be the only one that can
have long run effects over the first variable, whereas the second variable can be
affected by both the first and second shock in the long run.
    Finally, it is possible to use C (1) to calculate the parameters in the C0 matrix,
with it, the matrices Ci for i > 0 are obtained as in the identification by impact
restrictions. Combining (10) with (7) evaluated in L = 1 the following expression
for C0 is derived:
                                                −1
                                  C0 = [Ψ (1)] C (1)                             (13)
      Identification by long run restrictions is summarized in Algorithm 2.


4. Estimation
   The estimation of the parameters of the VAR-X can be carried out by classical
or Bayesian methods, as will become clear it is convenient to write the model in a
more compact form. Following Zellner (1996) and Bauwens, Lubrano & Richard
(2000), equation (1), for a sample of T observations, plus a fixed presample, can
be written as:
                                               Y            =       ZΓ + E                                        (14)
                   0                            0                   0            0          0                0   
                   y1         1               y0             ...    y1−p       x1      ...   x1−q              e1 
                              .
          
                    .. 
                                                                                                            
          
                              .
                                                                                                                .. 
                     .       .                                                                                   . 
                                                                                                                   
                                                                                                           
                                                                                                                  
                       0                       0                       0            0          0                     0
where Y =         yt , Z =                                                                         , E = 
                                                                                                                  
                              1              yt−1            ...     yt−p      xt      ...   xt−q               et 
                         
                                                                                                                    
                     ..      .                                                                                   .. 
                                                                                                                  
                              .
                                                                                                           
                      .      .                                                                                    . 
                                                                                                          
                                                                                                                    
                    0                          0                      0             0          0                    0
                                                                                                                  
                   yT                     1   yT −1           ...    yT −p      xT      ...   xT −q              eT
           h                                                           i0
and Γ =        v   B1       ...   Bp          Θo           ...   Θq         .
   4 Of course, not all the variables of y must be different, but the only meaningful restrictions
                                          t
are those imposed over variables that enter the model in that way. We restrict our attention to
a case in which there are no variables in levels in yt .


                                                           Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications              485

Algorithm 2 Identification by Long Run Restrictions

  1. Estimate the reduced form of the VAR-X.
  2. Calculate the VMA-X representation of the model (matrices Ψi ) and the
     covariance matrix of the reduced form disturbances e (matrix Σ).
                                                        0
  3. From the Cholesky decomposition of Ψ (1) ΣΨ (1) calculate matrix C (1).
                                               0
                                                    
                          C (1) = chol Ψ (1) ΣΨ (1)

  4. With the matrices of long run effects of the reduced form, Ψ (1), and struc-
     tural shocks, C (1), calculate the matrix of contemporaneous effects of the
     structural shocks, C0 .
                                              −1
                                 C0 = [Ψ (1)] C (1)

  5. For i = 1, . . . , R, with R sufficiently large, calculate the matrices Ci as:

                                        Ci = Ψi C0

Identification is completed since all matrices of the structural VMA-X are known.


   For convenience we define the auxiliary variable k = (1 + np + m (q + 1)) as
the total number of regressors. The matrices sizes are as follows: Y is a T × n
matrix, Z a T × k matrix, E a T × n matrix and Γ a k × n matrix.
   Equation (14) is useful because it allows us to represent the VAR-X model as a
multivariate linear regression model, with it the likelihood function is derived. The
parameters can be obtained by maximizing that function or by means of Bayes
theorem.


4.1. The Likelihood Function
   From equation (14) one derives the likelihood function for the error terms.
Since et ∼ N (0, Σ), one has: E ∼ MN (0, Σ ⊗ I), a matricvariate normal distri-
bution with I the identity matrix with dimension T × T . The following box defines
the probability density function for the matricvariate normal distribution.




                                     Revista Colombiana de Estadística 35 (2012) 479–508

486                                            Sergio Ocampo & Norberto Rodríguez


 The Matricvariate Normal Distribution. The probability density function
 of a (p × q) matrix X that follows a matricvariate normal distribution with mean
 Mp×q and covariance matrix Qq×q ⊗ Pp×p (X ∼ MN (M, Q ⊗ P)) is:
                                                 0
                                                                          
                     −1/2                                −1
   MNpdf ∝ |Q ⊗ P|        exp −1/2 [vec (X − M)] (Q ⊗ P) [vec (X − M)]        (15)

 Following Bauwens et al. (2000), the vec operator can be replaced by a trace
 operator (tr):
                                                     0
                −p/2    −q/2
                                                                
     MNpdf ∝ |Q|     |P|     exp −1/2tr Q−1 (X − M) P−1 (X − M)          (16)

 Both representations of the matricvariate normal pdf are useful when dealing with
 the compact representation of the VAR-X model. Note that the equations above
 are only proportional to the actual probability density function. The missing
 constant term has no effects in the estimation procedure.

   Using the definition in the preceding box and applying it to E ∼ MN (O, Σ ⊗ I)
one gets the likelihood function of the VAR-X model, conditioned to the path of
the exogenous variables:
                                 −T/2
                                                      0
                                                           
                      L ∝ |Σ|         exp −1/2tr Σ−1 E E

      From (14) one has E = Y − ZΓ, replacing:
                                                     0
                         −T/2
                                                            
              L ∝ |Σ|         exp −1/2tr Σ−1 (Y − ZΓ) (Y − ZΓ)

Finally, after tedious algebraic manipulation, one gets to the following expression:
                   h −(T −k)                      i
                              /2
           L ∝ |Σ|               exp −1/2tr Σ−1 S
                   
                        −k/2
                                                   0 0          
                                            −1
                    |Σ|      exp   −1/2tr Σ      Γ−Γ Z Z Γ−Γ
                                                    b              b

                 0
                    −1 0                0        
where Γ
      b =        ZZ    Z Y and S = Y − ZΓ
                                        b      Y − ZΓ
                                                    b . It is being assumed
                        0
overall that matrix Z Z is invertible, a condition common to the VAR and OLS
models (see Lütkepohl (2005) section 3.2).
   One last thing is noted, the second factor of the right hand side of the last
expression is proportional to the pdf of a matricvariate normal distribution for Γ,
and the first factor to the pdf of an inverse Wishart distribution for Σ (see the
box below). This allows an exact characterization of the likelihood function as:
                                                               −1 
            L = iWpdf (S, T − k − n − 1) MNpdf Γ,   b Σ ⊗ Z0 Z                 (17)

where iWpdf (S, T − k − n − 1) stands for the pdf of an inverse Wishart distribu-
tion with parameters S and T − k − n − 1.


                                    Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications                487

    The parameters of the VAR-X, Γ and Σ, can be estimated by maximizing
equation (17). It can be shown that the result of the likelihood maximization
gives:
                                Γml = Γ
                                      b              Σml = S
                                                                              0
Sometimes because practical considerations or non-invertibility of Z Z, when no
restrictions are imposed, equation by equation estimation can be implemented (see
Lütkepohl (2005) section 5.4.4).
 The Inverse Wishart Distribution
 If the variable X (a square, positive definite matrix of size q) is distributed
 iW (S, s), with parameter S (also a square, positive definite matrix
                                                                      size q),
                                                                      of
 and s degrees of freedom, then its probability density function iWpdf              is given
 by:
                                     s
                                 |S| 2         −(s+q+1)
                                                        exp −1/2tr X−1 S
                                                                        
           iWpdf (S, s) =       vq
                                       s
                                          |X|    2
                                                                                        (18)
                               2 Γq 2
                                 2



                     q(q−1)
                              q
                                  Γ x + 1−j
                              Q               
 where Γq (x) = π       4
                                         2        is the multivariate Gamma function. It
                              j=1
 is useful to have an expression for the mean and mode of the inverse Wishart
 distribution, these are given by:
                                    S                                S
                Mean (X) =                            Mode (X) =
                                  s−q−1                            s+q+1


4.2. Bayesian Estimation
    If the estimation is carried out by Bayesian methods the problem is to elect an
adequate prior distribution and, by means of Bayes theorem, obtain the posterior
density function of the parameters. The use of Bayesian methods is encouraged
because they allow inference to be done conditional to the sample, and in partic-
ular the sample size, giving a better sense of the uncertainty associated with the
parameters values; allows us not only for the parameters but for their functions
as is the case of the impulse responses, forecast error variance decomposition and
others; it is also particularly useful to obtain a measure of skewness in these func-
tions, specially for the policy implications of the results. As mentioned in Koop
(1992), the use of Bayesian methods gives an exact finite sample density for both
the parameters and their functions.
    The election of the prior is a sensitive issue and will not be discussed in this doc-
ument, we shall restrict our attention to the case of the Jeffrey’s non-informative
prior (Jeffreys 1961) which is widely used in Bayesian studies of vector auto-
regressors. There are usually two reasons for its use. The first one is that informa-
tion about the reduced form parameters of the VAR-X model is scarce and difficult
to translate into an adequate prior distribution. The second is that it might be
the case that the econometrician does not want to include new information to the


                                         Revista Colombiana de Estadística 35 (2012) 479–508

488                                                   Sergio Ocampo & Norberto Rodríguez


estimation, but only wishes to use Bayesian methods for inference purposes. Be-
sides the two reasons already mentioned, the use of the Jeffreys non-informative
prior constitute a computational advantage because it allows a closed form rep-
resentation of the posterior density function, thus allowing us to make draws for
the parameters by direct methods or by the Gibbs sampling algorithm (Geman &
Geman 1984).5
    For a discussion of other usual prior distributions for VAR models we refer
to Kadiyala & Karlsson (1997) and, more recently, to Kociecki (2010) for the
construction of feasible prior distributions over impulse response in a structural
VAR context. When the model is used for forecast purposes the so called Min-
nesota prior is of particular interest, this prior is due to Litterman (1986), and
is generalized in Kadiyala & Karlsson (1997) for allowing symmetry of the prior
across equations. This generalization is recommended and easy to implement the
Bayesian estimation of the model. It should be mentioned that the Minnesota
prior is of little interest in the structural VAR-X context, principally because the
model is conditioned to the path of the exogenous variables, adding difficulties to
the forecasting process.
    In general the Jeffreys Prior for the linear regression parameters correspond to
a constant for the parameters in Γ and for the covariance matrix a function of the
            −(n+1)
form: |Σ| 2 , where n represents the size of the covariance matrix. The prior
distribution to be used is then:
                                                      −(n+1)
                                  P (Γ, Σ) = C |Σ|      2
                                                                                           (19)

where C is the integrating constant of the distribution. Its actual value will be of
no interest.
      The posterior is obtained from Bayes theorem as:

                                            L (Y, Z | Γ, Σ) P (Γ, Σ)
                       π (Γ, Σ | Y, Z) =                                                   (20)
                                                     m (Y)

where π (Γ, Σ | Y, Z) is the posterior distribution of the parameters given the data,
L (Y, Z | Γ, Σ) is the likelihood function, P (Γ, Σ) is the prior distribution of the
parameters and m (Y) the marginal density of the model. The value and use of
the marginal density is discussed in Section 4.2.1.
   Combining equations (17), (19) and (20) one gets an exact representation of
the posterior function as the product of the pdf of an inverse Wishart distribution
and the pdf of a matricvariate normal distribution:
                                                               0 −1 
         π (Γ, Σ | Y, Z) = iWpdf (S, T − k) MNpdf Γ, Σ ⊗ Z Z
                                                        b                      (21)


   Equation (21) implies that Σ follows an inverse Wishart distribution with
parameters S and T − k, and that the distribution of Γ given Σ is matricvariate
   5 For an introduction to the use of the Gibbs sampling algorithm we refer to Casella & George

(1992).


                                         Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications          489

Algorithm 3 Bayesian Estimation

  1. Select the specification for the reduced form VAR-X, that is to chose values
     of p (endogenous variables lags) and q (exogenous variables lags) such that
     the residuals of the VAR-X (e) have white noise properties. With this the
     following variables are obtained: T, p, q, k, where:

                                k = 1 + np + m (q + 1)

  2. Calculate the values of Γ̂, S with the data (Y, Z) as:
                     0 −1 0                         0        
                Γ̂ = Z Z   ZY               S = Y − ZΓ̂    Y − ZΓ̂

  3. Generate a draw for matrix Σ from an inverse Wishart distribution with
     parameter S and T − k degrees of freedom.

                                 Σ ∼ iWpdf (S, T − k)

  4. Generate a draw for matrix Γ from amatricvariate
                                            −1        normal distribution with
                                          0
     mean Γ̂ and covariance matrix Σ ⊗ Z Z      .
                                             0 −1 
                          Γ|Σ ∼ MNpdf Γ̂, Σ ⊗ Z Z


  5. Repeat steps 2-3 as many times as desired, save the values of each draw.

The draws generated can be used to compute moments of the parameters. For
every draw the corresponding structural parameters, impulse responses functions,
etc. can be computed, then, their moments and statistics can also be computed.
The algorithms for generating draws for the inverse Wishart and matricvariate
normal distributions are presented in Bauwens et al. (2000), Appendix B.

                                                     −1
normal with mean Γ  b and covariance matrix Σ ⊗ Z0 Z      . The following two
equations formalize the former statement:
                                                                     −1 
 Σ | Y, Z ∼ iWpdf (S, T − k)          Γ | Σ, Y, Z ∼ MNpdf Γ,b Σ ⊗ Z0 Z


    Although further work can be done to obtain the unconditional distribution of
Γ it is not necessary to do so. Because equation (21) is an exact representation
of the parameters distribution function, it can be used to generate draws of them,
moreover it can be used to compute any moment or statistic of interest, this can
be done by means of the Gibbs sampling algorithm.



                                   Revista Colombiana de Estadística 35 (2012) 479–508

490                                                   Sergio Ocampo & Norberto Rodríguez


4.2.1. Marginal Densities and Lag Structure

    The marginal density (m (Y)) can be easily obtained under the Jeffreys prior
and can be used afterward for purposes of model comparison. The marginal density
gives the probability that the data is generated by a particular model, eliminating
the uncertainty due to the parameters values. Because of this m (Y) is often
used for model comparison by means of the Bayes factor (BF): the ratio between
the marginal densities of two different models that explain the same set of data
(BF12 = m(Y |M1 )/m(Y|M2 )). If the Bayes factor is bigger than one then the first
model (M1 ) would be preferred.
  From Bayes theorem (equation 20) the marginal density of the data, given the
model, is:
                                   L (Y, Z|Γ, Σ) P (Γ, Σ)
                         m (Y) =                                                    (22)
                                       π (Γ, Σ|Y, Z)

its value is obtained by replacing for the actual forms of the likelihood, prior and
posterior functions (equations 17, 19 and 21 respectively):

                                      T −k
                                              
                                 Γn     2
                                                 −n−1 n(n+1)
                    m (Y) =        T −k−n−1
                                             |S| 2 2 2 C                           (23)
                              Γn        2


    Although the exact value of the marginal density for a given model cannot be
known without the constant C, this is no crucial for model comparison if the only
difference between the models is in their lag structure. In that case the constant
C is the same for both models, and the difference between the marginal density of
one specification or another
                                              first two factors of the right hand
                              arises only in the
                         Γn ( T −k
                                2 )
                                         −n−1
side of equation (23) Γ T −k−n−1 |S| 2 . When computing the Bayes factor
                        n(      2   )
for any pair of models the result will be given by those factors alone.
   The Bayes factor between a model, M1 , with k1 regressors and residual covari-
ance matrix S1 , and another model, M2 , with k2 regressors and residual covariance
matrix S2 , can be reduced to:

                                         T −k1
                                      Γn (        )               −n−1
                                           2
                                      T −k1 −n−1          |S1 |    2
                                   Γn (    2          )
                          BF12 =         T −k2                                      (24)
                                     Γn   (       )               −n−1
                                           2
                                      T −k2 −n−1          |S2 |    2
                                   Γn (    2          )



5. Applications
    There are several applications for the structural VAR-X, all of them useful for
policy analysis. In this Section four of those applications are covered, they all use
the structural VMA-X representation of the model (equation 4).

                                      Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications                 491

5.1. Impulse Response Functions (IRF), Multiplier
     Analysis (MA), and Forecast Error Variance
     Decomposition (FEVD)
    Impulse response functions (IRF) and multiplier analysis (MA) can be con-
structed from the matrices in C (L) and Λ (L). The IRF shows the endogenous
variables response to a unitary change in a structural shock, in an analogous way
the MA shows the response to a change in an exogenous variable. The construc-
tion is simple and is based on the interpretations of the elements of the matrices
in C (L) and Λ (L).
    For the construction of the IRF consider matrix Ch . The elements of this
matrix measure the effect of the structural shocks over the endogenous variables
h periods ahead, thus cij  h (i-throw, j-th column) measures the response of the i-th
variable to a unitary change in the j-th shock h periods ahead. The IRF for the
i-th variable to a change in j-th shock is constructed by collecting elements cij
                                                                               h for
h = 0, 1, . . . , H, with H the IRF horizon.
    Matrices Ch are obtained from the reduced form parameters according to the
type of identification (Section 3). For a more detailed discussion on the construc-
tion and properties of the IRF we refer to Lütkepohl (2005), Section 2.3.2.
   The MA is obtained similarly from matrices Λh , which are also a function of
the reduced form parameters.6 The interpretation is the same as before.
    A number of methods for inference over the IRF and MA are available. If
the estimation is carried out by classical methods intervals for the IRF and MA
can be computed by means of their asymptotic distributions or by bootstrapping
methods.7 Nevertheless, because the OLS estimators are biased, as proved in
Nicholls & Pope (1988), the intervals that arise from both asymptotic theory and
usual bootstrapping methods are also biased. As pointed out by Kilian (1998)
this makes it necessary to conduct the inference over IRF, and in this case over
MA, correcting the bias and allowing for skewness in the intervals. Skewness is
common in the small sample distributions of the IRF and MA and arises from
the non-linearity of the function that maps the reduced form parameters to the
IRF or MA. A double bootstrapping method that effectively corrects the bias and
accounts for the skewness in the intervals is proposed in Kilian (1998).
    In the context of Bayesian estimation, it is noted that, applying Algorithm 1 or
2 for each draw of the reduced form parameters (Algorithm 3), the distribution for
each cij        ij
       h and λh is obtained. With the distribution function inference can be done
over the point estimate of the IRF and MA. For instance, standard deviations in
each horizon can be computed, as well as asymmetry measures and credible sets
(or intervals), the Bayesian analogue to a classical confidence interval.
   In the following we shall restrict our attention to credible sets with mini-
mum size (length), these are named Highest Posterior Density regions (HPD
from now on). An (1 − α) % HPD for the parameter θ is defined as the set I =
  6 See Lütkepohl (2005), Section 10.6.
   7 The asymptotic distribution of the IRF and FEVD for a VAR is presented in Lütkepohl

(1990). A widely used non-parametric bootstrapping method is developed in Runkle (1987).


                                          Revista Colombiana de Estadística 35 (2012) 479–508

492                                                   Sergio Ocampo & Norberto Rodríguez


R ∈ Θ : π ( /Y) ≥ k(α)},
{θ            θ             where k(α) is the largest constant satisfying P (I|y) =
   π (θ/Y ) dθ ≥ 1−α.8 From the definition just given, is clear that HPD regions are
 θ
of minimum size and that each value of θ ∈ I has a higher density (probability)
than any value of θ outside the HPD. The second property makes possible direct
probability statements about the likelihood of θ falling in I, i.e., “The probability
that θ lies in I given the observed data Y is at least (1 − α)%”, this contrast with
the interpretation of the classical confidence intervals. An HPD region can be
disjoint if the posterior density function (π (θ/Y)) is multimodal. If the posterior
is symmetric, all HPD regions will be symmetric about posterior mode (mean).
    Koop (1992) presents a detailed revision of how to apply Bayesian inference
to the IRF in a structural VAR context, his results can be easily adapted to the
structural VAR-X model. Another reference on the inference over IRF is Sims &
Zha (1999). Here we present, in Algorithm 4, the method of Chen & Shao (1998)
for computing HPD regions from the output of the Gibbs sampler.9
    It is important to note that Bayesian methods are by nature conditioned to
the sample size and, because of that, avoid the problems of asymptotic theory in
explaining the finite sample properties of the parameters functions, this includes
the skewness of the IRF and MA distribution functions. Then, if the intervals
are computed with the HPD, as in Chen & Shao (1998), they would be taking
into account the asymmetry in the same way as Kilian’s method. This is not the
case for intervals computed using only standard deviations although, with them,
skewness can be addressed as in Koop (1992), although bootstrap methods can be
used to calculate approximate measures of this and others moments, for instance,
skewness and kurtosis, Bayesian methods are preferable since exact measures can
be calculated.
    Another application of the structural VAR-X model is the forecast error vari-
ance decomposition (FEVD), this is no different to the one usually presented in the
structural VAR model. FEVD consists in decomposing the variance of the forecast
error of each endogenous variable h periods ahead, as with the IRF, the matrices
of C (L) are used for its construction. Note that, since the model is conditioned to
the path of the exogenous variables, all of the forecast error variance is explained
by the structural shocks. Is because of this that the FEVD has no changes when
applied in the structural VAR-X model. We refer to Lütkepohl (2005), Section
2.3.3, for the details of the construction of the FEVD. Again, if Bayesian methods
are used for the estimation of the VAR-X parameters, the density function of the
FEVD can be obtained and several features of it can be explored, Koop (1992)
also presents how to apply Bayesian inference in this respect.




   8 Integration can be replaced by summation if θ is discrete.
  9 The method presented is only valid if the distribution of the parameters of interest is uni-

modal. For a more general treatment of the highest posterior density regions, including multi-
modal distributions, we refer to the work of Hyndman (1996).


                                          Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications             493

Algorithm 4 Highest Posterior Density Regions
                                  
As in Chen & Shao (1998), let θ(i) , i = 1 , . . . , N be an ergodic sample of
π (θ/Y), the posterior density function of parameter θ. π (θ/Y) is assumed to be
unimodal. The (1 − α) % HPD is computed as follows:

  1. Sort the values of θ(i) . Define θ(j) as the j − th larger draw of the sample,
     so that:
                                 n o                               n o
               θ(1) = min          θ(i)           θ(N ) = max       θ(i)
                       i∈{1,...,N }                        i∈{1,...,N }


  2. Define N = b(1 − α) N c the integer part of (1 − α) N . The HPD will contain
     N values of θ.
                                 
  3. Define I(j) = θ(j) , θ(j+N ) an interval in the domain of the parameter θ,
            
     for j 1, . . . , N − N . Note that although I(j) contains always N draws of
     θ, its size may vary.
  4. The HPD is obtained as the interval I(j) with minimum size. HPD (α) =
     I(j ? ) , with j ? such that:
                                                                               
                        θ(j ? +N ) − θ(j ? ) =      min          θ(j+N ) − θ(j)
                                               j∈{1,...,N −N }




5.2. Historical Decomposition of the Endogenous Variables
     (HD)

    The historical decomposition (HD) consists in explaining the observed values
of the endogenous variables in terms of the structural shocks and the path of the
exogenous variables. This kind of exercise is present in the DSGE literature (for
example, in Smets & Wouters (2007)) but mostly absent in the structural VAR
literature. There are nonotheless various exceptions, an early example is the work
of Burbidge & Harrison (1985) on the role of money in the great depression, there
is also the textbook by Canova (2007), and the paper of King & Morley (2007),
where the historical decomposition of a structural VAR is used for computing a
measure of the natural rate of unemployment for the US.
    Unlike the applications already presented, the historical decomposition allows
us to make a statement over what has actually happened to the series in the sample
period, in terms of the recovered values for the structural shocks and the observed
paths of the exogenous variables. It allows us to have all shocks and exogenous
variables acting simultaneously, thus making possible the comparison over the
relative effects of them over the endogenous variables, this means that the HD
is particularly useful when addressing the relative importance of the shocks over
some sets of variables. The possibility of explaining the history of the endogenous


                                      Revista Colombiana de Estadística 35 (2012) 479–508

494                                                Sergio Ocampo & Norberto Rodríguez


variables instead of what would happen if some hypothetical shock arrives in the
absence of any other disturbance is at least appealing.
    Here we describe a method for computing the HD in a structural VAR and
structural VAR-X context. The first case is covered in more detail and the second
presented as an extension of the basic ideas.

5.2.1. Historical Decomposition for a Structural VAR Model

    In a structural VAR context it is clear, from the structural VMA representation
of the model, that variations of the endogenous variables can only be explained
by variations in the structural shocks. The HD uses the structural VMA repre-
sentation in order to compute what the path of each endogenous variable would
have been conditioned to the presence of only one of the structural shocks. It is
important to note that the interpretation of the HD in a stable VAR model is
simpler than the interpretation in a VAR-X. This is because in the former there
is no need for a reference value that indicates when a shock is influencing the
path of the variables. In that case, the reference value is naturally zero, and it
is understood that deviations of the shocks below that value are interpreted as
negative shocks and deviations above as positive shocks. As we shall see, when
dealing with exogenous variables a reference value must be set, and its election is
not necessarily “natural”.
    Before the HD is computed it is necessary to recover the structural shocks
                                                                                  0
from the estimation of the reduced form VAR. Define E b = [b         et . . . b
                                                            e1 . . . b        eT ] as the
matrix of all fitted residuals from the VAR model (equation (14) in the absence
of exogenous variables). Recalling equation (9), the matrix C0 can be used to
recover the structural shocks from matrix E
                                          b as in the following expression:
                                            −1
                                         b C0
                                    Eb = E                                            (25)
                                             0


     Because zero      0
                          is the reference value for the structural shocks the matrix Eb =
 1 . . . b
[b                 T ] can be used directly for the HD.
          t . . . b
    The HD is an in-sample exercise, thus is conditioned to the initial values of
the series. It will be useful to define the structural infinite VMA representation of
the VAR model, as well as the structural VMA representation conditional on the
initial values of the endogenous variables, equations (26) and (27) respectively.

                                 yt = µ + C (L) t                                    (26)
                                        t−1
                                        X
                                 yt =       Ci t−i + Kt                              (27)
                                        i=0


    Note that in equation (26) the endogenous variables depend on an infinite
number of past structural shocks. In equation (27) the effect of all shocks that are
realized previous to the sample is captured by the initial values of the endogenous
variables. The variable Kt is a function of those initial values and of the parameters


                                        Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications              495
                                                        
of the reduced form model, Kt = ft y0 , . . . , y−(p−1) . It measures the effect of
the initial values over the period t realization of the endogenous variables, thus
the effect of all shocks that occurred before the sample. It is clear that if the VAR
is stable Kt −→ µ when t increases, this is because the shocks that are too far in
the past have no effect in the current value of the variables. Kt will be refer to as
the reference value of the historical decomposition.
    Starting from the structural VMA representation, the objective is now to de-
compose the deviations of yt from Kt into the effects of the current and past values
of the structural shocks (i for i from 1 to t). The decomposition is made over the
                                     t−1
                                      P
                   et = yt − Kt =
auxiliary variable y                    Ci t−i . The information needed to compute
                                      i=0
et is contained in the first t matrices Ci and the first t rows of matrix E.
y                                                                         b
                                                         et into the j-th shock is
    The historical decomposition of the i-th variable of y
given by:
                                         t−1
                                 (i,j)
                                         X
                               yet     =     cij
                                              i bjt−i                        (28)
                                             i=0

    Note that it must hold that the sum over j is equal to the actual value of the
                            n
                                (i,j)                                          (i,j)
                et , yeti =
                            P
i-th element of y             yet . When t increases, when Kt is close to µ, yet
                           j=1
can be interpreted as the deviation of the i-th endogenous variable from its mean
caused by the recovered sequence for the j-th structural shock.
   Finally, the endogenous variables can be decomposed as well. The historical
decomposition for the i-th endogenous variable into the j-th shock is given by:
                                                             t−1
                       (i,j)             (i,j)
                                                             X
                     yt        = Kti + yet       =   Kti +       cij
                                                                  i bjt−i           (29)
                                                             i=0

                   (i,j)
the new variable yt     is interpreted as what the i-th endogenous variable would
have been if only realizations of the j-th shock had occurred. The value of Kt can
be obtained as a residual of the historical decomposition, since yt is known and
y
et can be computed from the sum of the HD or from the definition.
                                                 (i,j)
    The HD of the endogenous variables (yt ) can be also used to compute what
transformations of the variables would have been conditioned to the presence of
only one shock. For instance, if the i-th variable enters the model in quarterly
differences, the HD for the annual differences or the level of the series can be com-
                        (i,j)
puted by applying to yt       the same transformation used over yti , in this example,
a cumulative sum. Algorithm 5 summarizes the steps carried out for the historical
decomposition.


5.2.2. Historical Decomposition for a Structural VAR-X Model

    The structure already described applies also for a VAR-X model. The main dif-
ference is that now it is necessary to determine a reference value for the exogenous


                                       Revista Colombiana de Estadística 35 (2012) 479–508

496                                                        Sergio Ocampo & Norberto Rodríguez

Algorithm 5 Historical Decomposition for a Structural VAR Model

   1. Estimate the parameters of the reduced form VAR.
                                                                                 0
                                                                                  
       a) Save a matrix with all fitted residuals Ê = [ê1 . . . êt . . . êT ] .
        b) Compute matrices Ci according to the identifying restrictions (Algo-
            rithm 1 or 2).
                                                                      0
                                                                       
   2. Compute the structural shocks Ê = [ˆ   1 . . . ˆt . . . ˆT ] with matrix C0 and
      the fitted residuals of the reduced form VAR:
                                              0 −1
                                      Ê = Ê C0

   3. Compute the historical decomposition of the endogenous variables relative
      to Kt :
                                           t−1
                                   (i,j)
                                           X
                                 ỹt     =     cij
                                                i ˆjt−i
                                                     i=0

   4. Recover the values of Kt with the observed values of yt and the auxiliary
      variable ỹt :
                                    Kt = yt − ỹt

   5. Compute the historical decomposition of the endogenous variables:
                                          (i,j)               (i,j)
                                         yt       = Kti + ỹt

Steps 3 and 5 are repeated for t = 1, 2, . . . , T , i = 1, . . . , n and j = 1, . . . , n. Step
4 is repeated for t = 1, 2, . . . , T .


variables.10 It shall be shown that realizations of the exogenous variables different
to this value are what explain the fluctuations of the endogenous variables. We
shall refer to xt as the reference value for the exogenous variables in t.
    As before, it is necessary to present the structural VMA-X representation con-
ditional to the initial values of the endogenous variables (equation 30), with Kt
defined as above. It is also necessary to express the exogenous variables as devia-
tions of the reference value, for this we define an auxiliary variable xe t = xt − xt .
Note that equation (30) can be written in terms of the new variable x        et as in
                                                          t−1
                                                          P
equation (31). In the latter, the new variable K   et =      Λi x̄t−i + Kt has a role
                                                                      i=0

   10 The reference value for the exogenous variables need not be a constant. It can be given by

a linear trend, by the sample mean of the series, or by the initial value. When the exogenous
variables enter the model in their differences, it may seem natural to think in zero as a natural
reference value, identifying fluctuations of the exogenous variables in an analogous way to what
is done with the structural shocks.


                                          Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications                        497

analogous to that of Kt in the VAR context. K e t properties depend on those of x̄t
and, therefore, it can not be guaranteed that it converges to any value.
                                        t−1
                                        X                   t−1
                                                            X
                              yt =            Ci t−i +            Λi xt−i + Kt                (30)
                                        i=0                  i=0
                                        t−1
                                        X                   t−1
                                                            X
                              yt =            Ci t−i +               et−i + K
                                                                   Λi x      et                (31)
                                        i=0                  i=0


    The historical decomposition is now computed using matrices Ci , the recovered
matrix of structural shocks E, b matrices Λi and the auxiliary variables xei , for i from
1 to T . Matrix E is still computed as in equation (25). The new reference value
                  b
for the historical decomposition is K   e t , and the decomposition is done to explain
the deviations of the endogenous variables with respect to it as a function of
the structural shocks and deviations of the exogenous variables from their own
reference value, x̄t . For notational simplicity, variable xet is redefined: ye t = yt −
       t−1
        P             t−1
                      P
Ket =     Ci t−i +          et−i . The decomposition of the i-th variable of y
                          Λi x                                                    et into
       i=0              i=0
the j-th shock is still given by equation (28), and the decomposition into the k-th
exogenous variable is given by:
                                                          t−1
                                              (i,k)
                                                          X
                                          yet         =       λik
                                                               i xekt−i                        (32)
                                                          i=0

               (i,k)
   Variable yet , for k from 1 to m, is interpreted as what the variable yeti would
have been if, in the absence of shocks, only the k-th exogenous variable is allowed
to deviate from its reference value. As in the VAR model, the following equation
               n           m
                   (i,j)       (i,k)
holds: yei =
              P            P
         t       ye t    +   ye     t. The variable K
                                                    e t is recovered in the same way
              j=1             k=1
used before to recover Kt .
   The historical decomposition of the endogenous variables can be computed by
using the recovered values for K   e t . The decomposition of the i-th variable into
                                                                                     e ti .
the effects of the j-th shock is still given by equation (29), if Kti is replaced by K
The decomposition of the i-th variable into the deviations of the k-th exogenous
variable from its reference value is obtained from the following expression:
                                              (i,k)                 (i,k)
                                          yt          = Kti + yet                              (33)

               (i,k)                                                        (i,k)
   Variable yt   has the same interpretation as yet   but applied to the value of
the endogenous variable, and not to the deviation from the reference value.
    Although the interpretation and use of the HD in exogenous variables may seem
strange and impractical, it is actually of great utility when the reference value for
the exogenous variables is chosen correctly. The following example describes a
case in which the interpretation of the HD in exogenous variables is more easily
understood. Consider the case in which the exogenous variables are introduced in

                                                 Revista Colombiana de Estadística 35 (2012) 479–508

498                                                     Sergio Ocampo & Norberto Rodríguez

Algorithm 6 Historical Decomposition for a Structural VAR-X Model

   1. Estimate the parameters of the reduced form VAR-X.
                                                                                 0
                                                                                  
       a) Save a matrix with all fitted residuals Ê = [ê1 . . . êt . . . êT ] .
        b) Compute matrices Ci and Λi according to the identifying restrictions
            (Algorithm 1 or 2).
                                                                      0
                                                                       
   2. Compute the structural shocks Ê = [ˆ   1 . . . ˆt . . . ˆT ] with matrix C0 and
      the fitted residuals of the reduced form VAR-X:
                                              0 −1
                                      Ê = Ê C0

   3. Compute the historical decomposition of the endogenous variables relative
      to K̃t :
                                     t−1                                t−1
                         (i,j)                             (i,k)
                                     X                                  X
                       ỹt       =       cij
                                          i ˆjt−i        ỹt       =       λik  k
                                                                             i x̃t−i
                                     i=0                                i=0


   4. Recover the values of K̃t with the observed values of yt and the auxiliary
      variable ỹt :
                                     K̃t = yt − ỹt

   5. Compute the historical decomposition of the endogenous variables:
                        (i,j)                (i,j)          (i,k)               (i,k)
                       yt        = K̃ti + ỹt              yt       = K̃ti + ỹt

Steps 3 and 5 are repeated for t = 1, 2, . . . , T , i = 1, . . . , n , j = 1, . . . , n and
k = 1, . . . , m. Step 4 is repeated for t = 1, 2, . . . , T .


the model in their first differences. The person performing the study may be asking
themselves the effects of the shocks and the changes in the exogenous variables
over the endogenous variables. In this context, the criteria or reference value for
the exogenous variables arises naturally as a base scenario of no change in the
exogenous variables and no shocks. Under the described situation one has, for all
t, xt = 0 and Ke t = Kt . This also allows us to interpret both y (i,k) and ye(i,k) as
                                                                   t          t
what would have happened to the i-th endogenous variable if it were only for the
changes of the k-th exogenous variable.
    Algorithm 6 summarizes the steps carried out for the historical decomposition
in a structural VAR-X setup.




                                             Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications                  499

6. An Example
   In this section some of the concepts presented in the document are exemplified
by an application of Galí’s (1999) structural VAR, augmented with oil prices as
an exogenous variable. The exercise is for illustrative purposes only and does not
mean to make any assessment of the economics involved.
   The Section is organized as follows: first a description of the model to be
used is made, then the lag structure of the reduced form VAR-X is chosen and
the estimation described. Finally, impulse response functions, multiplier analysis
and the historical decomposition are presented for one of the model’s endogenous
variables.


6.1. The Model and the Data
    The model used in this application is original from Galí (1999) and is a bi-
variate system of labor productivity and a labor measure.11 The labor produc-
tivity is defined as the ratio between gross domestic product (GDP) and labor.
The identification of the shocks is obtained by imposing long run restrictions as
demonstrated by Blanchard & Quah (1989). Two shocks are identified, a technol-
ogy (productivity) shock and a non-technology shock, the former is assumed to be
the only shock that can have long run effects on the labor productivity. As pointed
out in Galí (1999) this assumption is standard in neoclassical growth, RBC and
New-Keynesian models among others.
    The model is augmented with oil prices as an exogenous variable with the
only purpose of turning it into a structural VAR-X model, so that it can be used
to illustrate some of the concepts of the document. As mentioned in Section 3
the presence of an exogenous variable does not change the identification of the
structural shocks.
    All variables are included in the model in their first differences, this is done
partially as a condition for the long run identification (labor productivity) and
partially because of the unit root behavior of the observed series. It should be
clear that, in the notation of the document, n = 2 (the number of endogenous
variables) and m = 1 (the number of exogenous variables).
   Noting by zt the labor productivity, lt the labor measure and pot the oil price,
the reduced form representation of the model is given by equation (1) with yt =
           0
  ∆zt ∆lt      and xt = ∆pot :

           yt = v + B1 yt−1 + . . . + Bp yt−p + Θ0 xt + . . . + Θq xt−q + et

    In the last equation vector v is of size 2 × 1, matrices Bi are of size 2 × 2 for
i = 1 : p and all Θj are 2 × 1 vectors. The structural VMA-X form of the model
is given (as in equation (4)) by:
  11 Galí uses total hours worked in the non-farm sector as labor measure in the main exercise

but also points at the number of employees as another possible labor measure, here we take the
second option and use non-farm employees.


                                        Revista Colombiana de Estadística 35 (2012) 479–508

500                                                  Sergio Ocampo & Norberto Rodríguez



                               yt = µ + C (L) t + Λ (L) xt
with µ a 2 × 1 vector, each matrix
                                 of C (L) is of size 2 × 2, and the “coefficients”
of Λ (L) are 2 × 1 vectors. t = Tt N
                                      t
                                        T     is the vector of structural shocks.
    The identification assumption implies that C (1) is a lower triangular matrix,
this allows us to use algorithm 2 for the identification of the shocks and the matrices
in C (L). Equations (5), (6) and (7) still hold.
   The data set used to estimate the model consists in quarterly GDP, non-farm
employees and oil price series for the US economy that range from 1948Q4 to
1999Q1. The quarterly GDP is obtained from the Bureau of Economic Analysis,
and the non-farm employees and oil price from the FRED database of the Federal
Reserve Bank of St. Louis. GDP and non-farm employees are seasonally adjusted.
GDP is measured in billions of chained 2005 dollars, non-farm employees in thou-
sands of people and oil prices as the quarterly average of the WTI price in dollars
per barrel.


6.2. Lag Structure and Estimation
    Choosing the lag structure of the model consists in finding values for p and q so
that the estimated reduced form model satisfies some conditions. In this case we
shall choose values for p and q so that the residuals (et ) are not auto-correlated.12
The tests indicate that four lags of the endogenous variables are necessary for
obtaining non-auto-correlated residuals (p = 4), this result is independent of the
lags of the exogenous variable. The change of the oil prices can be included only
contemporary (q = 0) or with up to six lags (q = 6).
    Since any number of lags of the exogenous variables makes the residuals satisfy
the desired condition, the marginal density of the different models (under the
Jeffreys prior) is used to determined the value of q. Each possible model only
differs in the lags of exogenous variable, there are seven models indexed as Mi (Y)
with i = 0 . . . 6. The marginal density for each model is computed as in equation
(23):
                                  Γn T −k
                                             
                                           i          −n−1 n(n+1)
                                         2
                     Mi (Y) =       T −ki −n−1
                                                |Si | 2 2 2 C
                               Γn        2

    A presample is taken so that all models have the same effective T , since all
have the same number of endogenous variables (n = 2), the only difference between
the marginal density of two models is in ki (the total number of regressors) and
Si (the estimated covariance of the residuals). Recalling from Section 4: ki =
                                         0           
(1 + np + m (qi + 1)) and Si = Y − Zi Γbi      Y − Zi Γ
                                                      bi .

  Table 1 presents the results of the marginal densities, it is clear that the
marginal density does not increase monotonically in the exogenous lag and that
  12 The auto-correlation of the residual is tested with Portmanteau tests at a 5% significance

level. See Lütkepohl (2005), Section 4.4.3.


                                         Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications                        501

M4 (Y) (q = 4) is preferred to the other models. Then, the VAR-X model is es-
timated with four lags in both the endogenous and the exogenous variables, and
the contemporary value of the change in the oil price.

                               Table 1: Marginal Densities.
    M0 (Y)       M1 (Y)       M2 (Y)        M3 (Y)       M4 (Y)       M5 (Y)        M6 (Y)
    6.1379       6.1268       6.1664        6.1817       6.2414       6.1733        6.1115
    The values presented are proportional to the marginal densities of the models by a factor
    of 1013 C.


    The estimation is carried out by Bayesian methods under the Jeffreys prior as
in Section 4.2. Algorithm 3 is applied to obtain 10,000 draws of the reduced form
parameters, for every draw Algorithm 2 is applied, along with the identification
restriction over the technology shock, to obtain the parameters of the structural
VMA-X representation of the model.


6.3. Impulse Response Functions and Multiplier Analysis
    From the output of the Bayesian estimation of the model the impulse response
function and multipliers are computed. Note that the distributions of the IRF
and the multipliers are available since the estimation allows us to obtain both for
each draw of the reduced form parameters. This makes it possible to compute
highest posterior density regions (HPD) as mentioned in Section 5.1. For doing so
we presented, in Algorithm 4, the steps to be carried out in the case in which the
distribution of the IRF and the multipliers in every period is unimodal. Here we
present only the response of labor to a technology shock and a change in oil price
as the posterior mean of the responses generated for each of the 10,000 draws of
the parameters, the responses are presented along with HPD regions at 68% and
90% probability.
    Before presenting the HPD for the IRF and the multipliers, it is necessary
to check if the distribution of the responses in every period are unimodal. Al-
though no sufficient, a preliminary test of the mentioned condition is to check the
histograms of the IRF and the multipliers before computing the HPD. Figure 1
presents the histograms for the response of labor to a technology shock (Figure
1(a)) and to a change in oil price (Figure 1(b)) at impact, the histograms for up
to 20 periods ahead are also checked, but not presented. In all cases Algorithm 4
can be used.
    The results are presented in Figure 2 and point to a decrease of labor in response
to both a positive technology shock and an increase in oil prices, although the
decrease is only significant for the response to a technology shock. The response
of labor to an increase in the oil price is never significant at 90% probability and
only significant at 68% probability after period 5.




                                          Revista Colombiana de Estadística 35 (2012) 479–508

502                                                                                                                                                                Sergio Ocampo & Norberto Rodríguez

                                         350                                                                                                         350



                                         300                                                                                                         300



                                         250                                                                                                         250



                                         200                                                                                                         200
                             Frequency




                                                                                                                                   Frequency
                                         150                                                                                                         150



                                         100                                                                                                         100



                                          50                                                                                                          50



                                              0                                                                                                       0
                                              −3              −2.5           −2                −1.5          −1          −0.5                        −0.02           −0.015   −0.01       −0.005           0        0.005        0.01        0.015
                                                                             Labor (Dev. from mean)                       −3
                                                                                                                       x 10                                                               Labor (Dev. from mean)



                                         (a) IRF: Labor to tech shock at impact                                                                            (b) MA: Labor to oil price at impact

Histograms of the response of labor to a technology shock and a change in the oil price at impact. The
histograms are obtained from 10000 draws of the parameters of the structural VAR-X model, and are
computed with 100 bins.
                                                                                                           Figure 1: Histograms.


                                         −3
                         x 10
                    0                                                                                                                                 0.02


                  −0.5                                                                                                                                0.01


                   −1                                                                                                                                      0


                  −1.5                                                                                                                               −0.01
Log(Employment)




                                                                                                                                   Log(Employment)




                   −2                                                                                                                                −0.02


                  −2.5                                                                                                                               −0.03


                   −3                                                                                                                                −0.04


                  −3.5                                                                                                                               −0.05


                   −4                                                                                                                                −0.06


                  −4.5                                                                                                                               −0.07
                         0                         2      4          6   8       10         12        14    16    18          20                               0       2      4       6          8       10        12       14          16     18    20
                                                                               Quarters                                                                                                                Quarters


                                                       (a) IRF: Labor to tech shock                                                                                (b) MA: Labor to oil price at impact

Response of labor to a unitary technology shock and a unit change in the oil price. The point estimate
(dark line) corresponds to the posterior mean of the distribution of the IRF and the multipliers of
labor, the distributions are obtained from 10000 draws of the parameters of the structural VAR-X
model. HPD regions at 68% and 90% probability are presented as dark and light areas correspondingly.

                                                              Figure 2: Impuse Response Functions and Multiples Analysis.




6.4. Historical Decomposition
    Finally, the historical decomposition of labor into the two structural shocks
and the changes in the oil price is computed. As mentioned, in Section 5.2 it
is necessary to fix a reference value for the exogenous variable. Since the oil
price enters the model in its first difference, the reference value will be set to
zero (∀t xt = 0). This means that all changes in the oil price are understood by

                                                                                                                  Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications                                    503

the model as innovations to that variable.13 In this exercise all computations are
carried out with the posterior mean of the parameters. Since the Jeffreys prior
was used in the estimation, the posterior mean of the parameters equals their
maximum likelihood values.
    Applying Algorithm 6, steps 1 to 3, the historical decomposition for the first
difference of labor (relative to K
                                 e t ) is obtained, this is presented in Figure 3. Yet,
the results are unsatisfactory, principally because the quarterly difference of labor
lacks a clear interpretation, its scale is not the one commonly used and might be
too volatile for allowing an easy understanding of the effects of the shocks.14

                                            2


                                           1.5


                                            1


                                           0.5
                      Percentage Points




                                            0


                                          −0.5


                                           −1


                                          −1.5


                                           −2


                                          −2.5
                                                 1960            1970              1980      1990
                                                                        Quarters
                                                        Tech Shock       No−Tech Shock    Oil Price

              Figure 3: Historical Decomposition - Labor in first difference


    An alternative to the direct historical decomposition is to use the conditioned
series (step 5 of Algorithm 6) to compute the historical decomposition of the an-
nual differences of the series, this is done by summing up the quarterly differences
conditioned to each shock and the exogenous variable. The advantage of this
transformation is that it allows for an easier interpretation of the historical de-
composition, since the series is now less volatile and its level is more familiar for the
researcher (this is the case of the annual inflation rate or the annual GDP growth
rate). The result is presented in Figure 4, it is clear that labor dynamics have been
governed mostly by non-technology shocks in the period under consideration, with
technology shocks and changes in the oil price having a minor effect.
     It is worth noting that decomposing the first difference of the series (as in
Figures 3 and 4) has another advantage. The decomposition is made relative to
Ke t with xt = 0, hence Ke t = Kt and K e t −→ µ, this means, for Figure 3, that the
decomposition is made relative to the sample average of the quarterly growth rate
of the series, in that case if the black solid line is, for example, 0.1 at some point
it can be read directly as the growth rate of labor being 10% above its sample
  13 Another possibility is to use the sample mean of the change in the oil price as a reference

value, in this case the innovations are changes of the oil price different to that mean.
  14 In fact the series used is not too volatile, but there are other economically relevant series

whose first difference is just too volatile for allowing any assessment on the results, the monthly
inflation rate is usually an example of this.


                                                             Revista Colombiana de Estadística 35 (2012) 479–508

504                                                                             Sergio Ocampo & Norberto Rodríguez


average. Since Figure 4 is also presenting differences it can be shown that the new
Ke t converges to the sample mean of the annual growth rate of the series, making
interpretation of the decomposition easier to read.

                                         6



                                         4



                                         2



                    Percentage Points    0



                                        −2



                                        −4



                                        −6



                                        −8
                                             1960            1970              1980      1990
                                                                    Quarters
                                                    Tech Shock       No−Tech Shock    Oil Price

          Figure 4: Historical Decomposition - Labor in annual differences


    Another alternative is to accumulate the growth rates (conditioned to each
shock and the exogenous variable) starting from the observed value of the series
in the first period, this generates the historical decomposition of the level of the
variable. The results of this exercise are presented in Figure 5.
    There are several points to be made about the historical decomposition in
levels, the first one is that, since Ke t is also being accumulated from some initial
value, the decomposition is not made relative to a constant but relative to a line,
this line corresponds to the linear tendency of the series. Figure 5(a) plots the
actual path of labor along with paths conditioned to each shock and the exogenous
variable and the “Reference” line, which is the accumulation of K    e t . Interpretation
of Figure 5(a) is difficult because the effect of each shock and the exogenous variable
is obtained as the difference between its conditioned path and the “Reference” line,
because all are moving in each period identifying this effect becomes a challenging
task.
    The second point arises from the interpretation of Figure 5(b), which presents
the decomposition of the level of labor relative to the “Reference” line, this is similar
to what was presented in Figures 3 and 4. The interpretation is nevertheless more
complicated. In the former Figures the decomposition was made relative to a
constant, but the decomposition in levels is made relative to a line, whose value
is changing in each period, this makes the reading of the level of the bars and the
line more difficult. If the line is in 3, it means that the observed series is 3 units
above its linear tendency.
    Another characteristic of decomposition in level must be mentioned, although
it is not clear from Figure 5(b), the accumulated effects of the shocks over any
series in the first and last period are, by construction, equal to zero. This means
that the bars associated with the structural shocks are not present in both the
first and last period of the sample, and that the value of the observed variable


                                                          Revista Colombiana de Estadística 35 (2012) 479–508

An Introductory Review of a Structural VAR-X Estimation and Applications                                                                                                                  505

has to be explained entirely by the exogenous variables, moreover, it means that
the accumulated effect of the shocks has to be dis-accumulated when the sample
is getting to its end. This occurs because the accumulated effect of the shocks
has to be zero at the beginning of the sample, since the effect of the shocks before
that point is summarized in the initial value of the series, and because the mean
of the shocks over the sample is zero (one of the properties of the estimation), this
              T
                 it = 0. When the conditioned difference series is accumulated, the
             P
implies that
                                           t=1
effect of the shock is accumulated so that it also sums to zero. This last problem
is not present in the historical decomposition in differences (or annual differences)
and makes the results of the decomposition in levels to be unreliable.


                     13                                                                                                        0.1


                                                                                                                              0.08


                                                                                                                              0.06


                    12.5                                                                                                      0.04
  Log(Employment)




                                                                                                           Log(Employment)
                                                                                                                              0.02


                                                                                                                                0


                     12                                                                                                      −0.02


                                                                                                                             −0.04


                                                                                                                             −0.06


                    11.5                                                                                                     −0.08
                                        1960            1970              1980      1990                                             1960            1970              1980      1990
                                                               Quarters                                                                                     Quarters
                           Employment          Tech Shock       No−Tech Shock    Oil Price   "Reference"                                    Tech Shock       No−Tech Shock    Oil Price


                                    (a) Decomposition in level                                             (b) Decomposition around reference value
                                                    Figure 5: Historical Decomposition - Labor in level




7. Final Remarks
    This paper presents a review of VAR-X topics with emphasis in Bayesian es-
timation, and different applications of the model, covering impulse response func-
tions, multiplier analysis, forecast error variance decomposition and historical de-
composition calculations. The treatment and discussion of the latter constitutes
a novelty in the literature, since it has been largely ignored (with few exceptions)
despite its usefulness in the context of multivariate time series analysis. A short
exercise in presented using much of the technique reviewed.
   Bayesian methods are presented with detail and shown as an easy to implement
option for overcoming the usual small sample restrictions faced by frequentist
methods. These methods are off course recommended to scholars when using the
VAR or the VAR-X model.
    Finally, this document is intended as an introductory review to the VAR-
X model, and does not exhaust all the literature available about it. A couple
of examples of further topics in the literature are the VAR model with mixed
frequencies, like Rodriguez & Puggioni (2010) or Chiu, Eraker, Foerster, Kim &

                                                                                             Revista Colombiana de Estadística 35 (2012) 479–508

506                                            Sergio Ocampo & Norberto Rodríguez


Seoane (2011) (and the references therein), and the recently proposed Copula-
VAR-X as in Bianchi, Carta, Fantazzini, Giuli & Maggi (2010), who use flexible
multivariate distributions, different from the normal distribution, allowing a rich
dependence structure and more flexible marginal distributions for a better fit of
empirical data, specially leptokurtosis.


Acknowledgements
    We are in debt with the editor of the Colombian Journal of Statistics and
three anonymous referees, their suggestions where crucial for this paper. We wish
to thank also Eliana González, Martha Misas, Andrés González, Luis Fernando
Melo, and Christian Bustamante for useful comments on earlier drafts of this
document, of course, all remaining errors are our own. Needless to say, the results
and opinions expressed in this document do not compromise in any way the Banco
de la República, its board of governors or the Inter-American Development Bank.
                                                                  
             Recibido: enero de 2012 — Aceptado: noviembre de 2012


References
Amisano, G. & Giannini, C. (1997), Topics in Structural VAR Econometrics, Springer.
Bauwens, L., Lubrano, M. & Richard, J.-F. (2000), Bayesian Inference in Dynamic Econometric Models, Oxford University Press.
Bianchi, C., Carta, A., Fantazzini, D., Giuli, M. E. D. & Maggi, M. (2010), ‘A Copula VAR-X Approach for Industrial Production Modelling and Forecasting’, Applied Economics 42(25), 3267–3277.
Blanchard, O. J. & Quah, D. (1989), ‘The Dynamic Effects of Aggregate Demand and Supply Disturbances’, American Economic Review 79(4), 655–73.
Burbidge, J. & Harrison, A. (1985), ‘A Historical Decomposition of the Great Depression to Determine the Role of Money’, Journal of Monetary Economics 16(1), 45–54.
Canova, F. (2007), Methods for Applied Macroeconomic Research, Princeton University Press, Nueva Jersey.
Canova, F. & De Nicolo, G. (2002), ‘Monetary Disturbances Matter for Business Fluctuations in the G-7’, Journal of Monetary Economics 49(6), 1131–1159.
Canova, F. & Pappa, E. (2007), ‘Price Differentials in Monetary Unions: The Role of Fiscal Shocks’, Economic Journal 117(520), 713–737.
Casella, G. & George, E. I. (1992), ‘Explaining the Gibbs Sampler’, The American Statistician 46(3), 167–174.
Chen, M. & Shao, Q. (1998), ‘Monte Carlo Estimation of Bayesian Credible and HPD Intervals’, Journal of Computational and Graphical Statistics 8, 69–92.
Chiu, C. W. J., Eraker, B., Foerster, A. T., Kim, T. B. & Seoane, H. D. (2011), Estimating VAR’s Aampled at Mixed or Irregular Spaced Frequencies : a Bayesian Approach, Research Working Paper RWP 11-11, Federal Reserve Bank of Kansas City.
Christiano, L. J., Eichenbaum, M. & Evans, C. L. (1999), Monetary Policy Shocks: What Have We Learned and to What End?, in J. B. Taylor & M. Woodford, eds, ‘Handbook of Macroeconomics’, Vol. 1 of Handbook of Macroeconomics, Elsevier, chapter 2, pp. 65–148.
Galí, J. (1999), ‘Technology, Employment, and the Business Cycle: Do Technology Shocks Explain Aggregate Fluctuations?’, American Economic Review 89(1), 249–271.
Geman, S. & Geman, D. (1984), ‘Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images’, IEEE Transactions on Pattern Analysis and Machine Intelligence 6, 721–741.
Hyndman, R. J. (1996), ‘Computing and Graphing Highest Density Regions’, The American Statistician 50, 120–126.
Jeffreys, H. (1961), Theory of Probability, International Series of Monographs on Physics, Clarendon Press.
Kadiyala, K. R. & Karlsson, S. (1997), ‘Numerical Methods for Estimation and Inference in Bayesian VAR-Models’, Journal of Applied Econometrics 12(2), 99–132.
Kilian, L. (1998), ‘Small-Sample Confidence Intervals For Impulse Response Functions’, The Review of Economics and Statistics 80(2), 218–230.
King, T. B. & Morley, J. (2007), ‘In Search of the Natural Rate of Unemployment’, Journal of Monetary Economics 54(2), 550–564.
Kociecki, A. (2010), ‘A Prior for Impulse Responses in Bayesian Structural Models’, Journal of Business & Economic Statistics 28(1), 115–127.
Koop, G. (1992), ‘Aggregate Shocks and Macroeconomic Fluctuations: A Bayesian Approach’, Journal of Applied Econometrics 7(4), 395–411.
Litterman, R. B. (1986), ‘Forecasting with Bayesian Vector Autoregressions - Five Years of Experience’, Journal of Business & Economic Statistics 4(1), 25–38.
Lütkepohl, H. (1990), ‘Asymptotic Distributions of Impulse Response Functions and Forecast Error Variance Decompositions of Vector Autoregressive Models’, The Review of Economics and Statistics 72(1), 116–25.
Lütkepohl, H. (2005), New Introduction to Multiple Time Series AnalysisSpringer.
Moon, H. R., Schorfheide, F., Granziera, E. & Lee, M. (2011), Inference for VARs Identified with Sign Restrictions, NBER Working Papers 17140, National Bureau of Economic Research, Inc.
Mountford, A. & Uhlig, H. (2009), ‘What are he Effects of Fiscal Policy Shocks?’, Journal of Applied Econometrics 24(6), 960–992.
Nicholls, D. F. & Pope, A. L. (1988), ‘Bias in the Estimation of Multivariate Autoregressions’, Australian Journal of Statistics 30A(1), 296–309.
Rodriguez, A. & Puggioni, G. (2010), ‘Mixed Frequency Models: Bayesian Approaches to Estimation and Prediction’, International Journal of Forecasting 26(2), 293–311.
Runkle, D. E. (1987), ‘Vector Autoregressions and Reality’, Journal of Business & Economic Statistics 5(4), 437–42.
Sims, C. A. (1980), ‘Macroeconomics and Reality’, Econometrica 48(1), 1–48.
Sims, C. A. & Zha, T. (1999), ‘Error Bands for Impulse Responses’, Econometrica 67(5), 1113–1156.
Smets, F. & Wouters, R. (2007), ‘Shocks and Frictions in US Business Cycles: A Bayesian DSGE Approach’, American Economic Review 97(3), 586–606.
Uhlig, H. (2005), ‘What are the Effects of Monetary Policy on Output? Results From an Agnostic Identification Procedure’, Journal of Monetary Economics 52(2), 381–419.
Zellner, A. (1996), An Introduction to Bayesian Inference in Econometrics, Wiley Classics Library, John Wiley.
