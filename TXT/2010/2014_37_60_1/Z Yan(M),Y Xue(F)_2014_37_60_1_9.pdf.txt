Algorithms to Calculate Exact Inclusion Probabilities for a Non-Rejective Approximate πps Sampling Design. Algoritmos para calcular probabilidades exactas de inclusión para un diseño de muestreo no rechazable πpt
Inner Mongolia University of Technology, Hohhot, P. R. China
Abstract
AP-design, an efficient non-rejective implementation of the πps sampling design, was proposed in the literature as an alternative Poisson sampling scheme. In this paper, we have updated inclusion probabilities formulas in the AP sampling design. The formulas of these inclusion probabilities have been greatly simplified. The proposed results show that the AP design and the algorithms to calculate inclusion probabilities are simple and effective, and the design is possible to be used in practice. Three real examples have also been included to illustrate the performance of these designs.
Key words: AP sampling design, Inclusion probabilities, Poisson sampling.
Resumen
Una implementación del diseño de muestreo πpt, que no es de rechazo, ha sido recientemente propuesta como alternativa al esquema de Poisson. En este trabajo, hemos adaptado las formulas de probabilidades de inclusión en el diseño de muestreo Poisson alternativo (AP por sus siglas en inglés). Estas fórmulas han sido significativamente simplificadas. Los resultados propuestos muestran que el diseño AP y los algoritmos para calcular las probabilidades de inclusión son simples y efectivos, y que el diseño se puede usar en la práctica. Se incluyen tres ejemplos reales para ilustrar el desempeño de la propuesta.
Palabras clave: AP diseño de muestra, probabilidades de inclusión, esquema de Poisson.

1. Introduction

     Unequal probability sampling is frequently used in surveys in order to increase
the efficiency in the estimation of the population characteristics. A sampling
design without replacement and with unequal inclusion probabilities which are
proportional to a size variable, that is known for all units in the population is
usually called a πps sampling design. The πps sampling usually produces more
efficient estimates than sampling with equal probabilities. Suppose that the finite
population U consists of N units labelled 1, . . . , N . An auxiliary variable with
value Xi for the unit i is known for all i = 1, . . . , N . Assume that Xi > 0, forPall i
and strict inequality for at least one i. It is required to estimate the total Y = i Yi
where the sum is over 1, . . . , N , given a sample of size n. Let pi = nXi /X, i =
                                                                           PN
1, . . . , N be the prescribed inclusion probability parameters with          i=1 pi = n
with X its corresponding population total. The problem is how to select a sample
with fixed size n, so that the probability of each unit i to be included in the
sample equals just pi . Many papers have proposed sampling schemes in which the
inclusion probability of unit i is πi . Some important reference are followings: Sen
(1953), Durbin (1967), Brewer (1963), Sampford (1967), Hájek (1964, 1981), Rosén
(1997a), Aires (1999), Bondesson & Thorburn (2008), Bondesson & Grafström
(2011), Grafströ (2009), Laitila & Olofsson (2011), Olofsson (2011). Most of the
schemes with predetermined inclusion probabilities are either difficult to execute
or calculate πij , the second order inclusion probability units i and j, if n is more
than 2. Recently, Zaizai, Miaomiao & Yalu (2013) presented a new approximative
πps design for fixed sample size n as follows:

      1. Draw an initial sample s0 , using Poisson sampling design with probabilities
      N
    pi 1 . The size of the initial sample s0 is a random variable denoted by ns0 .

    2. If ns0 = n, then the sampling is finished and the sample s = s0 . If ns0 < n,
then replenish the rest units denoted by s1 , its size n − ns0 , by simple random
sampling without replacement (SRSWOR) design from U −s0 , the final sample s =
s0 ∪ s1 . If ns0 > n, then remove ns0 − n units denoted by s2 , using the SRSWOR-
design, from s0 , the final sample s = s0 − s2 . The AP design becomes a non-
rejective sampling design. Algorithms for calculating exact first- and second-order
inclusion probabilities of the corresponding design are too complex and involve a
Jacobi over-relaxation iterative method.

Note 1. We assume that the population is such that pi = nXi /X < 1, for all i.
You need to remove the cases where pi is larger than 1 and then iterative removing
further units if necessary


    The purpose of this paper is to simplify calculation of the first-order and second-
order inclusion probabilities of the AP design. The analytical expressions of inclu-
sion probabilities for the AP design presented in Section 2 are simpler to operate
than the original one.


                                      Revista Colombiana de Estadística 37 (2014) 127–140

Exact Inclusion Probabilities for a Non-Rejective πps Sampling Design                         129

2. Inclusion Probabilities of AP Design
    Now we discuss inclusion probabilities  P of the AP sampling design. For conve-
nience, we denote the random variable k∈U,k6=i Ik as n−i    s0 , the random variable
                                           
P                       −ij                  1 if k ∈ s0
   k∈U,k6=i,k6=j Ik as ns0 , where Ik =                    for all k ∈ U are indica-
                                             0 otherwise
tors for the Poisson sampling. In order to calculate the first and second-order
inclusion probabilities of the AP design, we firstly derive the following Proposi-
tion and Lemmas. For convenience, the subset {1, 2, · · · , i} of U is abbreviated
                  Pi
as Ui and P r( α=1 Iα = j) as Pji where j = 0, 1, . . . , i; i = 1, 2, . . . , N . Then
P r(ns0 = ν) = PνN , ν = 0, 1, . . . , N .
Proposition
     Qi       1. Keep the same assumptions as above and qQ      i = 1 − pi . Then
                         i−1                                      i
P0i = α=1 qα ; Pki = pi Pk−1 + qi Pki−1 ,1 ≤ k ≤ i − 1 and Pii = α=1 pα .

   A proof of proposition 1 can be found in Tillé (2006) and Olofsson (2011).
Note 2. Proposition 1 shows that we can calculate P0i , P1i , . . . , Pii by using
                         i−1
P0i−1 , P1i−1 , . . . , Pi−1 with initial values P01 = q1 and P11 = p1 . By recursive
calculation with respect to i, we can finally obtain PνN , ν = 0, 1, . . . , N .
                    1
Lemma 1. Let µk = 1−p k
                        , then
                                                 ν
                                                 X                 pk ν−j N
                      P r(n−k
                           s0 = ν) = µk                (−1)ν−j            Pj                  (1)
                                                 j=0
                                                                 1 − pk

Lemma 2. Given the assumptions as in Lemma 1, then
                                 ν                          j
                                 X                 pl ν−j X             pk j−t N
   P r(n−kl
        s0 = ν) = µk µl            (−1)ν−j                     (−1)j−t          Pt            (2)
                                 j=0
                                                 1 − pl    t=0
                                                                       1 − pk

   Lemma 1 and Lemma 2 are proved in the appendix. Now we present theorems
1 and 2 which the core results of this paper.
Theorem 1. Under the AP-design, the algorithms for calculating the first-order
inclusion probabilities can be written as
                             N −1               ν
                             X                 X               pk ν−j
                     πk =           Ck (ν)µk       (−1)ν−j (         ) · PjN                  (3)
                             ν=0               j=0
                                                             1 − p k

                    (N −n)pk +(n−ν)
                                            ν = 0, . . . , n − 1,
where Ck (ν) =         npk
                             N −ν                                 and PjN = P r(ns0 = j).
                       ν+1                  ν = n, . . . , N − 1
Theorem 2. Under the AP-design, the analytical formula of the second-order
inclusion probabilities is as follows
           N −2                  ν                           j
           X                     X                  pl ν−j X             pk j−t N
   πkl =          Ckl (ν)µk µl         (−1)ν−j                  (−1)j−t          Pt           (4)
           ν=0                   j=0
                                                  1 − pl    t=0
                                                                        1 − pk


                                               Revista Colombiana de Estadística 37 (2014) 127–140

130                                                                Zaizai Yan & Yuxia Xue


where
                  (n−ν)(n−ν−1)                     n−ν−1
           qk ql (N −ν)(N −ν−1) + (pk ql + pl qk ) N −ν−1 + pk pl , ν = 0, 1, . . . , n − 2,
         
Ckl (ν) =           n(n−1)
           pk pl (ν+2)(ν+1) ,                                       ν = n−1, . . . , N −2.

    From Theorem 1 and Theorem 2, we can find that the problem to solve πk and
πkl may be switched into solving a series of P r(ns0 = ν) = PνN , ν = 0, 1, . . . , N .
We can recursively calculate PνN by using Proposition 1. Proofs of Theorems 1
and 2 can be found in the appendix.


3. Numerical Examples
    The statistical literature contains several proposals for methods generating
fixed-size without-replacement πps sampling designs. In practice, πps designs
with sample size n = 2 are widely used and fully studied. Due to the difficulties
in the implementation and the complexity in computing of inclusion probabilities,
application of πps designs with sample size n > 2 is relatively less. Instead, ap-
proximate πps designs such as the Conditional Poisson design (CP), two-phase πps
sampling design (2Pπps), Rosén (1997)’s Pareto design and Zaizai et al. (2013)’s
design (AP) have been used. However, there are fast and fairly simple implemen-
tations of strict πps designs such as systematic πps sampling. Unfortunately, its
variance estimation is cumbersome.


3.1. A Review of some Sampling Designs
    Poisson sampling is a method to generate a sample s, which has a random
size, from a finite population U consisting of N individuals. Each individual i in
the population has a predetermined probability pi and is included in the sample
s. A Poisson sample may be obtained by using N independent Bernoulli trials
to determine whether the individual under consideration is to be included in the
sample s or not. The first-order inclusion probabilities of the individuals are equal
to the target inclusion probabilities under the Poisson sampling design. A major
drawback with the Poisson design is the randomness of the sample size which has
urged statisticians to develop sampling schemes providing fixed size πps designs.
    Conditional Poisson sampling (CP), also called rejective sampling or maximum
entropy sampling, was first introduced by Hájek (1964). It is a fixed size sampling
design, without replacement, on a finite population, with unequal inclusion proba-
bilities among the units of the population. It was called rejective sampling because
Hájek’s implementation amounts to drawing samples with the Poisson sampling
design which has a random size until the desired size is chosen. In fact, one can
also obtain the conditional Poisson design by drawing samples, with replacement,
using a multinomial sampling design and rejecting the samples which hold some
units of the population more than one.
    Laitila & Olofsson (2011) proposed a new method to generate a sample with
fixed size and inclusion probabilities proportional to size, viz. the 2Pπps design


                                        Revista Colombiana de Estadística 37 (2014) 127–140

Exact Inclusion Probabilities for a Non-Rejective πps Sampling Design               131

based on a two-phase approach. Consider a population U of N units. For sample
generation, let n be the predetermined sample size and assume target inclusion
probabilities, pk , to be proportional to a size variable, xk , known for all k ∈ U .
The 2Pπps sampling scheme is as follows:
   1. Draw a sample, s0 , using a Poisson design  P with pak ∝ xk as inclusion
probabilities, with expected sample size E(ns0 ) = U pak ≥ n.
   2. If the size of s0 is greater than or equal to n, then proceed to step 3 and let
sa = s0 . If not, repeat step 1.
   3. From the sampled set, sa , draw a sample s of size n using an SRSWOR
design.
    It was shown that the first-order inclusion probabilities of the 2Pπps design are
asymptotically equal to the target inclusion probabilities. But the 2Pπps design
is still a rejective sampling design.
    Pareto sampling was introduced by Rosén (1997a, 1997b). It is a simple method
to get a fixed size πps sample though with inclusion probabilities only approxi-
mately as desired, which can be described as follows: firstly independent random
numbers(U1 , . . . , UN ) from U (0, 1) are generated, one value for each population
unit (i = 1, . . . , N ). Then Pareto distributed ranking variables Qi = Upii (1−Ui)
                                                                              (1−pi ) ,
                                                                  P
where pi is the targeted inclusion probability for unit i and        pi = n, are cal-
culated. Those n units with the smallest Q-values are selected as a πps sample
with fixed size n. Bondesson, Traat & Lundqvist (2006) obtained the formulas of
first-order and second-order inclusion probabilities for the Pareto design. The true
inclusion probabilities only agree with the target inclusion probabilities approxi-
mately.
  Zaizai et al. (2013) presented an alternative πps design (AP) as Section 1. The
AP design is a non-rejective sampling design.


3.2. Examples
    Since the Horvitz-Thompson estimators under the AP design, CP design and
(2Pπps) design are unbiased, their precision is measured by the variance. However,
the ratio estimators mentioned by Kadilar & Cingi (2004) and the traditional ratio
estimator are biased, so their precision is measured by mean square error (MSE).
In the following section, the estimators and their variances(or MSEs) under the
AP design, CP design, 2Pπps design and SRSWOR are studied using three data
sets earlier used in the literature. In this paper the AP design and other designs
are applied to three populations in which y-values are known, so these variances or
MSEs can be calculated exactly. This is only to show the performance of various
designs. In practice the y-values in an interested population will be unknown, the
variance or MSE of an estimator cannot be obtained, but can be estimated from a
sample. Then, the precision is measured by estimation of variance or MSE. As far
as the Horvitz-Thompson estimators under the AP design, CP design and (2Pπps)
design, the Yates-Grundy variance estimators can be used as the precision. It is
unbiased estimator for the true variance.


                                     Revista Colombiana de Estadística 37 (2014) 127–140

132                                                               Zaizai Yan & Yuxia Xue


Example 1. We have used the data of Kadilar & Cingi (2004) in this section.
However, we have considered the data of only Aegean Region of Turkey, as we are
interested in unequal probabilities sampling with fixed sample size here. We have
applied our proposed method and other unequal probabilities sampling methods,
such as the 2Pπps sampling design and the CP sampling design on the data of
apple production amount (as interest of variate y) and number of apple trees (as
auxiliary variate x) in 105 villages of Aegean Region in 1999 (Source: Institute of
Statistics, Republic of Turkey).

    For a large size population, we may divide the population into three strata
according to size of Xi , and the AP-design can be used to get a sample of fixed
size within each stratum independently. Let the population be stratified into 3
strata, where sample sizes and population sizes are (N1 , n1 ) = (41, 8),(N2 , n2 ) =
(41, 8) and (N3 , n3 ) = (23, 4) respectively. Finally we use stratification sampling
technique to build estimation. The relative differences of the inclusion probabilities
for the AP-design ,2Pπps-design and CP-design with respect to target inclusion
probabilities can be calculated in each stratum respectively. Then, we can build
              AP        2P πps        CP
estimators Yb HT   , Yb
                      HT       and Yb
                                    HT   of population mean Y from Table 1, and
                   AP      2P πps        CP
the variance of Yb HT , Yb HT     and Yb HT are easily computed, respectively. As
mentioned previously, it is of interest to compare the efficiency of using alternative
sampling schemes, for example, the 2Pπps design, AP design, CP design and
SRSWOR design. We conclude that the proposed method is more efficient than
the 2Pπps design and SRSWOR design. The empirical comparisons included in
Table 1 are of interest. It is noticed that the efficiency of the AP design is almost
identical to the 2Pπps design, but it is significantly higher than ratio estimators
of the SRSWOR design mentioned by Kadilar & Cingi (2004) (Note: The MSEs
here are different from the original literature, because the original literature has
106 datum, one of which is a invalid data and is removed, this article has 105
datum). Although the CP design is more efficient than the AP design, the CP
design is not easy to implement. The some important advantages of the proposed
sampling design are not only its implementation as non-rejective, but also its
inclusion probabilities that can be calculated recursively.

Table 1: The variances of the AP design, 2P πps design, CP design with n = 20, and
         MSE of SRSWOR ratio estimators in example 1. Aegean Region data.
          Sampling scheme    Method of estimation              Variance (or MSE)
                                AP
                                   = 1      y /π AP
                                       P
          The AP design      Yb
                              HT     N    i∈s   i   i                    349150
                                2P πps
                                         1 P          2P πps
          The 2Pπps design   Yb HT     = N   i∈s yi /πi                  375615
                                CP
                                    = 1       y /π CP
                                         P
          The CP design      Yb
                              HT     N    i∈s   i   i                    188396
          SRSWOR             Upadhyaya-Singh 1                          2331432
          SRSWOR             Upadhyaya-Singh 2                          2330455
          SRSWOR             Singh-Kakran                               2329395
          SRSWOR             Sisodia-Dwivedi                            2331304
          SRSWOR             Traditional                                2331436




                                      Revista Colombiana de Estadística 37 (2014) 127–140

Exact Inclusion Probabilities for a Non-Rejective πps Sampling Design                133

Note 3. The AP design still is not an exact πps design. The inclusion probabili-
ties will be larger than intended probabilities for small inclusion probabilities and
smaller than intended probabilities for large inclusion probabilities. At the ex-
treme case there will be risks of not selecting units which are intended to be taken
with probability 1, and of selecting units with intended inclusion probability 0.
Example 2. To analyze the performance of the suggested method in comparison
to other methods considered in this paper, a natural population data set from the
literature (Singh 1967) is being considered. The descriptions of these populations
are given below.

   y: Percentage of hives affected by disease.
   x: January average temperature.
   We shall consider drawing a sample according to the AP design previously
developed. The exact and desired first-order inclusion probabilities are listed in
Table 2 and the second-order inclusion probabilities are in Table 3. Then, once we
                                             AP
get an AP sample, we can build estimator Yb       of population mean Y , and the
                                                 HT
               AP
variance of Yb HT is easily computed.

Table 2: The raw data and the first-order inclusion probabilities for the AP design ,the
         2Pπps design, the CP design and Pareto design, N = 10, n = 4 in example 2.
         Single data.
      Unit i   y    x        p          πiAP      πi2P πps      πiCP       πiP ar
        1      49   35   0.3333333   0.3445468   0.3373678   0.3262696   0.3327040
        2      40   35   0.3333333   0.3445468   0.3373678   0.3262696   0.3327040
        3      41   38   0.3619048   0.3682212   0.3647676   0.3575523   0.3614987
        4      46   40   0.3809524   0.3840479   0.3828163   0.3785839   0.3807203
        5      52   40   0.3809524   0.3840479   0.3828163   0.3785839   0.3807203
        6      59   42   0.4000000   0.3999062   0.4006775   0.3997285   0.3999585
        7      53   44   0.4190476   0.4157930   0.4183399   0.4209603   0.4192101
        8      61   46   0.4380952   0.4317052   0.4357925   0.4422518   0.4384713
        9      55   50   0.4761905   0.4635925   0.4700272   0.4849000   0.4770065
       10      64   50   0.4761905   0.4635925   0.4700272   0.4849000   0.4770065

    From Table 4, we see that the proposed method has a smaller variance than
the CP design. Although the variance of the 2Pπps design is slightly smaller than
proposed method, the AP design is easy to implement and generally applicable.
In general, the AP design is extremely efficient and it is significantly higher than
ratio estimators of the SRSWOR design mentioned by Kadilar & Cingi (2004).
Example 3. The data we considered here is from 35 Scottish farms in Table 5.
Let sample size n be equal to 8. The descriptions of these populations are given
below (Asok & Sukhatme 1976, page 916).
   y: Acreage under oats in 1957.
   x: Recorded acreage of crops and grass for 1947.

   The exact first-order and second-order inclusion probabilities for the AP design,
2Pπps design and CP design are calculated. In this example, the efficiencies for the


                                      Revista Colombiana de Estadística 37 (2014) 127–140

134                                                                  Zaizai Yan & Yuxia Xue

                                                   AP
Table 3: The second-order inclusion probabilities πij for the AP design, N = 10, n = 4
         in example 2. Single data.
                                          Unit       j
          1       2       3       4       5          6         7       8       9      10
 Unit i
 1        0.34455 0.09537 0.10268 0.10764 0.10764 0.11267 0.11777 0.12293 0.13347 0.13347
 2        0.09537 0.34455 0.10268 0.10764 0.10764 0.11267 0.11777 0.12293 0.13347 0.13347
 3        0.10268 0.10268 0.36822 0.11588 0.11588 0.12128 0.12675 0.13230 0.14361 0.14361
 4        0.10764 0.10764 0.11588 0.38405 0.12146 0.12711 0.13284 0.13864 0.15047 0.15047
 5        0.10764 0.10764 0.11588 0.12146 0.38405 0.12711 0.13284 0.13864 0.15047 0.15047
 6        0.11267 0.11267 0.12128 0.12711 0.12711 0.39991 0.13901 0.14506 0.15740 0.15740
 7        0.11777 0.11777 0.12675 0.13284 0.13284 0.13901 0.41579 0.15156 0.16442 0.16442
 8        0.12293 0.12293 0.13230 0.13864 0.13864 0.14506 0.15156 0.43171 0.17152 0.17152
 9        0.13347 0.13347 0.14361 0.15047 0.15047 0.15740 0.16442 0.17152 0.46359 0.18595
 10       0.13347 0.13347 0.14361 0.15047 0.15047 0.15740 0.16442 0.17152 0.18595 0.46359




Table 4: The variances of the AP design, 2Pπps design, CP design and Pareto design
         with n = 4 and MSE of SRSWOR ratio estimators in example 2. Single data.
          Sampling scheme     Method of estimation                 Variance(or MSE)
                                 AP
                                    = 1      y /π AP
                                        P
          The AP design       YbHT    N    i∈s   i   i                       3.8268
                                 2P πps
                                          1 P         2P πps
          The 2Pπps design    Yb HT     = N  i∈s yi /πi                      3.7047
                                 CP
                                     = 1      y /π CP
                                          P
          The CP design       YbHT    N    i∈s   i   i                       3.8681
                                 P ar
                                       1 P          P ar
          The Pareto design   Yb HT = N    i∈s yi /πi                        3.7334
          SRSWOR              Upadhyaya-Singh 1                             10.5488
          SRSWOR              Upadhyaya-Singh 2                             15.6308
          SRSWOR              Singh-Kakran                                  10.9737
          SRSWOR              Sisodia-Dwivedi                               10.4738
          SRSWOR              Traditional                                   10.5164




AP design, CP design and 2Pπps design are compared. From the results of Table
6, we conclude that the AP design is more efficient than the CP design. Since
the CP design and 2Pπ ps design are far more complex than the AP design, the
proposed design is significantly better than the CP design and 2Pπ ps design and
it is significantly higher than ratio estimators of the SRSWOR design mentioned
by Kadilar & Cingi (2004).

    A primary purpose of this paper is to extend the theory of finite sampling
with unequal probabilities. Although the study variable y of the data presented
in Table 5 is often unknown in the real world, they do indicate that substantial
reductions in variance can be obtained by using the AP design (Table 1, 4 6). It
is the opinion of the authors that the technique suggested in this paper may be an
implemented utility in the real world for unknown study variable y. Hence, the
proposed method has potential application value.


                                      Revista Colombiana de Estadística 37 (2014) 127–140

Exact Inclusion Probabilities for a Non-Rejective πps Sampling Design                     135

Table 5: Recorded Acreage of Crops and Grass for 1947 and Acreage Under Oats in
         1957 for 35 Farms in Orkney in example 3. Scottish forms data.
           Farm No.   x      y       Farm No.      x          y    Farm No.    x     y
              1       50     17         13         78         23      25      209   70
              2       50     17         14         90          0      26      240   28
              3       52     10         15         91         27      27      274   62
              4       58     16         16         92         34      28      300   59
              5       60     6          17         96         25      29      303   66
              6       60     15         18        110         24      30      311   58
              7       62     20         19        140         43      31      324   128
              8       65     18         20        140         48      32      330   38
              9       65     14         21        156         44      33      356   69
              10      68     20         22        156         45      34      410    72
              11      71     24         23        190         60      35      430   103
              12      74     18         24        198         63


Table 6: The variances of the AP design, 2Pπps design, CP design with n = 8 and
         MSE of SRSWOR ratio estimators in example 3. Scottish forms data.
          Sampling scheme         Method of estimation                 Variance(or MSE)
                                     AP
                                        = 1      y /π AP
                                            P
          The AP design           Yb
                                   HT     N     i∈s   i   i                     15.7658
                                     2P πps
                                              1 P          2P πps
          The 2Pπps design        Yb HT     = N   i∈s yi /πi                    15.3746
                                     CP
                                         = 1       y /π CP
                                              P
          The CP design           Yb
                                   HT     N     i∈s   i   i                     16.8456
          SRSWOR                  Upadhyaya-Singh 1                             99.4516
          SRSWOR                  Upadhyaya-Singh 2                             99.5016
          SRSWOR                  Singh-Kakran                                  99.2217
          SRSWOR                  Sisodia-Dwivedi                               97.9005
          SRSWOR                  Traditional                                   98.5479



4. Conclusions
    We have shown that it is feasible to calculate the first-order and second-order in-
clusion probabilities in the AP design. Expressions for the third-order and fourth-
order inclusion probabilities under the AP sampling design can be obtained. The
proofs are similar to that of πk .
    This study shows that the AP design possesses approximately the same effi-
ciency with the CP design and 2Pπps design. But the AP design is a non-rejective
sampling design and very close to the strict πps design. First and second-order
inclusion probabilities can be accurately calculated by using the formula given in
this paper. From these numerical illustrations, it is deduced that there is consid-
erable gain in efficiency by using the Horvitz-Thompson estimator under the AP
design over the other ratio-type estimators mentioned.


Acknowledgments
   The authors are grateful to the Editor-in-Chief and two referees for providing
valuable comments on an earlier draft of the paper. The paper is supported by


                                           Revista Colombiana de Estadística 37 (2014) 127–140

136                                                            Zaizai Yan & Yuxia Xue


National Natural Science Foundation of China (11161031,11361036), Natural Sci-
ence Foundation of Inner Mongolia (2013MS0108) and Doctoral Fund of Ministry
of Education of China (20131514110005).
                                                                       
                  Recibido: octubre de 2013 — Aceptado: abril de 2014


References
Aires, N. (1999), ‘Algorithms to find exact inclusion probabilities for conditional Poisson sampling and Pareto πps’, Methodology and Computing in Applied Probability Sampling Designs 1(4), 457–469.
Asok, C. & Sukhatme, B. V. (1976), ‘On sampford’s procedure of unequal probability sampling without replacement’, Journal of the American Statistical Association 71(365), 912–918.
Bondesson, L. & Grafström, A. (2011), ‘An extension of Sampford’s method for unequal probability sampling’, Scandinavian Journal of Statistics 38(2), 377–392.
Bondesson, L. & Thorburn, L. D. (2008), ‘A list sequential sampling method suitable for real-time sampling’, Scandinavian Journal of Statistics 35(3), 466–483.
Bondesson, L., Traat, I. & Lundqvist, A. (2006), ‘Pareto sampling versus conditional Poisson and Sampford sampling’, Scandinavian Journal of Statistics 33(4), 699–720.
Brewer, K. R. W. (1963), ‘A model of systematic sampling with unequal probability’, Australian and New Zealand Journal of Statistics 5(1), 5–13.
Durbin, J. (1967), ‘Design of multi-stage surveys for the estimation of sampling errors’, Journal of the Royal Statistical Society. Series C: Applied Statistics 16(2), 152–164.
Grafströ, A. (2009), ‘Non-rejective implementations of the Sampford sampling design’, Journal of Statistical Planning and Inference 139(6), 2111–2114.
Hájek, J. (1964), ‘Asymptotic theory of rejective sampling with varying probabilities from a finite population’, Annals of Mathematical Statistics 35(4), 1491–1523.
Hájek, J. (1981), Sampling from a Finite Population, Marcel Dekker, New York.
Kadilar, C. & Cingi, H. (2004), ‘Ratio estimators in simple random sampling’, Applied Mathematics and Computation 151(3), 893–902.
Laitila, T. & Olofsson, J. (2011), ‘A two-phase sampling scheme and πps designs’, Journal of Statistical Planning and Inference 141(5), 1646–1654.
Olofsson, J. (2011), ‘Algorithms to find exact inclusion probabilities for 2pπps sampling designs’, Lithuanian Mathematical Journal 51(3), 425–439.
Rosén, B. (1997a), ‘Asymptotic theory for order sampling’, Journal of Statistical Planning and Inference 62(2), 135–158.
Rosén, B. (1997b), ‘On sampling with probability proportional to size’, Journal of Statistical Planning and Inference 62(2), 159–191.
Sampford, M. R. (1967), ‘On sampling without replacement with unequal probabilities of selection’, Biometrika 54(3-4), 499–513.
Sen, A. R. (1953), ‘On the estimate of variance in sampling with varying probabilities’, Journal of the Indian Society of Agricultural Statistics 5, 119–127.
Singh, M. P. (1967), ‘Multivariate product method of estimation for finite populations’, Journal of the Indian Society of Agricultural Statistics 31, 375–378.
Tillé, Y. (2006), Sampling Algorithms, Springer, New York.
Zaizai, Y., Miaomiao, L. & Yalu, Y. (2013), ‘An efficient non-rejective implementation of the πps sampling designs’, Journal of Applied Statistics 40(4), 870–886.


Appendix
   The derivation of the recursive formula is stated in this part.


A1. Recursive Formula of the First-Order Inclusion
Probabilities
    Proof of Lemma 1. We use induction on ν. Let ν = 0, then P0N = P r(ns0 =
          PN                           PN
0) = P r{ α=1 Iα = 0} = P r{Ik = 0, α=1,α6=k Iα = 0} = (1 − pk )P r(n−k s0 = 0).
Hence P r(n−ks0  = 0) = µ  P
                         k 0
                             N
                               , Lemma 1 is true for ν = 0. Assume that equation
(1) is true for ν = j < N . Then
                                        j
                                        X                 pk j−i N
                   P r(n−k
                        s0 = j) = µk          (−1)j−i            Pi
                                        i=0
                                                        1 − pk

Now, let ν = j + 1 ≤ N . Then Pj+1   N
                                         = P r(ns0 = j + 1) = pk P r(n−ks0 = j) +
              −k
(1 − pk )P r(ns0 = j + 1). By solving for P r(n−k
                                                s0 = j + 1) and substituting in the
expression above for P r(n−k
                           s0 = j), we can  get that

                            j+1
                            X                    pk j+1−i N
    P r(n−k
         s0 = j + 1) = µk         (−1)j+1−i               Pi
                            i=0
                                               1 − pk


                                      Revista Colombiana de Estadística 37 (2014) 127–140

138                                                                 Zaizai Yan & Yuxia Xue


                                                                      2
Proof of Lemma 2. By applying Lemma 1 to the reduced population U − {k},
we can get that
                                     ν
                                     X                 pl ν−j
               P r(n−kl
                    s0 = ν) = µl       (−1)ν−j                 P r(n−k
                                                                    s0 = j)
                                     j=0
                                                     1 − pl

Again, by substituting the expression for P r(n−k
                                               s0 = j) given by Lemma 1.                  2
Proof of Theorem 1. Firstly we note that

              πk = P r(k ∈ s) = P r(k ∈ s, ns0 < n) + P r(k ∈ s, ns0 ≥ n)             (A1)

The first factor on the right of equation (A1) equals
                        n−1
                        X
P r(k ∈ s, ns0 = 0) +         [P r(k ∈ s, Ik = 1, ns0 = ν) + P r(k ∈ s, Ik = 0, ns0 = ν)],
                        ν=1


                                 n               n
where P r(k ∈ s, ns0 = 0) =        P r(ns0 = 0) = (1−pk )P r(n−k
                                                              s0 = 0).
                                 N               N
When 1 ≤ ν ≤ n − 1,

P r(k ∈ s, ns0 = ν)     =     P r(k ∈ s, Ik = 1, ns0 = ν) + P r(k ∈ s, Ik = 0, ns0 = ν)
                                                                  n−ν
                        =     pk · P r(n−k
                                        s0 = ν − 1) + (1 − pk ) ·        · P r(n−k
                                                                                s0 = ν),
                                                                  N −ν
             PN
where n−k
       s0 =
                                                                             −k
              j6=k Ij . The last equality follows from the fact that Ik and ns0 are
independent. After some simple algebraic operation, it follows that

               P r(k ∈ s, ns0 < n)
                                             Pn−1 
               =N n
                    (1 − pk )P r(n−k
                                  s0 = 0) +
                                                          −k
                                              ν=1 pk P r(ns0 = ν − 1)                 (A2)
                          n−ν       −k
                                           
               +(1 − pk ) N −ν P r ns0 = ν

With the same notation and technique, we also derive that the second factor on
the right of equation (A1) corresponds to
                                           N −1
                                           X               n
                 P r(k ∈ s, ns0 ≥ n) =             pk ·       · P r(n−k
                                                                     s0 = ν)          (A3)
                                           ν=n−1
                                                          ν+1

By substituting (A3) and (A2) in the equation (A1) and some algebraic operations,
the first-order inclusion probabilities can then be expressed as
        n−1                                     i NX−1
        Xh    (N − n)pk + (n − ν)        −k             npk
 πk =                             · P r(ns0 = ν) +          · P r(n−k
                                                                   s0 = ν) (A4)
        ν=0
                    N −ν                           ν=n
                                                       ν +1

By applying Lemma 1 to P r(n−k
                            s0 = ν) of equation (A4), we can get Theorem 1.
2

                                         Revista Colombiana de Estadística 37 (2014) 127–140

Exact Inclusion Probabilities for a Non-Rejective πps Sampling Design                            139

A2. Recursive Formula of the Second-Order Inclusion
Probabilities
      Proof of Lemma 2. The second-order inclusion probabilities can be written
as
                  πij = P r(i ∈ s, j ∈ s, ns0 < n) + P r(i ∈ s, j ∈ s, ns0 ≥ n)                (A5)
The first expression on the right of equation (A5) equals
                                                                   n−1
                                                                   X
P r(i ∈ s, j ∈ s, ns0 = 0) + P r(i ∈ s, j ∈ s, ns0 = 1) +                 P r(i ∈ s, j ∈ s, ns0 = ν),
                                                                   ν=2


where P r(i ∈ s, j ∈ s, ns0 = 0) = qi qj Nn(n−1)       −ij
                                                             
                                           (N −1) P r ns0 = 0 and

             P r(i ∈ s, j ∈ s, ns0 = 1)
         = P r(i ∈ s, j ∈ s, Ii = 0, Ij = 0, ns0 = 1)
             +P r(i ∈ s, j ∈ s, Ii = 1, Ij = 0, ns0 = 1)
           +P r(i ∈ s, j ∈ s, Ii = 0, Ij = 1, ns0 = 1)
                  (n − 1)(n − 2)                                  (n − 1)
                                 P r(n−ij                                 P r n−ij
                                                                                     
         = qi qj                       s0 = 1) + (pi qj + qi pj )              s0 = 0
                 (N − 1)(N − 2)                                   (N − 1)

When 2 ≤ ν ≤ n − 1,

          P r(i ∈ s, j ∈ s, ns0 = ν)
     =    P r(i ∈ s, j ∈ s, Ii = 0, Ij = 0, ns0 = ν)
          +P r(i ∈ s, j ∈ s, Ii = 1, Ij = 0, ns0 = ν)
          +P r(i ∈ s, j ∈ s, Ii = 0, Ij = 1, ns0 = ν)
       +P r(i ∈ s, j ∈ s, Ii = 1, Ij = 1, ns0 = ν)
              (n − ν)(n − ν − 1)                                 n−ν
     = qi qj                      P (n−ij
                                      s0 = ν) + (pi qj + qi pj )      P r(n−ij
                                                                           s0 = ν − 1)
             (N − ν)(N − ν − 1)                                  N −ν
          +pi pj P r(n−ij
                      s0 = ν − 2)

The second factor on the right of equation (A5) corresponds to
N                                                      N
X                                                      X                n(n − 1)
      P r(i ∈ s, j ∈ s, Ii = 1, Ij = 1, ns0 = ν) =           pi ·pj ·            ·P r(n−ij
                                                                                       s0 = ν − 2)
ν=n                                                    ν=n
                                                                        ν(ν − 1)

On substituting the expressions above in equation (A5), the πij becomes
            n−2
            Xh                         (n − ν)(n−ν − 1)
 πij =            (1 − pi )(1 − pj )
            ν=0
                                       (N −ν)(N −ν − 1)

                                 n− ν − 1        i
                                          + pi pj P r n−ij
                                                              
          +(pi + pj − 2pi pj )                         s0 = ν
                                 N −ν−1

                                            Revista Colombiana de Estadística 37 (2014) 127–140

140                                                                Zaizai Yan & Yuxia Xue

          N −2
          X                  n(n − 1)
                                         P r n−ij
                                                     
      +           pi pj                       s0 = ν                                   (A6)
          ν=n−1
                          (ν + 2)(ν + 1)

By using Lemma 2 to P r(n−ij
                         s0 = ν) of equation (A6), we may derive Theorem 2.
2




                                          Revista Colombiana de Estadística 37 (2014) 127–140

