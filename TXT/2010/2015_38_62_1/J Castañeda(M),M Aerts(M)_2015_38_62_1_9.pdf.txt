Accounting for Model Selection Uncertainty:    Model Averaging of Prevalence and Force of Infection Using Fractional Polynomials
Medtronic Bakken Research Center, Maastricht, Netherlands. CenStat, Universiteit Hasselt, Diepenbeek, Belgium
Abstract
In most applications in statistics the true model underlying data generation mechanisms is unknown and researchers are confronted with the critical issue of model selection uncertainty. Often this uncertainty is ignored and the model with the best goodness-of-fit is assumed as the data generating model, leading to over-confident inferences. In this paper we present a methodology to account for model selection uncertainty in the estimation of age-dependent prevalence and force of infection, using model averaging of fractional polynomials. We illustrate the method on a seroprevalence crosssectional sample of hepatitis A, taken in 1993 in Belgium. In a simulation study we show that model averaged prevalence and force of infection using fractional polynomials have desirable features such as smaller mean squared error and more robust estimates as compared with the general practice of estimation based only on one selected “best” model.
Key words: Bias, Mean Squared Error, Multimodel Estimation, Seroprevalence.
1. Introduction
    The process of understanding and explaining mechanisms and relationships
in diverse scientific areas is a very complex one. A large number of observable
and non-observable factors govern truth in natural phenomena, and statistical
models are used in many situations to understand and represent natural relation-
ships. In the best cases we can hope to make meaningful inferences about truth
based on a good approximating model. Likelihood and least squares methods
provide a rigorous inference theory if the model structure is given, however, in
most practical scientific problems the model structure is unknown (Burnham &
Anderson 2002, Castañeda & Gerritse 2010). A typical strategy used when ana-
lyzing data is to identify a model from a class of models and utilize the selected
model for estimation purposes. This approach assumes that the data has been
generated from the selected model, ignoring model selection uncertainty which
leads to over-confident inferences (Hoeting, Madigan, Raftery & Volinsky 1999).
This raises an important concern regarding model selection uncertainty and the
need to account for this uncertainty in model selection and estimation of param-
eters of interest. One possibility to account for model selection uncertainty is the
multimodel inference based on model averaging, in which frequentist information-
theoretic (Burnham & Anderson 2002) and Bayesian (Hoeting et al. 1999) perspec-
tives provide a well defined methodology. In this paper we focus on the frequentist
information-theoretic approach based on the estimated relative Kullback-Leibler
distance (Kullback & Leibler 1951).
    Infectious diseases, including Hepatitis A, can be studied by a model that
allows the estimation of parameters such as age-dependent prevalence and force
of infection, which are susceptible to model selection uncertainty. An example
of model selection uncertainty is when two or more models fit the data equally
well according to a given criterion, but do not give the same estimate of the age-
dependent prevalence and force of infection. Small differences from one model to
another might not severely affect the estimation of prevalence, but in the case


                                      Revista Colombiana de Estadística 38 (2015) 163–179

Accounting for Model Selection Uncertainty: Prevalence and Force of Infection       165

of force of infection, a primary epidemiological parameter, these differences can
largely affect the estimation of such a sensitive parameter.
    Shkedy, Aerts, Molenberghs, Beutels, & Damme (2006) described the use of
fractional polynomials to estimate age-dependent prevalence and force of infection
on seroprevalence samples of hepatitis A, rubella, mumps and varicella. They
showed the advantages of this flexible modeling technique and advised its use in
the estimation of force of infection.
   In this paper we extend the work from Shkedy et al. (2006) by proposing a
methodology that accounts for model selection uncertainty.
    Faes, Aerts, Geys & Molenberghs (2007) explained that normally it is not clear
what models should be used for model averaging and suggested that fractional
polynomials are a natural and flexible family of parametric models, lending itself
nicely as the set of models to be used in model averaging. They also showed
the application of fractional polynomials for the estimation of a safe dose level
of exposure in the framework of model averaging. Goeyvaerts, Hens, Ogunjimi,
Aerts, Shkedy, Damme & Beutels (2010) also considered multimodel inference in
the context of estimation of infectious disease parameters.
    In this paper we propose the use of the frequentist information-theoretic ap-
proach for model averaging of fractional polynomials to account for model selec-
tion uncertainty when estimating age-dependent prevalence and force of infection.
These two age-dependent parameters are defined in Section 2. In Section 3 we
present fractional polynomials in the context of models for binary responses. The
use of model averaging of fractional polynomial estimates to account for model
selection uncertainty is described in Section 4. In Section 5 we illustrate the appli-
cation of model averaging using fractional polynomials to estimate age-dependent
prevalence and force of infection of hepatitis A in Belgium (Beutels, Damme &
Aelvoet 1997) with models assuming a logistic form for the fraction of disease-
susceptible individuals at age a. In Section 6 we present a simulation study that
shows the advantages of the proposed methodology over the traditional strategy
of selecting one single “best” model. We finish with a discussion in Section 7.



2. Age-Dependent Prevalence and Force of Infection
    Mathematical models consisting of a set of differential equations which aim
to describe the flow of individuals from one disease stage to the other are often
used to describe the process of infectious diseases. Under some conditions (lifelong
immunity, disease irreversible and negligible mortality caused by the infection) the
partial differential equation which describes the change in the susceptible fraction
at a certain age is called force of infection (Shkedy et al. 2006). In epidemi-
ology the force of infection is the rate at which susceptible individuals become
infected by an infectious disease. The force of infection can be used to compare
the rate of transmission between different groups of the population for the same
infectious disease or even between different infectious diseases. Several authors
have proposed different methods for estimation. Farrington (1990) used nonlinear


                                     Revista Colombiana de Estadística 38 (2015) 163–179

166                                                       Javier Castañeda & Marc Aerts


models to estimate force of infection. For the estimation of both the prevalence and
the force of infection Keiding (1991) used isotonic regression and Shkedy, Aerts,
Molenberghs, Beutels & Damme (2003) used local polynomials. None of these
authors accounted for model selection uncertainty in the estimation of prevalence
and force of infection.
   Typically the force of infection can be estimated from a seroprevalence age-
specific cross-sectional sample of size N with aj the age of the j th subject. Sero-
prevalence data are binary data defined as: Y = 1 if Z > ζ or Y = 0 if Z ≤ ζ;
where Z is the (log of the) antibody level and ζ a certain threshold value. The
binary variable Yj will take value 1 if subject j had experienced infection before
age aj and value 0 otherwise.
   Shkedy et al. (2006) assumed that the disease is irreversible, meaning that the
immunity is lifelong, and that the mortality caused by the infection is negligible
and can be ignored. Under these assumptions the partial differential equation
describing the change in the susceptible fraction at age a and time t is given by:
                       ∂           ∂
                          q(a, t) + q(a, t) = −`(a, t)q(a, t)
                       ∂a          ∂t
where q(a, t) is the fraction of susceptible individuals at age a and time t, and
`(a, t) is the hazard or force of infection describing the rate at which susceptible
individuals become infected. In a steady state, the term involving the time deriva-
tive is equal to zero and the partial differential equation reduces to the following
ordinary differential equation:
                                   d
                                     q(a) = −`(a)q(a).
                                  da
This representation of the model is known as the static model and describes the
change in the susceptible fraction with the host age. The age-dependent prevalence
is given by π(a) = 1 − q(a).
   If q(a) is the fraction of susceptible individuals at age a, π(a) = 1 − q(a) can
be defined as the probability to be infected at age a and the log-likelihood is given
by (Shkedy et al. 2006):
                        N
                        X
                   L=         log(π(aj )) + (1 − Yj ) log(1 − π(aj )).
                        j=1

Here π(a) = g −1 (η(a)), where η(a) is the linear predictor and g is the link function.
For binary responses, g is often taken to be a logit link function, log(π/(1 − π)).
   Using the static model and assuming a logit link function, the force of infection
can be written as:
                               q 0 (a)     π 0 (a)             eη(a)
                    l(a) = −           =           = η 0 (a)
                               q(a)      1 − π(a)            1 + eη(a)
Shkedy et al. (2006) derived the expression of the force of infection for other link
functions.

                                       Revista Colombiana de Estadística 38 (2015) 163–179

Accounting for Model Selection Uncertainty: Prevalence and Force of Infection             167

3. Fractional Polynomials
    The motivation to model the force of infection with fractional polynomial as
linear predictors, given a link function, is to allow for flexible changes on the force
of infection over the age of the host (Shkedy et al. 2006). Conventional polynomials
do not have asymptotes and fit the data poorly whenever asymptotic behavior of
the infection is expected. High order conventional polynomials offer a wide range
of curve shapes but often fit the data badly at the extremes of the observed age
and fit the data poorly whenever asymptotic behavior of the infection process is
expected.
    Fractional polynomials are a generalization of the conventional polynomial class
of functions (Royston & Altman 1994). Fractional polynomials can be described as
sums of m terms of the form apl or apl log(a). In the context of binary responses,
a fractional polynomial of degree m for the linear predictor is defined as (Shkedy
et al. 2006),
                                                         m
                                                         X
                      ηm (a, β, p1 , p2 , . . . , pm ) =   βl Hl (a),
                                                       l=0

where m is an integer, p1 ≤ p2 ≤ . . . ≤ pm is a sequence of powers, β =
(β0 , . . . , βm ) are regression parameters and Hl (a) is a transformation function
given by
                                    pl
                                    a                 pl 6= pl−1
                          Hl (a) =
                                     Hl−1 (a) × log(a) pl = pl−1
                                   

With p0 = 0 and H0 = 1. The definition includes possible “repeated powers” that
involve powers of log(a), as in the case of having a fractional polynomial of degree
m = 2 with “repeated powers” (1, 1) which takes the form β0 + β1 a + β2 a ln(a).
   In this paper we focus on generalized linear models with logit link function
and fractional polynomials of degree m = 2 as linear predictors for which the
only covariate in the model is the host age. Royston & Altman (1994) argued
that, fractional polynomials of order higher than two are rarely needed in practice
and suggested to choose the value of the powers from a set similar to {−2, −1.5,
−1, −0.5, 0, 0.5, 1, 1.5, 2, max(3, m)}.
     One problem that arises when a higher order polynomial model is fitted is that
the estimate for the force of infection can become negative. To avoid this, one can
fit fractional polynomials over the sequence of powers, and check for each fitted
model if η 0m (a, β, p1 , p2 , . . . , pm ) ≥ 0, for all ages a. In case that a given sequence
of powers leads to a negative derivative of the linear predictor, the model is not
considered an appropriate model.
    Even though the selection of a single model (e.g. the best fitting model) for
estimation purposes is very common, this approach ignores model selection un-
certainty. Shkedy et al. (2006) selected the model with the best goodness-to-fit
among all fractional polynomials for which η 0m (a, β, p1 , p2 , . . . , pm ) ≥ 0, which ig-
nores model selection uncertainty. In the next section we present a methodology
that accounts for model selection uncertainty.


                                        Revista Colombiana de Estadística 38 (2015) 163–179

168                                                    Javier Castañeda & Marc Aerts


4. Model Selection Uncertainty
    Likelihood and least squares methods provide a rigorous inference theory if
the model structure is given. However, in many practical scientific problems there
is not a given pre-specified model structure and there is uncertainty about the
correct model to be used. Model selection uncertainty arises when the data are
used for both, model selection and parameter estimation.
  Denote the sampling variance of an estimator θ̂, given a model, by var(θ̂|model).
More generally, the sampling variance of θ̂ should have two components:
      1) var(θ̂|model)
    2) a variance component due to not knowing the best approximating model to
be used and therefore having to estimate it (Burnham & Anderson 2002).
    Failure to allow for model selection uncertainty often results in estimating sam-
pling variance that is too low and confidence interval coverage below the nominal
value.


4.1. Multimodel Inference: Model Averaging
    Traditionally when a set of fractional polynomials is used, attention is restricted
to the so called “best” fitting model. This approach assumes that the data has been
generated from the selected fractional polynomial model, ignoring model selection
uncertainty which leads to over-confident inferences (Hoeting et al. 1999). Instead
of focusing on one single model, one can treat each model in the set of fractional
polynomial models as a possible model of interest (Faes et al. 2007).
      Given a set of R fractional polynomial models that lead to a non-negative
force of infection, specified independently of the sample data, formal inferences
can be made based on the entire set of models. In this paper our focus is on
models assuming a logistic form to estimate the prevalence of infection where the
fractional polynomial is the linear predictor and the only covariate in the model
is the host age. The linear predictor is not of main interest here, but rather the
resulting estimate of the prevalence, and the force of infection. Each one of the
R possible models yields an estimate of the age-dependent prevalence. We define
a model-averaged (MA) estimate of the age-dependent prevalence of infection, at
age a, as
                                                          eη̂M A (a)
                       π̂M A (a) = g −1 (η̂M A (a)) =                 ,             (1)
                                                       1 + eη̂M A (a)
                    PR
where η̂M A (a) = i=1 wi η̂i (a), wi is the weight of evidence in favor of model i and
η̂i (a) is the estimated fractional polynomial for model i. Burnham & Anderson
(2002) proposed the weights wi defined as the Akaike weights (Akaike 1974),
                                           exp − 21 ∆i
                                                        
                                wi = PR               1
                                                            
                                          r=1 exp − 2 ∆r

where ∆i = AICi − AICmin the Akaike Information criterion (AIC) difference
between the AIC of model i and the minimum AIC calculated in the entire set of

                                     Revista Colombiana de Estadística 38 (2015) 163–179

Accounting for Model Selection Uncertainty: Prevalence and Force of Infection            169

models. Here AICi = 2ki − 2Li , with ki the number of parameters in model i and
Li the log-likelihood for model i. The wi depends on the entire set of R logistic
fractional polynomial models and add to 1. Part of multimodel inference includes
first ranking the fitted logistic fractional polynomial models from best to worst,
based on the AIC differences ∆i = AICi − AICmin . After ranking the models the
second step is scaling them to obtain the relative plausibility of each fitted model
by a weight of evidence (wi ) relative to the selected best model. The AIC is an
asymptotically unbiased estimator of the relative, expected Kullback-Leibler (K-
L) distance (Faes et al. 2007). As a result, the weight wi is the weight of evidence
in favor of model i for being the K-L best model, given the design and sample size.
In this way, the best model k has ∆k = 0, and thus exp − 12 ∆k = 1. The larger
∆i , the smaller exp − 12 ∆i , and the smaller weight wi given to the model.
   Unconditional inferences about precision can be made over the entire set of
models by using the Akaike weights (wi ) and the sampling variance of the esti-
mator η̂ given logistic fractional polynomial model i. The latter is also called the
conditional sampling variance, var(η̂|modeli ).
  Faes et al. (2007) derived the unconditional variance of the model-averaged esti-
mate as follows. When η is estimated from a specific logistic fractional polynomial
model with parameters β, then the variance of η̂ is estimated as
                                             T                   
                                         ∂η                    ∂η
                      Var(η̂)
                      d       =                    d β̂)
                                                   Cov(
                                         ∂β                    ∂β       β =βˆ,

            d β̂) the estimated covariance matrix of β̂. However, when interested
    With Cov(
                                             PR
in the model-average estimator ηM A = i=1 wi ηi , which is estimated as η̂M A =
PR
   i=1 wi η̂i , the variance of η̂M A can be expressed as:

                           R
                           X
                                 wi2 E (η̂i − ηM A )2 | Mi
                                                               
           Var(η̂M A ) =
                           i=1
                             R
                           R X
                           X
                      +              wi wj E ((η̂i − ηM A )(η̂j − ηM A ) | Mi , Mj )
                           i=1 j=1
                             i6=j


The first term, the mean squared error of η̂i given model Mi , can be written as

            E (η̂i − ηM A )2 | Mi = E (η̂i − ηi + ηi − ηM A )2 | Mi
                                                                   

                                                                    2
                                         = E ((η̂i − ηi ) | Mi ) + (ηi − ηM A )2
                                         + 2(ηi − ηM A )E ((η̂i − ηi ) | Mi )
                                         = Var(η̂i | Mi ) + (ηi − ηM A )2 ,

which is the sum of the conditional variance Var(η̂i | Mi ) of η̂i given model Mi and
the squared bias of ηi with the model-averaged parameter ηM A . The covariance
term can be written as


                                          Revista Colombiana de Estadística 38 (2015) 163–179

170                                                              Javier Castañeda & Marc Aerts




  E ((η̂i − ηM A )(η̂j − ηM A ) | Mi , Mj )
                        q
                 = ρij E ((η̂i − ηM A )2 | Mi ) E ((η̂j − ηM A )2 | Mj )
                   q
             = ρij (Var(η̂i | Mi ) + (ηi − ηM A )2 ) (Var(η̂j | Mj ) + (ηj − ηM A )2 ),

where ρij represents the across-model correlation of η̂i with η̂j , with respect to
ηM A . As a result,
                      R
                      X
                            wi2 Var(η̂i | Mi ) + (ηi − ηM A )2
                                                                 
      Var(η̂M A ) =
                      i=1
                        R
                      R X
                      X
                +               wi wj ρij
                      i=1 j=1
                        i6=j
                      q
                ×         (Var(η̂i | Mi ) + (ηi − ηM A )2 ) (Var(η̂j | Mj ) + (ηj− ηM A )2 ).

    Often, it is assumed that there is an almost perfect correlation between the
estimates from different models, and ρij is conservatively assumed to be equal to
1 (Buckland, Burnham & Augustin 1997). In this case the unconditional variance
can be written as in Burnham & Anderson (2002),

                                      R
                                                                                !2
                                      X       p
                Var(η̂M A ) =               wi Var(η̂i | Mi ) + (ηi − ηM A )2                   (2)
                                      i=1

This unconditional variance can be estimated by use of estimates (η̂i , η̂M A ) instead
of parameters (ηi , ηM A ).
                                         q
    For large samples, η̂M A (a) ± z1−α/2 Var(η̂
                                           d M A (a)) is a confidence interval for
the true model-averaged logit at age a. The unconditional variance can be used
to estimate unconditional confidence limits for the age-dependent prevalence of
                                                   eη̂M A (a)
infection. Using the transformation π̂M A (a) = 1+e   η̂M A (a) , the endpoints of the

confidence interval for the estimated model-averaged logit invert to a corresponding
confidence interval for the estimated age-dependent model-averaged prevalence
(Agresti 2002).
    Multimodel inference using model averaging is recommended because it ac-
counts for the additional variability that is induced by the model selection process.
If the purpose is to compare different established models with well-known phys-
ical interpretations, and the investigator is not confronted with model selection
uncertainly, then multimodel inference may not be required.




                                              Revista Colombiana de Estadística 38 (2015) 163–179

Accounting for Model Selection Uncertainty: Prevalence and Force of Infection       171

5. Application to a Seroprevalence Sample of
   Hepatitis A
    In the previous sections we illustrated the methodology of model averaging
using fractional polynomials to account for model selection uncertainty. In this
section this methodology is applied to the estimation of age-dependent prevalence
and force of infection of hepatitis A with models assuming a logistic form for the
fraction of disease-susceptible individuals at age a and fractional polynomials that
lead to a non-negative force of infection. We restrict the discussion to models for
which the only covariate in the model is the host age.
    Viral hepatitis is a serious health problem throughout the world. In Flanders,
Belgium, a sero-epidemiological study was undertaken between April 1993 and
February 1994 in a sample of the general population. A total of 4,058 blood
samples were drawn and collected in 10 hospitals in Flanders. Beutels et al.
(1997) published the data of this study in which the objective was to calculate
the number of persons in the population who tested positive for hepatitis A based
on serology (blood serum) specimens. The purpose of this study was to obtain
a clear understanding of the prevalence of hepatitis A. This data has also been
analyzed by Shkedy et al. (2006) and Hens, Shkedy, Aerts, Faes, Van Damme &
Beutels (2012), among others.


5.1. Model Averaging of Age-Dependent Prevalence
     Using Fractional Polynomials
    Using the methods described in section three and the set of powers {−2, −1.5,
−1, −0.5, 0, 0.5, 1, 1.5, 2, 3}, fractional polynomials of degree one and two are used
as linear predictors to estimate the prevalence of hepatitis A. A total of 55 gener-
alized linear models with logit link function are fitted and 32 of these models are
used for analysis as they lead to non-negative force of infection. Each of the R =
32 models corresponds to a different fractional polynomial used as linear predictor
based on the host age. Considering the AIC criterion, the “best” fractional polyno-
mial is the one with the smallest AIC. Typically the “best” fractional polynomial
would be used for estimation of prevalence but this procedure ignores model se-
lection uncertainty. Model averaging is used to account for this uncertainty in the
estimation of age-dependent prevalence.
    The first step in the model averaging process is the ranking of the 32 models
from best to worst, based on ∆i = AICi − AICmin . The “best” model is the
one with AIC=AICmin and AIC difference ∆i = 0. After ranking the models,
weights of evidence relative to the selected best model are used to scale and obtain
the relative plausibility of each fitted model. To do this Akaike weights wi are
calculated for each model. The ranking and scaling of the complete set of fractional
polynomials is presented in Table 1. The best and the second best fitting fractional
polynomials (logistic models with linear predictors of the form β0 + β1 a + β2 a1.5
and β0 + β1 a + β2 a log(a), respectively) are equally parsimonious and have similar
maximized log-likelihood, −184.1 and −188.0 respectively. The third and fourth


                                     Revista Colombiana de Estadística 38 (2015) 163–179

172                                                                                                                                        Javier Castañeda & Marc Aerts


models also appear to have an appropriate fit to the data. Thus, several models are
nearly equally good for fitting the data, illustrating model selection uncertainty.
Figure 1 shows the nearly equal estimated age-specific prevalence using the best
fitting four fractional polynomial logistic regression models.

Table 1: Ranking and scaling of 32 fractional polynomials that lead to non-negative
         force of infection. Powers (p1, p2), AIC value, and AIC weights (w).
                                                    p1    p2     AIC            w                          p1                            p2       AIC       w
                                                      1   1.5   374.27        0.9740                      -0.5                           1.5     427.54   0.0000
                                                      1     1   382.00        0.0204                      -0.5                             2    443.30    0.0000
                                                    0.5     2   385.05        0.0045                        -1                           1.5    447.06    0.0000
                                                    0.5   1.5   388.32        0.0009                      -1.5                           1.5     462.90   0.0000
                                                    0.5     1   391.33        0.0002                      -0.5                             3    467.78    0.0000
                                                    0.5   0.5   393.53        0.0001                        -2                           1.5    474.39    0.0000
                                                   -0.5   0.5   394.40        0.0000                        -1                             2    477.05    0.0000
                                                      0   0.5   394.53        0.0000                      -0.5                             0    499.57    0.0000
                                                      0     1   401.27        0.0000                      -1.5                             2    506.57    0.0000
                                                      0   1.5   406.84        0.0000                        -2                             2    529.47    0.0000
                                                   -0.5     1   410.43        0.0000                        -1                             3    530.65    0.0000
                                                      0     2   410.80        0.0000                      -1.5                             3    590.59    0.0000
                                                      0     3   414.62        0.0000                        -2                             3    639.14    0.0000
                                                     -1     1   417.56        0.0000                        -1                             0    654.24    0.0000
                                                   -1.5     1   422.25        0.0000                      -1.5                             0    855.24    0.0000
                                                     -2     1   424.89        0.0000                        -2                             0    1043.96   0.0000



                                                   Best F.P. model (p1=1, p2=1.5)                                              Second Best F.P. model (p1=1, p2=1)
                       0.0 0.2 0.4 0.6 0.8 1.0




                                                                                                           0.0 0.2 0.4 0.6 0.8 1.0
      Seroprevalence




                                                                                         Seroprevalence




                                                   0      20     40      60      80                                                  0         20   40    60       80
                                                                 Age                                                                                Age
                                                 Third Best F.P. model (p1=0.5, p2=2)                       Fourth Best F.P. model (p1=0.5, p2=1.5)
                       0.0 0.2 0.4 0.6 0.8 1.0




                                                                                                           0.0 0.2 0.4 0.6 0.8 1.0
                                                                                         Seroprevalence
      Seroprevalence




                                                   0      20     40      60      80                                                  0         20   40    60       80

                                                                 Age                                                                                Age
              Figure 1: Estimated best four fractional polynomial models for prevalence.


                                                                                   Revista Colombiana de Estadística 38 (2015) 163–179

Accounting for Model Selection Uncertainty: Prevalence and Force of Infection             173

    Once the model-averaged estimate of the age-dependent prevalence of infection
is estimated using equation (1) and the calculated Akaike weights, model selection
uncertainty is accounted for by the unconditional variance function in equation
(2) using the set of 32 logistic fractional polynomial models. The unconditional
variance is used to estimate unconditional confidence limits for the age-dependent
prevalence of infection as shown at the end of Section 4.1. Model averaged and
unconditional confidence limits for the age-dependent prevalence of infection at
ages from 1 to 85 are presented in Figure 2.
                            1.0
                            0.8
           Seroprevalence
                            0.6
                            0.4
                            0.2
                            0.0




                                  0   20        40         60         80
                                                 Age
Figure 2: Model averaged estimated age-dependent prevalence (solid line) and uncon-
          ditional 95% confidence limits (dashed line). Dotted lines correspond to the
          estimated prevalence with each of the four best-fitting fractional polynomials.
          The size of the circles is proportional to the number of observed subjects at
          each age.



5.2. Model Averaging of Age-Dependent Force of
     Infection Using Fractional Polynomials
    In the previous section we used model averaging of logistic fractional poly-
nomial models for estimating the age-dependent prevalence of hepatitis A. Using
the same fractional polynomial models we can proceed to estimate the force of
infection.
   Using the static model and assuming a logit link function, the force of infection
                                        eη̂(a)
can be estimated as ˆl(a) = η̂ 0 (a) 1+e   η̂(a) , where η̂(a) is an estimated (fractional

polynomial) linear predictor and η̂ 0 (a) is its first derivative with respect to age.
Using ˆli (a), the estimated force of infection from fractional polynomial i, the model
                                                              PR
averaged force of infection is estimated as ˆlM A (a) = i=1 wi ˆli (a).
   The unconditional variance of the force of infection can be estimated as Var(  d ˆlM A )
               q                                2
    PR            d ˆ            ˆ ˆ           2                              d ˆli | Mi )
=      i=1 wi Var(li | Mi ) + (li − lM A )          . Using the delta method, Var(


                                           Revista Colombiana de Estadística 38 (2015) 163–179

174                                                                                  Javier Castañeda & Marc Aerts

                         d ˆli | Mi ) = ϕ̂i (η̂ 00 + η̂ 02 (1 − ϕ̂i )) 2 Var(η̂
                                                                     
can be calculated as Var(                                                d i | Mi ) with
                                                 i     i
       eη̂i          0       00
ϕ̂i = 1+eη̂i , and η̂i and η̂i the first and second derivatives with respect to age of
the estimated logit, respectively.
    Figure 3 shows the estimated model averaged force of infection (continuous line
[M.A.F.I]) and unconditional 95% confidence limits (95% C.l1. for F.I.) using the
32 fractional polynomials. It also shows the estimated force of infection (F.I.) from
the best four fractional polynomials (F.I.- 1st, F.I.- 2nd, F.I.- 3rd and F.I.- 4th).
Figure 3 displays an important issue when working with the force of infection;
despite the almost equal fit of the best four models for the prevalence (Figure 1),
the estimated force of infection using each of these models shows clear differences
and model selection uncertainty is even more evident for the force of infection.
Small differences from one model to another could slightly affect the estimation
of prevalence, but in the case of the force of infection, a primary epidemiological
parameter, small differences in these models can severely affect the estimation of
such a sensitive parameter.
                                0.05




                                           M.A.F.I.
                                           95% C.I. for M.A.F.I.
                                           F.I. − 1st
                                0.04




                                           F.I. − 2nd
                                           F.I. − 3rd
                                           F.I. − 4th
           Force of Infection
                                0.03
                                0.02
                                0.01
                                0.00




                                       0               20               40            60           80

                                                                          Age
Figure 3: Estimated model averaged force of infection, unconditional 95% confidence
          limits and estimated force of infection from the four best-fitting fractional
          polynomial models.




6. Simulation Study
    We have applied the methods discussed in previous sections to the single cross
sectional seroprevalence dataset of hepatitis A. In order to assess the methodol-
ogy of model averaging using fractional polynomials to estimate age-dependent
prevalence and force of infection, we present information on true expected values,
such as variance, bias and mean squared error of the multimodel estimator based
on a simulation study of B = 500 runs. Using fractional polynomials that lead
to non-negative force of infection, here we concentrate on the comparison of the
estimates using only the best fitting fractional polynomial model (which ignores
model selection uncertainty) and the model averaged estimate which accounts for

                                                                   Revista Colombiana de Estadística 38 (2015) 163–179

Accounting for Model Selection Uncertainty: Prevalence and Force of Infection               175

model selection uncertainty using fractional polynomials based on the set of powers
{−2, −1.5, −1, −0.5, 0, 0.5, 1, 1.5, 2, 3}.
    To study the characteristics of the model averaged estimate for prevalence and
force of infection, we assume that we know the underlying data generation mecha-
nism. Thus, it is possible to generate several independent datasets from the same
underlying process. Five hundred independent seroprevalence datasets are gener-
ated assuming an underlying process based on ηtrue (a) = −3.0 + 0.02(age)1.5 −
0.02(age)1.3 . The fractional polynomial class does not encompass this linear pre-
dictor, as the power 1.3 is not included in the set of powers.
   The true prevalence and true force of infection at age a are calculated as
             e(ηtrue (a))                    0
πtrue (a) = 1+e (ηtrue (a)) and true (a) = η true (a)πtrue (a), respectively. Therefore the

true prevalence and the true force of infection are known and comparisons can be
done based on the asymptotic true variance, bias and mean squared error (MSE).
    For each age (from 1 to 85 years old) the number of positive cases (number of
infected cases at age a) is generated using a binomial distribution with parameters
πtrue (a) and ni = total number of people at age a sampled in 1993 in Belgium.
Figure 4 shows one of such a generated seroprevalence datasets (circles) and the
‘true’ age-dependent prevalence (solid line).
                              1.0
                              0.8
             Seroprevalence
                              0.6
                              0.4
                              0.2
                              0.0




                                    0   20        40         60        80
                                                   Age
Figure 4: A simulated seroprevalence dataset (circles) and the true age-dependent
          prevalence πtrue (a) (solid line) based on the polynomial with p1 = 1.5 and
          p2 = 1.3. The size of the circles is proportional to the number of subjects at
          each age.


    Fractional polynomials of degree one and two are fitted to each of the 500
generated prevalence datasets. For each generated dataset, the logistic models
with fractional polynomials as linear predictors are ranked and scaled based on
the AIC weights and the model averaged prevalence and force of infection are esti-
mated. Thus, 500 model averaged prevalence and force of infection are estimated.
Similarly, for each one of the 500 generated datasets, the "best" fitting fractional
polynomial within the set of fractional polynomials is identified and used to esti-
mate the prevalence and force of infection. Therefore, model averaged and "best"
single model estimates can be compared with the true prevalence and true force of


                                             Revista Colombiana de Estadística 38 (2015) 163–179

176                                                              Javier Castañeda & Marc Aerts


infection to assess the characteristics of the unconditional and model-conditional
estimates.
    The asymptotic true variance,        bias and mean squared error (MSE) can be
                                   PB      ∗    ∗ 2
                                     b=1 (tb −t̄ )
estimated respectively as ν̂ =          B−1         , β̂ = t̄∗ − t and MSE
                                                                       [ = ν̂ + β̂ 2 ; with
b = 1, . . . , B, t the actual value of the parameter of interest (the true prevalence
or the true force of infection), t∗b the estimated parameter of interest from the b
                                                           t∗
                                                  PB
generated seroprevalence dataset, and t̄∗ = b=1
                                              B
                                                 b
                                                   .
   Two estimation methods are compared, estimation using model averaging which
uses all fractional polynomial models to account for model selection uncertainty,
and estimation using only the best fractional polynomial model (the model with
the minimum AIC among the set of fractional polynomials). The two estimation
methods are compared on their variance, bias and mean squared error (MSE) for
the estimation of the age-dependent prevalence and the force of infection.
   The true generating model (the fractional polynomial with powers p1 = 1.5 and
p2 = 1.3) was not selected as the best model since the fractional polynomial class
does not encompass the power 1.3. The fractional polynomial with powers p1 = 2
and p2 = 3 was selected as the best fitting model in 34% of the B runs. Fractional
polynomials with powers p1 = 1 and p2 = 3, and powers p1 = −2 and p2 = 1.5
appeared as the best fitting models in 17% and 16% of the times, respectively.
Although the underlying process is the same, there is considerable variation in
model selection across datasets and it shows model selection uncertainty.
    Table 2 shows the true age-dependent prevalence calculated from the data-
generating model, the sign of the bias, the squared bias (×10000), the variance
(×10000) and MSE (×10000) of the estimated prevalence based on the “best”
fractional polynomial only and based on model averaging.
Table 2: Simulation results for 500 runs. The true prevalence based on the simulating
         setting, prevalence based on the “best” fractional polynomial, model averaged
         prevalence with the fractional polynomials as a set of candidate models. The
         sign of the bias, the squared bias (×10000), the variance (×10000) and MSE
         (×10000) over all simulation runs.
           True        Prevalence based on the “best”               Model averaged prevalence
        prevalence          fractional polynomial
 Age                 (sign)    Bias2      Var      MSE          (sign)   Bias2     Var      MSE
 10       0.0592       +       0.0154   0.8082    0.8236          +      0.0134   0.7167   0.7301
 20       0.1003       +       0.0815   0.9591    1.0405          +      0.1120   0.7574   0.8694
 30       0.2013       +       0.0264   1.6565    1.6829          +      0.0516   1.2328   1.2844
 40       0.4110        -      0.0112   2.2208    2.2320           -     0.0209   2.0575   2.0784
 50       0.6979        -      0.0015   1.8262    1.8277           -     0.0205   1.5902   1.6107
 60       0.8999       +       0.0152   1.0378    1.0531          +      0.0223   0.9849   1.0073
 70       0.9760       +       0.0007   0.4050    0.4057          +      0.0146   0.2804   0.2950
 80       0.9953        -      0.0031   0.1057    0.1087          +      0.0010   0.0387   0.0397

   Comparing the two methods presented in Table 2, the estimates using only the
“best” fractional polynomial are less robust as compared with the estimates using
model averaging. In general, model averaging prevalence estimates have smaller
variance and MSE as compared with the estimated prevalence based only on the

                                        Revista Colombiana de Estadística 38 (2015) 163–179

Accounting for Model Selection Uncertainty: Prevalence and Force of Infection             177

“best” model. This indicates that model averaging is recommended over the use of
one single “best” fractional polynomial, since it reduces the MSE and yields more
precise estimates for the prevalence.
    Table 3 presents the true age-dependent force of infection, the squared bias, the
sign of the bias, the variance and MSE for the estimate of the force of infection
based on the “best” fractional polynomial only and based on model averaging.
Also for the force of infection, model averaging using the full set of fractional
polynomials shows consistently superior results as compared with the estimation
based on one single best fitting model. These results are comparable to the findings
reported by Faes et al. (2007) in the framework of the estimation of a safe level of
exposure with a continuous response.

Table 3: Simulation results for 500 runs. The true force of infection based on the simu-
         lating setting, force of infection based on the best fractional polynomial, model
         averaged force of infection with the fractional polynomials as set of candidate
         models. The sign of the bias, the squared bias (×10000), the variance (×10000)
         and MSE (×10000) over all simulation runs.
        True force        Force of infection based on                 Model averaged
             of                    the “best”                              force of
         infection          fractional polynomial                         infection
 Age                 (sign)   Bias2        Var       MSE     (sign)   Bias2       Var     MSE
 10      0.0025        +      0.0016     0.0088     0.0104     +      0.0021    0.0037   0.0059
 20      0.0071        +      0.0000     0.0078     0.0078     +      0.0001    0.0044   0.0045
 30      0.0186         -     0.0007     0.0183     0.0190      -     0.0009    0.0154   0.0163
 40      0.0457         -     0.0012     0.0715     0.0727      -     0.0040    0.0477   0.0517
 50      0.0894        +      0.0072     0.3245     0.3317     +      0.0056    0.2866   0.2922
 60      0.1292        +      0.0723     1.9356     2.0079     +      0.1775    1.3926   1.5701
 70      0.1542        +      0.1109     8.1142     8.2251     +      0.5805    3.7186   4.2990
 80      0.1707        +      0.0630    24.3592    24.4222     +      1.1253    8.1216   9.2469


    We also run simulations in the case the fractional polynomial class encompassed
the true generating model (using a fractional polynomial with powers p1 = 1.5 and
p2 = 3). In this case the true generating model was selected more frequently (44%
of runs) and the model averaged prevalence and force of infection estimates were
also more robust, in this instance with smaller MSE, smaller bias and smaller
variance, as compared with estimations based on a single “best” model.


7. Conclusion and Discussion
    Model uncertainty is an issue in applications where model selection, based on
observed data, is required. Researchers are frequently confronted with the criti-
cal issue of model selection uncertainty when using statistical modeling and often
this uncertainty is ignored leading to over-confident inferences. Data analysis for
epidemiological parameters of infectious diseases relies frequently on model selec-
tion. Small differences from one model to another might not severely affect the
estimation of the prevalence, but in the case of the force of infection, a primary
epidemiological parameter, small differences in models can largely affect the esti-


                                        Revista Colombiana de Estadística 38 (2015) 163–179

178                                                   Javier Castañeda & Marc Aerts


mation of such a sensitive parameter. The model selection process itself induces
additional variability that is not taken into account when estimation of the pa-
rameters is based only on the selected best fitting model. Thus, model selection
uncertainty is of concern and model averaging is a simple alternative of estimation
that takes all considered models into account by a ranking and scaling based on
weights of evidence.
    The use of fractional polynomials is a well-defined and flexible methodology for
the construction of a set of candidate models. For model averaging it is important
to start from a good set of candidate models and the use of fractional polynomials
is an attractive alternative. In the R-project, the package mfp can be used to
fit first and second order fractional polynomials. It is worth noticing that for
some applications assessment of goodness-of-fit is potentially useful in deciding
how appropriate the chosen model class is.
    Model averaging using fractional polynomials to estimate the prevalence and
the force of infection is a promising methodology to account for additional variabil-
ity induced by the model selection process. In our simulation study we show that
model averaged age-dependent prevalence and force of infection have desirable fea-
tures such as smaller variance and smaller mean squared error as compared with
the estimated prevalence and force of infection based, as frequently done, only on
one selected “best” model. The use of model averaging, based on a large flexible set
of predictor models, such as a set of fractional polynomials, is recommended and
yields more robust estimates as compared with the use of a single selected “best”
model, since outlying estimates are down weighted by the averaging process.
    There are some considerations that can be addressed in future studies. One
such consideration is about the correlation among the estimates from different
models and its impact on the estimation of the variance. This can be studied by a
bootstrap simulation to estimate the variance when correlation different from one
is considered.


Acknowledgments
    The authors gratefully acknowledge the VLIR-UOS scholarships program in
Belgium for funding the execution of this project. The authors wish to thank
Dr. Kukatharmini Tharmaratnam, Dr. Baerbel Maus and Dr. Amparo Castro,
for providing insightful suggestions to an early version of this paper and to the
referees for their valuable comments.
                                                              
               Received: October 2013 — Accepted: November 2014


References
Agresti, A. (2002), Categorical data analysis, 2nd edition, John Wiley & Sons, New York.
Akaike, H. (1974), ‘A new look at the statistical identification model’, IEEE transactions on automatic control 19, 716–723.
Beutels, M., Damme, P. V. & Aelvoet, W. (1997), ‘Prevalence of hepatitis A, B and C in the flemish population’, European Journal of Epidemiology 13, 275–280.
Buckland, S., Burnham, K. & Augustin, N. (1997), ‘Model selection: An integral part of inference’, Biometrics 53, 603–618.
Burnham, K. & Anderson, D. (2002), Model selection and multi model inference. A practical information-theoretic approach, 2, Springer, New York.
Castañeda, J. & Gerritse, B. (2010), ‘Appraisal of several methods to model time to multiple events per subject: Modelling time to hospitalizations and death’, Revista Colombiana de Estadística 11, 43–61.
Faes, C., Aerts, M., Geys, H. & Molenberghs, G. (2007), ‘Model averaging using fractional polynomials to estimate a safe level of exposure’, Risk Analysis 27(1), 111–123.
Farrington, C. (1990), ‘Modeling forces of infection for measles, mumps and rubella’, Statistics in Medicine 9, 953–967.
Goeyvaerts, N., Hens, N., Ogunjimi, B., Aerts, M., Shkedy, Z., Damme, P. V. & Beutels, P. (2010), ‘Estimating infectious disease parameters from data on social contacts and serological status’, Journal of the Royal Statistical Society. Series C (Applied Statistics) 59(2), 255–277.
Hens, N., Shkedy, Z., Aerts, M., Faes, C., Van Damme, P. & Beutels, P. (2012), Modeling Infectious Disease Parameters Based on Serological and Social Contact Data, 1st edition, Springer.
Hoeting, J., Madigan, D., Raftery, A. & Volinsky, C. (1999), ‘Bayesian model averaging: A tutorial’, Statistical Science 14(4), 382–401.
Keiding, N. (1991), ‘Age-specific incidence and prevalence: A statistical perspective’, Journal of the Royal Statistical Society. Series A (Statistics in Society) 154(3), 371–412.
Kullback, S. & Leibler, R. A. (1951), ‘On information and sufficiency’, Annals of Mathematical Statistics 22(1), 79–86.
Royston, P. & Altman, D. G. (1994), ‘Regression using fractional polynomials of continuous covariates: Parsimonious parametric modelling’, Journal of the Royal Statistical Society. Series C (Applied Statistics) 43(3), 429–467.
Shkedy, Z., Aerts, M., Molenberghs, G., Beutels, P., & Damme, P. V. (2006), ‘Modelling age-dependent force of infection from prevalence data using fractional polynomials’, Statistics in Medicine 25(9), 1577–1591.
Shkedy, Z., Aerts, M., Molenberghs, G., Beutels, P. & Damme, P. V. (2003), ‘Modelling forces of infection by using monotone local polynomials’, Journal of the Royal Statistical Society: Series C (Applied Statistics) 52(4), 469–485.
