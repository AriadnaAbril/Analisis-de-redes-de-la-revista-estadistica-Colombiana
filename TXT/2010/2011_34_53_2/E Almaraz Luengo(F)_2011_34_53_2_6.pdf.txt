An Application of Semi-Markovian Models to the Ruin Problem.  Una aplicación de los modelos semi-markovianos al problema de la ruina
Universidad Complutense de Madrid, España
Abstract
We consider the classical ruin problem due to Cramér and Lundberg and we generalize it. Ruin times of the considered models are studied and sufficient conditions to usual stochastic dominance between ruin times are established. In addition an algorithm to simulate processes verifying the conditions under consideration is proposed.
Key words: Coupling, Markov chains, Semi-Markov process, Simulation, Stochastic ordering.
Resumen
Se considera el problema clásico de ruina de Cramér y Lundberg y se generaliza. Se estudian los tiempos hasta la ruina de los modelos considerados y se establecen condiciones suficientes para la dominancia estocástica en el sentido usual entre los tiempos de ruina. Por otro lado, se establecen algoritmos de simulación de los procesos bajo estudio y de obtención de estimadores para las probabilidades involucradas.
Palabras clave: cadenas de Markov, dominancia estocástica, emparejamiento, proceso semi-markovianos, simulación.



1. Introduction
   The main purpose of the Ruin Theory is to obtain exact formulas or approx-
imations of ruin probabilities in different risk models, see Seal (1969), Gerber
(1995) and Ramsay (1992). Some of the most popular approximations are due
to Beekman (1969), in which a Gamma distribution is used to approximate the
  a Professor. E-mail: ealmarazluengo@mat.ucm.es




                                          477

478                                                            Elena Almaraz-Luengo

distribution of the claims, or the approximation due to De Vylder (1996), who ap-
proximates the ruin process using a simply process in which the ruin probability
is an exponential type. A relatively recent approach to estimate the probability of
ruin is presented by Goovaerts (1990), where bounds are established through the
ordering of the risks. Another kind of approach arises from the use of nonpara-
metric techniques such as resampling (see Frees 1986) or Monte Carlo simulation
(see Beard, Pentikäinen & Pesonen 1984).
    Many authors have studied the ruin problem, for example Reinhard (1984) and
Asmussen (1989). Reinhard (1984) considers a class of risk models in which the
frequency of claims and the quantities to be paid are influenced by an external
Markovian process (or environmental process), Reinhard & Snoussi (2001, 2002)
have analized the severity of ruin and the distribution of surplus prior to ruin in a
discrete semi-Markovian risk model. For more information about risk theory see
Beard et al. (1984), Latorre (1992) or Daykin (1994).
    In what follows, times to ruin in certain risk models will be ordered without an
explicit expression for the probability of ruin and without the use of approxima-
tions thereof, as was classically done by Ferreira & Pacheco (2005) and Ferreira &
Pacheco (2007).
    Many authors have studied these processes int he context of the Queuing The-
ory. However, they also have applicability for dynamic solvency models and sur-
vival analysis.
    This paper is organized as follows: in Section 2; the classical Cramér and
Lundberg risk model is described; in Section 3, the principal concepts and notation
being used in the rest of the paper are defined; in Section 4, the generalized model
is described and the principal results are shown; finally, in Section 5 algorithms of
simulation of the processes considered in Section 4, will be proposed.


2. Classical ruin model
   The Cramér-Lundberg’s classical risk model has its origin in Filip-Lundberg’s
doctoral thesis in 1903. In this work, Lundbery studied the collective reinsurance
problem and used compounded homogenous Poisson process. In 1930, Harald
Cramér re-examined Lundberg’s original ideas and formalize them in the stochastic
processes context.
   The original model is:
                                                 Nt
                                                 X
                            X(t) = X(0) + ct −         Yn                          (1)
                                                 n=1

with c > 0, X(0) ≥ 0 and X(0) Being the initial capital, c the premium density,
which is assumed to be constant, Yj the amount of the j-th claim and Nt is an
homogeneous Poisson process which represents the number of claims up to time t
(independent of the interval position and the history of the process). Claims Yj
are supposed to positive independent random variables which are independent of
the process Nt , with distribution F such that F (0) = 0 and whose mean µ is finite.

                                    Revista Colombiana de Estadística 34 (2011) 477–495

An application of SM models to the ruin problem                                      479

   If the arrival of the n-th claim is denoted by Sn , then:

                        Nt = sup {n ≥ 1 : Sn ≤ t} ,          t≥0

Note 1. The number of claims that have occurred up to time t can be approxi-
mated, in the Cramér and Lundberg’s model, from other distribution functions.

   The intervals between claims Tk = Sk − Sk−1 , k = 2, 3, . . . are independent
and identically distributed random variables with an exponential distribution with
parameter λ and finite mean and T1 = S1 .
   The aggregate claims until instant t are given by the random variable
                                              Nt
                                              X
                                     S(t) =         Yn
                                              n=1

known as compound Poisson. Its distribution is followed by
                                              ∞
                                              X               n
                                                           (λt) (n)
                   Gt (x) = P [S(t) ≤ x] =          e−λt        F (x)
                                              n=0
                                                             n!

with x, t ≥ 0 and F (n) the n-th convolution of F with F (0) the distribution function
of the measure of Dirac in 0.
   The time to ruin is defined as:

                             T = inf {t > 0 : X(t) ≤ 0}                              (2)

where inf ∅ = ∞.
   The probability of ruin in the interval [0, t] or probability of ruin in a finite
horizon is defined as:
                          ψ(u, t) = P [T ≤ t|X(0) = u]                           (3)
and the probability of ruin in an infinite horizon or simply probability of ruin is:

      ψ(u) = lim ψ(u, t) = lim P [T ≤ t|X(0) = u] = P [T < ∞|X(0) = u]               (4)
               t→∞            t→∞

Note 2. In this case, the probability in an infinite horizon is usually approximated
by the Normal-Power.

Definition 1. The basic Cramér-Lundberg’s process is described as

                         X(t) = X(0) + (1 + υ)λµt − S(t)
                                   c
where λµt = E [S(t)] and υ = λµ      − 1 > 0 is referred to as “solvency or safety
margin”, in order to guarantee survival (defined as the set of free capital whose
purpose is to address those risks that may threaten the solvency of the company,
the latter being the capacity to face obligations).


                                      Revista Colombiana de Estadística 34 (2011) 477–495

480                                                                       Elena Almaraz-Luengo

3. Preliminaries
   In this section we introduce notation that is used throughout the paper and
we set up some definitions. The introduced definitions are general and they can
be found in several texts, for example in Müller & Stoyan (2002), Shaked (2007)
or Almaraz (2009) among others.
   We let the following sets N = {0, 1, 2, . . .}, N+ = {1, 2, . . .} and R = (−∞, ∞).

Definition 2. Given two random variables X and Y taking values in a countable
ordered state space I, then Y is stochastically smaller than X in the usual sense,
and it is denoted as Y ≤st X, if P (Y ≤ i) ≥ P (X ≤ i) for all i ∈ I.

Definition 3. A subset U of Rn is regarded to be as increasing if y ∈ U when
y ≥ x and x ∈ U .

Definition 4. Let X and Y be two random vectors such that P [X ∈ U ] ≤ P [Y ∈
U ] for all the increasing subsets U ⊆ Rn . Then X is stochastically smaller than
Y in the usual sense and it is denoted as X ≤st Y .

Definition 5. Let X = {X(t), t ∈ T } and Y = {Y (t), t ∈ T }, be two stochastic
processes with state space I ⊆ R and time parameter space T (usually T = [0, ∞)
or T = N+ ). Suppose that, for all choices of an integer m and t1 < t2 < · · · < tm
en T , it happens that:

             (X(t1 ), X(t2 ), . . . , X(tm )) ≤st (Y (t1 ), Y (t2 ), . . . , Y (tm ))

Then X = {X(t), t ∈ T } is said to be stochastically smaller than Y = {Y (t), t ∈ T }
in the usual sense and it is denoted as X = {X(t), t ∈ T } ≤st Y = {Y (t), t ∈ T }.

Definition 6. A finite measure matrix is a matrix with non-negative entries whose
lines are finite measure vectors.

Definition 7. Let I and J be two countable ordered sets and let A = (aij )i∈I,j∈J
and B = (bij )i∈I,j∈J be two finite measure matrix with common indices on I × J.
Then the matrix A is said to be smaller than B in the Kalmykov sense, and it is
denoted as A ≤K B, if and only if:
                             X             X
                                  aim ≤          bjm , ∀i ≤ j     ∀n
                            m≥n            m≥n


   Also the following concepts will be necessary.

Definition 8. The counting process N = (Nt )t is an homogeneous Poisson process
with rate λ > 0 if:

  1. N0 = 0, almost sure.

  2. N has independent stationary increments.

                                         Revista Colombiana de Estadística 34 (2011) 477–495

An application of SM models to the ruin problem                                      481

  3. ∀ 0 ≤ s < t < ∞, Nt − Ns ∼ P (λ(t − s)), that is,

                                                    (λ(t − s))k
                     P [Nt − Ns = k] = e−λ(t−s)                 ,      k∈N
                                                         k!
Definition 9. (Markov process (MP)). A stochastic process {Xt , t ∈ T }, is said
to be a Markov process (or Markovian process) if

              P [Xtn+1 = xn+1 | Xt1 = x1 , Xt2 = x2 , . . . , Xtn = xn ] =


                           = P [Xtn+1 = xn+1 | Xtn = xn ]
for each n ∈ N y t1 < t2 < · · · < tn < tn+1 .
   This condition is known as the Markovian condition.

    A Markovian process with finite state space is known as the Markov Chain and
it can be in discrete time (DTMC) or continuous time (CTMC).

Definition 10. (Markovian Renewal process (MRP)). A bivariate process (Z, S) =
(Zn , Sn )n∈N is a Markovian Renewal process with phase states (countable) I and
kernel Q = (Q(t))t∈R P+ where Q(t) = (Qij (t))i,j∈I is a family of sub-distribution
functions such that j∈I Qij (t) is a distribution function, for each i ∈ I, if it is a
Markov process in I × R+ such that S0 = 0 and

               Qij (t) = P [Zn+1 = j, Sn+1 − Sn ≤ t | Zn = i, Sn = s]


for each n ∈ N, i, j ∈ I and s, t ∈ R+

Definition 11. (Semi-Markovian process (SMP)) A process W = (Wt )t∈R+ is a
semi-Markovian process with state space I and kernel Q (or admitting an embed-
ded kernel (P , F )) if
                          Wt = Zn , Sn ≤ t < Sn+1


for some MRP (Z, S) with phase space I and kernel Q (embedded kernel (P , F ))


4. Stochastic dominance of ruin times in semi-Markov
   modulated risk processes
   Let us consider the following generalization of the classic model:
                                         Z t                Nt
                                                            X
                        X(t) = X(0) +          cJ(s) ds −         Yn                 (5)
                                           0                n=1

where cj > 0 for all j, and X(0) ≥ 0.

                                      Revista Colombiana de Estadística 34 (2011) 477–495

482                                                                                       Elena Almaraz-Luengo

    Where X(0) is a random variable that represents the initial capital; J(s) a
semi-Markovian process; cj the Premium density when the process J(s) is in the
state j; Yn the size of the n-th claim and Nt a counting process associated to J
that represents the number of claims up to time t.
   Let (Sn , Kn ) a Markovian sequence associated to the process J, where

                                    Sn = inf {t ≥ 0 : Nt ≥ n} , n ∈ N

represents a sequence of events and

                                               Kn = J(Sn ), n ∈ N

is an irreductible and discrete Markov chain with state space I, a countable subset
of R, transition matrix P = (Pij )i,j∈I and representing the state visited in the
n-th tansistion, where

                                            Jt = Kn , Sn ≤ t < Sn+1

   Let Hn be the time between the (n − 1)-th and the n-th claim:

                                            Hn = Sn − Sn−1 , n ≥ 1                                         (6)



                  4


                  3


                  2                                   Y1
          X(t)




                  1     X(o)


                  0
                                                                                     S2
                                    state i       S1                 state j
                 −1

                 −0.5          0      0.5         1        1.5          2      2.5   3     3.5    4
                                                                 t
                                   Figure 1: Path of the process X(t).


   In classical literature, this graphical representation (Figure 1) is known as a
surplus process of ruin or process (see Bowers, Gerber, Hickman, Jones & Nesbitt
1997).
   In this way, the process may be written as:
                                            N
                                            X t −1                                         Nt
                                                                                           X
                 X(t) = X(0) +                       cKn Hn+1 + cKNt (t − SNt ) −                Yn        (7)
                                            n=0                                            n=1


                                                       Revista Colombiana de Estadística 34 (2011) 477–495

An application of SM models to the ruin problem                                                 483


where     cj > 0,    ∀j ∈ I.
   The semi-Markovian dependence structure under consideration is of the fol-
lowing type:

         P [Hn+1 ≤ x, Yn+1 ≤ y, Kn+1 = j|Kn = i, (Hr , Yr , Kr ), 0 ≤ r ≤ n] =

                     = P [H1 ≤ x, Y1 ≤ y, K1 = j|K0 = i] = Qij (x, y)                            (8)

    The sequence Q = (Qij )i,j∈I is the kernel of this process.
    The purpose of this paper is to establish sufficient conditions for the first order
stochastic dominance between the times of ruin of two processes like described in
(5).


4.1. Stochastic processes in which the amount of the claims
     depends on the environment
    Let us consider the following structure of the kernel:

                                 Qij (x, y) = pij Fij (x)Gij (y)                                 (9)

where

    • pij = Qij (∞, ∞) = P [Kn+1 = j|Kn = i], n ∈ N+ , i, j ∈ I

    • Fij is the distribution function of Hn |(Kn−1 = i, Kn = j), n ∈ N+ , i, j ∈ I

    • Gij is the distribution function of Yn |(Kn = i, Kn+1 = j), n ∈ N+ , i, j ∈ I

    This implies that (Y1 , Y2 , . . .) and (H1 , H2 , . . .) are conditionally independent
given (K0 , K1 , . . .) That is, the are conditionally independent given the evolution
of the process J.
   The parametrization of this process is (c, P, F, G), where c = (ci )i∈I ,
P = (pij )i,j∈I , F = (Fij )i,j∈I y G = (Gij )i,j∈I .
    We will denote the time to ruin of this process by:
                      n                     o                       
              (l)                                              (l)
             Tab = inf t > 0 : X (l) (t) ≤ 0 | X (l) (0) = b, K0 = a

Theorem 1. Let X (1) = (X (1) (t))t≥0 and X (2) = (X (2) (t))t≥0 be two stochas-
tic processes with parametrizations (c(1) , P (1) , F (1) , G(1) ) and (c(2) , P (2) , F (2) , G(2) )
respectively, as described in (5) and (9). Let J (1) (0) ≤ J (2) (0) and X (1) (0) ≤
X (2) (0).
    If
                                       (1)      (2)
                                      ci     ≤ ck ,   ∀i ≤ k                                   (10)

                                           P (1) ≤K P (2)                                      (11)

                                             Revista Colombiana de Estadística 34 (2011) 477–495

484                                                                                   Elena Almaraz-Luengo

                                      (1)              (2)
                                     Fij ≤st Fkl ,            ∀i ≤ k, j ≤ l                           (12)
                                      (2)              (1)
                                     Gkl ≤st Gij ,            ∀i ≤ k, j ≤ l                           (13)
         (1)           (2)
then Tiu ≤st Tjv             ∀i ≤ j, u ≤ v.

                                                                                                (1)    (2)
Proof . Let X (1) and X (2) as in the statement. We must prove that Tiu ≤st Tjv
for each i ≤ j, u ≤ v.
 The Markovian
               renewal sequence associated to J (l) , l = 1, 2 will be denoted as
  (l)   (l)
 Sn , K n .
      It is defined:
                           n                 o
                    ∗(l)             (l)         (l)        (l)
                  Tiu = inf Sn(l) : X (l) ≤ 0 |(X (l) = u, K0 = i),                      l = 1, 2.    (14)
                                            Sn               S0

                             (l)
h            the fact of X , l = 1, 2, being a non-decreasing sequence in
      Note that
     (l)  (l)
    Sn , Sn+1, denotes that:
                                                       (l)    ∗(l)
                                                 Tiu = Tiu                                            (15)
                                ∗(1)   ∗(2)
so it is enough to prove that Tiu ≤st Tjv                            ∀u ≤ v, i ≤ j.
      Let                                                           
                                                     e (1) , X
                                                     X       e (2)
                                                       n       n

be a couple of

                               (1)     (1)                           (2)    (2)
                             X (1) |X (1) = u and X (2) |X (2) = v
                               Sn      S0                            Sn     S0

on a common product probability space

                     Λ = Λ1 × Λ2 = (Ω, F , P ) = (Ω1 × Ω2 , F1 × F2 , P1 × P2 )
such that
                                     en(1) (ω) ≤ X
                                     X           en(2) (ω) , ∀ω ∈ Ω
and
                                        Sen1 (ω) ≤ Sen2 (ω), ∀ω ∈ Ω
            (l)                                  (l)
being Sen , a copy of the process Sn , l = 1, 2.

   To do that, the following independent sequences of independent uniform ran-
dom variables on the interval (0, 1) will be used: (Un )n∈N+ in Λ1 , (Vn )n∈N+ and
(Wn )n∈N+ in Λ2 .
               (1)
          e (ω1 ) = i and K           (2)
                                e (ω1 ) = j.
      Let K 0                    0
      In detail, for l = 1, 2:
                                        −1
                  e (l) (ω1 ) = P (l)(l)
                  K                          (Un (ω1 ))) ,                 n ∈ N+ , ω 1 ∈ Ω1          (16)
                    n              e  Kn−1 ,.



                                                  Revista Colombiana de Estadística 34 (2011) 477–495

An application of SM models to the ruin problem                                                          485
                                               −1
   e (l)     (l)
   Hn (ω) = F e (l)                    (l)
                                  e n (ω1 ))
                                                      (Vn (ω2 )),      n ∈ N+ , ω = (ω1 , ω2 ) ∈ Ω       (17)
                      (Kn−1 (ω1 ),K

                                               −1
   e (l)     (l)
   Yn (ω) = G e (l)                    (l)
                                  e n (ω1 ))
                                                      (Wn (ω2 )),       n ∈ N, ω = (ω1 , ω2 ) ∈ Ω        (18)
                      (Kn−1 (ω1 ),K


       e    (1)            e (2) = v and:
   Let X 0         = u and X 0

                                               n−1
                                               X                            n
                                                                            X
                                 e (l) +
                     e (l) (ω) = X                     (l)    (l)
                                                              e                   Yem(l) (ω),
                     X n           0                  c e (l) H
                                                       Km       m+1 (ω) −                                (19)
                                               m=0                          m=1

                                                                                                   (l)
n ∈ N, l = 1, 2, ω = (ω1 , ω2 ) ∈ Ω, be the embedded Markov Process of (X (l) )n≥0 ,
                                                                         Sn
l = 1, 2.
   Using (11), (12) and (13) we have respectively by construction:

                                           e (2) (ω1 ),
                             e (1) (ω1 ) ≤ K
                             K                                 ∀ω1 ∈ Ω1 , n ∈ N                          (20)
                               n             n

                                      e n(2) (ω),
                         e n(1) (ω) ≤ H
                         H                              ∀ω = (ω1 , ω2 ) ∈ Ω, n ∈ N                       (21)
and
                         Yen(1) (ω) ≥ Yen(2) (ω),       ∀ω = (ω1 , ω2 ) ∈ Ω, n ∈ N                       (22)

   On the other hand, using (10), (21) and (22), we have that:
                   n
                   X                     n
                                         X
                         Yem(1) (ω) ≥          Yem(2) (ω),    ∀ω = (ω1 , ω2 ) ∈ Ω, n ∈ N                 (23)
                   m=1                  m=1

                   n
                   X                   n
                                       X
   Sen(1) (ω) =          em
                         H (1)
                               (ω) ≤         em
                                             H (2)
                                                   (ω) = Sen(2) (ω),    ∀ω = (ω1 , ω2 ) ∈ Ω, n ∈ N       (24)
                   m=1                 m=1

      n−1
      X                             n−1
                                    X
             (1)    e (1)                     (2)    e(2)
            c e (1) H
             Km       m+1 (ω) ≤              c e (2) H
                                              Km       m+1 (ω),     ∀ω = (ω1 , ω2 ) ∈ Ω, n ∈ N           (25)
      m=0                           m=0

thus, leading to

                                     en(2) (ω) ∀ω = (ω1 , ω2 ) ∈ Ω, n ∈ N
                         en(1) (ω) ≤ X
                         X                                                                               (26)

   If denoted by:
                        n                  o
                 ∗(l)
              Teiu = inf Sen(l) : X
                                  e (l) ≤ 0 | (X       e (l) = i),
                                               e0 = u, K                                l = 1, 2         (27)
                                    n                    0


we have that
                               ∗(1)      ∗(2)
                            Teiu (ω) ≤ Tejv (ω),             ∀i ≤ j, u ≤ v, ω ∈ Ω                        (28)
intended to prove.

                                                    Revista Colombiana de Estadística 34 (2011) 477–495

486                                                                                 Elena Almaraz-Luengo

    In the special case in which the environment J is Markovian, particulary a
continuous time Markov chain (CTMC), the parametrization of the process (5)
is (c, P, q, G), where P = (pij )i,j∈I , q is the vector of transition rates from states
of J and G = (Gij )i,j∈I . In this case, the previous theorem has an immediate
                                                          (1)       (2)
application, it is enough to see that the condition Fij ≤st Fkl , ∀i ≤ k, j ≤ l is
                                                                                                      (2)
translated in a condition to the vectors of transition rates
                                                          from the states qk                              ≤
 (1)                                                    (l)                       (l)       (l)
qi       ∀i ≤ k, that is, the distribution function of Hn |                      Kn−1 = i, Kn = j     ,l =
                             (l)
1, 2, which was denoted as Fij , l = 1, 2 has in this case the following expression:
  (l)       (l)  (l)
Fij (x) = qi e−qi x for l = 1, 2.1
    In this way, the following two processes will be considered X (1) and X (2) as de-
scribes in (5) with parametrizations (c(1) , P (1) , q (1) , G(1) ) and (c(2) , P (2) , q (2) , G(2) )
respectively and then, the result for this particular case is described in the next
corollary.
                                     (1)                                   (2)
Corollary 1. Let X (1) = (Xt )t≥0 and X (2) = (Xt )t≥0 be two stochastic pro-
cesses with parameterizations (c(1) , P (1) , q (1) , G(1) ) and (c(2) , P (2) , q (2) , G(2) ) re-
spectively, as described in (5), with environments J (1) and J (2) beings CTMCs
with state space I, embedded transition probability matrices P (1) and P (2) and
vectors of transition rates from states q (1) and q (2) , respectively.
       Let J (1) (0) ≤ J (2) (0), and X (1) (0) ≤ X (2) (0). If
                                          (1)         (2)
                                         ci        ≤ ck ,         ∀i ≤ k                               (29)

                                               P (1) ≤K P (2)                                          (30)
                                           (2)         (1)
                                         qk ≤ qi                 ∀i ≤ k                                (31)
                                   (2)               (1)
                                 Gkl ≤st Gij ,                   ∀i ≤ k, j ≤ l                         (32)
          (1)        (2)
then Tiu ≤st Tjv           ∀i ≤ j, u ≤ v.

Proof . It is a direct consequence of Theorem 1.

   For the particular case in which the processes have the same transition matrix
P we may relax the conditions of the Theorem 1 to conditions involving only one
pair of states (i, j) such that pij > 0, in the following way.
                                     (1)                                   (2)
Corollary 2. Let X (1) = (Xt )t≥0 and X (2) = (Xt )t≥0 be two stochastic pro-
cesses with parameterizations (c(1) , P, F (1) , G(1) ) and (c(2) , P, F (2) , G(2) ) respec-
tively, as described in (5) and (9). If
                                               (1)         (2)
                                              cj     ≤ cj ,         ∀j                                 (33)

   1 Exponential distribution with intensity q        (l)
                                               i            and the distribution decreases stochastically in
the usual sense with this intensity


                                                   Revista Colombiana de Estadística 34 (2011) 477–495

An application of SM models to the ruin problem                                            487

and for each pair (i, j) such that Pij > 0
                                           (1)            (2)
                                          Fij ≤st Fij                                      (34)
                                           (2)            (1)
                                          Gij ≤st Gij                                      (35)
then
                                    (1)           (2)
                                  Tiu ≤st Tiv             ∀u ≤ v.

Proof . The result follows is derived from the construction used in the proof of
Theorem 1 since this construction now leads to K               e n(2) (ω1 ), ∀n ∈ N, ω1 ∈
                                                e n(1) (ω1 ) = K
Ω1 . This fact allows to conclude (21) and (22) using (34) and (35) despite of (12)
and (13). The rest of the proof is analogous.

4.1.1. A simple application

    In this section, a case from the counting process Nt , identified as a semi-
Markovian process J whose state space is {0, 1, 2 . . .} and whose transition prob-
ability matrix P is deterministic, in which case the probability to go from state n
to n + 1 is 1, is studied.
            (l)
   Let (Sn )n≥0 be a stochastic process with
                                            (l)         (l)
                                    0 = S0 < S1 < · · ·

such that
                                           (l)
                       Hn(l) = Sn(l) − Sn−1 ,           n ∈ N+ ,      l = 1, 2
are independent random variables with distribution function

                                          Fn(l) , l = 1, 2

and let                           n                 o
                       (l)
                     Nt      = sup n ≥ 0 : Sn(l) ≤ t , t ≥ 0, l = 1, 2
the counting process.
            (l)
   Let (Yj ), j ∈ N, l = 1, 2 be a sequence of independent random variables
                                   (l)                                         (l)   (l)
with distribution function (Gj ), j ∈ N+ , l = 1, 2. Let Hn , Gn be independent
∀n ∈ N+ .
   Let us consider the process (X (l) (t))t≥0 with parametrization (c(l) , F (l) , G(l) )
con l = 1, 2 defined as follows:

                                                                    (l)
                                                                Nt
                                                                X          (l)
                          X (l) (t) = X (l) (0) + c(l) t −                Yj               (36)
                                                                j=1

with c(l) > 0, X (l) (0) ≥ 0, and it is defined
                                 n                     o
                      Tu(l) = inf t ≥ 0 : X (l) (t) ≤ 0 |X (l) (0) = u                     (37)


                                           Revista Colombiana de Estadística 34 (2011) 477–495

488                                                                                Elena Almaraz-Luengo

Theorem 2. Let X (1) = (X (1) (t))t≥0 and X (2) = (X (2) (t))t≥0 be two stachastic
processes with parametrizations (c(1) , F (1) , G(1) ) and (c(2) , F (2) , G(2) ) as described
in (36), with X (1) (0) ≤ X (2) (0). If

                                                   c(1) ≤ c(2)                                            (38)

                                        Fn(1) ≤st Fn(2) ,     ∀n ∈ N+                                     (39)
                                        G(2)    (1)
                                         n ≤st Gn ,           ∀n ∈ N+                                     (40)
then
                                         Tu(1) ≤st Tv(2) ,     ∀u ≤ v
                                                                                       (1)        (2)
Proof . Let X (1) and X (2) as stated. It must be proved that Tu                             ≤st Tu     for all
u ≤ v.
      It is defined:
                                n                 o
                                          (l)        (l)
                    Tu∗(l) = inf Sn(l) : X (l) ≤ 0 |X (l) = u,                    l = 1, 2                (41)
                                                   Sn            S0


                           (l)
h            the fact of X ,
      Note that                                 l = 1, 2, being a non-decreasing sequence in
     (l)  (l)
    Sn , Sn+1, gives that:
                                                Tu(l) = Tu∗(l)                                            (42)
                                   ∗(1)   ∗(2)
therefore is enough to prove that Tu ≤st Tv                           ∀u ≤ v.
      For that, couplings will be build
                                                                           
                            Se(1) , Se(2)
                                    n       n           and    Xe (1) , X
                                                                  n
                                                                        e (2)
                                                                         n


of                                                                        
                                                                (1)     (2)
                                 Sn(1) , Sn(2)       and       X (1) , X (2)
                                                                 Sn      Sn
                         
            (1)     (2)
given X (1) , X (2) = (u, v) such that
            Sn     Sn

                               en(1) (ω) ≤ X
                               X           en(2) (ω) , ∀ω ∈ Ω,           n∈N

and
                                Sen(1) (ω) ≤ Sen(2) (ω), ∀ω ∈ Ω,        n∈N

    To do that, independent sequences of independent and identically distributed
U (0, 1) random variables will be used (Un )n∈N+ and (Vn )n∈N+ , defined on a com-
mon probability space (Ω, F , P ).
      Let for ω ∈ Ω and l = 1, 2:
                                         h      i−1
                              e (l) (ω) = F (l)
                              H                     (Un (ω))) ,         n ∈ N+                            (43)
                                n          n

                                          h     i−1
                              Yen(l) (ω) = G(l)
                                            n       (Vn (ω))) ,         n ∈ N+                            (44)


                                                   Revista Colombiana de Estadística 34 (2011) 477–495

An application of SM models to the ruin problem                                                    489

   Let for ω ∈ Ω and l = 1, 2:
                                               n
                                               X                       n
                                                                       X
                        e (l) (ω) + c(l)
            en(l) (ω) = X
            X                                        em
                                                     H (l)
                                                           (ω) −             Yem(l) (ω),   n∈N    (45)
                          0
                                               m=1                     m=1


with X                  e (2) (ω) = v, be the embedded Markov process of (X (l) )t≥0 ,
      e (1) (ω) = u and X
       0                  0                                                t
                (l)
coupling of X (l) l = 1, 2.
                Sn
   Using (39) and (40) we have for construction that:

                                          e (2) (ω),
                              e (1) (ω) ≤ H
                              H                               ∀ω ∈ Ω, n ∈ N                       (46)
                                n           n

                               Yen(1) (ω) ≥ Yen(2) (ω),       ∀ω ∈ Ω, n ∈ N                       (47)

   On the other hand, from (46) and (47):
                     n
                     X                    n
                                          X
      Sen(1) (ω) =         em
                           H (1)
                                 (ω) ≤         em
                                               H (2)
                                                     (ω) = Sen(2) (ω),           ∀ω ∈ Ω, n ∈ N    (48)
                     m=1                 m=1

                         n
                         X                    n
                                              X
                               Yem(1) (ω) ≥         Yem(2) (ω),       ∀ω ∈ Ω, n ∈ N               (49)
                         m=1                  m=1

which leads with condition (38) to:

                               e (1) (ω) ≤ X
                               X           e (2) (ω) ∀ω ∈ Ω, n ∈ N                                (50)
                                 n           n


   If we denote:                          n                  o
                             Teu∗(l) = inf Sen(l) : X
                                                    e (l) ≤ 0 ,
                                                      n                   l = 1, 2                (51)
        ∗(1)          ∗(2)                          ∗(1)      ∗(2)
being Teu      and Teu       a coupling of (Tu             , Tu      ) we have using (48) and (50) that

                                  Teu∗(1) (ω) ≤ Teu∗(2) (ω),          ∀ω ∈ Ω                      (52)

as it was pretended.


4.2. Comparisons of ruin probabilities
   An algorithm which leads to simulate processes verifying the conditions of
Theorem 1 will be described.




                                               Revista Colombiana de Estadística 34 (2011) 477–495

490                                                                      Elena Almaraz-Luengo

           Input: Independent sequences of independent random variables
           U (0, 1): (Un )n∈N+ , (Vn )n∈N+ , (Wn )n∈N+ . Values x(1) y x(2) , f (1) y
           f (2) with x(1) ≤ x(2) , f (1) ≤ f (2) .
           Xe (1) = x(1)
              0
           Xe (2) = x(2)
              0
           Ke (1) = f (1)
              0
           Ke (2) = f (2)
              0
           for n = 0, ..., N do
              for l = 1, 2 do
                      h        i−1
                 (l)
               e n+1     (l)
               K     = P e (l)     (Un+1 )
                            Kn ,.
                                         −1
               e (l) = F (l)(l) (l)
               H                                  (Vn+1 )
                 n+1      e    e
                            (Kn ,Kn+1 )
                                         −1
                 (l)    (l)
               Yen+1 = G e (l) e (l)              (Wn+1 )
                            (Kn ,Kn+1 )

                       e (l) +
               en(l) = X         Pn−1    (l)   e (l) − Pn Yem
                                                            (l)
               X        0           m=0 cK     H
                                          e (l) m+1     m=1
                                             m


                 end for
           end for
           Output: Two sequences X          e (2) such that
                                  e (1) and X
             (1)      (2)
           Tiu ≤st Tjv ∀i ≤ j, u ≤ v


Figure 2: Simulation of sequences of random variables as described in (5), under con-
          ditions of Theorem 1.



    Next algorithm consists of showing a method which allows to estimate the
difference between the ruin probabilities in a given period T , of two processes
which satisfy conditions of Theorem 1, that is, ψ (1) (u, T ) − ψ (2) (u, T ) is wanted to
be estimated. For simplicity, p(l) will denote the ruin probability of the process l
under the interval of consideration, so: p(l) = ψ (l) (u, T ), for l = 1, 2.
                                                                                              (l)
    For the above purpose, M replicas of each process will be simulated. Let Xr
be, for l = 1, 2 and r = 1, . . . , M , the r-th replica of the process l. Let
                                         n                    o
                           Tr(l) = inf t ≥ 0 : Xr(l) (t) ≤ 0

                                                                            (l)
be the time to ruin of the r-th replica r of the process l, and Rr = 1nT (l) ≤T o be
                                                                                      r
                                                  (l)
a random variable which indicates if the process Xr reaches ruin in the interval
[0, T ].
    The estimator of p(l) , l = 1, 2, which will be denoted as P (l) , is the proportion
of replicas in which ruin has happened, that is:
                                                      PM    (l)
                                            (l)        r=1 Rr
                                        P         =
                                                            M

                                              Revista Colombiana de Estadística 34 (2011) 477–495

An application of SM models to the ruin problem                                      491

and the estimator for the difference of these probabilities is:

                                   P = P (1) − P (2)

   The method used in the proof of the Theorem 1 is based on independent
simulations of random variables which gives a less variance for the estimator P :

                                            P · (1 − P )
                               V ar(P ) =
                                                 M
in relation to an independent simulation of the some.
                                              (l)
    For the algorithm, a control variable Ir is required, which has value 1 when
the simulation must go on or 0 in other case; l denotes the process l = 1, 2 and
r = 1, . . . , M the number of the replica.
    For l = 1, 2, P (l) represents the proportion of replicas in which ruin occurs
in process X (l) until time T . The number of replicas of the process X (l) with
l = 1, 2 in which ruin happens up to time T , has a Binomial (Bi) distribution, that
                                                    (1)    (2)
is, M · P (l) is Bi(M, p(l) ). On the other hand, Rr − Rr has a Bernoulli (Be)
                     (1)  (2)
distribution Be(p − p ) and so, M · P is Bi(M, P ).
    As it was mentioned, the method used in Theorem 1 gives an estimator with
less variance than the estimator obtained with independent simulations of P (1)
and P (2) . In fact, let

                               (p(1) − p(2) )(1 − (p(1) − p(2) ))
                        Vd =
                                               M
and
                             p(1) (1 − p(1) ) + p(2) (1 − p(2) )
                        Vi =
                                             M
the variances of the estimator in the case of dependent and independent simula-
tions, respectively, and let           √       √
                                         Vi − Vd
                                 E=         √
                                              Vi
    The following table shows a numerical example of the reduction that is obtained
by applying a dependent simulation method.
                                     √         √ each entry a the table there the
                                              In
following three values are displayed: M · Vd , M · Vi and E in percentage:




                                      Revista Colombiana de Estadística 34 (2011) 477–495

492                                                                              Elena Almaraz-Luengo




  Input: Independent sequences of independent random variables identically dis-
  tributed as U (0, 1): (Ur,n )n∈N+ , (Vr,n )n∈N+
  for r = 1, . . . , M do
     (Wr,n )n∈N+ , r = 1, . . . , M . Values T , x, f (1) and f (2) with f (1) ≤ f (2) .
        (1)
      er,0              (2)
                     er,0
     X       = x, X          =x
      e (1)       (1)    e (2) = f (2)
     K  r,0  =  f     ,  K  r,0
       (1)          (2)
     Ir = 1, Ir n = 1, n1 o         = 0, n2 = 0
                          (1)   (2)
     while max Ir , Ir               = 1 do
        for l = 1, 2 do
                (l)
            if Ir = 1 then
                                        −1
         e (l)        (l)
         Kr,nl +1 = PKe l                      (Ur,nl +1 )
                               r,nl ,.
                                                  −1
         e (l)        (l)
         H r,nl +1 = F e (l)        e (l)
                                                         (Vr,nl +1 )
                             (Kr,n ,K r,n +1 )
                                   l           l
                                                  −1
            (l)       (l)
         Yer,nl +1 = G e (l)        e (l)
                                                         (Wr,nl +1 )
                             (Kr,n ,K r,nl +1 )
                                  l
           (l)         (l)    e (l)
         Ser,nl +1 = Ser,nl + H r,nl +1

          e (l)       e (l)     (l)    e (l)      e (l)
         X r,nl +1 = Xr,nl + c e (l) Hr,nl +1 − Yr,nl +1
                                Kr,n
                                     l
         nl = nl + 1
         end if
               (l)             (l)               (l)
         if Ser,nl ≤ T and X er,n
                                   l
                                     ≤ 0 then Rr = 1 end if
               (l)          (l)              (l)
         if Ser,nl > T or Rr = 1 then Ir = 0 end if
       end for
    end while
  end for
  for l = 1, 2 do
         PM        (l)
               R
  P (l) = r=1 M
                  r

  end for
  P = P (1) − P (2)
  Vˆd = P ∗(1−P
            M
                )

  Output: Estimator P of the difference between ruin probabilities of the two pro-
  cesses under consideration and its approximate variance Vˆd

Figure 3: Algorithm to estimate the difference of ruin probabilities during a given time
          T , of two processes which satisfy conditions of Theorem 1.




                                                      Revista Colombiana de Estadística 34 (2011) 477–495

An application of SM models to the ruin problem                                                493

    Table 1: Reduction obtained by applying the dependent simulation method.
 PP        (1)
      PP p         0.1      0.2      0.3        0.4      0.5      0.6      0.7      0.8       0.9
 p(2)   PP  P
                 0.000    0.300    0.400     0.458     0.490    0.500    0.490    0.458     0.400
  0.1            0.424    0.500   0.5477    0.5745    0.5831   0.5745   0.5477    0.500    0.4243
                 100%    40.0%    27.0%     20.2%     16.0%    13.0%    10.6%      8.3%      5.7%
                     -    0.000    0.300     0.400     0.458    0.490    0.500    0.490     0.458
  0.2                -    0.566    0.608     0.632     0.640    0.632    0.608    0.566     0.500
                     -    100%    50.7%     36.7%     28.4%    22.5%    17.8%    13.4%       8.3%
                     -        -    0.000     0.300     0.400    0.458    0.490    0.500     0.490
  0.3                -        -    0.648     0.671     0.678    0.671    0.648   0.6083     0.548
                     -        -    100%     55.3%     41.0%    31.7%    24.4%    17.8%     10.6%
                     -        -        -     0.000     0.300    0.400    0.458    0.490     0.500
  0.4                -        -        -     0.693     0.700    0.693    0.671    0.632     0.575
                     -        -        -     100%     57.1%    42.3%    31.7%    22.5%     13.0%
                     -        -        -         -     0.000    0.300    0.400    0.458     0.490
  0.5                -        -        -         -     0.707    0.700    0.678    0.640     0.583
                     -        -        -         -     100%    57.1%    41.0%    28.4%     16.0%
                     -        -        -         -         -    0.000    0.300    0.400     0.458
  0.6                -        -        -         -         -    0.693    0.671    0.632     0.574
                     -        -        -         -         -    100%    55.3%    36.7%     20.2%
                     -        -        -         -         -        -    0.000    0.300     0.400
  0.7                -        -        -         -         -        -    0.648    0.608     0.548
                     -        -        -         -         -        -    100%    50.7%     27.0%
                     -        -        -         -         -        -        -    0.000     0.300
  0.8                -        -        -         -         -        -        -    0.566     0.500
                     -        -        -         -         -        -        -    100%     40.0%
                     -        -        -         -         -        -        -         -    0.000
  0.9                -        -        -         -         -        -        -         -    0.424
                     -        -        -         -         -        -        -         -    100%

                                  √                                         √
    As it can be seen, values of Vi are higher than the correspondents Vd ob-
tained with dependent simulation as in the proof of Theorem 1. In the particular
case in which p(1) = p(2) , this method gives a big reduction, because the described
method present a value Vd = 0, while values in the independent case are strictly
positive.
   With this method confidence intervals with lower amplitude can be built:
                                                r              !
                                                  P ∗ (1 − P )
               IC(1 − α) = P ± Φ(1 − α/2) ·
                                                       M


5. Conclusions
    The problem of ruin was addressed from a different perspective to the tradi-
tional. Instead of setting expressions or quotations for the ruin probability of a
particular model for the selection of each other, times to ruin have been ranked.
This will allow to make a selection without knowing explicitly the expression of
the probability of ruin or an approximation thereof.

                                           Revista Colombiana de Estadística 34 (2011) 477–495

494                                                            Elena Almaraz-Luengo

    On the other hand, simulation algorithms have been proposed for these pro-
cesses and statistical inference methods to estimate differences between the prob-
ability of ruin of the models have been considered.
    This paper is a reference tool which can be used to determine the actual level of
risk assumed by insurers (sufficiency of financial resources, reserves and capital).
    The problems of the minimum solvency margin and the probability of survival
of the reserves can be approached from the perspective proposed, since it allows
to model stochastic processes at groups, taking into account those risks that may
occur at the group level and not necessarily at the level of companies considered
individually.
                                                                   
             Recibido: septiembre de 2010 — Aceptado: julio de 2011


References
Almaraz, E. (2009), Cuestiones notables de ordenación estocástica en optimación financiera, Tesis de Doctorado, Universidad Complutense de Madrid, Facultad de Ciencias Matemáticas. Departamento de Estadística e Investigación Operativa, Madrid.
Asmussen, S. (1989), ‘Risk theory in a Markovian environment’, Scandinavian Actuarial Journal 2.
Beard, R. E., Pentikäinen, T. & Pesonen, E. (1984), Risk Theory, Chapman and Hall, London.
Beekman, J. (1969), ‘A ruin function approximation’, Transactions of Society of Actuaries 21.
Bowers, N. L., Gerber, H. U., Hickman, J. C., Jones, D. A. & Nesbitt, C. J. (1997), Actuarial Mathematics (2ł.Ed), The Society of Actuaries, USA.
Daykin, C. D. (1994), Risk Theory of Actuarie, Chapman & Hall, New York.
De Vylder, F. (1996), Advanced Risk Theory, Université de Bruxelles, Brussels.
Ferreira, F. & Pacheco, A. (2005), ‘Level crossing ordering of semi-Markov processes and Markov chains’, Journal of Applied Probability 42(4), 989–1002.
Ferreira, F. & Pacheco, A. (2007), ‘Comparision of level-crossing times for Markov and semi-Markov processes’, Statistics and Probability Letters 77(7), 151–157.
Frees, E. (1986), ‘Nonparametric Estimation of the Probability of Ruin’, ASTIN Bulletin 16.
Gerber, H. (1995), Life Insurance Mathematics, second edn, Springer, Heidelberg.
Goovaerts, M. (1990), Effective Actuarial Methods, Elsevier Science Publishers B.V.
Latorre, L. (1992), Teoría del Riesgo y sus Aplicaciones a la Empresa Aseguradora, Editorial Mapfre.
Müller, A. & Stoyan, D. (2002), Comparison Methods for Stochastic Models and Risks, John Wiley & Sons.
Ramsay, C. (1992), ‘A Practical Algorithm for Approximating the Probability of Ruin’, Transactions of the Society of Actuaries XLIV.
Reinhard, J. (1984), ‘On a class of semi-Markov risk models obtained as a classical risk models in a Markovian environment’, ASTIN Bulletin 14.
Reinhard, J. & Snoussi, M. (2001), ‘On the distribution of the surplus prior to ruin in a discrete semi-Markov risk model’, ASTIN Bulletin 31.
Reinhard, J. & Snoussi, M. (2002), ‘The severity of run in a discrete semi-Markov risk model’, Stochastic Models 18(1), 85–107.
Seal, H. (1969), Stochastic Theory of a Risk Business, John Wiley & Sons.
Shaked, M. y Shanthikumar, G. (2007), Stochastic Orders, Springer Series in Statistics.




                                    Revista Colombiana de Estadística 34 (2011) 477–495

