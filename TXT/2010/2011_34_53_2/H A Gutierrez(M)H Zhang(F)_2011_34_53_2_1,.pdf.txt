Hierarchical Design-Based Estimation in Stratified Multipurpose Surveys. Estimación jerárquica basada en el diseño muestral para encuestas estratificadas multi-propósito
Universidad Santo Tomás, Colombia
Abstract
This paper considers the joint estimation of population totals for different variables of interest in multi-purpose surveys using stratified sampling designs. When the finite population has a hierarchical structure, different methods of unbiased estimation are proposed. Based on Monte Carlo simulations, it is concluded that the proposed approach is better, in terms of relative efficiency, than other suitable methods such as the generalized weight share method.
Key words: Design based inference, Finite population, Hierarchical population, Stratified sampling.
Resumen
Este artículo considera la estimación conjunta de totales poblacionales para distintas variables de interés en encuestas multi-propósito que utilizan diseños de muestreo estratificados. En particular, se proponen distintos métodos de estimación insesgada cuando el contexto del problema induce una población con una estructura jerárquica. Con base en simulaciones de Monte Carlo, se concluye que los métodos de estimación propuestos son mejores, en términos de eficiencia relativa, que otros métodos de estimación indirecta como el recientemente publicado método de ponderación generalizada.
Palabras clave: inferencia basada en el diseño, población finita, población jerárquica, muestreo estratificado.
 


                                          403

404                                          Hugo Andrés Gutiérrez  Hanwen Zhang

1. Background
    The reality of surveys is complex; as Holmberg (2002) states, most of the
real applications in survey sampling involve not one, but several characteristics of
study; and as Goldstein (1991) claims, real populations have hierarchical struc-
tures. Moreover, in certain occasions, the survey methodologist is faced with the
estimation of several parameters of interest in different levels of the population
and he/she is commanded with the seeking of proper approaches to estimate those
parameters as required in the study. The problem of proposing sampling strategies
(optimal sampling design and efficient estimators) that contemplate joint estima-
tion of several parameters in multipurpose survey has been widely discussed in
recent statistical literature. Although there is a vast number of papers about es-
timation of hierarchical populations (Gelman  Hill 2006) and model-based (or
model-assisted) multilevel survey data (Skinner, Holt  Smith 1989, Lehtonen &
Veijanen 1999, Goldstein 2002, Rabe-Hesketh  Skrondal 2006), the design-based
estimation for finite populations with hierarchical structures seems to be omitted
by survey statisticians. The aim of this paper is to provide a multipurpose ap-
proach to the joint estimation of several parameters for different variables in a
stratified finite population with two levels.
    Next are detailed some clarifying ideas concerning the concept of hierarchical
structures in finite populations. Many kinds of data have a hierarchical or clustered
structure. Note that in biological studies it is natural to think in a hierarchy where
the offspring of the races is clustered into families; in educational surveys, students
belong to schools and schools belong to districts, and so on; in social studies, a
person belongs to a household and households are grouped geographically. In this
paper, the concept of hierarchy is related with the multipurpose approach in the
sense that the survey statistician often needs to make inferences on different levels
of the finite population. For example, consider an establishment survey. It would
be of interest to estimate the total sales of the market sections of the stores in
detail (sales by toys, grocery, electronics or pharmacy sections) and at the same
time it would be of interest to estimate the number of employees working in the
stores. It is clear that the multipurpose approach is given by the joint inference of
two different study variables (sales by market section and number of employees in
the stores) but these variables of interest are in different levels of the population:
sales are related with the market section level and the number of employees with
the store level. Note that as the market sections belong to the stores, then the set
of all market sections defines the second level and the set of all stores defines the
first level.
    In some occasions, it is impossible to obtain a sampling frame for the first level,
however this is available for the second level. For example, Särndal, Swensson &
Wretman (1992, example 1.5.1) reports on the Swedish household survey where
there is not a good complete list of households and the sampling frame used was the
Swedish Register of the Total Population, which is a list of individuals. In this case,
the first level is composed of households, the second level is composed of individuals
and the inferences about households are induced directly from the population of
individuals. If the requirements of that survey were to obtain inferences about both

                                     Revista Colombiana de Estadística 34 (2011) 403–420

Hierarchical Estimation in Stratified Multipurpose Surveys                            405

households and individuals, then it would be a clear example of a study involving
multipurpose estimation within a hierarchical structure in the finite population,
with the restriction that the sampling frame is only available in the second level.
In other cases, it is possible that both sampling frames are available in the design
stage. However, if the requirements of the survey are focused in the estimation of
the population totals in both levels, the most trivial, but in some cases useless,
solution would be planning two sampling designs. In this paper we propose another
solution requiring just the use of a sampling frame in order to simultaneously
estimate several parameters for different study variables in two different levels of
a stratified population, when the sampling frame to be used is related with the
units of the second level. Note that, since the sampling frame is not available
(or available but useless) in the first level, sampling designs such as cluster, or
multi-stage sampling designs are no longer valid to solve this kind of problems.
    The outline of this paper is as follows: after a brief introduction explaining the
hierarchical concept, different levels of estimation in such populations, and its im-
plications in the survey sampling context; Section 2, explains in detail, by means
of a simple example, the foundations of the hierarchical finite population and the
issue of this paper. Section 3, refers to the proposal of an indirect estimation in
the first level involving different variables of interest than those considered in the
second level. This approach is based on the computation of the first and second or-
der inclusion probabilities, given by the induced sampling design in the first level,
using the principles of the well-known Horvitz-Thompson and Hájek estimators
for a population total. Besides, in this section, the authors show how this problem
is related with the indirect sampling approach (Lavallée 2007). This section also
presents a simple case study to illustrate the procedures of the proposed approach
in the case of simple random stratified sampling (STSI) in the second level. In
Section 4, we present an empirical study based on several Monte Carlo simula-
tions that show how our proposal outperforms, in the sense of relative efficiency,
other methods of indirect estimation such as the generalized weight share method
(indirect sampling). Finally, some recommendations and conclusions are given in
Section 5.


2. Multipurpose Estimation
    Let U = {1, . . . , k, . . . , N } denote the second level finite population of N ele-
ments in which a sampling frame is available. Suppose that the sampling frame is
stratified and for each element k ∈ U the stratum to which k belongs is completely
identified by means of some discrete auxiliary variable. That is, the population U
is partitioned into H subsets U1 , U2 , ..., UH called strata, where
                    H
                    [                     \
                          Uh = U,    Uh       U h′ = ∅   for all h 6= h′
                    h=1


   On the other hand, assume that each element k ∈ U in the second level belongs
to a unique cluster in the first level. It is assumed that there exist NI clusters

                                       Revista Colombiana de Estadística 34 (2011) 403–420

406                                                 Hugo Andrés Gutiérrez  Hanwen Zhang

denoted by U1 , . . . , Ui , . . . , UNI . This set of clusters is symbolically represented as
UI = {1, . . . , i, . . . , NI }. This way, the first level population is UI , the second level
population is U and, clearly, the data show a notorious hierarchical structure.
    Although there is an available sampling frame for U , suppose that it is im-
possible to obtain a frame for the population of the first level UI and that the
requirements of the survey imply the inference of parameters, say population to-
tals or means, for both levels. Hence, it is assumed that there are two variables of
interest, say, y in the second level, and z in the first level, and it is requested the
estimation of both population totals, defined by

                                       X            H X
                                                    X
                                ty =         yk =              yk
                                       k∈U          h=1 k∈Uh

and                                            X
                                        tz =          zi
                                               i∈UI

    In this paper, the notation of any pair of elements in the second level will be
denoted by the letters k and l; meanwhile for the units in the first level, the letters
i and j will be used.
    By taking advantage of the sampling frame in the second level, a stratified
sample s is drawn. For each k ∈ s, the value of the variable of interest yk is
observed. Besides, it is supposed that unit k can also provide the information
of its corresponding cluster, say Ui . This way, the value of the other variable of
interest zi is recorded. Note that for a particular second level sample there exists
a corresponding set of units in the first level. In other words, the second level
sample s induces a set, contained in the first level population, which will be called
the first level sample, denoted by m and given by

           m = {i ∈ UI | at least one unit of the cluster Ui belong to s}

    In summary, the values of both variables of interest could be recorded ar the
same time: yk for the elements in the selected sample; s and zi for the clusters in
the induced sample m. As an example, consider the finite population showed in
Table 1. The second level population, denoted by U = {A1, B1, D1, . . . , D4, E4}
of size N = 15 is a set of market sections in different stores. This population
is stratified in four sections (H = 4). The population of the first level is hence
UI = {A, B, C, D, E} with NI = 5. Each stratum is present in different clusters.
For example, Section 1 is present in four stores, whereas Section 3 is present in
three stores. Notice that it is not required that each stratum be present in all of
the clusters.
    Following with the example, when a sample s is drawn, an interviewer visits
the selected market section, say k, records the value of yk and also obtains the
information about zi , the value of the variable of interest in the cluster that con-
tains that section. Table 2, reports the first and second level population values
for the variables of interest. If the sampling design is such that only one element

                                         Revista Colombiana de Estadística 34 (2011) 403–420

Hierarchical Estimation in Stratified Multipurpose Surveys                                    407

            Table 1: Description of a possible hierarchical configuration.
                         Section 1         Section 2          Section 3           Section 4
              Store A       A1                A2                  -                  A4
              Store B       B1                 -                 B3                   -
              Store C        -                C2                  -                  C4
              Store D       D1                D2                 D3                  D4
              Store E       E1                E2                 E3                  E4


of each section is selected, then a possible sample in the second level would be
s = {A1, E2, B3, E4}. This way, the recorded values for this specific sample corre-
spond to 32, 33, 26, 55 and the induced first level sample would be m = {A, B, E}
and the values of the variable of interest in this level correspond to 14.12, 10.25 and
24.81, respectively. Note that a store may be selected more than once; however,
following Särndal et al. (1992, section 3.8), we omit the repeated information in the
first level and carry out the inference by using the reduced sample. The parameter
of interest in the first level is tz = 14.12 + 10.25 + 17.52 + 22.58 + 24.81 = 89.28 and
the parameter of interest in the second level is ty = 106 + 105 + 68 + 162 = 441.

        Table 2: Variables of interest in a possible hierarchical configuration.
               Y1          Y2                Y3                  Y4                  Z
            yA1 = 32    yA2 = 12              -               yA2 = 51           ZA = 14.12
            yB2 = 18        -             yB3 = 26                -              ZB = 10.25
                -       yC2 = 36              -               yC4 = 10           ZC = 17.52
            yD1 = 42    yD2 = 24          yD3 = 14            yD4 = 46           ZD = 22.58
            yE1 = 14    yE2 = 33          yE3 = 28            yE4 = 55           ZE = 24.81

    As stated at the beginning of this section, the second level population U is
stratified into H strata. In each stratum h (h = 1, . . . , H) a sampling design ph (·)
is applied and a sample sh is drawn. An important feature of stratified sampling
design is the independence between selections. For this reason, the sampling design
takes the following form

                                H
                                Y                                           H
                                                                            [
                     p(s) =         ph (sh )          where          s=           sh
                              h=1                                           h=1


   We have that an unbiased estimator of ty and its variance are given by

                                         H X
                                         X                    H
                                                              X
                                             yk
                                t̂yπ =                    =         t̂hπ                      (1)
                                                     πk
                                         h=1 sh               h=1
                                H
                                X                    H X X
                                                     X                           yk yl
                  V (t̂yπ ) =         Vh (t̂hπ ) =                         ∆kl
                                                                                 πk πl
                                h=1                  h=1 k∈Uh l∈Uh



                                           Revista Colombiana de Estadística 34 (2011) 403–420

408                                                  Hugo Andrés Gutiérrez  Hanwen Zhang

  where ∆kl = πkl − πk πl , and t̂hπ corresponds to the Horvitz-Thompson esti-
mator in the h-th stratum, defined by
                                                X yk
                                       t̂hπ =
                                                sh
                                                      πk

   In the case that the sample design is simple random sampling carried out along
the strata, the first and second order inclusion probabilities are given by
                                                                      nh
                          πk = P (k ∈ s) = P (k ∈ sh ) =
                                                                      Nh

   And                    n
                            h
                           Nh           if k = l
                            nh nh −1
                  πkl =     Nh Nh −1     if k 6= l, with k, l ∈ h
                          
                           nh nh′
                            Nh Nh′       if k 6= l, with k ∈ h y l ∈ h′

    where Nh and nh denote the population size and the sample size in the stratum
h, respectively.


3. Estimation in the First Level
    In this section, we develop the proposed approach in order to estimate the
parameter of interest in the first level and we point out that another suitable
approach could be used to solve this kind of estimation problems, namely the
Generalized Weight Share Method (GWSM) (Deville  Lavallée 2006). However,
as it will be confirmed later, in the simulation report of Section 4, our proposal is
more efficient than the GWSM.


3.1. Proposed Approach
   Recalling that the second level sample s induces a first level sample m, we can
obtain the induced sampling design as stated in the following result.

Result 1. The sampling design in the first level induced by the stratified sample
s is given by

                                          X           H
                                                      Y
                             p(m) =                        ph (sh )                    (2)
                                        {s: s→m} h=1


where the notation s → m indicates that the second level sample s induces the first
level sample m.

Proof . Considering that even though a particular first level sample m may be
induced by different samples in the second level, it is clear that a second level

                                        Revista Colombiana de Estadística 34 (2011) 403–420

Hierarchical Estimation in Stratified Multipurpose Surveys                             409

sample s may only induce a unique first level sample m, then we have that
                                     X
                          p(m) =           p(s)
                                        {s: s→m}

                                             X     H
                                                   Y
                                   =                   ph (sh )
                                        {s: s→m} h=1


   The last equation follows because of the independence in the selection of sh for
h = 1, . . . , H.

     For example, continuing with the population described in Table 1, if the sam-
pling design in the second level is simple random sampling in each stratum such
that N3 = 3, N1 = N2 = N4 = 4 and nh = 1 for h = 1, 2, 3, 4, then in order to
compute the selection probability of the particular first level sample m = {A, B},
it is necessary to find all of the second level samples inducing that specific sample
m. Given the data structure, the set {s : s → m} has only two second level
samples; these samples are: {A1, A2, B3, A4} and {B1, A2, B3, A4}. For that m,
we have that its selection probability corresponds to

                p(m) = p({A1, A2, B3, A4}) + p({B1, A2, B3, A4})
                          4
                          Y      4
                                 Y
                             1      1   1
                      =        +      =    = 0.0104
                            Nh     Nh   96
                          h=1       h=1


    Given that one parameter of interest is the population total of the variable z
in the first level, we can obtain the first and second order inclusion probability
of clusters in UI in order to propose some estimators for tz . These inclusion
probabilities are given in the following results.

Result 2. The first order inclusion probability of the cluster Ui , denoted by πi , is
given by
                                                 YH
                                                      (i)
                         πi = P r(i ∈ m) = 1 −       qh                           (3)
                                                       h=1
        (i)
where qh = P r(None of the units of Ui belongs to sh ) and sh denotes the selected
sample in the stratum Uh , for h = 1, . . . , H.

Proof .

          πi = P r(i ∈ m) = P r(At least one unit of Ui belongs to s)
                          = 1 − P r(None of the units of Ui belongs to s)
                                  H
                                  Y      (i)
                           = 1−         qh
                                  h=1




                                        Revista Colombiana de Estadística 34 (2011) 403–420

410                                                    Hugo Andrés Gutiérrez  Hanwen Zhang

                                                                             (i)
Note 1. Note that the computation of the quantities qh depends on the sampling
                                           (i)
design used in each stratum. Moreover, if ah denotes the number of units of cluster
                                   (i)
Ui belonging to stratum Uh , then ah ≥ 0. Which implies that each cluster is not
necessarily present in each stratum.
Note 2. The stratified sampling design on the second level population implies
independence across strata. However, depending on the sampling design used
within each stratum, the independence of units selection may not be guaranteed.
For example, in the case of simple random sampling designs, there is no indepen-
dence. On the other hand, other sampling designs such as Bernoulli and Poisson
do provide that independence feature.

Result 3. The second order inclusion probability for any pair of clusters Ui , Uj
is given by
                             YH        YH         YH
                                  (i)       (j)        (ij)
                   πij = 1 −     qh −     qh +        qh                       (4)
                                       h=1           h=1                h=1

          (ij)
   With qh = P r(None of the units of Ui belongs to sh and none of the units of
                        (i)  (j)
Uj belongs to sh ) and qh , qh are defined analogously in Result 3.2.

Proof . After some algebra, we have that

                 πij = P r(i ∈ m, j ∈ m)
                                / m or j ∈
                    = 1 − P r(i ∈        / m)
                                 / m) + P r(j ∈
                    = 1 − [P r(i ∈                         / m, j ∈
                                              / m) − P r(i ∈      / m)]
                                                         / m, j ∈
                    = 1 − [(1 − πi ) + (1 − πj ) − P r(i ∈      / m)]
                           H
                           Y            H
                                        Y
                                 (i)           (j)
                    =1−         qh −                     / m, j ∈
                                              qh + P r(i ∈      / m)
                          h=1           h=1
                           H
                           Y            H
                                        Y              H
                                                       Y
                                 (i)           (j)               (ij)
                    =1−         qh −          qh +              qh
                          h=1           h=1            h=1




   Once these inclusion probabilities are computed, it is possible to estimate tz
by means of the well known Horvitz-Thompson estimator given by
                                                     X zi
                                         t̂zπ =                                             (5)
                                                     i∈m
                                                           πi

   Note that t̂zπ is unbiased for tz and, if the stratified sampling design in the
second level is such that nh ≥ 2 for h = 1, . . . , H, its variance is given by
                                              X X                    zi zj
                                V (t̂zπ ) =                ∆ij
                                                                     πi πj
                                              i∈UI j∈UI


                                             Revista Colombiana de Estadística 34 (2011) 403–420

Hierarchical Estimation in Stratified Multipurpose Surveys                                 411

    Where ∆ij = πij − πi πj . However, since the first level sample is induced by
the second level sample, the size of m is random, even when the stratified sample
design of the second level is of fixed size. For a more detailed discussion about the
randomness of the sample size and its effects when a Horvitz-Thompson estimator
is used, an interested reader can see Särndal et al. (1992, Example 5.7.3 and
Example 7.4.1). In order to avoid extreme estimates, sometimes obtained with the
previous estimator, and taking into account that NI is known, we propose to use
the expanded sample mean estimator (denoted in this paper as Hájek estimator)
given by
                                               b
                                               tzπ
                                     e
                                     tz = N I                                     (6)
                                              bI,π
                                              N

         bI,π = P
   Where N             1
                  i∈m πi . It is well known that its approximate variance is
given by
                            X X          zi − z UI zj − z UI
                AV (etz ) =          ∆ij                                 (7)
                                            πi        πj
                                      i∈UI j∈UI

                    P
   With z i∈ UI =      UI zi /NI . For more comprehensive details, see Gutiérrez
(2009, expressions 9.3.7. and 9.3.9.) and Särndal et al. (1992, expression 7.2.10.).


3.1.1. Some Particular Cases

   In the case that in each stratum of the second level population a Bernoulli
sampling design is used, with the same inclusion probability θ across the strata,
then the first order inclusion probability for a cluster Ui is given by
                         H
                         Y                    H
                                              Y               (i)
                               (i)
              πi = 1 −         qh = 1 −            (1 − θ)ah
                         h=1                  h=1
                                                        PH    (i)
                                     = 1 − (1 − θ)       h=1 ah        = 1 − (1 − θ)Ni

   Where Ni = #(Ui ). The second order inclusion probability for clusters Ui and
Uj is given by

                           H
                           Y                H
                                            Y            H
                                                         Y
                                     (i)          (j)           (ij)
               πij = 1 −         qh −             qh +         qh
                           h=1              h=1          h=1
                                                               H
                                                               Y              (i)   (j)
                   = 1 − (1 − θ)Ni − (1 − θ)Nj +                    (1 − θ)ah +ah
                                                               h=1
                   = 1 − (1 − θ)       Ni
                                            − (1 − θ)   Nj
                                                             + (1 − θ)Ni +Nj

   Other interesting case is carrying out simple random sampling in each stratum.
This way, the resulting formulaes for the proposed approach are quite simple.
Denoting the population size and the sample size in the h-th stratum by Nh and

                                            Revista Colombiana de Estadística 34 (2011) 403–420

412                                          Hugo Andrés Gutiérrez  Hanwen Zhang

nh , respectively, and by following the assumptions of the Result 3.2, the first
                                                              (i)
inclusion probability for a cluster Ui is given in terms of qh , where
                                       (i)
                              
                               (Nhn−a  h )
                                                            (i)
                        (i)          h
                                            , if nh ≤ Nh − ah
                       qh =       (Nnhh )
                              
                              0,             otherwise

    On the other hand, for the computation of the second order inclusion proba-
bility for clusters Ui and Uj , we have that
                                 (i)  (j)
                         
                          (Nh −anhh −ah )                 (i)  (j)
                    (ij)                   , if nh ≤ Nh − ah − ah
                  qh =           Nh
                                ( nh )
                         
                         0,                 otherwise

   For example, following the finite population in Table 1, the first inclusion
probabilities of the store A and store B are given by
                                                        
                                       n1         n2      n4
                  πstore(A) = 1 − 1 −        1−        1−
                                       N1        N2       N4
                                                  
                                       n1         n3
                  πstore(B) = 1 − 1 −        1−
                                       N1        N3

   And the second order inclusion probability for these two stores is given by
                                                                       
                                n1         n2        n4          n1          n3
πstore(A) ,store(B) = 1 − 1 −          1−         1−     − 1−           1−
                                N1         N2        N4          N1          N3
                                                                        
                       (N1 − n1 ) (N1 − n1 − 1)      n2       n3          n4
                    +                             1−      1−         1−
                          N1        (N1 − 1)         N2      N3          N4

    Once the inclusion probabilities are computed, it is possible to obtain estima-
tions of tz , by using (5) and (6), along with its respective estimated coefficients of
variation by means of the expression for the estimated variances.


3.2. Indirect Sampling
    This kind of situations can also be handled by using the indirect sampling
approach (Lavallée 2007). We introduce it briefly: it is assumed that the first level
population UI is related to the second level population U through a link matrix
representing the correspondence between the elements of UI and U . Since there is
no available sampling frame for UI , an estimate for tz can be obtained indirectly
using a sample from U and the existing links between the two populations. The
link matrix is denoted by Θ with size N × NI , and the ki-th element of the matrix
Θ is defined as
                    (
                      1 if the element k is related with the cluster Ui
           [Θ]ki =
                      0 otherwise

                                     Revista Colombiana de Estadística 34 (2011) 403–420

Hierarchical Estimation in Stratified Multipurpose Surveys                                       413

for k = 1, . . . , N , i = 1, . . . , NI .
    The formulation of the standardized link matrix is needed to carry out the
estimation of tz . This matrix is defined as

                                        e = Θ[diag(1′ Θ)]−1
                                        Θ           N

                                                                     e N = 1N I .
where 1N is the vector of ones of dimension N . It can be shown that Θ1
This way, the population total tz can be expressed as
                                                           e
                                         tz = 1′NI z = 1′N Θz

   Where z = (z1 , . . . , zNI ). By using the previous expression and taking into
account the principles of GWSM, as pointed in Deville  Lavallée (2006), we have
the following estimator:
                                  tz = 1′N IN Π−1
                                  b               e                            (8)
                                               N Θz

where ΠN = diag(π1 , . . . , πN ), is a matrix of dimension N × N that contains the
inclusion probabilities for all the elements in the second level population and IN
is the diagonal matrix containing the indicator variables Ik for the membership of
elements in the second level sample s. Note that (8) may be expressed as

                                                   b
                                                   tz = wz

where w = 1′N IN Π−1 e
                  N Θ. We can see that the elements of w are given by
                                         
                                         P                e ki
                                                           Θ
                                                  k∈U Ik        , if i ∈ m
                                 wi =                      πk
                                         
                                             0,                   if i ∈
                                                                       /m

for i = 1, . . . , NI . Note that b
                                  tz is a weighted sum upon all units in the induced
sample m of UI .
    Deville  Lavallée (2006) have shown that b     tz is an unbiased estimator for tz
and its variance is given by

                                                tz ) = z′ ∆NI z
                                             V (b

                  e where the kl-th element of ∆N is given by
           e ′ ∆N Θ,
with ∆NI = Θ
                                                       πkl − πk πl
                                        [∆N ]kl =
                                                          πk πl

for k, l = 1, . . . , N .
    It is important to comment that despite the resulting inferences of indirect
sampling from the GSWM are defined for the first level population, they are
directly induced by the probability measure of the sampling design in the second
level p(s). However, the inferences from our proposed approach are given directly
by the induced sampling design of the first level p(m).

                                                  Revista Colombiana de Estadística 34 (2011) 403–420

414                                          Hugo Andrés Gutiérrez  Hanwen Zhang

4. Simulation Study
    In this section, by means of Monte Carlo simulations, we compare the per-
formance of the two proposed estimators given by (5) and (6) and the indirect
sampling estimator. We simulate several stratified populations with hierarchical
structure where all clusters are presented in each stratum, that is, Nh = NI in all
strata. The values of the variables of interest y and z are generated from different
gamma distributions. Wu (2003) claims that heavy tail distributions such as the
log-normal and the gamma distribution with large scale parameters should not
be used to generate sampling observations. For this reason, we use the gamma
distribution with small shape and scale parameters.
    In each stratum, a simple random sample of equal size n is selected, then the two
proposed estimators and the indirect sampling estimator are computed in order to
estimate tz . The process was repeated G = 1000 times with NI = 20, 50, 100, 400
clusters, and H = 5, 5, 10, 50 for each of these values of NI . The simulation was
programmed in the statistical software R (R Development Core Team 2009) and
the source codes are available from the author upon request. In the simulation,
the performance of an estimator b  t of the parameter t was tracked by the Percent
Relative Bias (RB), defined by
                                                G
                                                X b
                                                  tg − t
                           RB(b
                              t) = 100%G−1
                                                g=1
                                                         t

and the Relative Efficiency (RE), that corresponds to the ratio of the Mean Square
Error (MSE) of the estimator of the GWSM approach to the Horvitz-Thompson
and the Hájek estimators defined as

                       M SE(btz )                               M SE(b
                                                                     tz )
            RE(b
               tzπ ) =                    and         RE(e
                                                         tz ) =
                            b
                       M SE(tzπ )                                    e
                                                                M SE(tz )

respectively. Note that b
                        tg is computed in the g-th simulated sample and the Mean
Square Error is given by
                                             G
                                             X
                                 t) = G−1
                            M SE(b                  tg − t)2
                                                   (b
                                             g=1


    The estimators are considered under a wide range of specifications. The simu-
lation results correspond to the ratio of MSE, since the ratio of bias is in all cases
negligible indicating that no estimator takes advantage over others in terms of the
RB.
    Table 3, reports the simulated ratio of MSE for the proposed estimators with
the indirect sampling estimator for NI = 20, H = 5 and n = 1, 5, 10, 15. It can
be seen that the Hájek estimator is always more efficient, even when the sample
size is n = 1. The gain in efficiency increases with increasing sample size. The
Horvitz-Thompson estimator has a quite poor performance.

                                     Revista Colombiana de Estadística 34 (2011) 403–420

Hierarchical Estimation in Stratified Multipurpose Surveys                          415

Table 3: MSE ratio of the indirect sampling estimator to HT and Hájek estimators for
         H = 5 strata and NI = 20 clusters.
                      Sample size per stratum        HT      Hájek
                               n=1                   0,08     1,06
                               n=5                   0,03     1,84
                               n=10                  0,05     5,50
                               n=15                  0,52    73,75

Table 4: MSE ratio of the indirect sampling estimator to HT and Hájek estimators for
         H = 5 strata and NI = 50 clusters.
                      Sample size per stratum      HT        Hájek
                               n=1                 0,12       1,02
                               n=5                 0,03       1,29
                               n=10                0,02       1,57
                               n=20                0,02       3,24
                               n=40                1,06      175,83

Table 5: MSE ratio of the indirect sampling estimator to HT and Hájek estimators for
         H = 10 strata and NI = 100 clusters.
                      Sample size per stratum      HT        Hájek
                               n=1                 0,09       1,03
                               n=10                0,02       1,83
                               n=20                0,02       3,64
                               n=50                0,44      101,47

Table 6: MSE ratio of the indirect sampling estimator to HT and Hájek estimators for
         H = 50 strata and NI = 40 clusters.
                      Sample size per stratum      HT        Hájek
                               n=1                 0,02       1,98
                               n=5                 0,77      110,25
                               n=10                 Inf        Inf
                               n=20                 Inf        Inf

Table 7: MSE ratio of the stratified estimator to indirect sampling (IND), HT and
         Hájek estimators for H = 5 strata and NI = 20 clusters.
                 Sample size per stratum      IND       HT      Hájek
                          n=1                 4,84     3.45      5.39
                          n=5                 4,92     2.53      9.42
                          n=10                4,34     4.94     27.08
                          n=15                5,37     40.88    342.90




                                     Revista Colombiana de Estadística 34 (2011) 403–420

416                                         Hugo Andrés Gutiérrez  Hanwen Zhang

    In the simulation reported in Table 4, we increased the number of clusters to
NI = 50, and the sample size to n = 40. We see that the Hájek estimator maintains
its advantage over the indirect sampling estimator, and it is particularly large when
n = 40. On the other hand, the Horvitz-Thompson still performs poorly, although
when n is close to NI it is slightly better. The results reported in the Table 5 with
NI = 100 and H = 10, are similar to those reported in Table 3.
    In Table 6, we set NI = 40 and H = 50, that is, there are more strata than
first level population clusters. We see that the advantage of the Hájek estimator
increases substantially even when n = 5. The symbol Inf indicates that the MSE
of the Horvitz-Thompson and the Hájek estimator are both close to zero in com-
parison with the MSE of the indirect sampling estimator; that is, the ratio of MSE
is huge.)
    In order to visualize the average performance of these three approaches, Figure
1, presents the histogram of the Horvitz-Thompson, Hájek and indirect sampling
estimators with NI = 20, H = 5, n = 5. The vertical dotted line indicates the value
of the parameter of interest. We observe that the three estimators are unbiased
and the estimations obtained with the Hájek estimator are highly concentrated
around the population total, while the Horvitz-Thompson estimator has a larger
variance.
    An interesting, but less practical, situation arises when the parameter of inter-
est in the secondPlevel coincides with the parameter of interest in the first level.
That is, if zi = k∈Ui yk , the variable of interest in the cluster Ui corresponds to
the total of the variable y in the cluster Ui . In this case, both population totals
are the same (ty = tz ) and they can be estimated by using the four mentioned
estimators, namely: the stratified estimator given in (1), the Horvitz-Thompson
estimator given in (5), the Hájek estimator given in (6) and the indirect sampling
estimator given in (8). Notice that in this case, the Horvitz-Thompson, Hájek
and indirect estimators use first level information, whereas the stratified estimator
uses second level information. Then, it is interesting to evaluate these estimators
and compare them. Figure 2 shows the average performance of the four estimators
with NI = 20, H = 5, n = 5. We conclude, once more, that the Hájek estimator
is the most efficient and that the estimator of indirect sampling has an acceptable
performance, while the stratified and the Horvitz-Thompson estimators have large
variances.
    Table 7, reports simulation results when comparing the stratified estimator
with respect to the remaining three estimators which use the first level informa-
tion, in terms of relative efficiency. We can see that estimators using first level
information are always more efficient than the classical stratified estimator; on the
other hand, for each n, the Hájek estimator is the most efficient when increasing
the sample size.
    The above simulations involve the case that any cluster contains at most one
member per stratum, this way the sample includes at most one member in each
cluster. However, since our approach may be extended to the general case where a
cluster might contain more than one member in some strata, then a more realistic
situation arises when we set ah > 1 in some strata. Table 8, reports the simulated

                                    Revista Colombiana de Estadística 34 (2011) 403–420

Hierarchical Estimation in Stratified Multipurpose Surveys                                                                                                                                   417

MSE ratio for the proposed estimators with the indirect sampling estimator for
NI = 20, H = 5, ah = 3 for each h = 1, . . . , H and each cluster. Finally, the
sample size considered per stratum was n = 1, 5, 10, 15. It can be seen that the
Hájek estimator is always more efficient, even when sample size is n = 1; its gain in
efficiency increases with the sample size augmenting. Figure 3, shows the average
performance of the three estimators with NI = 20, H = 5, n = 5.


    It is worth commenting that the Hajek estimator is asymptotically unbiased.
However, for samples of size 20 or more, the bias may be important not to be
ignored (Särndal et al. 1992, p. 251). There are some proposals available in the
literature to modify either the estimator or the sampling design to reduce the
bias of this estimator. For a review of some variations of the Hajek estimator,
see Rao (1988). Note that even though the sample size in the stratified second

                                               Revista Colombiana de Estadística 34 (2011) 403–420

Hierarchical Estimation in Stratified Multipurpose Surveys                          419

level is small, the induced sample size in the first level is not. This way, it is
understandable that the bias for the Hajek estimator is negligible.


5. Discussion and Conclusion
    In this paper, we have proposed a design-based approach that yields the un-
biased estimation of the population total in the first level based on a stratified
sampling design in the second level. With this in mind, the proposed approach
is multipurpose in the sense that, for the same survey, different parameters can
be estimated in different levels of the population. An important feature of this
method is its suitability in the estimation of parameters in the first level where
there is no sampling frame available. The empirical study shows that by using
the same information, our proposal outperforms the indirect sampling approach
because our proposal always has a smaller mean squared error.
    The reduction of variability in our proposal may be explained because different
second level samples may induce the same first level sample m. In this case, the
estimates obtained by applying the GWSM principles will be generally different
because the vector of weights w, that depends on the inclusion probabilities of the
selected elements in s, differs from sample to sample in the second level. Then we
will have different estimates for the same induced sample m. This feature is not
present if we follow the approach proposed in this paper, since btz,π and etz remain
constant for different second level samples that induce the same first level sample
m. However, b  tz,π does not perform as well as e
                                                tz because, in general, the Horvitz-
Thompson approach does not work well under random size sample designs, which
is the nature of the sampling design p(m).
   This research is still open, further work could be focused in the development of
a general methodology conducive to joint estimation in more than two levels when
the sampling frame is only available in the last level of the hierarchical population.
Besides, the proposed approach could be easily extended in some situations where
there is a suitable auxiliary variable (continuous or discrete) that helps to improve
the efficiency of the resulting estimators, just as in the functional form of the
GWSM with the calibration approach (Lavallée 2007, ch. 7).


Acknowledgements
    We thank God for guiding our research. We are grateful to the two anonymous
referees for their valuable suggestions and to the Editor in Chief for his advice dur-
ing the publication process and his comments on the asymptotic unbiased property
of the Hajek estimator. Our posthumous gratitude to Leonardo Bautista who mo-
tivated this research some years ago. This research was supported by a grant of
the Unidad de Investigación from Universidad Santo Tomás.
                                                                 
             Recibido: noviembre de 2009 — Aceptado: mayo de 2011


                                     Revista Colombiana de Estadística 34 (2011) 403–420

420                                         Hugo Andrés Gutiérrez  Hanwen Zhang

References
Deville J C,  Lavallée P. Indirect sampling: the foundation of the generalized weight shared method. (2006). Survey Methodology.
Gelman A,  Hill J. Data Analysis Using Regression and Multilevel/Hierarchical Models. (2006). Cambridge University Press.
Goldstein H. Multilevel modelling of survey data.(1991). Journal of the Royal Statistical Society.
Goldstein H. Multilevel Statistical Models. (2002).Wiley.
Gutiérrez H A. Estrategias de Muestreo Diseño de Encuestas y Estimación de Parámetros. (2009). Universidad Santo Tomás.
Holmberg A. A multiparameter perspective on the choice of sampling design in surveys. (2002). Statistics in Transition.
Lavallée P. Indirect Sampling. (2007). Springer.
Lehtonen R,Veijanen A. Multilevel-model assisted generalized regression estimators for domain estimation. (1999).ISI Session.
R Development Core Team.R: A Language and Environment for Statistical Computing.(2009).R Foundation for Statistical Computing.
Rabe-Hesketh S,Skrondal A. Multilevel modelling of complex survey data.(2006).Journal of the Royal Statistical Society.
Rao P S R S. Ratio and regression estimators.(1988).Handbook of Statistics.
Särndal C E,Swensson B,Wretman J.Model Assisted Survey Sampling. (1992). Springer.
Skinner C J, Holt D,Smith T M F.Analysis of Complex Surveys.(1989).Wiley.Chichester.
Wu C. Optimal calibration estimators in survey sampling.(2003). Biometrika.