Modeling Data With Semicompeting Risks: Application to Chronic Kidney Disease in Colombia. Modelo para datos con riesgos semi competitivos: una aplicaciÃ³n a insuciencia renal crÃ³nica en Colombia
Universidade de SÃ£o Paulo, SÃ£o Paulo, Brazil.  Hospital Pablo TobÃ³n Uribe, MedellÃ­n, Colombia
Abstract
In this paper, the structure of semicompeting risks data, dened by Fine, Jiang & Chappell (2001), is studied. Two events are of interest: a non terminal and a terminal event, the last one, can censor the non-terminal event, but not vice versa. Due to the possible dependence between the times until the occurrence of such events, two approaches are evaluated: modelling the bivariate survival function through Archimedean copulas and a shared frailty model. A simulation is conducted to examine its performance and both approaches are applied to a real data set of patients with chronic kidney disease (CKD).
Key words Archimedean Copula; Frailty model; Semicompeting risks; Survival.
Resumen
En este trabajo se estudia la estructura de datos con riesgos semicompetitivos denida por Fine et al. (2001). En esta estructura existen dos eventos de interÃ©s; uno intermedio y otro terminal, este Ãºltimo puede censurar el evento intermedio, pero no viceversa. Dada la posible dependencia, entre los tiempos hasta la ocurrencia de tales eventos, dos tipos de enfoques son evaluados: uno, modelando la funciÃ³n de supervivencia bivariada a travÃ©s de cÃ³pulas Arquimedianas y el outro por medio de un modelo con fragilidad compartida. El desempeÃ±o se observa atravÃ©s de simulaciÃ³n. Ambos enfoques son aplicados a un conjunto de datos reales de pacientes con insuciencia renal crÃ³nica, que pueden o no presentar una recaÃ­da de la enfermedad luego de ser tratados con diÃ¡lisis.
Palabras clave : CÃ³pulas arquimedianas; Modelo de fragilidad; Supervivencia; Riesgos semicompetitivos.


1. Introduction

    Currently, chronic kidney disease (CKD) is considered a worldwide problem
and a great increase of deaths caused by CKD has been observed from 1990 to
2010 (MartÃ­n-Cleary & Ortiz 2014). In Colombia, its prevalence has increased
(GÃ³mez 2006) and, according to Fondo Colombiano de Enfermedades de Alto
Costo (Cuenta del Alto Costo 2014),975.479 people had CKD in 2013. In Decem-
ber 1993, the social security system was reformulated (the law 100 was enacted)
and this change increased considerably the coverage of patients with renal dise-
ase. CKD is a high cost disease and the excessive cost is a major concern for
healthcare systems. Therefore, there is great interest in studying CKD and its
progression, mortality and response to treatments, such as hemodialysis and pe-
ritoneal dialysis. In this work, we are concerned with the analysis of a dataset
with end-stage renal disease (ESRD), stages IV and V, of CKD patients, followed
from 2009 to 2011, from ve cities in Colombia: Manizales, Monteria, Rionegro,
Sincelejo and Tunja. The data contains information about 1253 patients who had
started dialysis treatment. The patients were periodically examined and tests were
performed to obtain the levels of calcium, inorganic phosphorus, serum albumin,
serum creatinine, among other blood tests. There is a major interest in studying
survival times of those patients, but it is also of interest to study the disease's
progression. Researchers involved in this study were particularly interested in stu-
dying the time until a progression of the disease occurs. This progression can be
considered as a worsening in the patient's health, determined by the levels of some
substances in the blood and by the clinical evaluation of the patient. Specically,
in this study progression was dened by high levels of inorganic phosphorus (level
over 5,6 mg/dl). Therefore, in this particular study, there are two main events of
interest: time until progression and time until death.
   Common survival analysis techniques are suitable when the interest is to study
only the time until the occurrence of an event. When observations are subject to
more than one type of event (e.g, dierent causes of death) and the occurrence of
an event prevents the occurrence of the other, there is a competing risks structure.
Our CKD data, nevertheless, cannot be viewed as competing risks data since
some patients may experience the progression and also death. In our example, the
main interest is to study two events, one of which (terminal event) prevents the
occurrence of the other (non-terminal event), but not vice versa. This structure is
known as Semicompeting Risks, dened by Fine et al. (2001). In cancer studies,
typically the non-terminal event is the relapse of cancer and sometimes the non-
terminal event is simply called progression.


                                        Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                              37

    Recently, increased attention has been given to semicompeting risks data, and
there are two main diculties in addition to the existence of censored data: (i) the
hypothesis that we have a pair of random variables with the restriction that one of
them is always smaller than the other one (progression necessarily occurs before
death) or one of them is not observed and (ii) the time until the non-terminal event
and time until the terminal event cannot be considered as independent random
variables. This possible dependence must be taken into account into statistical
analysis. According to Hsieh, Wang & Ding (2008), if the relationship between
the two events is completely unspecied, the marginal distribution of the time to
a non-terminal event is not identiable due to possible dependent censoring. In
this context, while the univariate Kaplan-Meier (K-M) estimator can be used to
estimate the survival function of the terminal event, it cannot be used for the non-
terminal event and even a descriptive analysis for semicompeting risks data must
be done using appropriate methodologies. It can be found in the literature dierent
generalizations to the Kaplan-Meier estimator for bivariate situations (see, for
example, Campbell & Foldes 1980, Campbell 1981, Hanley & Parnes 1983, Tsai,
Leurgans & Crowley 1986, Dabrowska 1988, Prentice & Cai 1992). Although we
are interested in a bivariate survival function, semicompeting risks structure is
dierent and it is not straightforward to adapt those estimators for our context.
Therefore, the approach of Lakhal & Abdous (2008) using Archimedean copulas
is a natural choice since it was proposed for semicompeting risks data. It also
allows one to study explicitly the dependence between the time until the terminal
and non-terminal events. Moreover, Archimedean copulas are quite referenced in
the literature for bivariate survival models and they are associated with frailty
multiplicative models (Romeo 2005).
    In this work, we are focused on the statistical analysis of CKD data set using
appropriate methods for semicompeting risks data. In order to carry a complete
data analysis, we combined dierent new methodologies already available in the
literature. Initially, we are concerned with methodologies for an appropriate des-
criptive analysis and we consider the estimation of the bivariate survival function
and the non-terminal event survival function through Archimedean copulas, as
suggested by Lakhal & Abdous (2008). Estimators for the survival functions are
obtained for some Archimedean copulas (see Nelsen 2006, p.116) and we discuss
those estimators in Section 2. In the sequence, we are interested in a regression
model for both the time until progression and time until death. We focus on
a three-state process, known as Illness-Death process, initially studied by Fix &
Neyman (1951) and proposed by Xu, Kalbeisch & Tai (2010) for semicompeting
risks data. In this case, the inclusion of covariates and a possible dependence be-
tween the two times (terminal and non-terminal events) is taken into account by
a shared frailty and the model is presented in Section 3. We also present a short
simulation study comparing the performance of this model and a naive regression
model where the dependence is not included. Finally, in Section 4 we present the
results of the analysis of CKD data and in Section 5 we discuss the methods and
results.




                                      Revista Colombiana de EstadÃ­stica 42 (2019) 3559

38                    Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera

2. Bivariate Survival Function Estimation Through
     Archimedean Copulas

    In this section, we describe the methodology used for a proper descriptive
analysis of semicompeting risks data. We briey introduce the concept of copulas
and discuss the four copulas considered in this work. We then discuss estimation
procedures for plotting graphics of the marginal survival functions of both events
of interest.
    Let X be the time to the non-terminal event and let Y be the time to the
terminal event. For semicompeting risks data we have the restriction X < Y ,
thus, the bivariate survival function is dened in the upper wedge. Furthermore,
the assumption of independence of X and Y is not reasonable and, therefore,
we cannot use K-M estimator for the survival function of the non-terminal event
X . It is then necessary to incorporate the dependence between X and Y in the
estimator. In the bivariate case, let (X, Y ) be continuous random variables with
marginal survival functions (SX (x), SY (y)). The bivariate survival function based
on a copula CÎ± (Â·) for some Î± âˆˆ A is given by

       SXY (x, y) = P (X > x, Y > y) = CÎ± (SX (x), SY (y)),         0 â‰¤ x â‰¤ y.      (1)

   The copula is a natural function and an ecient way to construct multivari-
ate distributions for random variables, since it couples the marginal distribution
and captures their dependence. Archimedean copulas are an important family of
copulas associated with bivariate survival models (Romeo 2005) and are dened
by
             CÎ± (u, v) = Ï†âˆ’1
                          Î± {Ï†Î± (u) + Ï†Î± (v)}    0 â‰¤ u â‰¤ 1, 0 â‰¤ v â‰¤ 1,         (2)
where Ï†Î± (Â·), known as the generator of CÎ± (Â·, Â·), is a continuous strictly decreasing
convex function from [0, 1] to [0, âˆž) such that Ï†Î± (1) = 0 and Ï†âˆ’1  Î± (Â·) denotes the
inverse of Ï†Î± (Â·) (Nelsen 2006). The parameter Î± is associated with the intensity
of the dependence between the variables. Usually, this dependence is quantied
by Kendall's tau measure of association, discussed in more details in Section 2.2.
   Although the approach of Lakhal & Abdous (2008) for estimating survival and
association in the semicompeting risks works for any Archimedean copula, we have
implemented the methodology for the most referenced families. The Clayton fa-
mily (which we call Family A) is associated to the multiplicative frailty gamma
model and the dependence is (strongly) concentrated in the extreme lower left.
The Frank family (family C) admits both positive and negative dependence and
the Gumbel family (family D) has positive dependence strongly concentrated in
the extremes (tail dependence). We have also implemented the family B corre-
sponding to the family 4.2.2 dened on page 116 of Nelsen (2006) due to the simple
expression of the copula. Table 1 shows the function CÎ± (u, v) that denes each
family and the corresponding generating function.




                                       Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                           39

                   Table 1:    Archimedean copulas families considered.
                                                                                Generating
  Family                          Copula, CÎ± (u, v)                           function Ï†Î± (k)

                                                                                1 âˆ’Î±
     A           [max(uâˆ’Î± + v âˆ’Î± âˆ’ 1, 0)]âˆ’1/Î± ,    Î± âˆˆ [âˆ’1, âˆž) \ {0}              (k    + 1)
                                                                                Î±
     B            1 âˆ’ [(1 âˆ’ u)Î± + (1 âˆ’ v)Î± ]1/Î± ,        Î± âˆˆ [1, âˆž)               (1 âˆ’ k)Î±
                      (eâˆ’Î±u âˆ’ 1)(eâˆ’Î±v âˆ’ 1)
                                                                                 âˆ’Î±k      
              1                                                                     e    âˆ’1
     C       âˆ’ ln 1 +         âˆ’Î±
                                               ,         Î± âˆˆ (âˆ’âˆž, âˆž) \ {0}   âˆ’ ln     âˆ’Î±
              Î±              e   âˆ’1                                                  e   âˆ’1
     D             exp{âˆ’[(âˆ’ ln u)Î± + (âˆ’ ln v)Î± ]1/Î± },     Î± âˆˆ [1, âˆž)            (âˆ’ ln k)Î±




2.1. Censoring and Notation

    We assume that our data is subject to right-censoring and therefore we may
not observe X and Y for all subjects. The observable quantities are described
as follow. Let Z = min(X, Y ) and Î´x = I{X<Y } , where I{X<Y } is given by
I{X<Y } = 1 if X < Y and I{X<Y } = 0 otherwise. Let C be a right-censoring
variable independent of (X, Y ) and dene the random variables R = min(Y, C),
S = min(Z, C), Î´y = I{Y <C} , Î´z = I{Z<C} and Î´xz = Î´x Î´z . Thus, the data set
consists of n independent replications of Di = {(Ri , Si , Î´yi , Î´zi , Î´xzi ), i = 1, Â· Â· Â· , n}
of observable variables (R, S, Î´y , Î´z , Î´xz ).
    It is important to notice that, due to the right-censoring, for semicompeting
risks four situations are possible:
   Case 1. Subject was observed to have progression at xi and death at yi , then,
Di = (Ri = yi , Si = xi , Î´yi = 1, Î´zi = 1, Î´xzi = 1);
      Case 2. Subject died at time yi without progression, Di = (Ri = yi , Si =
yi , Î´yi = 1, Î´zi = 1, Î´xzi = 0);
     Case 3. Subject was observed to have progression at xi and right censoring at
yi , so Di = (Ri = ci , Si = xi , Î´yi = 0, Î´zi = 1, Î´xzi = 1);
   Case 4. Both events progression and death were not observed, and hence,
Di = (Ri = ci , Si = ci , Î´yi = 0, Î´zi = 0, Î´xzi = 0).


2.2. Measures of Association

    As mentioned before, the parameter Î± in (1) and (2) is associated with the
intensity of the dependence and its interpretation depends on the specic copula
considered. A common association measure used in this context is the Kendall's
tau coecient, dened by

                           Ï„ = E{sgn((X1 âˆ’ X2 )(Y1 âˆ’ Y2 ))},
               ï£±
               ï£² âˆ’1         if x < 0
where sgn(x) =   0          if x = 0 ,
               ï£³
                 1          if x > 0

                                            Revista Colombiana de EstadÃ­stica 42 (2019) 3559

40                      Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera

(X1 , Y1 ) and (X2 , Y2 ) are two independent replications of (X, Y ) of any random
variables. For Archimedean copulas, Kendall's tau coecient can be easily com-
puted, see Nelsen (2006) for more details.
    In semicompeting risks, when right censoring is observed, (Xi , Yi ) and (Xj , Yj )
can be compared only when the event Aij = XÌƒij â‰¤ YÌƒij â‰¤ CÌƒij occurs, with
XÌƒij = min(Xi , Xj ), YÌƒij = min(Yi , Yj ) and CÌƒij = min(Ci , Cj ). This leads to
some diculties when working with Kendall's coecient and it is then useful to
dene the conditional Kendall's tau (Oakes 1989):
                         Ï„Î± = E{sgn[(Xi âˆ’ Xj )(Yi âˆ’ Yj )]|Aij }.

   Another important association measure is a local counterpart of the Kendall's
tau, which is a local measure of dependence, dened by Clayton (1978) as the
cross-ratio function, given by
                          P {(Xi âˆ’ Xj )(Yi âˆ’ Yj ) > 0|XÌƒij = x; YÌƒij = y}
               Î¸âˆ— (x, y) =
                          P {(Xi âˆ’ Xj )(Yi âˆ’ Yj ) < 0|XÌƒij = x; YÌƒij = y}
                           SXY (x, y)D1 D2 S(x, y)
                        =                            ,
                          D1 SXY (x, y)D2 SXY (x, y)
where D1 = âˆ’âˆ‚/(âˆ‚x) and D2 = âˆ’âˆ‚/(âˆ‚y). Oakes (1989) showed that Î¸Î±âˆ— (x, y) =
Î¸(SXY (x, y)), then for the Archimedean copulas we have the result
                                                  00
                                               kÏ†Î± (k)
                              Î¸Î±âˆ— (x, y) = âˆ’           = Î¸Î± (k),
                                               Ï†0Î± (k)
where k = SXY (x, y).
   Table 2 shows the expressions for Kendall's tau coecient and the correspon-
ding cross-ratio function for each of the four copulas considered in this work.
        Table 2:    Association measures of four Archimedean copulas families.
                      Generating                                                 cross-ration
        Family                                 Kendall's tau Ï„
                    function Ï†Î± (k)                                            function Î¸Î±âˆ— (k)

                      1 âˆ’Î±
           A             (k    + 1)                     Î±
                                                       Î±+2
                                                                                    Î±+1
                      Î±
                                                                                   k(Î±âˆ’1)
           B            (1 âˆ’ k)Î±                   Ï„ = Î±âˆ’2
                                                        Î±                           1âˆ’k
                         âˆ’Î±k       
                           e    âˆ’1                RÎ±             
           C       âˆ’ ln      âˆ’Î±
                                        1 âˆ’ Î±42   0
                                                           t
                                                         eâˆ’t âˆ’1
                                                                           4
                                                                      dt âˆ’ Î±         Î±k
                                                                                   1âˆ’eâˆ’Î±k
                            e   âˆ’1
           D            (âˆ’ ln k)Î±            4     1
                                                         + 1 = Î±âˆ’1                    Î±âˆ’1
                                                     
                                            âˆ’Î±     4            Î±
                                                                                  1 âˆ’ log k


   The cross-ration function and the conditional tau coecient are related and it
can be shown (PatiÃ±o 2012) that
                            (                                )
                              Î¸Î± {SXY (XÌƒij , YÌƒij )} âˆ’ 1
                     Ï„Î± = E                               Aij .              (3)
                              Î¸Î± {SXY (XÌƒij , YÌƒij )} + 1

In the next section, expression (3) will be used as motivation for an estimating
equation for Î±.


                                           Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                                 41

2.3. Estimation

    We are interested in estimating the marginal survival functions SX (x) and
SY (y) and also the bivariate survival SXY (x, y) based on our available data. Some
conditional functions in which the copula parameter Î± is always involved may also
be of interest and will be discussed later. To construct (1), we need the non-
terminal and terminal survival function SX (x) and SY (y), respectively, as well
as the parameter Î± of the assumed copula. As mentioned before, the traditional
K-M method (Kaplan & Meier 1958) can be used to estimate SY (y). However, for
the non-terminal survival function SX (x) it is not appropriate due to the possi-
ble dependence between X and Y . In this context, various estimators have been
proposed: non parametric estimator by Fine et al. (2001), Pseudo Self-Consistent
estimator by Jiang, Fine, Kosorok & Chappell (2005) and the copula-graphic es-
timator by Zheng & Klein (1982), which was adapted by Rivest & Wells (2001)
for dependent censoring and by Lakhal & Abdous (2008) for semicompeting risks
data.
   We describe here the method proposed by Lakhal & Abdous (2008), know it
as copula-graphic estimator for semicompeting risks. The authors rst consider
the estimation of the parameter Î±. Motivated by expression (3), it is possible to
show that
          (                                )
              Î¸Î± {SXY (XÌƒij , YÌƒij )}                                         
        E                               Aij = E I{P {(Xi âˆ’Xj )(Yi âˆ’Yj )>0} |Aij .
            Î¸Î± {SXY (XÌƒij , YÌƒij )} + 1

This result motivates the following estimating equation:
                                                                                             
   1 X                                                            Î¸Î± {SXY (XÌƒij , YÌƒij )}
   n
      w( SÌƒ ij , RÌƒij )1{A ij } Ã—  I{(Xi âˆ’Xj )(Yi âˆ’Yj )>0} âˆ’                                     = 0, (4)
   2   i<j
                                                                Î¸Î± {SXY (XÌƒij , YÌƒij )} + 1

 where w(Â·, Â·) is a random weight function associated to the pair (i, j). Fine et al.
(2001) suggest
                                           n
                        âˆ’1             1X
                       wa,b (u, v) =         1{Si â‰¥min(u,a),Ri â‰¥min(b,v)} ,
                                       n i=1

for a > 0 and b > 0 constants. Note that equation (4) depends on the bivariate
survival function, which it is what we want to estimate in (1). Nevertheless, a non
parametric estimator may be used as a rst approximation and Lin & Ying (1993)
suggested the following
                                Pn
                                     I{Si >x,Ri >y}
                 SÌƒXY (x, y) = i=1                  ,  0 â‰¤ x â‰¤ y,
                                     GÌ‚C (y)

where GÌ‚C (Â·) is the K-M estimator of censoring survival function C .
    For each copula considered in this work, a dierent estimating equation is
obtained and numerical procedures may be needed. For the Clayton copula, a
solution for the equation may be obtained analytically. The estimation equations
or solution for the four copulas considered are shown in Table 3.


                                               Revista Colombiana de EstadÃ­stica 42 (2019) 3559

42                            Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera

         Table 3:     The estimation equations four Archimedean copulas families.
     Family     Estimation equation
                      P
                              w(SÌƒij ,RÌƒij )Dij (2âˆ†ij âˆ’1)
        A       Î±Ì‚ = Pi<j
                          i<j w(SÌƒij ,RÌƒij )Dij (1âˆ’âˆ†ij )
                                                                                 
                                                        SÌƒXY (XÌƒij ,YÌƒij )(Î±âˆ’1)
        B       1
                      P
                  n
                                               âˆ†ij âˆ’
                            w(SÌƒij , RÌƒij )Dij Ã—                                      =0
                                                      SÌƒXY (XÌƒij ,YÌƒij )(Î±âˆ’2)+1
                  2 i<j                                                                           
                                                                     Î±SÌƒXY (XÌƒij ,YÌƒij )
        C       1
                     P
                 n
                        w(SÌƒij , RÌƒ ij )Dij Ã—  âˆ† ij âˆ’                                                =0
                                                      Î±SÌƒ(XÌƒij ,YÌƒij )+1âˆ’exp(âˆ’Î±SÌƒXY (XÌƒij ,YÌƒij ))
                 2 i<j                                                                 
                                                       ln(SÌƒXY (XÌƒij ,YÌƒij ))âˆ’(Î±âˆ’1)
        D       1
                     P
                 n
                        w(SÌƒij , RÌƒij )Dij Ã— âˆ†ij âˆ’                                        =0
                                                            2 ln(SÌƒXY (XÌƒij ,YÌƒij ))âˆ’(Î±âˆ’1)
                  2   i<j




    After estimating Î±, we use the copula-graphic estimator adapted by Lakhal
& Abdous (2008) for the survival function associated to the non-terminal event.
The idea is to construct an estimator for SX (t) with similar properties to the K-
M estimator, i.e., that jumps when an non-terminal event is observed. In order
to do so, we need to consider Z = min(X, Y ) and it is important to notice that
SZ (t) = P (Z > t) = P (X > t, Y > t) = Ï†âˆ’1 Î± {Ï†Î± (SX (t)) + Ï†Î± (SY (t))}. If t0 is
an instant when a non-terminal event (X ) was observed, then it is also an instant
that Z was observed. Therefore, the Kaplan-Meier estimator of SZ (t), which we
denote by SÌ‚Z (t), should jump at t0 and
                                          CG
                 Ï†Î±Ì‚ {SÌ‚Z (t0 )} = Ï†Î±Ì‚ {SÌ‚X  (t0 )} + Ï†Î±Ì‚ {SÌ‚Y (t0 )}
Ï†Î±Ì‚ {SÌ‚Z (t0 )} âˆ’ Ï†Î±Ì‚ {SÌ‚Z (tâˆ’             CG                CG âˆ’                                    âˆ’
                             0 )} = Ï†Î±Ì‚ {SÌ‚X (t0 )} âˆ’ Ï†Î±Ì‚ {SÌ‚X (t0 )} + Ï†Î±Ì‚ {SÌ‚Y (t0 )} âˆ’ Ï†aÌ‚ {SÌ‚Y (t0 )},


 where SÌ‚X CG
               (t0 ) is the copula-graphic estimator. Assuming continuous X and Y ,
the two events cannot occur at the same time and Ï†Î±Ì‚ {SÌ‚Z (t0 )} âˆ’ Ï†Î±Ì‚ {SÌ‚Z (tâˆ’   0 )} =
                          CG âˆ’
       CG
Ï†Î±Ì‚ {SÌ‚X  (t0 )} âˆ’ Ï†Î±Ì‚ {SÌ‚X  (t0 )}. For an arbitrary t, summing this expression for all
t0 < t, we have
                       X
                              Ï†Î±Ì‚ {SÌ‚Z (Si )} âˆ’ Ï†Î±Ì‚ {SÌ‚Z (Siâˆ’ )} = Ï†Î±Ì‚ {SÌ‚X
                                                                          CG
                                                                             (t)}
                  Si â‰¤t;Î´xzi =1

and the copula-graphic estimator is given by
                           ï£®                                             ï£¹
                               X
              CG
            SÌ‚X  (t) = Ï†âˆ’1 ï£°           Ï†aÌ‚ {SÌ‚Z (Si )} âˆ’ Ï†aÌ‚ {SÌ‚Z (Siâˆ’ )}ï£» .                              (5)
                        aÌ‚
                                        Si â‰¤t;Î´xzi =1


   Finally, we can nd the semiparametric estimator of the bivariate survival
function (1) with the marginals (5) for SX (x) and K-M Estimator for SY (y).
Large sample properties of the resulting estimator have been established (weak
convergence to a a Gaussian process) using martigale representation (Rivest &
Wells 2001).
    Furthermore, from de the bivariate survival function, some other useful quan-
tities can be obtained (Lakhal & Abdous 2008), such as the probability that a
patient survives at y given that he has not progression at time x, given by

                                                                        SÌ‚(x, y)
                                PÌ‚ (Y > y|X > x; Y > x) =                          ,
                                                                        SÌ‚(x, x)

                                                     Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                                         43

and the survival probability at y given that the patient has a progression at time
x and is alive at time t > x:

        Modeling Data with Semicompeting Risks                                                             9
                                                          Ï†0Î± (CÎ± {SÌ‚X (x), SÌ‚Y (t)})
                     PÌ‚ (Y > y|X = x; Y > t) =                                            .
                                                            0
                                                     theÎ± {patient
                                                 Ï†Î± (C
        and the survival probability at y given that                 SÌ‚Ya(y)})
                                                            SÌ‚X (x),has   progression at time
        x and is alive at time t > x:

  These estimators can be easily obtainedÏ†0for    {SÌ‚X four
                                               (CÎ±the  (x), SÌ‚families
                                                              Y (t)})
                                                                        in Table 1; for
more details see PatiÃ±o  > y|X = x; Y > t) = Î±
                   PÌ‚ (Y (2012).                                      .
                                             0
                                            Ï† (C {SÌ‚ (x), SÌ‚ (y)})
                                                                Î±   Î±   X       Y
    Regarding computational implementation, only the estimation of the depen-
dence parameter     is computationally
          These estimators    can be easilyintensive.    As the
                                              obtained for  already
                                                                 four mentioned,      for the
                                                                       families in Table       Clay-
                                                                                            1; for
            there isseenoPatiÃ±o
      more details
ton copula                        (2012).
                           iterative   method because     an  analytical   solution    is available;
                                                     
for the other  copulas,
          Regarding        there is a sum
                       computational         over n2 terms
                                        implementation,   only in
                                                                thethe  equations
                                                                     estimation   of and   this may
                                                                                     the depen-
        computational
be thedence parameter is lengthiest      step intensive.
                            computationally   in estimation    for large
                                                         As already        n, butfor
                                                                      mentioned,     this
                                                                                       thedoes
                                                                                            Clay-not
      ton copula
represent  a real there         iterative
                         is no in
                   problem                method because
                                   applications.          an analytical  solution  is available;
        for the other copulas, there is a sum over n2 terms in the equations and this may
        be the computational lengthiest step in estimation for large n, but this does not
        represent a real problem in applications.
3. Illness-Death Model
       3. Illness-Death
    Generally      in applied survival    Model
                                              analysis, it is of interest to determinate the eect
of covariates     on   the   risks  occurrence
           Generally in applied survival analysis,   of the itevent      of interest.
                                                                 is of interest        For this the
                                                                                 to determinate         eect we
                                                                                                    purpose
use the   Illness-Death        model     with   shared     frailty,    proposed    by  Xu
       of covariates on the risks occurrence of the event of interest. For this purpose we  et  al. (2010).
        thisthe
    In use    model,      the semicompeting
                 Illness-Death     model with shared          data can
                                                      risksfrailty,               by Xu et by
                                                                            be described
                                                                        proposed                  a three-state
                                                                                              al. (2010).
process, the     illness
           In this   model, andthedeath    process, which
                                    semicompeting       risks datais acan process  widelybydiscussed
                                                                            be described                  in the
                                                                                               a three-state
literature   (see,
       process,   theFix        and death1951,
                             & Neyman
                        illness               process, Fiocco,
                                                          which is  Putter    & van
                                                                        a process widelyHouwelingen
                                                                                           discussed in 2008).
                                                                                                          the
       literature
The state            (see, Fix
              occupied           & Neyman
                             by the              1951,atFiocco,
                                        individual          time tPutter= 0 is& called
                                                                                 van Houwelingen       2008). 0)
                                                                                         on study (state
       The   state   occupied    by   the  individual    at   time    t  = 0 is
and it is assumed the patient remains in this state until the intermediate eventcalled  on  study   (state  0)
       and it is assumed the patient remains in this state until the intermediate event
or the death occurs. When the intermediate event (not terminal) occurs, the
       or the death occurs. When the intermediate event (not terminal) occurs, the
individual     condition
       individual             is called
                      condition            relapse
                                   is called   relapseororprogression         (state 1)1)and
                                                              progression (state           andthethe   death
                                                                                                     death  is is
       the condition
the nal    nal condition  or absorbing
                                or absorbing      state(state
                                              state       (state2).2). Notice                   not
                                                                                  thatititisisnot
                                                                          Notice that                 possible
                                                                                                   possible  a a
transition    fromfrom
       transition      the the
                             intermediate
                                 intermediate      statetotothe
                                                state          the initial            Themain
                                                                             state. The
                                                                     initial state.           maininterest
                                                                                                     interest
                                                                                                            is is
to model    the transition
       to model                  intensities
                    the transition    intensities   functions,i.e.,
                                                 functions,       i.e., the  hazardrates
                                                                         the hazard           associated
                                                                                      ratesassociated    withwith
       the transitions
the transitions      betweenbetween    states
                                  states      (seeFigure
                                           (See      Figure1). 1).

                                                        
                                                       
                                     Relapse/Progression
                                                         J

                                                       J
                                                          J
                                                            ^                       
                                    
                                                      - Death
                                                                                   
                            On study

                               Illness-Death model for Semicompeting risks data.
                       Figure 1: Illness-Death model for Semicompeting risks data.
                Figure 1:




    The model    proposed
          The model        by Xu
                     proposed         al.al.
                                   et et
                               by Xu         (2010)isisbased
                                          (2010)        based on the
                                                                  thehazard
                                                                      hazardratios
                                                                              ratios  functions
                                                                                   functions
      of transitions
of transitions            the the
                     between
                between           states
                               states    0 (understudy),
                                       0 (under      study), 11 (relapse/progression)
                                                                (relapse/progression)  andand
                                                                                           2 2
      (death)
(death)           by by
              dened
         dened

                                              Revista Colombiana de EstadÃ­stica. En ediciÃ³n (2019) 123
                                                   Revista Colombiana de EstadÃ­stica 42 (2019) 3559

44                    Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera



                              P (x â‰¤ X < x + âˆ†|X â‰¥ x, Y â‰¥ x)
                 Î»1 (x) = lim                                 ,
                         âˆ†â†’0                 âˆ†
                              P (y â‰¤ Y < y + âˆ†|X â‰¥ y, Y â‰¥ y)
                 Î»2 (y) = lim                                  and                   (6)
                         âˆ†â†’0                âˆ†
                              P (y â‰¤ Y < y + âˆ†|X = x, Y â‰¥ y)
              Î»12 (y|x) = lim                                ,
                         âˆ†â†’0                âˆ†
with 0 < x < y .
    Notice that the hazards rates Î»1 (x) and Î»2 (y) are not equal to the usual hazard
rates dened in survival analysis; they correspond to the specic cause risk function
used in the context of competing risks (Klein & Moeschberger 2003).
    As mentioning before, in semicompeting risks, it is not appropriate to assume
independence between the event X and Y . Therefore, in order to introduce a
possible dependence of the transition times between the states progression and
death, we consider the use of a shared frailty model, denoting the frailty by a
random variable Î³ . The authors propose to model the conditional transitions
hazard rates given Î³ and include this random variable multiplicatively. Since
each transition hazard rate must be non-negative, we must have Î³ > 0 and it
is convenient to assume Î³ âˆ¼ Î“(1/Î¸; 1/Î¸) such that E(Î³) = 1 and the variance
is Î¸ (which is unknown and must be estimated). The gamma distribution for
the random eects is convenient for semi parametric proportional hazards models
mainly due to mathematical convenience (for details see Wienke 2011) and it is,
therefore, a natural choice for a rst approach. However, models with dierent
frailty distributions should be considered in future research.
    Thus, the conditional hazard functions dened above (6) are given by

                          Î»1 (x|Î³)   = Î³Î»01 (x),      x > 0,
                          Î»2 (y|Î³)   = Î³Î»02 (y),      y > 0,
                      Î»12 (y|Î³, x)   = Î³Î»03 (y),      0 < x < y.

   However, in a general model, covariates (z ) are incorporated similar to the Cox
proportional hazards model, so that

                     Î»1 (x|Î³, z) =Î³Î»01 (x) exp{Î² t1 z},    x > 0,
                     Î»2 (x|Î³, z) =Î³Î»02 (y) exp{Î² t2 z},    y > 0,                    (7)
                  Î»12 (y|Î³, x, z) =Î³Î»03 (y) exp{Î² t3 z},   0 < x < y.

    We are mainly interested in estimating the coecients Î² 1 , Î² 2 and Î² 3 , which
contains information on the eects of covariates on the intensity functions condi-
tional on frailty. Xu et al. (2010) do not make any assumption for the baseline
functions Î»01 (x), Î»02 (y) and Î»03 (y) and non-parametric estimators are considered.

3.1. Estimation

   Maximum likelihood can be used to obtain the estimators of the model para-
meters in (7). From this model, notice that the probability density function (and


                                        Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                                      45

survival function) depends on the baseline transition intensity functions Î»01 (k),
Î»02 (k) and Î»03 (k), which are unknown and must be estimated. Following the idea
of several non-parametric estimators of cumulative hazard functions (see Breslow
(1972), Breslow (1975)), we can approximate the cumulative hazard function by a
function that jumps when a failure or event is observed. Assuming that we observe
m intermediate events, estimation of Î»01 (x) reduces to the problem of estimation
m parameters. Denoting by tr1 , tr2 , Â· Â· Â· , trm the instants in which a non-terminal
event was observed, td1 , td2 , Â· Â· Â· , tdf the times when a terminal event without pro-
gression was observed and trd1 , trd2 , Â· Â· Â· , trdg the times in which a terminal event
occurred after the progression, we can write
             m                                    f                                    g
                                                        Î»02j I{tdj <k} and Î›03 (k) =
             X                                    X                                    X
 Î›01 (k) =         Î»01j I{trj <k} ,   Î›02 (k) =                                              Î»03j I{trdj <k} .
             j=1                                  j=1                                  j=1


Let Î»01 = (Î»011 , Â· Â· Â· , Î»01m )> , Î»02 = (Î»021 , Â· Â· Â· , Î»02f )> and Î»03 = (Î»031 , Â· Â· Â· , Î»03g )> ,
where Î»01j = dÎ›01 (trj ), j = 1 Â· Â· Â· , m, Î»02j = dÎ›02 (tdj ), j = 1 Â· Â· Â· , f and Î»03j =
dÎ›03 (tdrj ), j = 1 Â· Â· Â· , g .
   With this notation, the vector of parameters is

          Î· = (Î¸, Î² 1 , Î² 2 , Î² 3 , Î»01 , Î»02 , Î»03 ) = (Î¸, Î² 1 , Î² 2 , Î² 3 , dÎ›01 , dÎ›02 , dÎ›03 ),

For the estimation of Î· , it is necessary to obtain the joint survival function and the
corresponding density probability function of (X, Y ) to determine the contribution
of an individual in each case on the likelihood L(Î·). In semicompeting risks
structure, it is not straightforward to compute the bivariate probability density
function of (X, Y ) from the model specication (7) because we have the restriction
that X < Y and X may not be observed.
    In order to compute the bivariate density function, we assume conditional
independence of X and Y given the frailty. Due to relation beetwen the hazard,
density and survival functions h(Â·) = f (Â·)/s(Â·) from (7) we can write

                   fX|Î“ (x|Î³, z) = Î³Î»01 (x) exp{Î² >                    >
                                                  1 z âˆ’ Î³Î›01 (x) exp{Î² 1 z}}


and
                          fY |X,Î“ (y|x, Î³, z) = Î»âˆ— (y|x, Î³, z)S âˆ— (y|x, Î³, z),
where
                   (
 âˆ—                     Î³Î»03 (y) exp{Î² >
                                      3 z},       x â‰¤ y,
Î» (y|x, Î³, z) =
                       Î³Î»02 (y) exp{Î² >
                                      2 z},       otherwise (non-terminal event not observed)

and

     S âˆ— (y|x, Î³, z) =
(
      exp âˆ’Î³(Î›02 (x) exp{Î² >                    >                    >
           
                           2 z} + Î›03 (y) exp{Î² 3 z} âˆ’ Î›03 (x) exp{Î² 3 z}) ,                   x â‰¤ y,
                          >
                                                                                               otherwise.
           
      exp âˆ’Î³Î›02 (y) exp{Î² 2 z} ,




                                                  Revista Colombiana de EstadÃ­stica 42 (2019) 3559

46                          Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera
                                                    Râˆž
   Using the fact that fX,Y (x, y|z) =               0
                                                          fY |X,Î“ (y|x, Î³, z)fX|Î“ (x|Î³, z)fÎ“ (Î³)dÎ³ , we
can show that

 fX,Y (x, y|z) =
ï£±                 >            >
ï£´
ï£´ (1 + Î¸)Î»01 (x)eÎ²1 z Î»03 (y)eÎ²3 z
                 >                  >                           >
  (1 + Î¸Î›01 (x)eÎ²1 z + Î¸Î›02 (x)eÎ²2 z + Î¸(Î›03 (y) âˆ’ Î›03 (x))eÎ²3 z )âˆ’(1/Î¸)âˆ’2 ,
ï£´
                                                                                                x â‰¤ y,
ï£²
ï£´
ï£´
                                                                                                otherwise.
                  >            >                  >               >
ï£´
  (1 + Î¸)Î»01 (x)eÎ²1 z Î»02 (y)eÎ²2 z [1 + Î¸Î›01 (x)eÎ²1 z + Î¸Î›02 (y)eÎ²2 z ]âˆ’(1/Î¸)âˆ’2 ,
ï£³

                                                                                                               (8)

    In expression (8), notice that the situation in which the non-terminal event is
not observed depends on x, which is not appropriate. Xu et al. (2010) assume that
this situation correspond to X = âˆž and compute

     fâˆž (y|z) =
       Z âˆž
                            >            >                  >               >
            (1 + Î¸)Î»01 (x)eÎ²1 z Î»02 (y)eÎ²2 z [1 + Î¸Î›01 (x)eÎ²1 z + Î¸Î›02 (y)eÎ²2 z ]âˆ’(1/Î¸)âˆ’2 dx
         y
                                                >                   >                 >
                                   = Î»02 (y)eÎ²2 z [1 + Î¸Î›01 (y)eÎ²1 z + Î¸Î›02 (y)eÎ²2 z ]âˆ’(1/Î¸)âˆ’1 .         (9)

 Expressions (8) for x < y and (9) are the probability densities functions needed for
the likelihood construction. Assuming that our data is subject to right censoring,
we must compute the survival distributions for censored observations. As discussed
before, due to censoring, we have four dierent possibilities and the contribution
for the likelihood is dierent for observations in each case: for observations in
case 1, the contribution to the likelihood is the density fXY (x, y), x < y ; in case
2, the contribution is given by expression (9), i.e., fâˆž (y|z); for case 3, we must
compute SY |X=x (y)fX (x); and, nally, for case 4, we need the survival function
SXY (x, y) (with x = y ). Table 4 presents the expressions of the contribution for
the likelihood of each case.

Table 4:       Contribution to the likelihood construction for each possible situation for right
               censored data.
                      Contribution to the likelihood function

                                       >              >
             Case 1   (1 + Î¸)Î»01 (x)eÎ²1 z Î»03 (y)eÎ²3 z Ã—
                                     Î²>                   >                           >     1
                      [1 + Î¸Î›01 (x)e  1 z   + Î¸Î›02 (x)eÎ²2 z + Î¸(Î›03 (y) âˆ’ Î›03 (x))eÎ²3 z ]âˆ’ Î¸ âˆ’2 ;

                               >                     >               >     1
             Case 2   Î»02 (y)eÎ²2 z [1 + Î¸Î›01 (y)eÎ²1 z + Î¸Î›02 (y)eÎ²2 z ]âˆ’ Î¸ âˆ’1 ;

                               T
             Case 3   Î»01 (x)eÎ²1 z Ã—
                                       >                  >                           >    1
                      [1 + Î¸Î›01 (x)eÎ²1 z + Î¸Î›02 (x)eÎ²2 z + Î¸(Î›03 (c) âˆ’ Î›03 (x))eÎ²3 z ]âˆ’ Î¸ âˆ’1 ;

                                       >                  >    1
             Case 4   [1 + Î¸Î›01 (c)eÎ²1 z + Î¸Î›02 (c)eÎ²2 z ]âˆ’ Î¸




                                                    Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                                47

   Thus, with the observable variables Di = {(Ri , Si , Î´yi , Î´zi , Î´xzi ), i = 1, Â· Â· Â· , n}
described in 2.1 the likelihood function is given by
              n
              Y
   L(Î·) =           Î»01 (Ri )Î´xzi Î»02 (Si )Î´yi (1âˆ’Î´xzi ) Î»03 (Si )Î´xzi Î´yi
              i=1

              Ã— exp{Î´xzi Î² >                         >                  >
                           1 z i + (Î´yi (1 âˆ’ Î´xzi )Î² 2 z i + Î´xzi Î´yi Î² 3 z i } Ã— (1 + Î¸)
                                                                                         Î´xzi Î´yi

                                                  >                >
              Ã— {1 + Î¸[Î›01 (Si )eÎ²1 z + Î›02 (Si )eÎ²2 z                                               (10)
                                                            Î²>
                                                             3 z       âˆ’ Î¸1 âˆ’Î´xzi âˆ’Î´yi
                          + (Î›03 (Ri ) âˆ’ Î›03 (Si ))e               ]}                    .
    Observe that in cases 2 and 4 the term Î›03 (Ri ) âˆ’ Î›03 (Si ) in (10) vanishes,
since Ri = Si . For more details, see PatiÃ±o (2012).
    Finally, the estimators are solution of score equation U (Î·) = âˆ‚ log(L(Î·))
                                                                        âˆ‚Î·     = 0.
The log likelihood function and the components of score vector are presented in
the Appendix A. Xu et al. (2010) specify some conditions to establish asymptotic
properties of the estimators. They discuss identiability of the model and asymp-
totic convergence of estimators. The numerical approach proposed by the authors
can be summarized as follows:
                          (0)         (0)
   1. Let Î¸(0) , Î² j , Î›0j (k), j = 1, 2, 3 be initial estimates. We can set Î¸(0) = 0,
        (0)                                 (0)
      Î² j = 0 and for Î›0j (k), j = 1, 2, 3 we use the Nelson-Aalen type estimate
      of the respective cumulative hazard functions.
                    (0)                                                                        (1)
   2. Given Î›0j (k), j = 1, 2, 3, we update estimates of Î¸, e Î² j to Î¸(1) , Î² j , j =
      1, 2, 3, from U1 , U2 , U3 , U4 where Ui = âˆ‚ log(L(Î·))
                                                     âˆ‚Î²j     i = 1, 2, 3.
                                (1)
   3. Given Î¸(1) , Î² j , j = 1, 2, 3, we solve the equations U5 = 0, U6 = 0 and
                                                      (1)
      U7 = 0 for updated estimated Î›0j (k), j = 1, 2, 3.
   4. Finally, we update the initial estimates in (1) and we repeat steps (2)-(4)
      until convergence.
     Ë†
Let I(Î·Ì‚) = âˆ’ âˆ‚U   (Î·Ì‚)
                âˆ‚ Î·Ì‚ >
                        be the observed information matrix for Î·Ì‚ given by the second
derivatives of log-likelihood function evaluated at maximum likelihood estimators
                                          Ë† âˆ’1 can be used to estimate asymptotic
(MLE) for Î· . For large sample sizes, I(Î·Ì‚)
                           >   >   >
variance of Î± = (Î¸, Î² 1 , Î² 2 , Î² 3 ).
               >

    For the estimation of parameters of this model, we use the R package nqslv
for the numeric solutions of the score equations. For estimation of Î¸, Î² 1 , Î² 2 and
Î² 3 we use a convergence criteria  = 0.001 and for Î»01 , Î»02 , Î»03 we consider
a less restrictive criteria Î´ = 0.01. We did not have convergence problems and
the procedure is not much inuenced by initial values (for regression parameters,
initial values were obtained by a Cox model).

3.2. Simulation Study

    A simulation study was conducted mainly in order to compare the illness-death
frailty model with a simple regression model that does not consider the dependence
of the observed events.


                                                      Revista Colombiana de EstadÃ­stica 42 (2019) 3559

48                    Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera

    Considering the model (7), we simulated the frailty with mean 1 and variance
Î¸ from a gamma distribution with shape and scale parameters 1/Î¸. We added
a random variable Z âˆ¼ Normal (0,1) representing a covariate. We generated n
observations T1i and T2i from the Weibull distribution for both non-terminal and
terminal events: T1i âˆ¼ Weibull with hazard function Î»1i = Î³i eÎ±+Î²1 xi and T2i âˆ¼
Weibull with hazard function Î»2i = Î³i eÎ±+Î²2 xi , i = 1 Â· Â· Â· n, respectively. Fixing
Î± = âˆ’10, we have Tki âˆ¼ Weibull(ai , bki ), with ai = 2 and bki = exp{âˆ’1/ai (log Î³i +
Î± + Î²k xi )} for k = 1, 2.
    Since our data is subject to right-censoring, we added a proportion pc of censo-
red observations. As it is usual in real data applications, we considered both type I
and random censoring: we assume that the study ends at time Ï„ (type I censoring)
and, if pc is not achieved, we added a random censoring with C âˆ¼ Unif(0, Ï„ ).
    We report results from 500 replications for n = 100, n = 500 and n = 800 with
Î²1 = 1, Î²2 = 1, frailty variance given by Î¸ = 0, 5, Î¸ = 1 and Î¸ = 2 and, nally, xed
proportions of censoring pc equal to 40%, 60%, 70%. We chose a follow up time
Ï„ = 1095 days motivated by our real data application. All computer codes were
developed for R software (for both simulation and application) and are available
upon request.
    Results of mean and standard error of estimated parameters from 500 replica-
tions are summarized in Figures 2 and 3. The horizontal line corresponds to true
value of parameters Î²1 and Î²2 . In general, it is possible to observe that for most
situations the illness death model was less biased than the naive Weibull model,
and it is interesting to notice that, as the variance of frailty increases, the bias
also increases. Therefore, one can conclude that the illness death model performs
very favourably in terms of bias, although the variance of estimators (and hence
the mean squared error) may be greater than the corresponding variance of the
naive Weibull model for small samples. This is expected, since there are more
parameters to be estimated in the frailty model considered.


4. Kidney Disease Data Analysis

    As previously discussed, we are interested in analysing a dataset with 1253
end-stage renal disease (ESRD), stages IV and V, of CKD patients, followed from
2009 to 2011 by Fresenius Medical Care in Colombia and Laboratory Medical
Echavarria. Patients included in the analysis started dialysis treatment and were
periodically examined. Tests were performed to obtain the levels of calcium, in-
organic phosphorus, serum albumin, serum creatinine, among other blood tests.
It is of interest to study survival time of patients from beginning of dialysis tre-
atment, but it is also of interest to study the disease's progression. In this rst
approach, it was considered that a patient experiences progression when their level
of phosphorus in the blood is greater than 5.6 mg/dl.
    All patients are from ve cities in Colombia: Manizales (280 patients), Monteria
(370 patients), Rionegro (131), Sincelejo (334) and Tunja (138) and 61.2% are
males. Regarding age, people between 51 and 65 years represent 34% of the data
and those over 66 years represent 30.6%.



                                      Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                                                                                                                 49

                                     Î¸ = 0.5 n = 100                                              Î¸ = 0.5 n = 500                                              Î¸ = 0.5 n = 800




     0.4 0.6 0.8 1.0 1.2 1.4




                                                                  0.4 0.6 0.8 1.0 1.2 1.4




                                                                                                                               0.4 0.6 0.8 1.0 1.2 1.4
Î²1




                                                             Î²1




                                                                                                                          Î²1
                               40%        60%          70%                                  40%        60%          70%                                  40%        60%          70%

                                        censoring                                                    censoring                                                    censoring


                                     Î¸ = 1 n = 100                                                Î¸ = 1 n = 500                                                Î¸ = 1 n = 800
     0.4 0.6 0.8 1.0 1.2 1.4




                                                                  0.4 0.6 0.8 1.0 1.2 1.4




                                                                                                                               0.4 0.6 0.8 1.0 1.2 1.4
Î²1




                                                             Î²1




                                                                                                                          Î²1
                               40%        60%          70%                                  40%        60%          70%                                  40%        60%          70%

                                        censoring                                                    censoring                                                    censoring


                                     Î¸ = 2 n = 100                                                Î¸ = 2 n = 500                                                Î¸ = 2 n = 800
     0.4 0.6 0.8 1.0 1.2 1.4




                                                                  0.4 0.6 0.8 1.0 1.2 1.4




                                                                                                                               0.4 0.6 0.8 1.0 1.2 1.4
Î²1




                                                             Î²1




                                                                                                                          Î²1




                               40%        60%          70%                                  40%        60%          70%                                  40%        60%          70%

                                        censoring                                                    censoring                                                    censoring

Figure 2:                            Simulations results for Î²1 = 1. Continuous lines: Illness-Death model. Dis-
                                     continuous lines: weibull model.


    An initial descriptive analysis of data was done using copula graphic estimators.
We computed the copula graphic estimator using the four copulas considered in
this work. Table 5 shows the estimates of the copula parameter and Kendall's tau
coecient. An important aspect in application is the choice of the copula for the
copula graphic estimator. We suggest a scatter plot of time to progression and time
to death of uncensored observations as a rst guide and also to use several copulas
and compare the resulting plots. In our example, the estimated dependence is
positive and small for most copulas; only family B copula had a dierent result.
Although the estimated dependence for Family B copula is dierent form other
copulas, copula graphic estimates for the survival function are very similar, as
shown in Figure 4.
    From the K-M plot of the survival distribution of patients and the copula
graphic estimator of the survival function of the progression, we can conclude that
after two years we still have around 60% of patients alive and also 60% of patients
without progression of the disease. It is important to notice that we have only two


                                                                                                  Revista Colombiana de EstadÃ­stica 42 (2019) 3559

50                                                       Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera

                                      Î¸ = 0.5 n = 100                                               Î¸ = 0.5 n = 500                                              Î¸ = 0.5 n = 800




     0.4 0.6 0.8 1.0 1.2 1.4




                                                                    0.4 0.6 0.8 1.0 1.2 1.4




                                                                                                                                 0.4 0.6 0.8 1.0 1.2 1.4
Î²2




                                                               Î²2




                                                                                                                            Î²2
                                40%         60%         70%                                   40%         60%         70%                                  40%         60%         70%

                                         censoring                                                     censoring                                                    censoring


                                      Î¸ = 1 n = 100                                                 Î¸ = 1 n = 500                                                Î¸ = 1 n = 800
     0.4 0.6 0.8 1.0 1.2 1.4




                                                                    0.4 0.6 0.8 1.0 1.2 1.4




                                                                                                                                 0.4 0.6 0.8 1.0 1.2 1.4
Î²2




                                                               Î²2




                                                                                                                            Î²2
                                40%         60%         70%                                   40%         60%         70%                                  40%         60%         70%

                                         censoring                                                     censoring                                                    censoring


                                      Î¸ = 2 n = 100                                                 Î¸ = 2 n = 500                                                Î¸ = 2 n = 800
     0.4 0.6 0.8 1.0 1.2 1.4




                                                                    0.4 0.6 0.8 1.0 1.2 1.4




                                                                                                                                 0.4 0.6 0.8 1.0 1.2 1.4
Î²2




                                                               Î²2




                                                                                                                            Î²2




                                40%         60%         70%                                   40%         60%         70%                                  40%         60%         70%

                                         censoring                                                     censoring                                                    censoring

Figure 3:                             Simulations results for Î²2 = 1. Continuous lines: Illness-Death model. Dis-
                                      continuous lines: weibull model.


years of follow up, and the graphics show that a longer follow up time would be
valuable for a better understanding of disease progression.

                               Table 5:       Estimated copula parameter and dependence coecient, Î±Ì‚ and Ï„Ì‚ .
                                             Copula                                                           Î±Ì‚ (se)            Ï„Ì‚ (se)
                                             Family A - Clayton copula                                    0,586 (0,142)      0,227 (0,042)
                                             Family B                                                     1,559 (0,022)      -0,282 (0,018)
                                             Family C - Frank copula                                      1,387 (0,295)      0,151 (0,031)
                                             Family D - Gumbel copula                                     1,141 (0,038)      0,124 (0,029)


   For a multivariante analysis, we tted the model described in Section 3 and
four covariates were included: treatment (peritoneal dialysis/hemodialysis), sex
(male/female), age(â‰¤ 30 years/ â‰¥ 31 and â‰¤ 50 years/ â‰¥ 51 and â‰¤ 65 years/ â‰¥ 66


                                                                                                    Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                                                                        51

years) and city (Manizales/ Monteria/ Rionegro/ Sincelejo/ Tunja). The results
of estimated coecients shown in Table 6 and Table 7.

                         1.0




                                                                                                      1.0
Sx(t) (Copulaâˆ’Graphic)
                         0.8




                                                                                                      0.8
                                                                              Sy(t) (Kaplanâˆ’Meier)
                         0.6




                                                                                                      0.6
                         0.4




                                                                                                      0.4
                                                  Aâˆ’Clayton
                         0.2




                                                                                                      0.2
                                                  B
                                                  Câˆ’Frank
                                                  Dâˆ’Gumbel
                         0.0




                                                                                                      0.0
                               0     100 200 300 400 500 600 700                                            0   100 200 300 400 500 600 700
                                                  Time                                                                    Time

Figure 4:                            Estimated marginal survival functions for disease progression (left) and death
                                     (right).


                         Table 6:         Estimates of Illness-death model for kidney disease analysis (death).
                                                    Time to death without progression Time to death after progression
Covar./parameter                                    Estimate SE          P value      Estimate SE          P value

Treat.                             peritoneal               -       -                                  -                -       -       -
                                   hemodialysis          -0,354   0,168                              0,035            0,017   0,320   0,958
Sex                                female                   -       -                                  -                -       -       -
                                   male                  -0,162   0,157                              0,301           -0,154   0,264   0,558
Age     â‰¤ 30                                                -       -                                  -                -       -       -
(years) â‰¥ 31 and â‰¤ 50                                    -0,108   0,279                              0,697           -0,161   0,425   0,705
        â‰¥ 51 and â‰¤ 65                                     0,541   0,237                              0,023           0,335    0,384   0,382
                                   â‰¥ 66                   0,998   0,233                              0,000           0,833    0,386   0,031
City                               Manizales                -       -                                  -                -       -       -
                                   Monteria               0,263   0,206                              0,200            0,755   0,335   0,024
                                   Rionegro              0,259    0,382                              0,499           0,917    0,560   0,101
                                   Sincelejo              0,782   0,228                              0,000            1,549   0,359   0,000
                                   Tunja                 0,633    0,302                              0,036           0,538    0,454   0,236


   The treatment was signicant for time to progession and time to death without
progression. Patients treated with hemodialysis have a higher risk of progession,
however a lower risk of death when compared to patients having peritoneal disease.
This result seems consistent with the fact that there was a smaller proportion of
patients with death without progression (67.2 %) than with progression (80.2 %)
and death after recurrence (80.6 %) in the group treated with hemodialysis.
   Age is an important covariate to be included (it is signicant), and the results
are as expected. It is interesting to notice that age group 4 has a lower risk
of progression, however a high risk of death. Regarding the city, Monteria and


                                                                          Revista Colombiana de EstadÃ­stica 42 (2019) 3559

52                    Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera

 Table 7:   Estimates of Illness-death model for kidney disease analysis (progression).
                                                Time to progression
            Covar./parameter                 Estimate   SE     P value

            Treat.     peritoneal dialysis        -         -         -
                       hemodialysis             0,439     0,134     0,001
            Sex        female                     -         -         -
                       male                     0,019     0,111     0,867
            Age        â‰¤ 30                       -         -         -
            (years)    â‰¥ 31 and â‰¤ 50            0,074     0,162     0,646
                       â‰¥ 51 and â‰¤ 65            0,045     0,152     0,767
                       â‰¥ 66                    -0,508     0,175     0,004
            City       Manizales                  -         -         -
                       Monteria                -0,466     0,144     0,001
                       Rionegro                 0,471     0,177     0,008
                       Sincelejo               -0,338     0,160     0,034
                       Tunja                    0,197     0,184     0,284
            Î¸                                   0,109     0,222       -


Rionegro showed signicant progression and death after progression eect, which
show us that the local where the patient is treated is an important factor that must
be included in the analysis. The covariate sex is not signicant in any transition
rate and the estimated dependence is positive, but not strong (Ï„Ì‚ = 0.05).
    It is important to notice that our approach was the use of hypothesis testing
for covariate selection, however it would be useful to implement a discrimination
criteria to help the decision of the best model, as pointed out by Lakhal & Abdous
(2008). Also goodness-of-t methods need to be developed to both assess the
overall quality of t in the regression model and assist the selection of a parametric
family of Archimedean copulas (although in our application the conclusions were
similar for dierent copulas).


5. Discussion

    In this work, the semicompeting risks structure approach was used to analyse
chronic kidney disease data. We focused on two events: the progression of disease
(considered as a non-terminal or intermediate event) and death (terminal event).
Although this is a preliminary analysis, the results will provide useful information
for decision-making purposes and planning politics for patient care centers.
    The rst diculty that arises in the analysis of semicompeting risks data is to
obtain estimators of the survival function for a simple descriptive analysis or data
visualization. Given the possible dependence between the two events, the Kaplan-
Meier estimator is not suitable for estimating the marginal survival function ob-
served when the intermediate event occurs. The approach proposed by Lakhal


                                        Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                              53

& Abdous (2008) using the copula-graphic estimator in this situation seems to
have good results. The use of the Archimedean copula family proved to be quite
convenient for estimating the bivariate survival function. In general, for an initial
descriptive analysis data, the approach with copula is a very good alternative. The
selection of a particular copula of the Archimedean family can indeed inuence the
estimates and, although the dierences among dierent copulas observed in the
application are not signicant, it would be interesting to develop a methodology
to evaluate somehow which is the most convenient copula for a given application.
    When the interest is focused on eects of covariates and a regression model is
needed, the model proposed by Xu et al. (2010) is a very interesting alternative.
The estimation by maximum likelihood and the iterative process is quite fast,
obtaining convergence in few iterations. In this case, the baseline hazard rate
functions are not specied and an usual approximation was used for estimation
(the cumulative basal hazard function is approximated by a step function that
jumps when an event is observed) which depends on the size of the sample. A
parametric approach could also be developed in order to decrease the number of
parameters to be estimated. Also, asymptotic properties of estimators have been
established, however there are not any results for small sample sizes, so we do not
recommend the use of this methodologies when the sample size is not large.
    In general, the results obtained are consistent with expected by researchers
and hemodialysis results to be a good alternative in many situations. Our data
had patients form ve dierent cities and Manizales is known to have a wide
trajectory in the treatment of renal patients. Our results showed that Manizales
is the city with higher survival probabilities (for both death without progression
and death after progression). Rionegro and Sincelejo renal units are newer, and our
results found less favourable conditions. Regarding the fragility parameter (i.e.,
the variance of the random eect), the estimative obtained from the general model,
Î¸Ì‚= 0.109 (0.222), indicates a weak association between progression and death. It
is also an expected result considering that the observation time of patients with
this disease was short. This is an ongoing study and a study with longer follow up
time is needed. Researches suggest to continue this study to evaluate the survival
of patients with CKD with a follow-up longer than two years and including clinic
covariates like co-morbidity, type of primary disease and manifestations or not of
extrarenal complications.


Acknowledgements

   We are grateful to Clara InÃ©s Salazar from Fresenius Medical Care of Colombia,
Blanca Susana Ramirez and Maria Alejandra Restrepo from the medical laboratory
Echavarria.




                                      Revista Colombiana de EstadÃ­stica 42 (2019) 3559

54                     Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera
              
                  Received: November 2017  Accepted: August 2018
References
Breslow, N. (1972), `ContribuiÃ§Ã£o para a discusssÃ£o do artigo de d. r. cox', Journal of the Royal Statistical Society, Ser. B 34, 216217.
Breslow, N. (1975), `Analysis of survival data under the proportional hazards model', International Statistical Review 43, 4558.
Campbell, G. (1981), `Nonparametric bivariate estimation with randomly censored data.', Biometrika 68, 417422.
Campbell, G. & Foldes, A. (1980), Large sample properties of nonparametric bivariate estimators with censored data., Technical report, Indiana. USA.
Clayton, D. (1978), `A model for association in bivariate life tables and its application in epidemiological studies of family tendency in chronic disease incidence', Biometrika 65, 141151.
Cuenta del Alto Costo (2014), Fondo Colombiano de Enfermedades de Alto Costo. Enfermedad Renal CrÃ³nica en Colombia. ResoluciÃ³n 4700 de 2008., BogotÃ¡.
Dabrowska, D. M. (1988), `Kaplan-meier estimate on the plane.', Annals of Statistics 16, 14751489.
Fine, J., Jiang, H. & Chappell, R. (2001), `On semicompeting risk', Biometrika 88, 907919.
Fiocco, M., Putter, H. & van Houwelingen, H. (2008), `Reduced-rank proportional hazards regression and simulation-based prediction for multi-state models', Statistics in Medicine 27, 43404358.
Fix, E. & Neyman, J. (1951), `A simple stochastic model for recovery, relapse, death and loss of patients', Human Biology 23, 205241.
GÃ³mez, R. A. (2006), `Renal disease in colombia', Renal failure 28, 643-647.
Hanley, J. A. & Parnes, M. N. (1983), `Nonparametric estimation of a multivariate distribution in the presence of censoring.', Biometrics 39, 129139.
Hsieh, J., Wang, W. & Ding, A. (2008), `Regression analysis based on semicompeting risk data.', Journal of the Royal Statistical Society, Ser. B 70, 3-20.
Jiang, H., Fine, J., Kosorok, R. & Chappell, R. (2005), `Pseudo self-consistent estimation of a copula model with informative censoring.', Scandinavian Journal of Statistics 32, 1-20.
Kaplan, E. & Meier, P. (1958), `Nonparametric estimation from incomplete observations', Journal of the American Statistical Association 53, 457-481.
Klein, J. & Moeschberger, M. (2003), Survival Analysis: Techniques for Censored and Truncated Data, 2nd edn, Springer.
Lakhal, L.and Rivest, L. & Abdous, B. (2008), `Estimating survival and association in a semicompeting risk model', Biometrics 64, 180188.
Lin, D. Y. & Ying, Z. (1993), `A simple nonparametric estimator of the bivariate survival function under univariate censoring', Biometrika 80, 573582.
MartÃ­n-Cleary, C. & Ortiz, A. (2014), `Ckd hotspots around the world: where, why and what the lessons are. a ckj review series', Clinical Kidney Journal 7, 519523.
Nelsen, R. (2006), An Introduction to Copulas, 2nd edn, Springer.
Oakes, D. (1989), `Bivariate survival models induced by frailties', Journal of the American Statistical Association 84, 487492.
PatiÃ±o, E. G. (2012), AnÃ¡lise de dados com riscos semicompetitivos, DissertaÃ§Ã£o de Mestrado, Universidade de SÃ£o Paulo, Instituto de MatemÃ¡tica e EstatÃ­stica. Departamento de EstatÃ­stica, SÃ£o Paulo.
Prentice, R. L. & Cai, J. (1992), `Covariance and survival function estimation using censored multivariate failure time data.', Biometrika 79, 495512.
Rivest, L.-P. & Wells, M. (2001), `A martingale approach to the copula-graphic estimator for the survival function under dependent censoring', Journal of Multivariate analysis 79, 138155.
Romeo, J. S. (2005), Modelagem Bayesiana para dados de sobrevivÃªncia bivariados atrvÃ©s de cÃ³pulas, Tese de Doutorado, Universidade de SÃ£o Paulo, Instituto de MatemÃ¡tica e EstatÃ­stica. Departamento de EstatÃ­stica, SÃ£o Paulo.Tsai, W. Y., 
Leurgans, S. & Crowley, J. (1986), `Nonparametric estimation of a bivariate survival function in the presence of censoring.', Annals of Statistics 14, 13511365.
Wienke, A. (2011), Frailty Models in Survival Analysis, 1fs edn, CRC Press, GÃ¼strow.
Xu, J., Kalbeisch, J. & Tai, B. (2010), `Statistical analysis of illness-death processes and semicompeting risks data', Biometrics 66, 716725.
Zheng, M. & Klein, J. (1982), `Estimates of marginal survival for dependent competing risk based on an assumed copula', Biometrika 82, 127138.
Appendix A. The log likelihood function and score
                             vector of illness-death model

     The log likelihood function of model (7) is

                   n
                   X
     log(L(Î·)) =         Î´xi log{Î»01 (Si )} + Î´yi (1 âˆ’ Î´xi ) log{Î»02 (Ri )} + Î´xi Î´yi log{Î»03 (Ri )}
                   i=1

                   + Î´xi Î² >                       >                 >
                           1 z i + Î´yi (1 âˆ’ Î´xi )Î² 2 z i + Î´xi Î´yi Î² 3 z i + Î´xi Î´yi log{(1 + Î¸)}
                                                                      >                      >
                   âˆ’ ((1/Î¸) + Î´xi âˆ’ Î´yi ) log{1 + Î¸[Î›01 (Si )eÎ²1 zi + Î›02 (Si )eÎ²2 zi
                                                   >
                   + (Î›03 (Ri ) âˆ’ Î›03 (Si ))eÎ²3 zi ]}.                                                   (A.1)



    In order to obtain the components of the vector score of partial derivatives
from Î»0R , Î»0D and Î»0RD , notice that Î›01 (k), Î›02 (k) and Î›03 (k) represent the
cumulative hazard functions at time k in the sample for the time until progres-
sion, time until death without progression and time to death after progression,
respectively. Thereby, it is possible to write

                                                                                       m
                                                                                       X
  Î›01 (k) = Î»011 I{tr1 <k} + Î»012 I{tr2 <k} + Â· Â· Â· + Î»01m I{trm <k} =                       Î»01j I{trj <k} .
                                                                                       j=1


                                f
                                P                                          g
                                                                           P
Analogously, Î›02 (k) =               Î»02j I{tdj <k} and Î›03 (k) =               Î»03j I{trdj <k} . Then, the
                               j=1                                        j=1
log likelihood function log(L(Î·)) given in (A.1) can be written as

                   n
                   X
     log(L(Î·)) =         Î´xi log{Î»01 (Si )} + Î´yi (1 âˆ’ Î´xi ) log{Î»02 (Ri )} + Î´xi Î´yi log{Î»03 (Ri )}
                   i=1

              + Î´xi Î² >                       >                 >
                      1 z i + Î´yi (1 âˆ’ Î´xi )Î² 2 z i + Î´xi Î´yi Î² 3 z i + Î´xi Î´yi log{(1 + Î¸)}
                                                   X m                              f
                                                                              >      X
              âˆ’ ((1/Î¸) + Î´xi âˆ’ Î´yi ) log 1 + Î¸             Î»01j I{trj <Si } eÎ²1 zi +     Î»02j
                                                          j=1                             j=1
                                         g                                    
                                 >       X                             >
              Ã— I{tdj <Si } eÎ²2 zi +           Î»03j I{Ri â‰¤trdj <Si } eÎ²3 zi        .
                                         j=1



To simplify the expression of partial derivatives of each component of score vector
U (Î·), let be Ai = A1i + A2i + A3i , with
                                    Pm                       Î²>
    A1i = Î›01 (Si ) exp{Î² >
                          1 zi} =     j=1 Î»01j I{trj <Si } e
                                                              1 zi ,

                          >         Pf                        >
    A2i = Î›02 (Si ) exp{Î² 2 z i } = j=1 Î»02j I{tdj <Si } eÎ²2 zi and
                                                 Pg                              Î²>
    A3i = (Î›03 (Ri ) âˆ’ Î›03 (Si )) exp{Î² >
                                        3 zi} =      j=1 Î»03j I{Ri â‰¤trdj <Si } e
                                                                                  3 zi .




                                                   Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                                                 57

   Thus, the components of score vector U (Î·) are:
                     âˆ‚
      U1       =        log(L(Î·))
                    âˆ‚Î¸
                     n                                                      
                    X     Î´xi Î´yi   n                     Ai     1
               =                  + 2 log{1 + Î¸Ai } âˆ’              + Î´xi + Î´yi     ,
                    i=1
                           1+Î¸     Î¸                    1 + Î¸Ai Î¸
                     âˆ‚
      U2       =        log(L(Î·))
                    âˆ‚Î²1
                     n                                     
                    X                1               Î¸A1i z i
               =         Î´xi z i âˆ’     + Î´xi + Î´yi              ,
                    i=1
                                     Î¸               1 + Î¸Ai
                     âˆ‚
      U3       =         log(L(Î·))
                    âˆ‚Î²2
                     n                                               
                                                1               Î¸A2i zi
                                                                          e
                    X
               =          (1 âˆ’ Î´xi )Î´yi z i âˆ’     + Î´xi + Î´yi
                    i=1
                                                Î¸               1 + Î¸Ai
                     âˆ‚
      U4       =        log(L(Î·))
                    âˆ‚Î²3
                     n                                         
                    X                    1               Î¸A3i z i
               =         Î´xi Î´yi z i âˆ’     + Î´xi + Î´yi              .
                    i=1
                                         Î¸               1 + Î¸Ai

Finally, the j âˆ’ th components of U5 , U6 and U7 are
                   n                                    I                      >
                     dtrj                                    {trj <Si } Î¸ exp(Î² 1 z i )
                                    
                   X                    1
   U5j     =                    âˆ’         + Î´xi + Î´yi                                     ,       j = 1 Â· Â· Â· m,
                   i=1
                         Î»01j           Î¸                           1 + Î¸Ai
                   n d                                  I                     >
                                                             {td <Si } Î¸ exp(Î² 2 z i )
                                    
                   X  td
                        j               1                       j
   U6j     =                    âˆ’         + Î´xi + Î´yi                                     ,       j = 1 Â· Â· Â· f,
                   i=1
                       Î»02j             Î¸                           1 + Î¸Ai
                   n                                    I                          >
                     d t rj                                  {Si <trj â‰¤Ri } Î¸ exp(Î² 3 z i )
                                    
                   X                    1
   U7j     =                    âˆ’         + Î´xi + Î´yi                                         ,       j = 1 Â· Â· Â· g.
                   i=1
                         Î»03j           Î¸                             1 + Î¸Ai




                                                        Revista Colombiana de EstadÃ­stica 42 (2019) 3559

58                        Elizabeth GonzÃ¡lez PatiÃ±o, Gisela Tunes & Maria Isabel Munera

Appendix B. Simulations Results


Table B.1:      Summaries from 500 replications for the illnes-death model (Par: parameter
                to be estimated, pc : percentage of censoring) with dierent frailty variance
                (Î¸ = 0.5, Î¸ = 1, Î¸ = 2).
                          N=100                      N=500                      N=800
 Par      pc      40%      60%     70%      40%       60%     70%      40%       60%     70%
                                                Î¸ = 0.5
     Î¸   Bias    -0.124   -0.204   -0.285   -0.137   -0.206   -0.243   -0.114   -0.209   -0.233
         SD       0.408   0.313    0.267     0.213   0.152    0.130     0.176   0.094    0.108
         MSE      0.182    0.140    0.153    0.064   0.066    0.076     0.044    0.053   0.066
 Î²1      Bias    -0.054   -0.121   -0.199   -0.094   -0.142   -0.181   -0.075   -0.137   -0.188
         SD       0.260   0.239    0.194     0.150   0.126    0.114     0.130   0.095    0.094
         MSE      0.071    0.072    0.077    0.031   0.036    0.046     0.023    0.028   0.044
 Î²2      Bias    -0.036   -0.027   -0.044   -0.047   -0.048   -0.055   -0.033   -0.052   -0.042
         SD       0.244   0.231    0.221     0.144   0.120    0.114     0.118   0.086    0.095
         MSE      0.061    0.054    0.051    0.023   0.017    0.016     0.015    0.010   0.011
 Î²3      Bias    0.071    0.208     0.293   -0.012   0.013    0.139    -0.030   -0.015   0.115
         SD       0.359   0.434    0.508     0.192   0.217    0.254     0.155   0.174    0.194
         MSE      0.134    0.231    0.344    0.037   0.047    0.084     0.025    0.030   0.051
                                                  Î¸=1
     Î¸   Bias    -0.193   -0.200   -0.326   -0.081   -0.318   -0.472   -0.064   -0.316   -0.466
         SD       0.617   0.641    0.612    0.344    0.325    0.222     0.279   0.263    0.140
         MSE      0.418    0.451    0.480    0.125    0.207   0.272     0.082   0.169    0.237
 Î²1      Bias    -0.063   -0.106   -0.203   -0.036   -0.150   -0.249   -0.033   -0.162   -0.253
         SD       0.279   0.277    0.260    0.158    0.155    0.133     0.133   0.116    0.100
         MSE      0.082    0.088    0.109    0.026    0.047   0.080     0.019   0.040    0.074
 Î²2      Bias    -0.059   -0.031   -0.058    0.003   -0.066   -0.104   -0.001   -0.070   -0.104
         SD       0.292   0.267    0.262    0.147    0.144    0.123     0.136   0.110    0.095
         MSE      0.089    0.072    0.072    0.022    0.025   0.026     0.018   0.017    0.020
 Î²3      Bias    -0.008   0.175    0.234    -0.027   -0.080   -0.040   -0.020   -0.103   -0.097
         SD       0.395   0.504    0.608    0.213    0.210    0.248     0.175   0.163    0.189
         MSE      0.156    0.285    0.424    0.046    0.050   0.063     0.031   0.037    0.045
                                                  Î¸=2
     Î¸   Bias    -0.587   -0.036   -0.236   0.115    -0.108   -0.687   0.149    -0.102   -0.756
         SD       1.090   1.444    1.463    0.811    0.847    0.675    0.687    0.700    0.541
         MSE      1.532    2.085    2.198   0.672     0.730    0.927   0.494    0.500    0.865
 Î²1      Bias    -0.176   -0.052   -0.181   0.007    -0.087   -0.251   0.011    -0.086   -0.274
         SD       0.332   0.389    0.407    0.236    0.216    0.200    0.195    0.179    0.154
         MSE      0.141    0.154    0.198   0.056     0.054    0.103   0.038    0.039    0.099
 Î²2      Bias    -0.148   -0.007   -0.030   0.022    -0.026   -0.120   0.029    -0.027   -0.148
         SD       0.343   0.357    0.358    0.220    0.212    0.177    0.198    0.166    0.141
         MSE      0.139    0.127    0.129   0.049     0.046    0.046   0.040    0.028    0.042
 Î²3      Bias    -0.150   0.099    0.120    0.006    -0.061   -0.148   0.022    -0.062   -0.202
         SD       0.433   0.556    0.674    0.279    0.269    0.240    0.240    0.214    0.191
         MSE      0.210    0.319    0.469   0.078     0.076    0.079   0.058    0.050    0.078




                                             Revista Colombiana de EstadÃ­stica 42 (2019) 3559

Modeling Data with Semicompeting Risks                                                       59

Table B.2:    Summaries from 500 replications for the weibull model (Par: parameter to
              be estimated, pc : percentage of censoring) with dierent frailty variance
              (Î¸ = 0.5, Î¸ = 1, Î¸ = 2).
                        N=100                      N=500                      N=800
 Par    pc      40%      60%     70%      40%       60%     70%      40%       60%     70%
                                              Î¸ = 0.5
  Î²1   Bias    -0.193   -0.197   -0.220   -0.248   -0.244   -0.245   -0.244   -0.241   -0.263
       SD       0.152   0.171    0.168    0.090    0.099    0.098     0.070   0.075    0.078
       MSE      0.060    0.068    0.077    0.070   0.069    0.070     0.065   0.064    0.075
  Î²2   Bias    -0.073   0.043    0.092    -0.085   0.012    0.065    -0.086   0.014    0.071
       SD       0.142   0.157    0.182    0.079    0.092    0.091     0.065   0.069    0.075
       MSE      0.025    0.027    0.042    0.013   0.009    0.012     0.012   0.005    0.011
                                                Î¸=1
  Î²1   Bias    -0.381   -0.368   -0.386   -0.429   -0.415   -0.430   -0.433   -0.430   -0.445
       SD       0.176   0.178    0.204    0.100    0.107    0.106     0.082   0.083    0.088
       MSE      0.176    0.167    0.191   0.194    0.183    0.196     0.194   0.192    0.206
  Î²2   Bias    -0.264   -0.121   -0.055   -0.268   -0.144   -0.086   -0.271   -0.152   -0.093
       SD       0.156   0.174    0.179    0.087    0.095    0.102     0.069   0.078    0.082
       MSE      0.094    0.045    0.035   0.079    0.030    0.018     0.078   0.029    0.015
                                                Î¸=2
  Î²1   Bias    -0.578   -0.559   -0.597   -0.601   -0.603   -0.608   -0.610   -0.604   -0.606
       SD       0.175   0.189    0.200    0.096    0.093    0.104     0.080   0.076    0.085
       MSE      0.365    0.349    0.396   0.370    0.373    0.380     0.378   0.371    0.374
  Î²2   Bias    -0.485   -0.347   -0.275   -0.500   -0.377   -0.296   -0.504   -0.379   -0.307
       SD       0.162   0.167    0.198    0.087    0.101    0.105     0.067   0.076    0.086
       MSE      0.261    0.148    0.115   0.257    0.152    0.099     0.258   0.149    0.102




                                           Revista Colombiana de EstadÃ­stica 42 (2019) 3559

