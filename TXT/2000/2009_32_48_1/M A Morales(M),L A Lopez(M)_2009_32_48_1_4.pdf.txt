Estudio de homogeneidad de la dispersiÃ³n en diseÃ±o a una vÃ­a de clasificaciÃ³n para datos de proporciones y conteos
Universidad de CÃ³rdoba;Universidad Nacional de Colombia
Resumen
En el modelamiento de datos donde se evidencia la presencia de sobredispersiÃ³n, usualmente se asume que para todos los efectos de tratamiento el parÃ¡metro de sobredispersiÃ³n es comÃºn. Esta situaciÃ³n no siempre se satisface antes; por el contrario, puede ser mÃ¡s frecuente que la variabilidad exhibida por los datos sea mayor que la variaciÃ³n teÃ³rica del modelo; debiendo incorporarse en el modelamiento esta situaciÃ³n. En este artÃ­culo se llevan a cabo desarrollos teÃ³ricos con los cuales se evidencia si es aceptable o no la hipÃ³tesis de homogeneidad del parÃ¡metro de dispersiÃ³n entre tratamientos,cuando estos se ensayan en condiciones de uniformidad del material experimental y la respuesta de interÃ©s sea conteos o de proporciones, las cuales se modelan a travÃ©s de la distribuciÃ³n Binomial Negativa (BN) y Beta Binomial (BB), respectivamente. Se usÃ³ la Prueba de RazÃ³n de Verosimilitud como criterio para decidir acerca de la hipÃ³tesis nula de homogeneidad en el parÃ¡metro de dispersiÃ³n. Para determinar la eficiencia de la prueba propuesta, mediante simulaciÃ³n, con procedimientos algorÃ­tmicos desarrollados en R, se evaluÃ³ la potencia de las pruebas frente al supuesto de homogeneidad del parÃ¡metro de dispersiÃ³n. Bajo el supuesto que los modelos BB y BN son correctos, se propone el ajuste de un modelo lineal generalizado ponderado como una alternativa para el anÃ¡lisis de datos de conteo y proporciÃ³n con sobredispersiÃ³n
Palabras clave: sobredispersiÃ³n, distribuciÃ³n beta-binomial, distribuciÃ³n binomial negativa, modelo lineal generalizado ponderado, razÃ³n de verosimilitud.
IntroducciÃ³n
    En el anÃ¡lisis de datos relacionados con proporciones y conteos es comÃºn que
haya presencia de sobredispersiÃ³n, situaciÃ³n que se presenta cuando la varianza
exhibida por los datos es mucho mÃ¡s grande que la que predice el modelo. En
el caso de datos resultantes de experimentos de una vÃ­a de clasificaciÃ³n, en la
literatura comÃºnmente se aborda el problema asumiendo homogeneidad del parÃ¡-
metro de dispersiÃ³n, como puede verse en Crowder (1978) y Brooks (1978). En la
parametrizaciÃ³n que hacen del modelo beta-binomial, asumen que Ïƒi2 = Ïƒ 2 para
i = 1, . . . , K.
    Si bien es cierto que existen aplicaciones donde el supuesto de homogeneidad
de la dispersiÃ³n se satisface, como ocurre con los datos de germinaciÃ³n de las se-
millas de Orobanche Cernua cultivadas en tres medios, analizados por Crowder
(1978), existen situaciones donde, de acuerdo con la naturaleza del experimento,
es posible que se justifique suponer heterogeneidad en el parÃ¡metro de dispersiÃ³n.
Por ejemplo, Crowder (1979), refiriÃ©ndose al anÃ¡lisis de un conjunto de datos que
reportan la presencia o ausencia de tumores en ratones expuestos a un cancerÃ­geno,
comenta que el coeficiente de correlaciÃ³n entre respuestas binarias estÃ¡ asociado al
efecto de la herencia sobre la respuesta, y demuestra que, para ese caso, es apro-
piado asumir un coeficiente de correlaciÃ³n distinto para cada nivel de exposiciÃ³n
al cancerÃ­geno, con lo cual se evidencia sobredispersiÃ³n.
    De acuerdo con Prentice (1986), en muchas aplicaciones es natural asumir que
la probabilidad en una respuesta binaria tenga un valor comÃºn p dentro de la
unidad experimental y que pares de observaciones tengan una correlaciÃ³n comÃºn
Ï†; estos supuestos dan origen al modelo beta-binomial. La falta de independencia
entre respuestas binarias explica la presencia de sobredispersiÃ³n y es posible que,
por su naturaleza, dentro de cada tratamiento se tenga una correlaciÃ³n distinta

                                        Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

Homogeneidad de la dispersiÃ³n en diseÃ±o a una vÃ­a                                     61

entre pares de respuestas binarias, ocasionando heterogeneidad de la dispersiÃ³n
entre tratamientos.
    Se tiene entonces la necesidad de contar con herramientas teÃ³ricas que permitan
modelar datos en presencia de sobredispersiÃ³n, diagnosticar si los tratamientos se
pueden considerar homogÃ©neos en cuanto a la dispersiÃ³n o si, por el contrario, es
necesario tener en cuenta que cada tratamiento â€œaportaâ€ de una forma distinta a
la sobredispersiÃ³n, debiendo hacer correcciones en cada caso.
   En este artÃ­culo se proponen mÃ©todos para juzgar acerca de la hipÃ³tesis de
homogeneidad de la dispersiÃ³n, es decir, se establece una metodologÃ­a que permite
contrastar el juego de hipÃ³tesis

                   H0 : Ï†1 = Ï†2 = Â· Â· Â· = Ï†K = Ï†
                                                                                     (1)
                   H1 : Ï†i 6= Ï†i0 para i 6= i0 , i, i0 = 1, . . . , K

cuando se tienen datos provenientes de experimentos de una vÃ­a de clasificaciÃ³n,
concretamente dentro de un diseÃ±o completamente al azar, cuando la variable res-
puesta es de tipo conteo o proporciÃ³n y modeladas por medio de las distribuciones
BN y BB, respectivamente.
   El parÃ¡metro Ï† en (1) para el caso de datos de proporciÃ³n, corresponde, de
acuerdo con Prentice (1986), al coeficiente de correlaciÃ³n entre respuestas binarias.
Para el caso de datos de conteo, el parÃ¡metro Ï† se define como el inverso del
parÃ¡metro de forma de la distribuciÃ³n gamma.


2. SobredispersiÃ³n
    En muchas situaciones prÃ¡cticas, cuando se ajusta un modelo lineal generali-
zado a un conjunto de datos, se puede observar un desvÃ­o mucho mÃ¡s grande que
el esperado si el modelo fuera â€œcorrectoâ€. La explicaciÃ³n mÃ¡s comÃºn a este fenÃ³-
meno es que se tiene una forma estructural incorrecta para el modelo, es decir,
no se han incluido los predictores apropiados; no se ha hecho la transformaciÃ³n o
combinaciÃ³n apropiada de efectos; o no se han incluido todos los factores de ajuste
en el modelo. Otra explicaciÃ³n comÃºn para un desvÃ­o grande es la presencia de un
nÃºmero pequeÃ±o de outliers.
   Habiendo excluido todas las posibilidades anteriores, es posible que la variaciÃ³n
de los datos sea mucho mÃ¡s grande aÃºn que la predicha por el modelo. A este
fenÃ³meno se le conoce como sobredispersiÃ³n, de acuerdo con Hinde & DemÃ©trio
(1998).
    Las principales consecuencias de no tener en cuenta la sobredispersiÃ³n, segÃºn
Hinde & DemÃ©trio (1998), son: errores incorrectos (subestimados), y por tanto la
significaciÃ³n de los parÃ¡metros de regresiÃ³n puede juzgarse de manera incorrecta;
los cambios en el desvÃ­o asociados a los tÃ©rminos del modelo serÃ­an grandes y
pueden conducir a la selecciÃ³n de un modelo demasiado complejo, lo cual lleva
a que la interpretaciÃ³n del modelo sea incorrecta y las predicciones demasiado
imprecisas.

                                        Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

62                                      Mario Alfonso Morales & Luis Alberto LÃ³pez

2.1. Modelos de sobredispersiÃ³n
    Para ajustar datos en presencia de sobredispersiÃ³n, el modelamiento estadÃ­s-
tico presenta varias alternativas que surgen de los supuestos que se asumen para
explicar este fenÃ³meno. SegÃºn Hinde & DemÃ©trio (1998), los modelos se pueden
clasificar en dos grandes grupos: (i) Modelos de media varianza: que asumen una
forma mÃ¡s general de la funciÃ³n de varianza, incluidos parÃ¡metros adicionales.
Estos posiblemente no correspondan a una distribuciÃ³n de probabilidad especÃ­fi-
ca para la respuesta, pero se pueden ver como una extensiÃ³n del modelo bÃ¡sico;
cuando esto sucede, los parÃ¡metros pueden estimarse usando mÃ©todos de cua-
siverosimilitud; (ii) Modelos en dos etapas: los cuales asumen que el parÃ¡metro
asociado a la respuesta no es fijo, sino que tiene alguna distribuciÃ³n de probabili-
dad conocida. Estos modelos conducen a un modelo de probabilidad compuesto;
en principio, todos los parÃ¡metros pueden estimarse usando mÃ¡xima verosimilitud.
Sin embargo, en general, la distribuciÃ³n resultante no toma una forma simple.
   Dos ejemplos concretos de modelos de dos etapas son el beta-binomial y el
binomial negativo, de gran utilidad en el modelamiento de datos de proporciones
y conteos respectivamente.


3. Prueba de la hipÃ³tesis por medio de la razÃ³n de
   verosimilitud
    Para contrastar la hipÃ³tesis (1), cuando se tienen datos resultantes de un expe-
rimento bajo un diseÃ±o sin ninguna restricciÃ³n en la aleatorizaciÃ³n, asumiendo que
la variable respuesta sigue una distribuciÃ³n beta-binomial en el caso de proporcio-
nes o distribuciÃ³n binomial negativa en el caso de datos de conteos, se procediÃ³ a
hacer uso de la prueba de la razÃ³n de verosimilitud. En el desarrollo de la prueba,
es necesario definir dos modelos. Uno donde se asume que la hipÃ³tesis alterna H1
es verdadera, el cual se llamÃ³ modelo alternativo; y otro que es un caso particular
del primero, cuando H0 es verdadera, conocido como modelo nulo. Para decidir
entre los dos modelos, se siguen estos pasos: (i) se estiman los parÃ¡metros de am-
bos modelos por el mÃ©todo de mÃ¡xima verosimilitud; (ii) se obtiene la razÃ³n de
verosimilitud:                                    
                                         L Î¸b0 ; y
                                    Î»=            
                                         L Î¸b1 ; y
                         
donde L Î¸b0 ; y y L Î¸b1 ; y son las verosimilitudes maximizadas bajo los modelos
nulo y alternativo, respectivamente; y (iii) se decide entre los dos modelos segÃºn
P Ï‡2kâˆ’1 > âˆ’2 ln Î» sean mayor o menor que el nivel de significaciÃ³n Î± fijado
previamente.
               por mÃ¡xima verosimilitud implica la soluciÃ³n del sistema de
    La estimaciÃ³n
ecuaciones u Î¸b = 0, donde u representa el vector de primeras derivadas de la
log-verosimilitud. La soluciÃ³n del sistema no lineal de ecuaciones se hace mediante

                                      Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

Homogeneidad de la dispersiÃ³n en diseÃ±o a una vÃ­a                                         63

el algoritmo de Newton-Raphson, que consiste en obtener
                                   h    iâˆ’1  m   m 
                             bm âˆ’ H m
                      bm+1 = Î¸
                      Î¸                      b u Î¸
                                             Î¸      b                                    (2)
        m
donde Î¸b es el vector de estimaciones en el paso m y H es la matriz de segundas
derivadas de la log-verosimilitud estimada en el paso m. En las secciones que
siguen se establecen los supuestos y la notaciÃ³n, se definen los modelos nulos y
alternativos y se obtienen las funciones de log-verosimilitud. En las secciones 3.1
y 3.2 se ilustra el procedimiento para el caso particular de este trabajo.


3.1. Datos de proporciÃ³n
    Cuando se tiene el caso de datos de proporciÃ³n, para efectos de este trabajo se
deben tener en consideraciÃ³n los siguientes supuestos: se tienen datos provenientes
de un experimento con diseÃ±o completamente al azar con K â‰¥ 2 tratamientos;
se cuenta con ri repeticiones dentro del tratamiento i; la j-Ã©sima observaciÃ³n del
tratamiento i es yij con i = 1, . . . , K y j = 1, . . . , ri ; yij es el nÃºmero de Ã©xitos
en mij ensayos tipo Bernoulli, por tanto yij puede tomar los valores 0, 1, . . . , mij ;
yij es la realizaciÃ³n de una variable aleatoria Yij tal que Yij | pi âˆ¼ Bin(mij , pi )
con pi âˆ¼ Beta(ai , bi ), lo cual implica que la distribuciÃ³n no condicional de Yij es
beta-binomial (vÃ©ase Hinde & DemÃ©trio 1998).
    El modelo bajo el supuesto que la hipÃ³tesis alternativa es cierta debe considerar
lo siguiente: la variable respuesta Yij se asume con distribuciÃ³n beta-binomial de
parÃ¡metros mij , ai y bi y, por tanto, de acuerdo con Prentice (1986), se tiene que
la probabilidad de Ã©xito en el tratamiento i es Ï€i = ai /(ai + bi ) y el coeficiente de
correlaciÃ³n entre respuestas binarias en dicho tratamiento es Ï†i = Î³i (1 + Î³i )âˆ’1 con
Î³i = (ai + bi )âˆ’1 para i = 1, . . . , K. TambiÃ©n se tiene que
                                
                    E Yij /mij = Ï€i
                                                    
                  var Yij /mij = 1 + Ï†i (mij âˆ’ 1) Ï€i (1 âˆ’ Ï€i )/mij

de esta forma se estÃ¡ suponiendo un valor Ï†i para cada tratamiento. Modelamos
las probabilidades de Ã©xito Ï€i mediante g(Ï€i ) = Î·i con Î·i = Î±i , con este enlace
queda caracterizado las medias de celda en la parte sistemÃ¡tica. En resumen, el
modelo alternativo es:
                       
             E Yij /mij = Ï€i
                                                                           (3)
           var Yij /mij = 1 + Ï†i (mij âˆ’ 1) Ï€i (1 âˆ’ Ï€i )/mij yg(Ï€i ) = Î±i

y la distribuciÃ³n de probabilidad de Yij , siguiendo a Prentice (1986) es:
                          yij âˆ’1            mij âˆ’yij                 mYij âˆ’1
                     mij Y                      Y
 P (Yij = yij ) =                 (Ï€i + Î³i s)          (1 âˆ’ Ï€i + Î³i s)         (1 + Î³i s) (4)
                      yij    s=0               s=0                       s=0
                                                                          Qx
para yij = 0, 1, . . . , mij y como es usual, se adopta la restricciÃ³n que i=0 ci = 1
para cualquier x < 0. Este modelo tiene 2K parÃ¡metros, que corresponden a K

                                          Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

64                                                     Mario Alfonso Morales & Luis Alberto LÃ³pez

proporciones de Ã©xitos y K coeficientes de correlaciÃ³n entre respuestas binarias,
uno dentro de cada tratamiento.
    El modelo bajo el supuesto que la hipÃ³tesis nula es cierta resulta de la prÃ¡ctica
usual al tomar (ai + bi )âˆ’1 = Î³ para i = 1, 2, . . . , K. Bajo ese supuesto se tiene
que el coeficiente de correlaciÃ³n entre respuestas binarias es Ï† = Î³(1 + Î³)âˆ’1 para
todo i = 1, . . . , K. Es decir, va a ser constante para todos los tratamientos. Los
demÃ¡s supuestos permanecen como en el modelo alternativo. Con esto se tiene que
el modelo queda caracterizado por:
                          
             E Yij /mij = Ï€i
                                                                               (5)
           var Yij /mij = 1 + Ï†(mij âˆ’ 1) Ï€i (1 âˆ’ Ï€i )/mij y g(Ï€i ) = Î±i

y la distribuciÃ³n de probabilidad de la respuesta Yij tiene la forma de la ecuaciÃ³n
(4), remplazando Î³i por Î³. Este modelo tiene K + 1 parÃ¡metros, que corresponden
a K proporciones de Ã©xito y el coeficiente de correlaciÃ³n entre respuestas binarias
dentro de cada tratamiento, que se supone el mismo para todos los tratamientos.
Se observa que Ï†1 = Ï†2 = Â· Â· Â· = Ï†k = Ï†, es decir, se asume que la hipÃ³tesis H0 de
(1) es cierta.
    De la ecuaciÃ³n (4), tomando logaritmo natural, se obtiene la contribuciÃ³n de
la observaciÃ³n yij a la log-verosimilitud, dada por

                              yij âˆ’1
                              X
  l(Ï€i , Î³i | yij , mij ) =            log(Ï€i + Î³i s)+
                              s=0
                                         mij âˆ’yij âˆ’1                          mij âˆ’1
                                            X                                  X
                                                       log(1 âˆ’ Ï€i + Î³i s) âˆ’            log(1 + Î³i s) (6)
                                            s=0                                s=0

para i = 1, . . . , K, j = 1, . . . , ri , las sumas con Ã­ndice superior negativo se toman
iguales a cero, lo cual puede ocurrir cuando yij = 0 o cuando yij = mij . Para
mÃ¡s detalle, vÃ©ase Crowder (1978). La log-verosimilitud de toda la muestra es
               PK Pri                                                                           t
l(Î¸1 | y) =         i=1  j=1 l Ï€i , Î³i | yij ; mij con Î¸ 1 = [Ï€1 , . . . , Ï€K , Î³1 , . . . , Î³K ] el
vector de parÃ¡metros. La contribuciÃ³n de la observaciÃ³n yij a la log-verosimilitud,
en el caso del modelo nulo, tiene la misma forma de la ecuaciÃ³n (6); basta con
                                                                                               t
reemplazar Î³i por Î³. En ese caso, el vector de parÃ¡metros es Î¸ = [Ï€1 , . . . , Ï€K , Î³] . En
Morales (2008) se encuentran los detalles de la obtenciÃ³n del vector u y la matriz
H necesarios para implementar el algoritmo de Newton-Raphson, de acuerdo con
la ecuaciÃ³n (2).

Ejemplo 1. Se sometieron 58 ratas hembras a dietas deficientes en hierro, divi-
didas en cuatro grupos. A un grupo de control se le proporcionÃ³ semanalmente
inyecciones de suplemento de hierro para mantener su ingestiÃ³n de hierro en ni-
veles normales, mientras que a otro grupo se le proporcionÃ³ solo inyecciones de
un placebo. A los otros dos grupos se les proporcionÃ³ menos inyecciones de suple-
mento de hierro que a los controles. Las ratas fueron preÃ±adas, sacrificadas y tres
semanas despuÃ©s se registrÃ³ el nÃºmero total de fetos y el nÃºmero de fetos muertos
en cada camada. Los datos, que se muestran en la tabla 1, fueron analizados por

                                                  Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

Homogeneidad de la dispersiÃ³n en diseÃ±o a una vÃ­a                                     65

Agresti (2002) usando cuasiverosimilitud. De acuerdo con la notaciÃ³n adoptada en
este trabajo se tiene: K = 4, r1 = 31, r2 = 12, r3 = 5, r4 = 10, y11 = 1, m11 = 10,
y43 = 2 y m43 = 9.

Tabla 1: NÃºmero de fetos (N ) y nÃºmeros de fetos muertos (R) de ratas sometidas a
         dietas bajas en hierro. Fuente Agresti (2002).
                             Grupo no tratado (bajo en hierro)
            N   10   11   12    4    10   11     9    11   10     10   12   10
            R    1    4    9    4    10    9     9    11   10      7 12      9
            N    8   11    6    9    14   12    11    13   14     10   12   13
            R    8    9    4    7    14    7     9     8     5    10   10    8
            N   10   14   13    4     8   13    12
            R   10    3   13    3     8    5    12
                     Grupo 2: inyecciones de hierro solo en el dÃ­a 7 Ã³ 10
            N   10    3   13   12    14    9    13    16   11      4    1   12
            R    1    1    1    0     4    2     2     1     0     0    0    0
                        Grupo 3: inyecciones de hierro en el dÃ­a 0 y 7
            N    8   11   14   14    11
            R    0    1    0    1     0
                        Grupo 4: inyecciones de hierro semanalmente
            N    3   13    9   17    15    2    14     8     6    17
            R    0    0    2    2     0    0     1     0     0     0



    Las varianzas observadas dentro de cada tratamiento son, respectivamente,
9.867, 1.454, 0.3 y 0.722, mientras que las varianzas esperadas, asumiendo la dis-
tribuciÃ³n binomial para la respuesta, son: 1.932, 0.898, 0.386 y 0.476. NÃ³tese que
las varianzas observadas de los tratamientos 1, 2 y 4 son mucho mÃ¡s grandes que las
esperadas, presentÃ¡ndose sobredispersiÃ³n (vÃ©ase Sudhir & Saha 2007). Al ajustar
un modelo lineal generalizado usual, usando la distribuciÃ³n binomial y la funciÃ³n
logit(Â·) como enlace, se obtiene un desvÃ­o residual de 173.45 con 54 grados de liber-
tad, lo cual confirma que los datos presentan sobredispersiÃ³n. Dado que la variable
respuesta es el nÃºmero de fetos muertos del total de fetos en cada camada, no es
necesario verificar el supuesto de independencia entre respuestas binarias (muerto
o vivo) en cada camada; luego la distribuciÃ³n beta-binomial es un buen modelo
para el ajuste de estos datos. Los valores iniciales para implementar el algoritmo
de estimaciÃ³n se obtienen a partir del ajuste del modelo lineal generalizado bi-
nomial usual, del cual se obtiene Î±                  b Î±1 ) = 0.1292, Î±
                                     b1 = 1.1440, ee(b                b2 = âˆ’2.1785,
 b Î±2 ) = 0.3046, Î±
ee(b                              b Î±3 ) = 0.7196 y Î±
                   b3 = âˆ’3.3322, ee(b                                b Î±4 ) = 0.4584;
                                                      b4 = âˆ’2.9857, ee(b
aplicando la funciÃ³n inversa del enlace a Î±bi , se obtienen las probabilidades de Ã©xi-
to Ï€
   b1 = 0.7584, Ï€ b2 = 0.1017, Ï€b3 = 0.0345 y Ï€  b4 = 0.0481. El valor del estadÃ­stico
de Pearson es X 2 = 154.707, n = 58, p = 4; en este caso, Ï†0 = 0.2, por lo que
se toman los valores iniciales Î³01 = Î³02 = Î³03 = Î³04 = 0.2(0.2 + 1)âˆ’1 = 0.167.
DespuÃ©s del ajuste del modelo alternativo (3) se obtiene Ï€                b2 = 0.103,
                                                              b1 = 0.777, Ï€
b3 = 0.032, Ï€
Ï€                         b            b              b             âˆ’9    b
             b4 = 0.062, Ï†1 = 0.3397, Ï†2 = 0.0398, Ï†3 = 2.23 Ã— 10 y Ï†4 = 0.0658
y, a partir del modelo nulo (5), se obtiene Ï€   b1 = 0.793, Ï€b2 = 0.146, Ï€b3 = 0.074,
b4 = 0.071 y Ï†b = 0.2412. La logâ€“verosimilitud para el modelo nulo, con 5 pa-
Ï€
rÃ¡metros, es âˆ’93.46, mientras que para el modelo alternativo, con 8 parÃ¡metros,

                                        Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

66                                             Mario Alfonso Morales & Luis Alberto LÃ³pez

es âˆ’88.40; por tanto, Î»âˆ— = âˆ’2 Ã— (âˆ’93.46 âˆ’ (âˆ’88.40)) = 10.11, el valor p de la
prueba es P Ï‡23 > 10.11 = 0.01766, asÃ­ que a un nivel de significaciÃ³n de 2 % se
rechaza la hipÃ³tesis nula, luego los datos deben ajustarse con un parÃ¡metro de
sobredispersiÃ³n distinto para cada tratamiento, es decir, Ï† no es igual mismo para
todos los tratamientos.


3.2. Datos de conteo
     En el caso de datos de conteo, para respuestas provenientes de ensayos sin
restricciÃ³n en la aleatorizaciÃ³n de un experimento con K â‰¥ 2 tratamientos, con ri
repeticiones dentro del tratamiento i, la j-Ã©sima observaciÃ³n del tratamiento i es
yij , con i = 1, . . . , K y j = 1, . . . , ri ; yij es el nÃºmero de ocurrencias de un evento
en una unidad de tiempo o espacio, por tanto yij puede tomar los valores 0, 1, 2, . . .;
yij es la realizaciÃ³n de una variable aleatoria Yij tal que Yij | Î¸i âˆ¼ Pois(Î¸i ), donde se
supone que Î¸i es aleatorio con distribuciÃ³n gamma, de tal forma que la distribuciÃ³n
no condicional de Yij es binomial negativa (vÃ©ase Hinde & DemÃ©trio 1998).
    Para definir el modelo alternativo se asume que Î¸i âˆ¼ Î“(Îºi , Î»i ); por tanto la va-
riable respuesta Yij i = 1, . . . , K, j = 1, . . . , ri tiene distribuciÃ³n binomial negativa
con media y varianza dadas por
                           Îºi
                    E Yij =     = Âµi
                             Î»i
                                Âµ2
                   var Yij = Âµi + i = Âµi + Ï†i Âµ2i = (1 + Ï†i Âµi )Âµi
                                  Îºi

donde Ï†i = 1/Îºi . Al modelar la media de la variable respuesta mediante la funciÃ³n
de enlace g(Âµi ) = Î·i con Î·i = Î±i , es decir, la parte sistemÃ¡tica corresponde al
modelo de medias de celda, se tiene que el modelo bajo la hipÃ³tesis alternativa
estÃ¡ caracterizado por
                                         Îºi
                                  E Yij =      = Âµi
                                           Î»i
                                                                                         (7)
                                 var Yij = Âµi (1 + Ï†i Âµi )
                                        
                                    g Âµi = Î±i

y la distribuciÃ³n de probabilidad de la variable respuesta Yij es, segÃºn Hinde &
DemÃ©trio (1998),
                                                    y
                                Î“ Îºi + yij         Âµi ij ÎºÎºi i
                    P Yij = yij =                                             (8)
                                    Î“(Îºi )yij ! (Âµi + Îºi )Îºi +yij

donde yij = 0, 1, 2 . . .. Tomando logaritmo natural, la contribuciÃ³n a la log-verosimilitud
de la observaciÃ³n yij es
                 
  l Âµi , Îºi | yij = yij ln Âµi + Îºi ln Îºi âˆ’
                                               
                                       Îºi + yij ln(Îºi + Âµi ) + dlg(yij , Îºi ) âˆ’ ln yij ! (9)


                                             Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

Homogeneidad de la dispersiÃ³n en diseÃ±o a una vÃ­a                                     67
                                   
donde dlg(yij , Îºi ) = ln Î“ Îºi +yij âˆ’Î“(Îºi ). La log-verosimilitud para toda la muestra
                 PK Pri                    
es l(Âµ, Îº | y) = i=1 j=1 l Âµi , Îºi | yij .
    En este caso, el modelo nulo es el usual descrito por Hinde & DemÃ©trio (1998),
en el cual se tienen los mismos supuestos del modelo alternativo, pero los Î¸i ,
i = 1, . . . , K son variables aleatorias con distribuciÃ³n Î“(Îº, Î»i ), lo que equivale a
tener igual parÃ¡metro de dispersiÃ³n Ï† para todos los tratamientos. De esa forma
se tiene
                                        Îº
                                E Yij =      = Âµi
                                         Î»i
                                                                                   (10)
                               var Yij = Âµi (1 + Ï†Âµi )
                                      
                                  g Âµi = Î±i

    NÃ³tese que el modelo alternativo se reduce al modelo nulo cuando Ï†1 = Â· Â· Â· =
Ï†K = Ï† = Îº1 . La distribuciÃ³n de probabilidad para la variable respuesta Yij tiene
la misma forma de la ecuaciÃ³n (8); basta remplazar Îºi por Îº. De manera similar,
la contribuciÃ³n de la observaciÃ³n yij a la log-verosimilitud tiene la misma forma
de (9), remplazando Îºi por Îº.

Ejemplo 2. Se realizÃ³ un experimento con un diseÃ±o completamente al azar, en el
cual se sometieron larvas de bagre blanco (Sorubim cuspicaudus) a tres densidades
de siembra; 100, 200 y 300 larvas por litro (tratamientos). Una de las variables
medidas fue el nÃºmero de larvas muertas despuÃ©s del cuarto dÃ­a de cultivo. Las
muertes ocurren bien sea por canibalismo o por estrÃ©s debido a la manipulaciÃ³n.
Los datos, tomados de GarcÃ­a & PÃ©rez (2008), se muestran en la tabla 2. Las me-
dias observadas dentro de cada tratamiento son, respectivamente, 139.3, 230.5 y
321.6 mientras que las varianzas son: 9526.6, 2797.1 y 6190.3, las cuales son mucho
mÃ¡s grandes que los valores de las medias. Asumiendo la distribuciÃ³n de Poisson
para la respuesta, se espera que los valores de las medias sean similares a los de
las varianzas. Estos resultados permiten concluir que los datos presentan sobre-
dispersiÃ³n (vÃ©ase Sudhir & Saha 2007). Al ajustar un modelo lineal generalizado
Poisson usual, con la funciÃ³n logaritmo natural como enlace, se obtiene un desvÃ­o
de 457.58 con 15 grados de libertad, evidenciando la presencia de sobredisper-
siÃ³n. Las estimaciones de los parÃ¡metros de regresiÃ³n y sus errores estÃ¡ndar son:
b1 = 4.93687, ee(b
Î±                                 b2 = 5.44025, ee(b
                b Î±1 ) = 0.03459, Î±              b Î±2 ) = 0.02689 y Î± b3 = 5.77352,
 b Î±3 ) = 0.02276 y al aplicar la transformaciÃ³n inversa se tiene Âµ
ee(b                                                                  b1 = 139.33,
b2 = 230.50 y Âµ
Âµ                b3 = 321.67. Asumiendo que la distribuciÃ³n binomial negativa
es adecuada para el mecanismo aleatorio que generÃ³ estos datos, procedemos a
verificar el supuesto Ï†1 = Ï†2 = Ï†3 .


    Tabla 2: NÃºmero de larvas de bagre blanco muertas al cuarto dÃ­a de cultivo.
          Densidades de siembra de larvas         NÃºmero de larvas muertas
                       100                  325    105  124    155   63    64
                       200                  257    233  310    223   210   150
                       300                  335    376  426    319   201   273



                                        Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

68                                        Mario Alfonso Morales & Luis Alberto LÃ³pez

    DespuÃ©s de estimar por mÃ¡xima verosimilitud los parÃ¡metros del modelo al-
ternativo (7), se obtiene Âµ
                          b1 = 139.394, Âµb2 = 230.579, Âµb3 = 321.548, Ï†b1 = 0.3162,
b               b
Ï†2 = 0.0415 y Ï†3 = 0.0510, la log-verosimilitud es âˆ’100.2. Los valores estimados
para el modelo nulo son: Âµ
                         b1 = 139.3236, Âµ               b3 = 321.6874, Ï†b = 0.1359,
                                         b2 = 230.4857, Âµ
                                              âˆ—
y la log-verosimilitud es âˆ’104; por tanto, Î» = âˆ’2(âˆ’104 âˆ’ (âˆ’100.2)) = 7.6 con
6 âˆ’ 4 = 2 grados de libertad, el valor p de la prueba es 0.02207 asÃ­ que a un nivel
de significaciÃ³n de 3 % se rechaza la hipÃ³tesis nula H0 , luego estadÃ­sticamente el
parÃ¡metro Ï† no es el mismo para los tres tratamientos.


4. Modelo lineal generalizado ponderado: una
   alternativa para el anÃ¡lisis
    Nelder & Wedderburn (1972) demuestran que la estimaciÃ³n por mÃ¡xima ve-
rosimilitud de los parÃ¡metros de un modelo lineal generalizado es equivalente a
un proceso de MÃ­nimos Cuadrados Ponderados Iterativos (MCPI) con funciÃ³n de
pesos
                                              2
                                     1     dÂµi
                              wi =                                         (11)
                                   V(Âµi ) dÎ·i
y una variable dependiente modificada
                                                             
                                                        dÎ·i
                             Zi = Î·i + (Yi âˆ’ Âµi )                                  (12)
                                                        dÂµi

    Los pesos wi , dados en la ecuaciÃ³n (11), corresponden al inverso de la varianza
de Zi y, por tanto, son tales que wi var(Zi ) = 1. Sin embargo, si la variable res-
puesta tiene una funciÃ³n de varianza de la forma var(Yi ) = Î´i V(Âµi ), entonces se
tiene que wi var(Zi ) = Î´i ; con este Ãºltimo factor se evalÃºa la dispersiÃ³n extra. Lo
anterior sugiere, por analogÃ­a con el modelo lineal clÃ¡sico (vÃ©ase Ravishanker &
Dey 2001), que en el ajuste de los datos se usen los valores 1/Î´i como ponderacio-
nes, de tal forma que se cancele el efecto del factor Î´i , lo que es equivalente a usar
wiâˆ— = wi /Î´i , en lugar de los pesos wi en la ecuaciÃ³n (11).
    AsÃ­ que con datos de proporciÃ³n con presencia de sobredispersiÃ³n y bajo el
supuesto que el modelo beta-binomial es correcto, el razonamiento anterior conduce
                                                âˆ—
a que el proceso MCPI se realice con pesos wij    = wij /Î´ij con Î´ij = [1 + Ï†i (mij âˆ’
1)], donde wij son los pesos que se calculan, para cada observaciÃ³n, mediante la
ecuaciÃ³n (11), los cuales resultan del modelo binomial usual. Cuando se tienen
datos de conteos con sobredispersiÃ³n y bajo el supuesto que el modelo binomial
negativo es adecuado, usando MCPI para la estimaciÃ³n, los pesos correspondientes
      âˆ—
son wij = wij /Î´ij con Î´ij = (1 + Ï†i Âµi ) y wij los pesos que se calculan para cada
observaciÃ³n mediante (11), que resultan del modelo Poisson usual.
    Los parÃ¡metros Ï†i y Âµi no se conocen, pero despuÃ©s del proceso de prueba de
la hipÃ³tesis de interÃ©s (1) se tienen las estimaciones por mÃ¡xima verosimilitud,
que se usarÃ­an en su lugar como estimaciones iniciales. La mayorÃ­a de los paquetes
para el cÃ¡lculo estadÃ­stico permiten la inclusiÃ³n de ponderaciones en el ajuste de

                                       Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

Homogeneidad de la dispersiÃ³n en diseÃ±o a una vÃ­a                                           69

un modelo lineal generalizado. En particular, en R (Development Core Team 2007)
solo hay que agregar la opciÃ³n weights=1/deltai en la funciÃ³n glm(), asÃ­ que
una vez se han estimado los pesos que se deben usar, es muy sencillo llevar a cabo
el anÃ¡lisis ponderado.
    La matriz de varianzas y covarianzas del vector de parÃ¡metros estimados Î²        b
estÃ¡ dada por la inversa de la matriz de informaciÃ³n (vÃ©ase Dobson 2002), Iâˆ’1 =
(X t W X)âˆ’1 , donde W = diag wij para i = 1, . . . , K, j = 1, . . . , ri y X es la
matriz de diseÃ±o, la cual, de acuerdo conLK la estructura de los datos en el modelo
                                                               Pri de informaciÃ³n
de medias de celda, tiene la forma X = i=1 1ri , asÃ­ que la matriz
I es diagonal con elementos en la diagonal dados por Ii = j=1         wij ; por tanto,
                                                        P                âˆ’1
                                                                   ri
                                                    c Î²bi =
si se ajusta un modelo lineal generalizado usual, var              j=1 w ij     , mien-
tras que si se ajusta un modelo lineal generalizado ponderado con pesos 1/Î´ij , se
            P             âˆ’1
                      ri
       c Î²bâˆ— =
tiene var   i            wâˆ—
                       j=1   ij  , donde los Î²bâˆ— hacen referencia a la estimaciÃ³n del
                                                  i
                                                        âˆ—
parÃ¡metro Î²i a partir del ajuste con ponderaciones y wij  = wij /Î´ij . Como en este
                                           âˆ—
                                                           Pri           Pri     âˆ—
caso se tiene que Î´ij â‰¥ 1, entonces wij â‰¥ wij y, por tanto, j=1 wij â‰¥ j=1      wij ,
asÃ­ que
                                1            1            
                   c Î²bi = Pri
                  var                   â‰¤ Pri           c Î²biâˆ—
                                                     = var
                                j=1 wij      j=1 wij
                                                   âˆ—

con lo cual se concluye que la varianza estimada de los estimadores obtenida con
el modelo ponderado es mayor o igual que la que se obtiene al ajustar un modelo
generalizado usual sin ponderaciones. Es claro que la igualdad se presenta cuando
Î´ij = 1, es decir, cuando Ï†i = 0. Se observa, ademÃ¡s, que si Î´ij = Î´ij 0 = Î´i = para
j 6= j 0 , es decir, si los pesos dentro del tratamiento i son todos iguales, entonces
                                           Î´i              
                             c Î²biâˆ— = Pri
                             var                        c Î²bi
                                                   = Î´i var
                                           j=1 wij

es decir, la varianza estimada del estimador del parÃ¡metro Î²i queda multiplicada
                                                                             âˆš
por el factor Î´i o, lo que es igual, el error estÃ¡ndar queda multiplicado por Î´i .
La regresiÃ³n ponderada resuelve el problema de la subestimaciÃ³n de los errores
estÃ¡ndar de los estimadores de regresiÃ³n, lo cual, segÃºn Hinde & DemÃ©trio (1998),
es una de las consecuencias mÃ¡s graves cuando no se tiene en cuenta la sobre-
dispersiÃ³n, porque se podrÃ­a evaluar de manera incorrecta la significancia de los
parÃ¡metros.
    Las estimaciones de los parÃ¡metros de regresiÃ³n tambiÃ©n se ven afectadas por
el uso de las ponderaciones 1/Î´ij . A partir de Î²b = (X t W X)âˆ’1 X t W z, teniendo
en cuenta la forma de las matrices X y W , se demuestra que
                                      Pri wij
                                        j=1 Î´ zij
                                b
                                Î² = Pr ijw
                                  âˆ—
                                    i         i       ij
                                              j=1 Î´ij
                                                                 P ri
                                                                         wij zij
mientras que si no se usan las ponderaciones se tiene Î²bi =       j=1
                                                                  P ri             . NÃ³tese que
                                                                     j=1 wij

Î²biâˆ— â‰ˆ Î²bi cuando Î´ij â‰ˆ 1 y si se verifica que Î´ij = Î´ij 0 = Î´i , entonces las estimaciones
del modelo sin ponderar coinciden con las del modelo que usa las ponderaciones,

                                         Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

70                                         Mario Alfonso Morales & Luis Alberto LÃ³pez

es decir, Î²biâˆ— = Î²bi . En el caso de datos de proporciÃ³n, la igualdad se verifica cuando
mij = mij 0 = mi , para todo j 6= j 0 , es decir, el nÃºmero de ensayos a partir de los
cuales se obtienen los yij Ã©xitos es el mismo dentro del tratamiento i.

Ejemplo 3 (continuaciÃ³n del ejemplo 1). En seguida se muestran los resultados
del ajuste de un modelo lineal generalizado binomial con la funciÃ³n logit(Â·) como
                                 
enlace, pero usando los valores 1 Î´bij como ponderaciones con Î´bij = 1 + Ï†bi (mij âˆ’ 1)
b1 = 1.2261, ee(b
Î±              b Î±1 ) = 0.2736; Î±                 b Î±2 ) = 0.3626; Î±
                                 b2 = âˆ’2.1736, ee(b                 b3 = âˆ’3.3322,
b Î±3 ) = 0.7196 y Î±
ee(b               b4 = âˆ’3.0011, ee(bb Î±4 ) = 0.6097. AdemÃ¡s, se obtuvo un desvÃ­o
de 53.685 con 54 grados de libertad, evidenciando un buen ajuste de los datos al
modelo donde no hay homogeneidad del parÃ¡metro de dispersiÃ³n.
    De acuerdo con los resultados teÃ³ricos mostrados en esta secciÃ³n, se observa
que la estimaciÃ³n Î±b3 y su error estÃ¡ndar estimado no varÃ­an con respecto al ajuste
no ponderado (vÃ©ase el ejemplo 1). Eso es debido a que Ï†b3 â‰ˆ 0, lo cual implica que
                                                       b1 , Î±
Î´3j â‰ˆ 1 para todo j = 1, . . . , r3 . Las estimaciones Î±         b4 varÃ­an poco, pero los
                                                            b2 y Î±
errores estÃ¡ndar se modifican sustancialmente; por ejemplo, el del tratamiento 1
pasa de 0.1292 a 0.2736, aproximadamente el doble. Una aproximaciÃ³n de este valor
                      h                     i1/2            âˆš
se obtiene a partir de 1+ Ï† b1 Ã—(11âˆ’1)           Ã—0.1292 = 1 + 0.3397 Ã— 10Ã—0.1292 =
2.0969 Ã— 0.1292 = 0.2709, donde se ha tomado 11 como un valor promedio del
nÃºmero de fetos en ese tratamiento. Si el nÃºmero de fetos de cada rata dentro del
tratamiento 1 fuera igual, es decir, si se tuviera que m1j = m1j 0 para todo j 6= j 0 ,
se obtendrÃ­a exactamente el valor 0.2736. Se observa que las varianzas estimadas
de los estimadores son mÃ¡s grandes en el modelo ponderado, como se esperaba, de
acuerdo con los resultados de esta secciÃ³n. A partir del ajuste se obtiene un desvÃ­o
residual D = 53.68 con 54 grados de libertad, p = 0.486; el valor del estadÃ­stico
X 2 de Pearson es 48.84 con 54 grados de libertad y p = 0.673. Ambas estadÃ­sticas
indican que el modelo lineal generalizado ponderado proporciona un buen ajuste
a los datos (vÃ©ase Dobson 2002). El anÃ¡lisis de residuales, que se muestra en el
apÃ©ndice, indica que no hay evidencia de violaciÃ³n de los supuestos del modelo y
tampoco hay presencia de datos influyentes ni atÃ­picos.

Ejemplo 4 (continuaciÃ³n del ejemplo 2). En seguida se presentan los resultados
de ajustar un modelo lineal generalizado tipo Poisson con la funciÃ³n log(Â·) como
                       
enlace y los valores 1 Î´bij con Î´bij = 1+ Ï†bi Âµbi como ponderaciones. En este caso Î´1j =
45.081, Î´2j = 10.560 y Î´3j = 17.403 para todo j = 1, 2, . . . , 6. Se obtiene un desvÃ­o
de 18.169 con 15 grados de libertad y las siguientes estimaciones de los parÃ¡metros
de regresiÃ³n Î±                 b Î±âˆ—1 ) = 0.23222, Î±
              bâˆ—1 = 4.93687, ee(b                                    b Î±âˆ—2 ) = 0.08738 y
                                                     bâˆ—2 = 5.44025, ee(b
  âˆ—                  âˆ—
b3 = 5.77352 , ee(b
Î±                b Î±3 ) = 0.09496. Se observa que las estimaciones de los parÃ¡metros
no varÃ­an con respecto a las âˆš obtenidas a partir del ajuste sin ponderaciones (vÃ©ase
                       âˆ—
ejemplo
âˆš        2) pero  ee(b
                  b  Î± 1 ) =            b âˆšÎ±1 ) = 0.23222, de manera similar ee(b
                              45.081 Ã— ee(b                                     b Î±âˆ—2 ) =
                                      âˆ—
             b Î±2 ) = 0.08738 ee(b
  10.560 Ã— ee(b                  b Î±3 ) = 17.403 Ã— ee(b b Î±3 ) = 0.09496.
    A partir del ajuste se obtiene un desvÃ­o residual D = 18.17 con 15 grados de
libertad y p = 0.253; el valor del estadÃ­stico X 2 es 18.86 con 15 grados de libertad y
p = 0.22. Ambas estadÃ­sticas indican que el modelo lineal generalizado ponderado
proporciona un buen ajuste a los datos, al confrontarlo con el ajuste del modelo
maximal (sobreparametrizado), (vÃ©ase Dobson 2002). El anÃ¡lisis de residuales,

                                        Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

Homogeneidad de la dispersiÃ³n en diseÃ±o a una vÃ­a                                         71

que se muestra en el apÃ©ndice, indica que no hay evidencia de violaciones de los
supuestos del modelo y tampoco hay presencia de datos influyentes o atÃ­picos.


5. AnÃ¡lisis de la potencia de la prueba
    Dado que el procedimiento de prueba propuesto para la hipÃ³tesis (1) involucra
mÃ©todos numÃ©ricos iterativos, no es posible obtener una expresiÃ³n explÃ­cita para
la funciÃ³n de potencia de la prueba. Para obtener una aproximaciÃ³n grÃ¡fica, se
llevÃ³ a cabo un proceso de simulaciÃ³n.
    Se generaron datos por un modelo con una vÃ­a de clasificaciÃ³n, con K = 2, 3, 4
y 5 tratamientos, a partir de la distribuciÃ³n beta-binomial, en el caso de propor-
ciones, y de la distribuciÃ³n binomial negativa, en el caso de conteos, mediante las
funciones rbetabin()1 y rnbinom(), respectivamente, ambas funciones del pa-
quete estadÃ­stico R. Se generaron 5, 10, 15, 20 y 25 datos, dentro del tratamiento
i, para cada valor de K. Se estableciÃ³, para i = 1, . . . , K, Ï€i = 0.5 en el caso de
proporciones y Âµi = 12 para conteos. Los valores de los parÃ¡metros Ï†â€™s se estable-
cieron de la siguiente forma: en el caso de datos de proporciÃ³n se tomÃ³ Ï†1 = 0.19 y,
para i = 2, . . . , K, los valores de Ï†i se establecieron de tal forma que la diferencia
âˆ†Ï† = Ï†k+1 âˆ’ Ï†k tome los valores 0, 0.01, 0.03, 0.04, 0.06, 0.07, 0.09, 0.10, 0.11,
0.13, 0.14, 0.16, 0.17, 0.19, 0.20. Por ejemplo, en el caso de K = 5 los valores de
Ï†i fueron Ï†1 = Â· Â· Â· = Ï†5 = 0.19 (hipÃ³tesis H0 verdadera) y para un âˆ†Ï† = 0.20 se
tomÃ³ Ï†1 = 0.19, Ï†2 = 0.39, Ï†3 = 0.59, Ï†4 = 0.79, Ï†5 = 0.99 (hipÃ³tesis H0 falsa).
En el caso de datos de conteo se tomÃ³ Îº1 = 1.1 (Ï†1 = 1/1.1 = 0.9090) y los demÃ¡s
valores de Îºi , para i = 2, . . . , K, se establecieron de tal forma que la diferencia
âˆ†Îº = Îºk+1 âˆ’ Îºk tome los valores 0.00, 0.15, 0.30, 0.45, 0.60, 0.75, 0.90, 1.05, 1.20,
1.35, 1.50, 1.65, 1.80, 1.95, 2.10. Por ejemplo, en el caso de K = 5 los valores de Îºi
fueron Îº1 = Â· Â· Â· = Îº5 = 1.1, equivalente a Ï†1 = Â· Â· Â· = Ï†K = 0.9090 (hipÃ³tesis H0
verdadera); para un âˆ†Îº = 1.20 se tomÃ³ Îº1 = 1.1, Îº2 = 2.30, Îº3 = 3.50, Îº4 = 4.70,
Îº5 = 5.90, lo que equivale a Ï†1 = 0.9090, Ï†2 = 0.4348, Ï†3 = 0.2857, Ï†4 = 0.2128,
Ï†5 = 0.1695 (hipÃ³tesis H0 falsa).
    Una vez generados los datos, se lleva a cabo el procedimiento de prueba como
se explica en la secciÃ³n 3, tomando Î± = 0.05. El proceso se repite 1000 veces y se
cuenta las veces (R) que se rechaza la hipÃ³tesis nula. El valor R/1000 proporciona
una estimaciÃ³n de la potencia de la prueba.


5.1. Resultados de las simulaciones
    En el caso de datos de proporciÃ³n, para 5 repeticiones y 2 tratamientos, la
prueba reporta una proporciÃ³n de rechazo de 0.073 y un valor de 0.096 para tres
tratamientos y 5 repeticiones, es decir, una proporciÃ³n de rechazo moderadamente
mayor que el valor esperado de 0.05. Se observa que para 15 repeticiones y 5
tratamientos el valor de la proporciÃ³n de rechazos es 0.06; con 5 tratamientos y 25
repeticiones, es 0.055. De los resultados de las simulaciones es claro que cualquiera
  1 Esta funciÃ³n pertenece a la librerÃ­a VGAM




                                            Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

72                                                                                                                Mario Alfonso Morales & Luis Alberto LÃ³pez

que sea el nÃºmero tratamientos, a medida que aumenta el nÃºmero de repeticiones
la proporciÃ³n de rechazos se acerca al valor 0.05, mostrando el comportamiento
asintÃ³tico de la prueba.
    En la figura 1 se muestra la funciÃ³n de potencia obtenida mediante las simula-
ciones para cada combinaciÃ³n de nÃºmero de repeticiones y nÃºmero de tratamientos.
La lÃ­nea horizontal punteada corresponde al valor 0.05. A partir del grÃ¡fico se evi-
dencia que a medida que aumenta el nÃºmero de repeticiones mejora la capacidad
de las pruebas para detectar alejamientos de la hipÃ³tesis nula (comportamiento
asintÃ³tico). Por ejemplo, cuando se tiene âˆ†Ï† = 0.14, que corresponde, en el caso de
5 tratamientos, a la parametrizaciÃ³n Ï€i = 0.5 para todo i = 1, . . . , 5 y Ï†1 = 0.19,
Ï†2 = 0.33, Ï†3 = 0.47, Ï†4 = 0.61 y Ï†5 = 0.75 se observa, para 5 repeticiones,
que la proporciÃ³n de rechazos es de 80 %, para 10 repeticiones es de 94 %, con 15
repeticiones es de 98 %, con 20 repeticiones la proporciÃ³n de rechazos es de 99.7 %
y, por Ãºltimo, con 25 repeticiones la prueba rechaza el 100 % de las veces.

                                                                  0.00   0.05     0.10    0.15   0.20                                 0.00   0.05     0.10    0.15   0.20

                                              Ntrat=5                           Ntrat=5                           Ntrat=5                           Ntrat=5                           Ntrat=5
                                              Nrep=5                            Nrep=10                           Nrep=15                           Nrep=20                           Nrep=25
                                                                                                                                                                                                              1.0
                                                                                                                                                                                                              0.8
                                                                                                                                                                                                              0.6
                                                                                                                                                                                                              0.4
                                                                                                                                                                                                              0.2

                                              Ntrat=4                           Ntrat=4                           Ntrat=4                           Ntrat=4                           Ntrat=4
                                              Nrep=5                            Nrep=10                           Nrep=15                           Nrep=20                           Nrep=25
                          1.0
                          0.8
 ProporciÃ³n de rechazos




                          0.6
                          0.4
                          0.2

                                              Ntrat=3                           Ntrat=3                           Ntrat=3                           Ntrat=3                           Ntrat=3
                                              Nrep=5                            Nrep=10                           Nrep=15                           Nrep=20                           Nrep=25
                                                                                                                                                                                                              1.0
                                                                                                                                                                                                              0.8
                                                                                                                                                                                                              0.6
                                                                                                                                                                                                              0.4
                                                                                                                                                                                                              0.2

                                              Ntrat=2                           Ntrat=2                           Ntrat=2                           Ntrat=2                           Ntrat=2
                                              Nrep=5                            Nrep=10                           Nrep=15                           Nrep=20                           Nrep=25
                          1.0
                          0.8
                          0.6
                          0.4
                          0.2

                                0.00   0.05    0.10     0.15   0.20                                 0.00   0.05     0.10    0.15   0.20                                 0.00   0.05     0.10    0.15   0.20

                                                                                           âˆ†Ï† (Diferencia en el parametro de dispersiÃ³n)


Figura 1: FunciÃ³n de potencia simulada: Ntrat, nÃºmero de tratamientos. Nrep, nÃºmero
          de repeticiones.


    Con datos de conteo, la prueba reporta, para 5 repeticiones y 2 tratamientos,
una proporciÃ³n de rechazo de 0.077, y para tres tratamientos y 5 repeticiones, un
valor de 0.079, es decir, una proporciÃ³n de rechazo ligeramente mayor que el 5 %
que se esperaba. Sin embargo, se observa que para 25 repeticiones y 5 tratamientos
el valor de la proporciÃ³n de rechazos es 0.045. De acÃ¡ se induce que a medida que
aumenta el nÃºmero de repeticiones, la proporciÃ³n de rechazos se acerca al valor
0.05, mostrando el comportamiento asintÃ³tico de la prueba.
    A partir del grÃ¡fico de la funciÃ³n de potencia obtenida mediante las simulacio-
nes, se evidencia un aumento de la potencia de la prueba a medida que aumenta
el tamaÃ±o de la muestra. Por ejemplo, cuando se tiene âˆ†Îº = 1.5, que corresponde,
en el caso de 4 tratamientos, a la parametrizaciÃ³n Âµi = 12 para todo i = 1, . . . , 4

                                                                                                           Revista Colombiana de EstadÃ­stica 32 (2009) 59â€“78

Homogeneidad de la dispersiÃ³n en diseÃ±o a una vÃ­a                                     73

y Îº1 = 1.1, Îº2 = 2.60, Îº3 = 4.10, Îº4 = 5.63 o equivalentemente a Ï†1 = 0.9090,
Ï†2 = 0.3846, Ï†3 = 0.2439, Ï†4 = 0.1776, se observÃ³ que para 5 repeticiones la
proporciÃ³n de rechazos es de 40.7 %; para 10, de 52.4 %; para 15, de 64.4 %; para
20, de 78.8 %; y para 25, de 87.6 %.


6. Conclusiones
    Cuando se analizan datos de proporciÃ³n o conteos en presencia de sobredis-
persiÃ³n, en la literatura estadÃ­stica lo usual es asumir un parÃ¡metro de dispersiÃ³n
Ï† comÃºn a todas las observaciones. Sin embargo, puede suceder que cada trata-
miento tenga asociado su propio parÃ¡metro de sobredispersiÃ³n. En este artÃ­culo se
demuestra que hay situaciones en que es necesario verificar inicialmente la hipÃ³te-
sis de que el parÃ¡metro se mantiene constante a travÃ©s de todos los tratamientos,
es decir, hay homogeneidad de dicho parÃ¡metro. Una de las consecuencias de la
sobredispersiÃ³n es la subestimaciÃ³n de los errores estÃ¡ndar de los estimadores de
regresiÃ³n; una forma de evitar este problema es multiplicar los errores estÃ¡ndar
por el factor Î´ de modo que la varianza de la variable respuesta sea Î´ V(Âµ), como
lo sugieren Hinde & DemÃ©trio (1998), pero si el parÃ¡metro Î´ no es igual para to-
das las observaciones, se corre el riesgo de sobreestimar unos errores estÃ¡ndar y
subestimar otros.
    Para el anÃ¡lisis de datos de proporciÃ³n o conteos en presencia de sobredis-
persiÃ³n, bajo el supuesto que los modelos beta binomial o binomial negativo son
adecuados para el ajuste, es apropiado que se ajuste un modelo de regresiÃ³n lineal
generalizado ponderado con pesos 1/Î´ij , donde Î´ij es tal que var(Yij ) = Î´ij V(Âµi )
con V(Âµi ) la funciÃ³n de varianza usual. Los valores Î´ij son desconocidos, pero en
el caso de la distribuciÃ³n beta binomial o binomial negativa, despuÃ©s del procedi-
miento de prueba de la hipÃ³tesis propuesta en (1), se cuenta con la estimaciÃ³n de
estos, la cual se usa en su lugar.
ApÃ©ndice
AnÃ¡lisis de residuales y tÃ©cnicas de diagnÃ³stico
   En la figura 2 se muestran seis grÃ¡ficos para el anÃ¡lisis de residuos y detecciÃ³n
de puntos influyentes en el ajuste del modelo lineal generalizado binomial con
ponderaciones (ejemplo 3). En el grÃ¡fico a, que muestra los desvÃ­os residuales
(componentes de desvÃ­o) contra los valores ajustados se observa el dato y11 como
un posible atÃ­pico (outlier ). En el grÃ¡fico b, que muestra los valores absolutos de los
residuales contra los valores ajustados, no se observa tendencia alguna, por lo cual
se concluye que la funciÃ³n de varianza asumida es adecuada, vÃ©ase McCullagh
& Nelder (1989). El grÃ¡fico del predictor lineal ajustado (b     Î· ) contra la variable
dependiente ajustada (z), (grÃ¡fico c), muestra una tendencia lineal de los puntos,
con lo cual se concluye que la funciÃ³n de enlace logit(Â·) es apropiada (McCullagh
& Nelder 1989). El grÃ¡fico de hii , que se muestra en el grÃ¡fico d, indica que la
observaciÃ³n y33 tiene un alto leverage y que podrÃ­a ser una observaciÃ³n influyente,
mientras que los grÃ¡ficos e y f muestran que las observaciones y16 , y25 y y43 son
las que mÃ¡s influencia ejercen sobre los parÃ¡metros de localizaciÃ³n y escala. Sin
embargo, todas las distancias de Cook en el grÃ¡fico medio normal (half normal
plot ) de la figura 3b se encuentran dentro de la banda. Por tanto, no hay evidencia
de observaciones influyentes en el ajuste, vÃ©ase Atkinson (1981). El grÃ¡fico de
los residuales con bandas simuladas, que se muestra en la figura 3a, confirma la
ausencia de datos atÃ­picos de acuerdo con Atkinson (1981).

Figura 2: GrÃ¡ficos para el anÃ¡lisis de residuales del modelo lineal generalizado binomial
          ponderado, ejemplo 3.


   En la figura 4 se muestran seis grÃ¡ficos para el anÃ¡lisis de residuos y detecciÃ³n
de puntos influyentes en el modelo lineal generalizado Poisson. El grÃ¡fico a, que
muestra los desvÃ­os residuales (componentes de desvÃ­o), permite concluir que no
hay evidencia de datos atÃ­picos. En el grÃ¡fico b, que muestra los valores absolutos
de los residuales contra los valores ajustados, no se observa tendencia alguna,
Figura 3: (a): grÃ¡fico de probabilidad normal con banda de confianza simulada para los
          residuos y (b): grÃ¡fico de probabilidad medio normal con banda de confianza
          al 95 % simulada para la distancia de Cook, (ejemplo 3).
por lo cual se concluye que la funciÃ³n de varianza asumida es adecuada, vÃ©ase
McCullagh & Nelder (1989); el grÃ¡fico del predictor lineal ajustado (b   Î· ) contra la
variable dependiente ajustada (z), grÃ¡fico c, muestra una tendencia lineal de los
puntos, con lo cual se concluye que la funciÃ³n de enlace es apropiada (McCullagh
& Nelder 1989). El grÃ¡fico d indica que no hay puntos con alto leverage, mientras
que los grÃ¡ficos e y f muestran que la observaciÃ³n y11 es la que mÃ¡s influencia ejerce
sobre los parÃ¡metros de localizaciÃ³n y escala; sin embargo, todas las distancias de
Cook en el grÃ¡fico medio normal (half normal plot ) de la figura 5b se encuentran
dentro de la banda simulada. Por tanto, no se tiene evidencia de observaciones
influyentes en el ajuste (Atkinson 1981). El grÃ¡fico de los residuales con bandas
simuladas, que se muestra en la figura 5a, confirma la ausencia de datos atÃ­picos
(Atkinson 1981).
Referencias
Agresti A.Categorical Data Analysis.(2002).John Wiley & Sons.New Jersey.
Atkinson A C.Two Graphical Displays for Outlying and Influential Observations in Regression.(1981).Biometrika.
Brooks R J.Approximate Likelihood-Ratio Test in the Analysis of Beta Binomial Data.(1978).Applied Statistics.
Crowder M J.Beta-Binomial Anova for Proportions.(1978).Applied Statistics.
Crowder M J.Inference About the Intraclass Correlation Coefficient in the Beta-binomial ANOVA for Proportions.(1979).Journal The Royal Statistical Society.
Development Core Team, R.R: A Language and Environment for Statistical Computing.(2007).R Foundation for Statistical Computing.Austria.
Dobson A J.An Introduction to Generalized Linear Models.(2002).Chapmann & Hall.New York.
GarcÃ­a Y B,PÃ©rez J A.Efecto de la densidad de siembra en la larvicultura de bagre blanco (sorubim cuspicaudus).(2008).Universidad de CÃ³rdoba.MonterÃ­a.
Hinde J,DemÃ©trio C.Overdispersion: Models and Estimation.(1998).ABE.SaÌƒo Paulo.
McCullagh P,Nelder J A.Generalized Linear Models.(1989).Chapmann & Hall.New York.
Morales M A.Estudio de homogeneidad de la dispersiÃ³n en un diseÃ±o completamente al azar con datos de proporciones y conteos.(2008).Universidad Nacional de Colombia.BogotÃ¡.
Nelder J A,Wedderburn D W M.Generalized Linear Models.(1972).Journal The Royal Statistical Society.
Prentice R L.Binary Regresion Using an Extended Beta-Binomial Distribution with Discussion of Correlation Induced by Covariate Measurement Errors.(1986).Journal of the American Statistical Association.
Ravishanker N,Dey D K.A First Course in Linear Model Theory.(2001).Chapmann & Hall.New York.
Sudhir P,Saha K.The Generalized Linear Model and Extensions: a Review and some Biological and Environmental Applications.(2007).Environmetrics.