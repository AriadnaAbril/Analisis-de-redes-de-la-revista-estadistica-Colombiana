Estimation of the Population Total using the Generalized Difference Estimator and Wilcoxon Ranks
Universidad Santo Tomás;Colorado State University
Abstract
This paper presents a new regression estimator for the total of a population created by means of the minimization of a measure of dispersion and the use of the Wilcoxon scores. The use of a particular nonparametric model is considered in order to obtain a model-assisted estimator by means of the generalized difference estimator. First, an estimator of the vector of the regression coefficients for the finite population is presented and then, using the generalized difference principles, an estimator for the total a population is proposed. The study of the accuracy and efficiency measures, such as design bias and mean square error of the estimators, is carried out through simulation experiments.
Key words: Finite population, Regression estimator, Wilcoxon score.
Introduction
    In survey sampling, some auxiliary variables are commonly incorporated in
the estimation procedure by using a model, but the inferences are still design-
based; this kind of approach is called model-assisted. In this approach, the model
is used to increase the efficiency of the estimators, but even when the model is
not correct, estimators typically remain design-consistent, as Breidt & Opsomer
(2000, page 1026) claim. Auxiliary information on the finite population is often
used to increase the precision of estimators of the population mean, total or the
distribution function (Wu & Sitter 2001). As an example, the ratio estimator
contains known information (population total) of some auxiliary variable. There
are several methods that can be called model-assisted, but most of them have only
been discussed in the context of linear parametric regression models. The main
examples are the generalized regression estimators (GREG) (Cassel et al. 1976a,
Särndal 1980), the calibration estimators (Deville & Särndal 1992), and empirical
likelihood estimators (Chen & Qin 1993).
   In this research, the use of some nonparametric models is considered in order to
obtain a model-assisted estimator by means of the generalized difference estimator
proposed by Cassel et al. (1976b). Specifically, we consider rank-based regression
methods in order to describe the relationship between auxiliary variables and the
study variable and also to improve the efficiency of the estimates. The results of
several simulations done in this research show that the proposed estimator works
very well under particular conditions found in the survey sampling context. In
the following sections, the minimum dispersion criterion (Jaeckel 1972, Jurečková
1971) is used in order to build a rank-based sampling estimator of the regression
coefficients. A comparison of the two approaches is achieved through Monte Carlo
simulations where it could be observed that the proposed rank-based estimator
gains in efficiency and its relative bias is negligible.
    The outline of the paper is as follows: After a short introduction that describes
briefly the model-assisted approach in survey sampling, Section 2 is focused in the
construction of an estimator of regression coefficients obtained by the minimum
dispersion approach. In Section 3, the generalized difference estimator is consid-
ered in order to build an estimator of the population total by means of results
obtained in Section 2. Also in Section 3, some theoretical properties of the pro-
posed estimator are reviewed. In Section 4, some empirical simulations show the
good performance, in terms of low relative bias and high efficiency, of the proposed
estimator -which is compared to traditional estimators under several scenarios-
supported by favorable results in most cases.



1.1. Framework

   Consider a finite population as a set of units {u1 , . . . , uk , . . . , uN }, where each
one can be identified without ambiguity by a label. Let U = {1, . . . , k, . . . , N }
denote the set of labels. The size of the population N is not necessarily known.

                                        Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                             125

    The aim is to study a variable of interest y that takes the value yk for unit
k. Note that the yk ’s are not random. The objective is to estimate a function of
interest T of the yk ’s:
                             T = f (y1 , . . . , yk , . . . , yN )            (1)

     The most common functions are the population total, given by
                                           X
                                    ty =         yk                                 (2)
                                           k∈U

and the population mean, given by
                                         P
                                            k∈U yk
                                  yU =                                              (3)
                                             N

   Associated with the kth unit (k = 1, . . . , N ), there is a column vector
                                                                       P      of p
auxiliary variables, xk . It is assumed that the population totals tx = U xk are
known.
   A probability sample s is drawn from U , according to a sampling design p(·).
Note that p(s) is the probability of drawing the sample s. The sample size is n(s),
but, for a fixed size sampling design, the sample size is n. The sampling design
determines the first order inclusion probability of the unit k, πk , defined as
                                                  X
                             πk = P r(k ∈ s) =           p(s)                       (4)
                                                  s3k

and the second order inclusion probability of the units k and l, defined as
                                                X
                          πkl = P r(k, l ∈ s) =    p(s)                             (5)
                                                      s3k,l


     The study variable y is observed for the units in the sample.
    The foundations of inference in survey sampling are based in pursuing a sam-
pling strategy, that is the combination of a sampling design and an estimator. In
this research it is assumed that the user knows the population behavior of the
response variable, and chooses the appropriate sampling design. In this way, the
pursuit is restricted to the estimator. Some sampling estimators for the total of a
population are as follows.


1.1.1. The Horvitz-Thompson Estimator

     The Horvitz-Thompson (HT) estimator (Horvitz & Thompson 1952) is defined
by
                                           X yk
                                    b
                                    tπ =                                            (6)
                                                 πk
                                           k∈s


                                     Revista Colombiana de Estadística 32 (2009) 123–143

126                                                        Hugo Andrés Gutiérrez & F. Jay Breidt
                                                 
   This estimator is design-unbiased, that is Ep btπ = ty where Ep (·), denotes
the expectation with respect to the sample design. Its variance is given by
                                           X yk yl ∆kl
                                  V arp b
                                        tπ =                                                     (7)
                                                 πk πl
                                                      k,l∈U


    For more information about the properties of this estimator it is recommended
to review Särndal et al. (1992, Ch. 2).


1.1.2. The Generalized Regression Estimator

    The HT estimator does not use the auxiliary information in the estimation
step1 . However, it is of interest to improve its efficiency by using the auxiliary
information. For this purpose, we suppose that the relationship between yk and
xk could be described by a model (Cassel et al. 1976b) ξ, such that yk = x0k β + εk
and
                                             Eξ (yk ) = x0k β
                                                                                                 (8)
                                        V arξ (yk ) = σk2

for k = 1, . . . , N , where εk are independent random variables with mean zero and
variance σk2 and β is a vector of unknown constants. If (8) is adjusted with an
intercept, then x1k ≡ 1 ∀k ∈ U . Cassel et al. (1976a, p. 81) claim that the finite
population is actually drawn from a larger universe and this is the model idea
in "its most pure form". Särndal et al. (1992, pp. 225 - 226) explain that the
hypothetical finite population fit of the model would result in estimating β by
                                                          !−1
                                        X xk x0                 X xk yk
                                                      k
                                B=                                                               (9)
                                                σk2                    σk2
                                         U                      U

    When a sample s is drawn, B is estimated by
                                                          !−1
                                        X xk x0                 X xk yk
                                b =
                                B                     k
                                                                                                (10)
                                         s
                                              σk2 πk             s
                                                                     σk2 πk

   Then, the Generalized Regression Estimator (GREG) (Cassel et al. 1976b) is
given by
                                                   !0
                                    X        X xk
                    b
                    tGREG = btπ +       xk −          b
                                                      B                 (11)
                                                πk
                                                 k∈U             k∈s

      b is the vector of estimated regression coefficients.
where B
   1 The HT estimator does not use auxiliary information explicitly. However, auxiliary informa-

tion is often used implicitly in developing inclusion probabilities (as in a probability proportional
to size sampling design) or developing stratification.


                                             Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                                  127

   Särndal et al. (1989) give the approximate variance of the GREG as follows:
                               X     (yk − x0k B) (yl − x0l B)
                  V arp btGREG '   ∆kl                                                  (12)
                                           πk            πl
                                        k,l∈U

which is small if yk is well explained by the vector of auxiliary variables, xk . Isaki
& Fuller (1982) and Deville & Särndal (1992) present the theoretical background
of this estimator.


2. Estimating the Regression Coefficients
    In this section, the traditional least squares estimation method of the vector
of regression coefficients under the assumption of the model given in equation (8)
is reviewed. After this, a new estimator of the vector of regression coefficients is
obtained through the minimum dispersion approach.


2.1. Least Squares Estimation
    When the least squares approach is used, β is estimated by (9). By using the
principles of estimation proposed by (Horvitz & Thompson 1952), when a sample
s is drawn, B is estimated by (10)2 and its variance expression must be found.
Särndal et al. (1992, section 5.10) show that when using the Taylor approach, an
approximation of the variance of (10) is given by
                                            !−1              !−1
                               X xk x0          X xk x0
                   AV B b =               k
                                                V          k
                                                                            (13)
                                      σk2              σk2
                                    U                    U

where V is a symmetric matrix p × p with entries
                          XX                         
                                       xik Ek    xjl El
                    vij =        ∆kl                                                    (14)
                                         πk       πl
                                     U

and Ek = yk − x0k B. The variance estimator is given by
                                        !−1                !−1
                            X xk x0           X xk x0
                   b  b
                   V B =              k     b
                                            V            k
                                                                                        (15)
                               s
                                 σk2 πk          s
                                                    σk2 πk

where V is a symmetric matrix p × p with entries
                            X X ∆kl  xik ek   xjl el 
                     vbij =                                                             (16)
                               s
                                  πkl     πk      πl

                  b Note that i, j = 1, . . . , p. In this research, we assume a model
and ek = yk − x0k B.
like 8 supposing that εk deviates from the Gaussian distribution.
  2 Note that (10) is biased but asymptotically design unbiased and consistent under mild as-

sumptions.


                                         Revista Colombiana de Estadística 32 (2009) 123–143

128                                                   Hugo Andrés Gutiérrez & F. Jay Breidt

    Besides this particular case, if the scatterplot shows some points of influence
or some outliers, as in Figure 1, the use of the least squares approach is not
                              b Jaeckel (1972) proposes some alternatives to find
suitable in order to estimate B.
a nonparametric estimate of the vector of coefficients. As usual, in a linear model,
the problem is to find those values of the coefficients which make the residuals as
small as possible.




                       20000
                                                        Least Squares
                                                        Real Trend



                       15000
                       10000
                   y

                       5000
                       0




                               0   100   200    300      400       500   600

                                                x


                Figure 1: Two regression lines in the finite population.




2.2. Estimation of B through the Minimum Dispersion
     approach
     Without loss of generality, it is supposed that the k-th unit has only one auxil-
iary variable associated. The reason for this is the convenience for the theoretical
development, but the reader must note that the estimation of the regression coef-
ficients can be extended to the multiparameter case. Then y1 , . . . , yk , . . . , yN is a
realization of a linear working model, ξ : yk = β0 + βxk + εk , where we denote by
Fε (·) the continuous distribution function of the residuals of this model and fε (·)
their corresponding probability density function.
   The following definitions (Hettmansperger 1984, section 3.4) are required in
order to develop an estimator that could be considered as suitable under the former
assumptions.

Definition 1. Let D(·) be a measure of variability in the finite population that
satisfies the following properties:

   1. D(E + 1N c) = D(E)

                                         Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                                129

   2. D(−E) = D(E)

for any N × 1 vector E and any scalar c. Note that 1N is a vector of ones of size
N . Then D(·) is called a translation-invariant measure of dispersion.

     Let x be a vector of size N of known auxiliary information and y = (y1 , . . . ,
yk , . . . , yN )0 . By minimizing D(y − βx), an estimate of β, generated by D(·), is
obtained. Jaeckel (1972) defined the following measure of dispersion for any vector
E = y − βx
                                           N
                                           X
                                   D(E) =      a(Rk )Ek                         (17)
                                            k=1

where R1 , . . . , RN are the ranks of E1 , . . . , EN , and a(k) are a non-decreasing set
of scores. Using the former measure we have the following definition.

Definition 2. A rank estimate of β is the value b that minimizes

                                         N
                                         X        
                                D(E) =     a R(Ek ) (Ek )                             (18)
                                         k=1


where Ek = yk − β0 − βxk and E = (E1 , . . . , Ek , . . . , EN )

   Note that we shall not estimate β0 , through the dispersion measure approach,
because of the first condition of the Definition 1, which implies that the estimate of
β does not depend on β0 . We expect that the estimates generated by minimizing
18 will be more robust than least-square estimates because the influence of outliers
enters in a linear rather than quadratic fashion.

Result 1. Without loss of generality, the estimate b that minimizes 18 is the same
as the one that minimizes the measure of dispersion in terms of centered data.

Proof . Using the properties of a measure of variability, we have that:

                     N
                     X        
          D(E) =       a R(Ek ) (Ek )
                     k=1
                     X
                 =         a(R(yk − b0 − bxk ))(yk − b0 − bxk )
                     U
                     X                                                                (19)
                 =         a(R(yk − yU − bxk + bxU ))(yk − y U − bxk + bxU )
                     U
                     X               c        
                 =    a R ykc − bxck   yk − bxck
                     U

where ykc = yk − yU and xck = xk − xU .



                                        Revista Colombiana de Estadística 32 (2009) 123–143

130                                                       Hugo Andrés Gutiérrez & F. Jay Breidt

Result 2. Jaeckel (1972, theorem 4) states that when using the Wilcoxon scores,
defined by3,4
                                         k     1
                                a(k) =       −                              (20)
                                       N +1 2
then (18) is minimized when b, the estimator of β, is the weighted median of the
set of pairwise slopes given by
                                      yk − yl
                              bkl =                     k, l = 1, . . . , N                    (21)
                                      xk − xl
for xk > xl , where each slope is weighted proportional to xk − xl , and bkl are
assumed all distinct.

    Note that 18 is translation-invariant, so we can obtain the estimate b0 as the
median of yk − bxk . Draper (1988) explains that "to calculate a weighted median,
sort the observations from smallest to largest, carrying their weights along with
them, find the overall sum S of the weights, and begin adding the weights from
the top or bottom of the sorted list until S/2 is reached. The corresponding
observation is the weighted median".
    The estimator of β0 in the finite population is given by the following result.
Result 3. Let b be the estimator of β which minimizes 18. Then the estimator of
β0 which satisfies the condition that the median point (med(x), med(y)) must lie
in the regression line is given by

                                       b0 = med(y − bx)                                        (22)

2.2.1. Slope Estimation

    In practice, we just have a sample of the finite population, so that both b0
and b remain unknown, but can be estimated by a sample estimator involving the
inclusion probability of each element in the selected sample.
Result 4. A rank-based sampling estimator of the slope regression coefficient is
given by eb, which is a weighted median of
                                                    c       c
                                         ebkl = y̌k − y̌l                                      (23)
                                                x̌ck − x̌cl
for x̌ck > x̌cl , where each term is weighted proportional to x̌ck − x̌cl . With
                                                   yk − y s
                                          y̌kc =
                                                     πk
   3 The Wilcoxon procedures are robust and highly efficient in the sense that the effect of outliers

(in the variable of interest) is smaller than the least squares procedures; i.e., Wilcoxon procedures
provide protection against outlying responses, see (Terpstra & McKean 2005).
   4 This paper considers only the case where the set of scores corresponds to the Wilcoxon scores.

The reason is that Wilcoxon procedures are more efficient than least squares procedures when
the data are non-normal and feature 95.5% efficiency when the data are normally distributed
(Hettmansperger & McKean 1998, pp.163-164). There are many other choices for the set of
scores and could be considered for future research.


                                           Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                                 131

                                                 xk − xs
                                        x̌ck =
                                                   πk
y s and xs are the sample mean of the response variable and the sample mean of
the auxiliary variable, respectively. Note that bf
                                                 kl are assumed to be all distinct
with k, l = 1, . . . , n.

Proof . The former estimator is quite intuitive: from the Result            1, we obtained
                                                             P           c      c
                                                                                    c
that the measure of dispersion to minimize is D =                U  a R y k −  bxk    yk −
    
bxck . As it was mentioned, in practice the yk ’s are not available in the whole
population, so a natural estimation of D is given by including the first order
inclusion probabilities in the measure, as follows:
                                  c                       
                                       y −bxc
                           X a R k πk k             ykc − bxck
                     De=
                            s
                                              πk
                           X   y c − bxc   y c − bxc 
                        =      a R       k       k        k        k                   (24)
                            s
                                           πk               π  k
                           X                    c          
                        =      a R y̌kc − bx̌ck    y̌k − bx̌ck
                             s


   Then, the proof is complete when using Result 1.

    There are many choices in the estimation of the population dispersion, the
reason that we use π-expansion in the denominator of expression (24) is that D
could be seen as a population total and its corresponding HT estimator must be
a sample total expanded by the inclusion probability of each unit in the selected
sample, s. The π-expansion is included in the rank function R(·) because it must
maintain the original weights given by the inclusion probability of each element.
Note that (24) takes a form similar to (19), and applying the Result 2 an estimator
of b is obtained.

2.2.2. Intercept

   The estimation of the intercept b0 can be found by estimating the median
(with respect to the pseudo-residuals e∗k = yk − ebxk , k = 1, . . . , n) of the finite
population.

 Result 5. A sampling estimator of the intercept regression coefficient is given by
eb0
                                eb0 = Fe −1 (0.5)                              (25)
Fe−1 is the inverse function of Fe(0.5) given by
                                                                !−1
                                        X zk,0.5      X 1
                           Fe (0.5) =                                                  (26)
                                         s
                                                 πk    s
                                                           πk


                                         Revista Colombiana de Estadística 32 (2009) 123–143

132                                                   Hugo Andrés Gutiérrez & F. Jay Breidt

and                           (
                                  1   if e∗k ≤ 0.5,
                   zk,0.5 =                           where    e∗k = yk − ebxk                (27)
                                  0   if e∗k > 0.5

   The general procedure suggested for the estimation of a median has the fol-
lowing steps (Särndal et al. 1992, p. 197):

   1. First, obtain the estimated distribution function, Fe

   2. Estimate the median by Fe −1 (0.5).


2.3. Properties of the Rank-Based Estimator of Regression
     Coefficients
    In this section, the results of a Monte Carlo simulation are used in order to show
that the rank-based estimator of the regression coefficients has a good performance
(lower relative bias and mean square error than the least squares approach) under
two specific scenarios.
   A size N = 1000 finite population is simulated from a superpopulation model,
ξ. To do this, it is supposed that the relationship between yk and xk can be
described through a model ξ, such that yk = β0 + βxk + εk and


                                         Eξ (yk ) = β0 + βxk
                                                                                              (28)
                                      V arξ (yk ) = σk2

    The first simulation scenario is when the values of x come from a gamma
distribution with scale and shape parameter equal to one5 . The second scenario
is similar to the first, but 5% of the data in the response variable is contaminated.
This process was done by contaminating the errors through a mixture of normal
densities. The R code of the contamination step is available by requesting to the
first author. Figure 2 shows the corresponding scatterplot for the second scenario.
   The value of the parameter β was set to two and the value of the parameter
β0 was set to ten such that yk > 0∀k ∈ U . For the non-contaminated units, it is
assumed that εk are independent and identically distributed as N (0, σ 2 ).
    In each run of the simulation, random samples were drawn, according to a
simple random sampling design without replacement (SI). Each sample was of size
n = 100. The parameters were estimated using least squares and the minimum
dispersion approach. This process was repeated M = 1000 times. The simulation
was written in the statistical software R 2.6.0. (Team 2007). In the simulation,
the performance of an estimator bb was evaluated with its relative bias, (RB ) and
its mean square error, (MSE ), defined as follows:
   5 The values of this distribution are non negative and its shape is right-skewed. This is common

in practice (Wu 2003, p. 946).


                                            Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                                    133




                          60
                          50
                          40
                     y

                          30
                          20
                          10
                               0        2         4             6       8

                                                      x


Figure 2: Scatter plot of the contaminated response variable against the simulated aux-
          iliary variable.




                                                           M b
                                                           X
                                                 −1          bm − β
                               RB = 100%M                                                  (29)
                                                          m=1
                                                                    β

                                                          M
                                                          X
                               M SE(bb) = M −1                (bbm − β)2                   (30)
                                                          m=1

respectively, and bbm was computed in the m-th simulated sample.
    Table 1 shows the relative bias of the estimators of β0 and β. The sampling
estimators based in the minimization of the sampling dispersion through Wilcoxon
ranks have a smaller bias than the least squares estimators under a normal model
with no contaminated data. The difference is huge under a normal model with
contaminated data in the response variable demonstrating the robustness of the
proposed estimator.

                         Table 1: Relative bias of the estimators.
                                    Minimum dispersion                   Least Squares
                                      β0          β                    β0             β
          Not contaminated         −0.37%    −0.33%                  −0.51%      −0.62%
          Contaminated             −3.98%    −0.19%                 −33.94%       23.09%


    Regardless to the efficiency of the proposed estimators, Table 2 shows that
under a model with contaminated data, the estimator performs well and it could
be stated that the fit is good in comparison with the least squares estimator. The
proposed estimator gains in efficiency under the model with contaminated data;
this gain is very high in the slope estimation of the regression line.

                                            Revista Colombiana de Estadística 32 (2009) 123–143

134                                               Hugo Andrés Gutiérrez & F. Jay Breidt

                   Table 2: Mean square error of the estimators.
                                   Minimum dispersion           Least Squares
                                     β0        β                β0         β
              Not contaminated     0.13     0.0004            0.25     0.0001
              Contaminated         0.16     0.0005            1.15       0.21



3. Estimating the Population total Through Mini-
   mum Dispersion
   If b0 and b were known, then a design-unbiased estimator of the population total
could be constructed using the generalized difference estimator (Cassel et al. 1976b)
given by the following expression:
                             X yk − b0 − bxk          X
                      b
                      ty =                        +         (b0 + bxk )               (31)
                                      πk
                             k∈s                      k∈U


   The design variance of this estimator is given by
                                   XX     Ek El
                             V ar b
                                  ty =  ∆kl                                           (32)
                                            πk πl
                                              U

where Ek = yk − b0 − bxk . It is expected that this variance would be smaller than
the variance of the HT estimator.
    In practice, we have only a sample of the finite population, so that both b0
and b remain unknown, but can be estimated by a sample estimator involving the
inclusion probability of each element in the selected sample.
Result 6. A rank-based survey regression estimator for the population total is
given by the following expression

                             X yk − eb0 − ebxk        X           
                     e
                     ty =                        +      eb0 + ebxk                    (33)
                                      πk
                             k∈s                      k∈U


where eb is given by (23) and eb0 is given by (25).


3.1. Properties of the Rank-Based Estimator of the Popula-
     tion Total
   It is straightforward to show that (33) can be written as
                                                  0
                               e    tyπ + tx − btxπ B
                               ty = b                 e                               (34)
                                                                                P          0
where b
      t is the HT estimator for the variable of interest, tx = N,                   U xk        ,
      yπ
       P 1 P xk 0                 0
b
txπ =                   e = eb0 , eb .
                    and B
          s πk s πk



                                      Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                            135

3.1.1. Simple Random Sampling
                                                                                    n
   If simple random sampling without replacement is considered, then πk =
                                                                                    N
            n(n − 1)
and πkl =             for l 6= l. For this sampling design, the rank-based regression
           N (N − 1)
estimator is defined as
                                  N X                 0
                           e
                           ty =         yk + tx − btxπ B  e                      (35)
                                  n s

                     P       0                0
where btxπ = N, N                   e = eb0 , eb . Under SI, eb is the median of the
                   n    s xk    and B
set of pairwise slopes given by:
                                           yk − yl
                                   bkl =                                          (36)
                                           xk − xl

and eb0 is the median of yk − ebxk . Note that the second term of (35) can be
considered as a rank-based correction for the estimated population total.

3.1.2. Variance Estimation Through the Difference Estimator
                                               e is dominated by the variability in
    If it is suspected that the variability in B
tyπ and b
b         txπ , then
                                      0            0       
            e         tyπ − ty + tx − b
            ty − ty = b               txπ B + tx − btxπ      e −B
                                                             B                    (37)

where B = (b0 , b1 )0 is the vector of finite population regression coefficients that
would be obtained from the rank-based procedure if the entire finite population
were observed. The last term above is the product of two terms, each converging to
zero, and is supposed of smaller order than either of the first two terms (small ×
small = negligible). This means that the proposed rank-based model-assisted
estimator is well approximated by a generalized difference estimator, from which
a variance estimator could be found straightforwardly.
    Under the previous scenario, it follows that the proposed estimator behaves in
large samples the generalized difference estimator (Särndal et al. 1992, p. 221)
and then:                                         0
                              e    tyπ + tx − b
                              ty ≈ b            txπ B,                           (38)

   The design variance of this estimator is given by (32). An estimator of this
variance is given by:
                                XX ∆ e e
                         Vd
                                               kl k l
                           ar bty =                                        (39)
                                         s
                                             πkl πk πl

where ek = yk − eb0 − eb1 xk .
   The rigorous study of the properties of the estimator for the variance in (39)
requires theoretical sampling-based arguments that are beyond of the scope of

                                    Revista Colombiana de Estadística 32 (2009) 123–143

136                                                Hugo Andrés Gutiérrez & F. Jay Breidt

this research. However, in this section we will proceed through simulations to
show that the difference estimator approach is reasonable. For this purpose, the
performance of the variance estimator in (39) is evaluated. A finite population of
size N = 1000 was simulated from a superpopulation model, ξ. It is supposed that
the relationship between yk and xk could be described by means of the very first
model ξ (non contaminated data) in the section 2.3, such that yk = β0 + βxk + εk .
The auxiliary information is generated in the same way as in the previous section.
   In particular, the model yk = 10 + 2xk + εk is considered such that yk > 0
∀k ∈ U . It is assumed that εk are independent and distributed as N (0, σk2 ).
    In each run of the simulation, simple random samples were drawn; each sample
was of size n = 100. The parameters (β0 , β1 ) were estimated using the least squares
approach and the minimum dispersion approach. This process was repeated M =
1000 times. The simulation was written in the statistical software R 2.6.0. (Team
2007). In the simulation, the performance of the proposed variance estimator
using the principles of the generalized difference estimator, (44), was evaluated
using the percent relative bias, (RB% ) that was 0.963%. The value of the relative
bias is very close to zero and even though it is an empirical exercise, the use of
the estimator appears reasonable under the standard model ξ.


3.1.3. Jackknife Variance Estimation

    The exact design-based variance of the proposed estimator does not have a
closed form because the estimator B  e is a nonlinear one. On this subject Lohr
(1999, p. 293) claims that Jackknife methods are convenient for multiparameter
and non-parametric problems and provides an attractive alternative in this cases.
    Let e
        ty(j) denote the estimator of the population total omitting the j-th unit.
Then, for a simple random sample we define the delete 1-Jackknife variance esti-
mator of ety as
                               n−1X      n             2
                         VbJK e
                              ty =             ty(j) − e
                                               e       ty                     (40)
                                       n j=1

   This method provides a consistent estimation of the variance.


3.1.4. Representative Strategies
                                                                           
Definition 3. Given x an auxiliary information vector, a sampling strategy p, b
                                                                              t
is called representative with respect to x, if and only if6

                                         b
                                         t(x) = tx                                       (41)

for every s with p(s) > 0; that is, the estimator applied to the auxiliary variables
reproduces exactly the population total of each auxiliary variable.
                        “ ”
  6 The combination         t denoting an estimator b
                         p, b                       t based on a sample drawn accordingly to a
design p is called a strategy.


                                        Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                              137

Result 7. Under any sampling design p(s), the proposed
                                                         population total estimator
induces a representative strategy because the pair p(s), e
                                                         t estimates the population
total of the auxiliary variables with null variance.

Proof . It is straightforward to show that eb1 = 1 because it is the weighted
                                                                               median
         x̌ck −x̌cl
of bkl = x̌c −x̌c , and b0 = 0 because it is the sampling estimation of med xk −eb1 xk .
   e                    e
            k     l
Therefore,
                                                  !
                            X xk − be0 − be1 xk        X               
                      e
                      tx =                          +      be0 + be1 xk
                             s
                                        πk
                                                       U
                            X xk − 0 − xk  X
                               
                          =                      +    (0 + xk )                     (42)
                             s
                                      πk
                                                   U
                            X
                          =     xk = tx
                          U

                  
   Note that V ar e
                  tx = V ar(tx ) = 0.


3.1.5. Cochran-Consistency

   The definition of Cochran-Consistency (Särndal et al. 1992, p. 168) claims that
an estimator is consistent for a parameter in a finite population if s = U implies
that the estimator is equal to the parameter.

Result 8. Under SI designs, the proposed estimator is Cochran-consistent.

Proof . It is straightforward to show that if s = U under the family of SI designs,
then tx = b
          txπ , so
                                                 0
                              ty = tyπ + tx − b
                              e               txπ B  e
                                              0                                   (43)
                                 = ty + tx − tx B e = ty




4. Empirical Simulation
   In this section, some simulation experiments are carried out in order to compare
the performance of the proposed estimator given by (33) and referred to as JAC,
with the Horvitz-Thompson (HT) estimator and the regression estimator (REG).
    A size N = 1000 finite population is simulated from a superpopulation model
ξ. It is supposed that the relationship between yk and xk can be described through
a model ξ, such that yk = β0 + βxk + εk and

                                      Revista Colombiana de Estadística 32 (2009) 123–143

138                                             Hugo Andrés Gutiérrez & F. Jay Breidt




                          Eξ (yk ) = 10 + 2xk              yk > 0
                                                                                    (44)
                        V arξ (yk ) = σk2          k = 1, . . . , n

    The values of the vector of auxiliary information are generated from a gamma
distribution with scale and shape parameter equal to 1. It is assumed that the
values of εk are independent and distributed as N 0, σk2 . This is the real model
used in the construction of the proposed estimator. Note that even though the
model includes a term for the variance, the resulting rank-based estimator (JAC)
does not contain this variance term nor does the HT estimator. The REG estimator
takes into account the variance term, and this is an interesting feature in the
simulation.
    In each run, random samples according to a SI design were drawn. Each sample
was of size n = 100. The parameters (β0 , β1 ) were estimated using least squares
and the minimum dispersion approach. This process was repeated M = 1000
times. The simulation was written in the statistical software R 2.6.0. (Team 2007).
In the simulation, the performance of an estimator b
                                                   ty of ty is tracked by the Percent
Relative Bias:
                                            XM
                                                b
                                                ty,m − ty
                          RB = 100%M −1                                          (45)
                                            m=1
                                                    ty
and the relative efficiency
                                           
                                     M SE bt
                               RE b
                                  ty =      y                                     (46)
                                       M SE b
                                            tyπ

where b
      ty,m is computed in the mth simulated sample, m = 1, . . . , 1000. The Mean
Square Error (MSE) is defined by

                                     M 
                                       X            2
                        M SE b
                             ty = M −1    b
                                          ty,m − ty                                 (47)
                                             m=1


   Note that the HT estimator is the baseline estimator for efficiency comparison.
    Specifically, we consider the robustness and the absence of normality of the
residuals as the main issues that moves us to consider a model-assisted survey rank-
based regression estimator. We used the minimum dispersion procedure (Jurečková
1971) and (Jaeckel 1972) to build the proposed estimator. It is known that rank-
based procedures outperform, in the sense of efficiency, traditional (least squares)
procedures when the distribution function of the residuals in the model is deviated
from the normal distribution (Hettmansperger 1984, Hettmansperger & McKean
1998).
   The estimators are considered under a wide range of model specifications. The
simplest of these ones is simple linear regression with normal, uncorrelated, ho-
moscedastic errors. Departures from this simple model (mean function is not

                                      Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                                      139

linear, errors are not normal, errors are heteroscedastic) would all be of interest.
It is expected that the rank-based procedure would continue to work well across
a whole range of simulated models. The model specifications are as follows:

   1. M1: normal linear model with correctly specified variance structure and
      uncorrelated, homoscedastic errors;

   2. M2: normal linear model with correctly specified variance structure and
      uncorrelated, heteroscedastic errors7;

   3. M3: linear model with correctly specified variance structure and non-normal
      errors, uncorrelated, homoscedastic errors8;

   4. M4: normal linear model with incorrectly specified variance structure and
      uncorrelated, heteroscedastic errors9;

   5. M5: nonlinear model10 ;

   6. M6: normal linear model with five percent of contaminated data11 .

   These cases represent a range of correct and incorrect model specifications for
the estimators that are considered. Table 3 reports the simulated relative bias for
the estimators. In all of these cases, the relative bias is negligible.

                          Table 3: Relative Bias of the estimators.
                        Model        HT               REG        JAC
                         M1       −0.024%            0.008%    0.007%
                         M2        0.034%            0.013%    0.014%
                         M3       −0.020%            0.002%    0.003%
                         M4        0.034%            0.014%    0.014%
                         M5        0.002%            0.002%    0.002%
                         M6       −0.009%           −0.021%   −0.023%


    The motivation of this research was the construction of an estimator able to
gain in efficiency compared with the traditional estimators in the survey sampling
context. From results shown in Table 4, it can be seen that the proposed estimator
in the M1 model gains against the others, it can be seen that the MSE of the
estimators that uses the auxiliary information is less than the HT estimator in
all cases, specifically, under a regular model like M1 the estimator features very
well. Under the M2 model, the REG estimator loses efficiency compared with the
   7 In this step, the population values of the y
                                                                            `   2
                                                                                  ´
                                              k are generated by adding N 0, σk errors. Notice
that σk2 was set in order that the model had a strong heteroscedastic structure.
   8 This model assumes errors ε following an exponential distribution with parameter equals
                                  k
to one.
   9 In this step the true model has a different variance for each sample point, but it is wrongly

assumed that the model has a constant variance for all sample points.
  10 The model ξ is such that y =          1
                                k                 + εk .
                                    (10 + 2xk )3
  11 In this step the contaminated data follow the same specifications as in the simulation of

section 2.3


                                            Revista Colombiana de Estadística 32 (2009) 123–143

140                                             Hugo Andrés Gutiérrez & F. Jay Breidt

proposed estimator. This is an important issue due that the proposed estimator
does not take into account any term of variance. A similar situation occurs in the
M3 model where the errors are non-normal; in this scenario both of the estimators
features well. The results of the M4 model are the same than the M2 model
for the proposed estimator because it does not take into account any variance
term. When the model is not linear, all of the estimators features well. In the
M6 model, when dealing with contaminated data in the response variable, the
proposed estimator work very well, and in this point the gain in efficiency is
higher. In general conditions, the proposed estimators plays a good role and it is
supported by this empirical experiment.

                  Table 4: Mean Square Error of the estimators.
                       Model      HT        REG            JAC
                        M1      311.11     33.83          33.82
                        M2      349.38     44.23          43.12
                        M3      326.88      9.86           9.83
                        M4      349.38     43.10          43.12
                        M5        2.11      2.12           2.11
                        M6         509    244.62         243.55


    Table 5 shows the relative efficiency of the HT and REG estimators in com-
parison with the proposed estimator, JAC12 . In all of the models, the proposed
estimator performs better than the HT estimator, except the nonlinear model.
The efficiency of the proposed estimator in comparison with REG estimator is
almost bigger than 1. Notice that the use of auxiliary information is very relevant
in the M3 model and does not affect in the M5 model. The efficiency of the pro-
posed estimator is very close to one, in most cases, in comparison with the REG
estimator.

               Table 5: Relative efficiency of the proposed estimator.
                                Model    HT      REG
                                 M1      9.19     1.00
                                 M2      8.10     1.02
                                 M3      33.2     1.00
                                 M4      8.11     0.99
                                 M5      1.00     1.00
                                 M6      2.08     1.00




4.1. Small Sample Sizes
    So far, the proposed estimator features very well in comparison with the HT
estimator and performs at least as well as REG estimator. There is a particular
                                                                                “ ”
 12 The Relative Efficiency, RE, of an estimator b   ty is given by the ratio RE b
                                                                                 ty =
      “ ”
       b
 M SE ty
    “      ” . Ratios bigger than one favor the proposed estimator.
M SE b
     tJ AC


                                    Revista Colombiana de Estadística 32 (2009) 123–143

Estimation of the Population Total using Wilcoxon Ranks                                   141

case when the proposed estimator gains more than 40% in comparison with REG
estimator: when the sample size is small and the percentage of the contaminated
data is between 1 and 10%, the proposed estimator is clearly better than REG
estimator, as is shown in Table 6.

Table 6: Relative efficiency of the proposed estimator in comparison with REG estima-
         tor.
              % contaminated     n=100     n=50    n=20    n=10     n=5    n=3
                  0.1%            0.99     1.08    1.01     1.21    0.87   1.16
                   1%             1.00     1.02    1.07     1.16    1.20   1.04
                   5%             1.00     1.02    1.04     1.14    1.04   1.46
                  10%             0.99     1.03    1.06     1.12    1.16   1.17
                  20%             1.00     1.03    1.04     1.09    0.98   1.06
                  40%             1.00     1.03    1.05     1.08    1.07   0.99
                  50%             1.01     1.04    1.06     1.09    1.08   0.96



   The simulation was done following the same specifications as in Section 2.3
The value of the parameter β1 was set to two and the value of the parameter β0
was set to ten such that yk > 0∀k ∈ U . It is assumed that εk follows a mixture of
two normal densities with means 0 and 10 and identical variance equal to 213 .
   Regarding the percentage of the contaminated data, the proposed estimator
(JAC) does not perform well when there is too much contamination. When a
small probability of a large contamination is used, i.e. with a few outliers, the
rank based method performs better. The simulation was done using different
sample sizes and different percent of contaminated data in the response variable.
   Table 6 reports the relative efficiency of the proposed estimator in comparison
with REG estimator and it can be noted that, when the sample size decreases,
the good performance of the REG estimator decreases too, in comparison with the
JAC estimator14 . When the sample size is equal to 100, the proposed estimator
performs as well as the REG estimator and the percent of contaminated data does
not influence the performance of the estimators.
    When the percentage of contaminated data is higher than 10%, the efficiency
of the proposed estimator tends to decrease. Note that when the percentage of
contaminated data is high, REG estimator has a very good behavior, even when
the sample size is small. Specifically, it is recommended to use the method pro-
posed in this research when the percentage of contaminated data is less than 20%
because when the sample size decreases, the efficiency of the estimator increases
substantially and it indicates that the JAC estimator performs better than tradi-
tional estimators in the survey sampling literature and still maintains a very small
bias.

  13 The contamination of the response variable is done with the creation of an indicator that

converts the error term to a mixture of normal densities with different means.
  14 The Relative Bias of both estimators, REG and JAC, is always less than 3% and is not

reported.


                                         Revista Colombiana de Estadística 32 (2009) 123–143

142                                             Hugo Andrés Gutiérrez & F. Jay Breidt

5. Conclusions and Further Research
    This research was motivated by the construction of an estimator able to gain
in efficiency under some particular conditions. The estimator was built under a
model-assisted approach using the minimum dispersion criterion and the gener-
alized difference estimator as baseline. In order to construct a population total
estimator that involves a regression model it was necessary to build the estimators
of such regression coefficients. These estimator were motivated by some partic-
ular cases where the traditional least squares approach did not fit well (such as
the contaminated response variable scenario). In this pursuit of the rank-based
estimators for the slope and intercept, the minimum dispersion criterion was used
and the behavior of such estimators was completely satisfactory, in the sense of
high efficiency, compared with the least squares approach.
    When the good performance of these regression estimators was observed, the
next step was the construction of a population total estimator. The form of the
generalized difference estimator was used and the construction of the variance
estimator of the population total estimator was proposed. The results of several
simulations done in this research show that the proposed estimator works very
well under particular conditions consistent with the survey sampling context. The
proposed estimator and its implementation in the R software is open and available
in case needed.
    Of course, there are many open questions in this research. There are many
other choices for the set of scores and it will be interesting to show how the choice
of the scores affects the estimation of the parameters. Note that the poststrat-
ification estimator was not considered in the simulation study. If the auxiliary
information is not continuous but discrete, as in the poststratification estimator,
robust poststratification through the minimum dispersion criterion be an interest-
ing alternative.
References
Breidt F J,Opsomer J D.Local Polynomial Regression Estimators in Survey Sampling.(2000).The Annals of Statistics.
Cassel C M,Särndal C E,Wretman J.Foundations of Inference in Survey Sampling.(1976).Wiley.New York.
Cassel C M,Särndal C E,Wretman J.Some Results on Generalized Difference Estimation and Generalized Regression Estimation for Finite Populations.(1976).Biometrika.
Chen J,Qin J.Empirical Likelihood Estimation for Finite Populations and the Efectivene Usage of Auxiliary Information.(1993).Biometrika.
Deville J C,Särndal C E.Calibration Estimators in Survey Sampling.(1992).Journal of the American Statistical Association.
Draper D.Rank-Based Robust Analysis of Linear Models I, Exposition and Review.(1988).Statistical Science.
Hettmansperger T P.Statistical Inference Based on Ranks.(1984).Wiley.New York.
Hettmansperger T P,McKean J W.Robust Nonparametric Statistical Methods.(1998).Arnold.
Horvitz D G,Thompson D J.A Generalization of Sampling Without Replacement from a Finite Universe.(1952).Journal of the American Statistical Association.
Isaki C T,Fuller W A.Survey Design under the Regression Superpopulation Model.(1982).Journal of the American Statistical Association.
Jaeckel L.Estimating Regression Coefficients by Minimizing the Dispersion of the Residuals.(1972).The Annals of Mathematical Statistics.
Jurečková J.Nonparametric Estimate of Regression Coefficients.(1971).The Annals of Mathematical Statistics.
Lohr S.Sampling: Design and Analysis.(1999).Duxbury Press.California.
Särndal C E.On π-inverse Weighting Versus best Linear Unbiased Weighting in Probability Sampling.(1980).Biometrika.
Särndal C E,Swensson B,Wretman J.The Weighted Residual Technique for Estimating the Variance of the General Regression Estimator of the Finite Popoulation Total.(1989).Biometrika.
Särndal C E,Swensson B,Wretman J.Model Assisted Survey Sampling.(1992).Springer.New York.
Team R D C.R: A Language and Environment for Statistical Computing.(2007).R Foundation for Statistical Computing.Austria.
Terpstra J F,McKean J W.Rank-based analyses of linear models using R.(2005).Journal of Statistical Software.
Wu C.Optimal Calibration Estimators in Survey Sampling.(2003).Biometrika.
Wu C,Sitter R R.A Model Calibration Approach to Using Complete Auxiliary Information from Survey Data.(2001).Journal of the American Statistical Association.