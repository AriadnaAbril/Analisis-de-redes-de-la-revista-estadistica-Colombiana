Estimation Stage in Survey Sampling: A Multiparameter Approach
Universidad Santo Tomás
Abstract
Most of the real applications in survey sampling involve not one, but several characteristics of study. In this paper, a unified framework of joint estimation of the parameters of interest is presented under various sampling designs. The applications of the results of this research entails a significant gain in computational efficiency.
Key words: Multipurpose survey, Multiparameter estimation.
Introduction
    The purpose of sample surveys is to gather information about a certain finite
population by estimating parameters such as means, totals, or ratios. However,
most surveys do not include just one but several study variables. Sampling books
seem to discard the fact that a survey is seldom interested in the estimation of
one single parameter and most of the theory developed by sampling researchers
is focused on the search of both, design and estimator, that perform well and
gain in efficiency under the single parameter case. Several advantages have been
developed in this field. However, all of them are motivated by the assumption that the survey methodologist is interested in one single parameter. As Holmberg
(2002a) claims, «a typical business survey has several study variables and several
target parameters... with multiple target parameters, and multiple requirements
on precision, the practising statistician must then select a compromise design.»
    A survey could be divided in two stages: The design stage and the estima-
tion stage. The work of Holmberg during the past decade was related to find a
sampling design that yields unequal first order inclusion probabilities, and that
is optimal in the sense that significant improvements on the overall precision are
possible. This paper is focused on the next step after planning the survey, the
estimation stage, presenting a methodological unified framework in the estima-
tion of each parameter of interest by means of the matricial approach; lets say, a
generalized system of multiparameter survey estimation. Practical applications of
the matricial approach may result in a significant gain in computational efficiency
and a better comprehension of the theory of multivariate estimation in finite pop-
ulations. It is supposed that survey methodologists know the structural behavior
of the population and they are able to choose a design that performs well with
respect to overall characteristics of interest such as Holmberg suggests.
    The structure of the paper is as follows: The second section provides some basic
definitions and introduces the foundations of multiparameter estimation by means
of the Horvitz-Thompson estimator. The third section is related to the estimation
under the most common element sampling designs. The fourth section is related
to the use of auxiliary estimation. The last section deals with a numerical example
of the design and estimation applied in realistic multipurpose survey context. In
that section, with the help of the R1 sampling package (Tillé & Matei 2008),
it is shown in detail how to produce estimations for a multiparameter survey
avoiding computational loops that makes the estimation stage more difficult and
slow. Proofs of the results are not shown by simplicity of the lecture. However, the
reader familiarized with matrix algebra and the basic principles of survey sampling
will find no problem with this.
    This paper gives a comprehensive approach of joint estimation in survey sam-
pling. Although the results of this paper are simple, it offers a powerful way of
estimation in multipurpose surveys.


2. Estimating Several Parameters
   Let U = {1, . . . , k, . . . , N } be a finite population of N elements2 . A probability
sample s is drawn from U according to a sampling design p(·) that yields the first
order inclusion probability of the unit k, πk , defined as
                                                          X
                                   πk = P r(k ∈ s) =            p(s)                             (1)
                                                          s3k

     1 R is a statistical software that is very efficient in matricial computation.   (R Development
Core Team 2008)
  2 The population size is often not known




                                               Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                              81

   and the second order inclusion probability of the units k and l, defined as
                                                         X
                              πkl = P r(k, l ∈ s) =             p(s)                       (2)
                                                        s3k,l

    Suppose that the survey involves the study of Q characteristics of interest.
Associated with the kth unit (k ∈ U ) there is a vector of Q characteristics of
interest, yk = (yk1 , . . . , ykQ ) whose values are unknown for the entire population.
In this way, the following matrix
                                                 
                     y11        y12    ...   y1Q
                    .            ..   ..      .. 
                    ..            .      .     . 
                                                                               
                                                 
              YU =  yk1        yk2    ...   ykQ  = y1           y2   . . . yQ            (3)
                    .           ..           .. 
                    .                 ..         
                    .            .       .    . 
                       yN 1     yN 2   . . . yN Q
will be called the matrix of interest. Note that the element ykq refers to the value of
the qth characteristic of interest in the kth element, with k ∈ U and q = 1, . . . , Q.
In the design based context, yq is not considered a random vector, because its
components are considered fixed but unknown. Hence, the values of each charac-
teristic of interest are not necessarily continuous such as income, expenditure or
weight, but also could be indicators of the membership of a population subgroup
such as domains, strata or post-strata. Then, YU could be a mixed-valued matrix.
    The objective is to estimate the Q components of the vector of totals defined
by

                               t = (t1 , t2 , . . . , tQ )0 = YU0
                                                                     1N         (4)
                                                   P
where 1N = (1, 1, . . . , 1)0N ×1 and tq = k∈U ykq . When the sample of size n is
drawn, ykq is observed (k ∈ s)and it is possible to define the following matrix
                                                                     
                                        y11 y12 . . . y1Q
                                      .              ..   ..      .. 
                                      ..              .      .     . 
                                                                     
                                                                     
                              Ys =  yk1 yk2 . . . ykQ                         (5)
                                      .             ..           .. 
                                      .                   ..         
                                      .              .       .    . 
                                        yn1 yn2 . . . ynQ

   When s = U , YU = Ys . In this way, the matrix of inclusion probabilities in
the sample is defined by

                                Π = diag(π1 , π2 , . . . , πn )                            (6)

and the Horvitz-Thompson estimator of t is defined as
                                                0
                    b
                    tπ = b      t2π , . . . , b
                          t1π , b             tQπ = Ys0 Π−1 1n                             (7)


                                              Revista Colombiana de Estadística 32 (2009) 79–97

82                                                              Hugo Andrés Gutiérrez

                                          P
with 1N = (1, 1, . . . , 1)0n×1 and b
                                    tqπ = k∈s ykq /πk being the Horvitz-Thompson
estimator of tq . It is easy to show that b tπ is an unbiased estimator of t, and its
covariance matrix is given by
                                                    0
                              V btπ = E b tπ − t b tπ − t                        (8)

                          
   Note that, if N ≥ q, V b
                          tπ is a positive defined symmetric matrix whose qq 0
element is                   XX          ykq ylq0
                                    ∆kl                                   (9)
                                         πk πl
                                k∈U l∈U

with ∆kl = πkl − πk πl and if s 6= U , then it is impossible to calculate the value of
the previous expression. However,
                                  if n ≥ q, it could be estimated unbiasedly by a
                         b btπ whose qq 0 element is
positive definite matrix V

                                X X ∆kl ykq ylq0
                                                                                   (10)
                                          πkl πk πl
                                k∈s l∈s


   In some cases, the requirement of the survey is the estimation of the vector of
population means given by
                                         1
                                    y= t                                      (11)
                                         N
     Then, an unbiased estimator of ȳ is
                                            1b
                                     yπ =     tπ                                   (12)
                                            N
                                                          
                                                       b btπ . If the population
whose covariance matrix is estimated unbiasedly by N12 V
size is unknown, it can be estimated unbiasedly by using the principles of the
Horvitz-Thompson estimator, such that
                                  bπ = 10 Π−1 1n
                                  N                                                (13)
                                        n


   Note that computational efficiency could be higher with the incorporation of
the matrix approach because the estimation of several parameters is obtained by
performing a matrix algebraic operation.


3. Some Sampling Designs
   In this section, some examples of the estimation of several parameters, under
the most used sampling designs, are given.
Example 1. Under Bernoulli sampling design, t is estimated unbiasedly by

                                    btπ = 1 Ys0 1n                                 (14)
                                          π

                                       Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                           83

and its covariance matrix is estimated unbiasedly by
                                           
                           b btπ = 1 1 − 1 Ys Y0
                           V                                                           (15)
                                                     s
                                     π π

Example 2. Simple random sampling without replacement (SI) design is not the
most utilized of the sampling designs, but it is useful in the last stages of a complex
survey. Under this design t is estimated unbiasedly by

                                      b   N
                                      tπ = Ys0 1n                                      (16)
                                          n
   And its covariance matrix is estimated unbiasedly by
                                  N2    n
                              b b
                              V  tπ =   1−    Sy                                       (17)
                                      n    N
with Sy , being the covariance matrix of the characteristics of interest in the sample.
On the other hand, y is estimated unbiasedly by
                                          1b    1
                                yπ =        tπ = Ys0 1n                                (18)
                                          N     n
   Its covariance matrix is estimated unbiasedly by the following expression
                                             
                               Vb y = 1 V   b btπ                            (19)
                                   π
                                        N2

3.1. Estimation for Domains
     If the requirements of the survey are related to the estimation of the size of
a domain or the total of the characteristics of interest in such domain, the next
methodological construction is required.
     Let us suppose that the population is divided in D domains, such that U =
U1 , . . . , Ud , . . . , UD . Then, the indicator matrix of domain membership is defined
by                                                                
                                         z11 . . . z1d . . . z1D
                                        .    ..     .. ..      .. 
                                        ..      .    .    .     . 
                                                                  
                                                                  
                                  Z =  zk1 . . . zkd . . . zkD                     (20)
                                        .          .          .   
                                        .    . ..  ..  . ..   .. 
                                        .                         
                                         zn1 . . . znd . . . znD
where the element                     (
                                          1 if k ∈ Ud , and
                              zkd =                                                    (21)
                                          0 otherwise

   The vector of absolute domain sizes is given by

                               Nd = (N1 , N2 , . . . , ND )0                           (22)

                                           Revista Colombiana de Estadística 32 (2009) 79–97

84                                                                 Hugo Andrés Gutiérrez

where                                        X
                                      Nd =         zkd                                (23)
                                             k∈U

Nd is estimated by means of the Horvitz-Thompson estimator as follows
                                                   0
                        bd = N
                        N           b2 , . . . , N
                               b1 , N            bD = Z0 Π−1 1n                        (24)
                                                      
and its variance is estimated unbiasedly by V      b N b d , defined similarly as in (8)
    Totals of the characteristics of interest overall domains are commonly required
parameters in real applications. The total of the qth variable overall D domains
is given by
                               tdq = (t1q , t2q , . . . , tDq )0
and could be estimated by the following expression
                                                  0
                 btdqπ = b      t2qπ , . . . , b
                         t1qπ , b              tDqπ = (yq 1D    Z)0 Π−1 1n            (25)

      Where yq denotes the qth column of the matrix Ys , 1D = (1, . . . , 1)0D×1 and
     denotes the Hadamard matrix product.

Example 3. Under SI design, the Horvitz-Thompson estimator for the absolute
domain sizes and the total of the qth characteristic of study overall D domains
are, respectively, given by
                               Nb d = (N/n)Z0 1n                           (26)
                              b
                              tdqπ = (N/n)(yq 1D         Z)1n                         (27)


3.2. Stratified Estimation
    For stratified sampling designs, the finite population U is divided into H mu-
tually exclusive strata: denoted by U1 , . . . , Uh . . . , UH . Note that, before data
collection, the membership of each element is known over the strata. This way,
in each stratum a random sample is drawn. Although, it is straightforward to
produce estimates by using the principles of the Horvitz-Thompson estimator, it
is required to sort the population such that the matrix Ys is partitioned into H
blocks, as follows
                                               
                                             Y1
                                            . 
                                            .. 
                                               
                                               
                                      Ys =  Yh                                      (28)
                                            . 
                                            . 
                                            . 
                                               YH
where Yh is a matrix that contains the values of each characteristic of interest
for the elements that belong to the hth stratum, with h = 1, . . . , H. Note that

                                         Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                         85

Ys ∈ RHn×Q and Yh ∈ Rnh ×Q , where given n = (n1 , . . . , nH )0 , then n = n0 1H =
n1 + · · · + nH .
    As usual, the objective is to estimate the Q components of the vector of totals
in the hth stratum given by
                                                     0
                         th = t1h , t2h , . . . , tQh = Yh0 1Nh                (29)

where Nh is the size of the hth stratum. The population total can be written as

                                                               H
                                                               X
                                                      0
                           t = t1 , t2 , . . . , tQ        =         th              (30)
                                                               h=1

where th is estimated unbiasedly by the following expression
                                                    0
                     b     t1hπ , b
                     thπ = b      t2hπ , . . . , b
                                                 tQhπ = Yh0 1nh                      (31)

where nh is the size of the sample in the hth stratum. Of course, independence
over sampling design is assumed at each stratum. This way, the estimator of the
population total is given by

                                                    0 X
                                                        H
                        btπ = b
                              t1π , b
                                    t2π , . . . , b
                                                  tQπ =   bth                        (32)
                                                                 h=1

and its variance can be written as
                                  X  H    
                             VST btπ =   Vh btπ                                      (33)
                                               h=1

which is estimated unbiasedly by

                                   X  H     
                             b ST btπ =
                             V            b h btπ
                                          V                                          (34)
                                               h=1

Example 4. Under the stratified sampling with SI within each strata (STSI)
design, the π estimator of the population total is
                                        H
                                        X
                                btπ =     Nh
                                                    Yh0 1nh                          (35)
                                               nh
                                        h=1

and its covariance matrix is estimated unbiasedly by

                               X H           
                      b ST SI b      Nh2     nh
                      V       tπ =        1−      Syh                                (36)
                                     nh      Nh
                                         h=1

with Syh , the sample covariance matrix of the study variables in the hth stratum.


                                         Revista Colombiana de Estadística 32 (2009) 79–97

86                                                                        Hugo Andrés Gutiérrez

4. The use of Auxiliary Information
    Let us suppose that associated with the kth unit (k ∈ U ) there is a vector of
P auxiliary variables, xk . The values of the vector xk = (xk1 , . . . , xkP ) are known
for the entire population. Hence, the following matrix
                                              
                       x11 x12 . . . x1P
                      .        ..  ..      .. 
                      ..        .     .     . 
                                                                       
                                              
               XU =  xk1 xk2 . . . xkP  = x1 x2 . . . xP                           (37)
                      .       ..          .. 
                      .            ..
                      .        .      .    . 
                       xN 1 xN 2 . . . xN P

will be called the matrix of auxiliary information.


4.1. Some Remarks
    It is possible to assume that an explicit linear relationship exists between each
of the characteristics of interest and the auxiliary information given by a super-
population model ξq , q = 1, . . . , Q, such that

                               Yq =           X      β q + εq
                              (N ×1)        (N ×P )(P ×1)       (N ×1)


     The model ξq has the following features:

                                           Eξq (εq ) = 0
                                                                                           (38)
                                           Vξq (εq ) = Σq

Σq establishes the variance structure of the vector εq . The previous relationships
can also be described by a joint superpopulation model ξ such that

                               Y       =      X      β      +     ε
                             (N ×Q)         (N ×P )(P ×Q)       (N ×Q)


    Note that this approach suggests that Y, X and ε are random matrices (Gupta
& Nagar 2000) defined in the superpopulation model ξ, of which YU and XU
are supposed to be the outcomes. More precisely, the model ξ has the following
features:
                        Eξ (ε) =       0
                                   (N ×Q)
                                                                                          (39)
                    Vξ (vec ε) =       Σ          = diag Σ1 , Σ2 , . . . , ΣQ
                                   (N Q×N Q)


   Note that the subindex ξ refers to the expectation under the assumed working
model. In practical situations, it is often common to take Σq = σq2 diag(c1q , . . . , cN q ),
where ckq = fq (xk1 , . . . , xkP ) and fq is a real-valued function.

                                              Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                         87

    The problem of estimating β is considered briefly. Let D(X) be a translation-
invariant measure of dispersion such that D(X + K) = D(X), with K a matrix
of constants. Then the estimation of B will be the matrix that minimizes the
measure of dispersion. Particularly, D(·) could be given by the multivariate total
variance defined as
                           trace(Y − Xβ)0 (Y − Xβ)                            (40)

   By using the least squares method, (40) is minimized by the following choice
                                                      
                             B = B1 , B2 , . . . , BQ                       (41)

where                                        −1               
                         Bq = X0U Σ−1
                                   q XU            X0U Σ−1
                                                        q YU                         (42)


4.2. Classical Information
    In real applications, just one sample is drawn from a finite population and it
is not possible to compute B. Then, it must be estimated with the information
available in the sample. It can be shown that an asymptotically unbiased estimator
of B is given by                                           
                               b = B
                               B           c2 , . . . , B
                                      c1 , B            d Q                   (43)

where
                          cq = (X0 A−1 Xs )−1 (X0 A−1 Ys )
                          B                                                          (44)
                                 s q            s q

q = 1, . . . , Q, Xs is defined similarly to (5) and

                                   Aq = Π1/2 Σq Π1/2                                 (45)

    Hence, the multiple generalized regression estimator of the population total is
defined by                                             
                          btMgreg = b
                                    tyπ + Bb 0 tx − b
                                                    txπ                       (46)

with, btyπ , b
             txπ the Horvitz-Thompson estimators of ty and tx , respectively. Note
     b q could also be written as
that B

                       b q = (X0 Dλ Xs )−1 Xs Dλ Ys
                       B       s
                                           !−1               !
                              X       q 0
                                                X       q 0
                                                                                     (47)
                           =      xk λk xk          xk λk yk
                                k∈s                k∈s

where Dλ = diag(λq1 , . . . , λqn ) and λqk some real-valued function of the probabilities
of inclusion and the auxiliary information. Note that the model ξ serves as a vehicle
for finding an appropriate general regression estimator. Once the estimator is
found, the model is no longer of use. The properties of the multiple generalized
regression estimator (expectation and variance) are still derived from a design
based perspective.

                                         Revista Colombiana de Estadística 32 (2009) 79–97

88                                                                  Hugo Andrés Gutiérrez

4.2.1. Some Particular Cases

    All of the following cases are enounced under a general assumption. Then, sev-
eral special cases of the multiple generalized regression estimator are distinguished,
depending on the choice of the values of λk .

     • If P = 1, xk = xk , and λqk = (πk xk )−1 , we have the ratio estimator for each
       characteristic of interest,
     • If P = 2, xk = (1, xk )0 , and λqk = (πk )−1 , we have the classical simple
       regression estimator,
     • If P = M (number of post-strata), xk = δk = (0, . . . 0, 1, 0, . . . , 0)0 , and λqk =
       (πk )−1 , where δk represents M dummy variables (each dummy represents a
       post-stratum membership), we have the post-stratified estimator.

   The multiple generalized regression estimator can be written in a simplified
form given by
                           b
                           tMgreg = (W0 Ys0 )1n                           (48)
where                                             
                         w11     w12    . . . w1Q
                        .        ..    ..     .. 
                        ..        .        .   . 
                                                                        
                                                  
                   W = wk1      wk2    . . . wkQ  w1    w2    . . . wQ                (49)
                                                  
                        ..        ..   ..      .. 
                        .          .       .    . 
                        wn1      wn2    . . . wnQ
                                                   0
     Note that wq = w1q , . . . , wkq , . . . , wnq is a vector of weights such that
                                                              !−1            
                  q   1               q 0
                                                 X        q 0
                wk =          1 + λk xk               xk λk xk           txπ )
                                                                   (tx − b              (50)
                     πk
                                            k∈s


    These weights are often called the calibration weights and they reproduce the
vector of totals tx when they are applied to the auxiliary information. Then, W
is called the calibration matrix. It is not difficult to show that
                              X q
                                  wk xk = X0s wq = tx                        (51)
                                  k∈s

for all q = 1, . . . , Q. It is very interesting to see that tx is calibrated under different
choices of wq ’s. On the other hand, note that
                                                                         
                                                                tx − btxπ
                                                           −1
                       wq = Π−1 1n + Aq Xs (X0s Aq Xs )                                  (52)

   In the post-stratified estimation, a generalized inverse must be used; however,
the multiple generalized regression estimator is invariant to the choice of the in-
verse.

                                           Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                            89

4.3. Joint Auxiliary Information
    The least squares method is not the only way to obtain a multiple regression
estimator. In this subsection, it is supposed that a joint information matrix could
be constructed by means of
                                                                               
                    y11        y12   ...    y1Q       x11     x12    ...    x1P
                   y21        y22   ...    y2Q       x21     x22    ...    x2P 
                                                                               
                V= .           ..   ..      ..        ..      ..    ..      ..        (53)
                   ..           .      .     .         .       .       .     . 
                         yn1   yn2   . . . ynQ        xn1     xn2    . . . xnP
   The estimator of the vector of totals of both, characteristics of interest and
auxiliary information, is given by btvπ , defined as
                                     b
                                     tvπ = V0 Π−1 1n                                    (54)

   Then, let us suppose that b
                             tvπ has a multivariate normal distribution with mean
                                                    0
                          E btvπ = tv = t0Yπ , t0Xπ

and covariance matrix given by
                                                                      
                              V btyπ                      C btyπ , btxπ
                       tvπ =  
                     V b                                         
                               C btyπ , btxπ                 V b txπ
         
where V b tyπ is a symmetric matrix such that the jth element of its diagonal is
given by the variance of b
                         ty j π
                                       XX     yjk yjl
                           V b   ty j π =   ∆kl
                                                πk πl
                                                  U

                                                              tyi π and b
and the off-diagonal element ij is given by the covariance of b         ty j π ,
                                          XX      yik yjl
                        C bty i π , b
                                    ty j π =    ∆kl
                                                    πk πl
                                                      U
                                           
V btxπ is similarly defined, and C btyπ , btxπ , not necessarily symmetric, is such
                                                  tyi π and b
that the element ij is given by the covariance of b         tx j π
                                          XX     yik xjl
                          C btyi π, b
                                    tx j π =   ∆kl
                                                   πk πl
                                                      U

    According to the multivariate inference for normal populations, the conditional
                tYπ given b
distribution of b          tXπ follows a multivariate normal distribution with a
conditional mean given by
                                             −1              
            E b      txπ = tyπ + C btyπ , btxπ V b
               tyπ | b                              txπ      tx − b
                                                                  txπ          (55)


                                            Revista Colombiana de Estadística 32 (2009) 79–97

90                                                              Hugo Andrés Gutiérrez

and a conditional variance given by
                                            −1             
              tyπ | b
            V b             tyπ − C btyπ , btxπ V b
                    txπ = V b                      txπ  C btxπ , btyπ              (56)

     Note that 55 and (56) are unbiasedly estimated by
                                              −1           
                   b           b b
                   ty = btyπ + C  tyπ , btxπ Vb btxπ    tx − btxπ
                                                                                 (57)
                               b tx − b
                      = btyπ + B          txπ

and,
                                          −1             
             Vb b      tYπ − C b
                ty = V b        tYπ , btXπ V btXπ     C btXπ , btYπ                (58)

respectively. Note that (58) looks like the multiple regression estimator. However,
           b is different. While the slope of the latter is given by the use of
its slope, B,
the least squares method, the slope of the first corresponds to a set of multiple
regressions of X over Y. This estimator of the total should be called a multiple
optimal regression estimator and has been studied by Cassady & Valiant (1993)
in a model based context for the estimation of a total of a single characteristic of
interest.


5. A Numerical Example
    In this section, an example of the multiparameter approach is considered. In the
design stage, an optimal sampling design must be chosen and the Holmberg’s ap-
proach (Holmberg 2002b) is used. In the estimation stage the matricial approach,
proposed in the preceding sections, is used. Both, the design and estimation stages
are implemented using the statistical software R. Specifically the package sampling
is used in selecting the sample and estimating several parameters in domains of
interest.
   For this purpose, a realistic population is used (the population of Swedish
municipalities MU281 available in appendix B in Särndal et al. (1992)). This
way, it is possible to plan a multiparameter survey, where auxiliary variables and
domains are supplied, and where it is feasible to have some kind of beliefs about
the validity of the relationships between the study variables and the auxiliary
variables. The main issue of this section is not focused on planning a perfect
sampling design, but on illustrating the performance (design and estimation) of a
multiparameter survey.
     The study variables are:
       y1    =   P85       (1985 population)
       y2    =   RMT85     (Revenues from the 1985 municipal taxation)
       y3    =   REV84     (Real state values according to 1984 assessment)

     The auxiliary variables are:

                                       Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                          91

       x1     =     P75   (1975 population)
       x2     =     S82   (Total number of seats in the municipal council in 1982)
    For domain estimation the following variable is used: z=REG (Geographic
region indicator)
    The following code could be used to specify the previous features of the survey.

> library(sampling)
> data(MU284)
> MU281 <- MU284[MU284$RMT85$<=3000,]
> attach(MU281)

> Y1 <- P85
> Y2 <- RMT85
> Y3 <- REV84
> X1 <- P75
> X2 <- S82
> Z <- REG

    In order to have some kind of idea about the resulting estimations, it is useful
to know the totals of the study variables and the auxiliary variables. So, the
following code could be used to obtain such totals.

> Ty <- c(sum(Y1),sum(Y2),sum(Y3))
> Tx <- c(N,sum(X1),sum(X2))

> Ty
[1]         7033    53151 757246
> Tx
[1]         281    6818 13257


5.1. Design Stage under Holmberg’s Approach
   Let us suppose that the importance of the three study variables is the same.
A brief summary of the Holmberg’s approach is as follows:

  1. For each of the study variables, the survey statistician must propose an op-
     timal sampling design, pq (·), such that the expected sample size is Ep (ns ) =
     nq . Of course, note that all of the Q designs may differ; but even more,
     the sample sizes may not be necessarily the same. In the traditional way,
     the statistician should choose a compromise design that works well for all
     parameters to be estimated.
       In the MU281 example, the population size is N = 281, and let us suppose
       that the statistician assumes to take a sample size of 100 units for all of the
       three sampling designs. This specifications in R are as simple as follows

                   > N <- 281; n <- 100



                                          Revista Colombiana de Estadística 32 (2009) 79–97

92                                                                          Hugo Andrés Gutiérrez

     2. The design Pq (·) induces a vector of size N of inclusion probabilities for every
        unit in the population. The inclusion probabilities must take the following
        form (Holmberg 2002b, eq. 6)
                                                     σqk
                                        πqk = nq P
                                                    k∈s σqk

        with σqk size measures (usually, but not necessarily, linked to a regression
        model). Optimality is obtained if πqk ∝ σqk . Note that if the optimal
        sampling design for the qth study variable is SI, then σqk = 1 for all k ∈ U .
                                             2         γ
        On the other hand, by choosing σqk      = σq2 xqkq , where σq2 is a constant and
        xqk is the value of the kth unit for some auxiliary variable, then the optimal
                                                                                    γ /2
        sampling design is a probability proportional to size (πPS) with πqk ∝ xqkq .
        Let us suppose that the statistician is confident that the best optimal sam-
        pling designs, for the study variables of the MU281 population, are: For y1 ,
        a πPS design with π1k ∝ x0.71k . For y2 , a πps design with π2k ∝ x1k . For y3 ,
        a SI design with π3k = 100/281. The R code is as follows

                > sigy1 <- sqrt(X1^(1.4))
                > sigy2 <- sqrt(X1^(2))
                > sigy3 <- rep(1,N)

                > pik1 <- n*sigy1/(sum(sigy1))
                > pik2 <- n*sigy2/(sum(sigy2))
                > pik3 <- n*sigy3/(sum(sigy3))


     3. Based on the criterion of minimum anticipated overall relative efficiency loss
        (ANOREL), the optimal sample size for the multiparameter case is given by
                                              P √ 2
                                                 aqk
                                                  k∈U
                                   ∗
                                  n ≥           P
                                      (1 + c)Q + k∈U aqk

        where
                                        Q
                                        X                2
                                                        σqk
                                aqk =         P                  
                                                         1             2
                                        q=1   k∈U       πqk − 1       σqk

        and c is the maximum error allowed based on the ANOREL criterion. Note
                           2
        that in practice, σqk  is unattainable and it must be written as a function
        of an auxiliary variable. Holmberg (2002b) claims that subject knowledge,
        guesses, or previous survey estimates can be used as planning values for this
        quantity.
        In the MU281 example, the optimal sample size based on the ANOREL
        criterion under the multiparameter case is n∗ = 108. The R code is as
        follows

                                          Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                     93

            > a1 <- sigy1^2/(sum(((1/pik1)-1)*sigy1^2))
            > a2 <- sigy2^2/(sum(((1/pik2)-1)*sigy2^2))
            > a3 <- sigy3^2/(sum(((1/pik3)-1)*sigy3^2))
            > aqk <- a1+a2+a3

            > n.st <- ((sum(sqrt(aqk)))^2)/((1+0.03)*3+(sum(aqk)))
            > n.st <- as.integer(n.st)
            [1] 108


  4. Once the sample size is computed, a new vector of optimal inclusion prob-
     abilities for all of the study variables is created. This vector is induced by
     a general sampling design, which minimizes the anticipated overall relative
     efficiency loss, and it is given by
                                                  √
                                               n∗ aqk
                                   π(opt)k = P      √                          (59)
                                               k∈U   aqk

     In the MU281 example, the optimal vector of inclusion probabilities is given
     by the following code

            > pikopt <- n.st*sqrt(aqk)/sum(sqrt(aqk))
            > sum(pikopt) == n.st
            [1] TRUE

  5. In most cases, the resulting π(opt)k is a vector of unequal inclusion probabil-
     ities. In this situation a πps selection scheme must be performed in order to
     select the sample.
     In the MU281 example, let us suppose that the statistician recommends an
     order sampling (unequal probabilities, without replacement and fixed sample
     size) to be performed. The function UPopips of the sampling package selects
     a sample with the previous features and after the sample has been drawn,
     the function getdata extracts the observed data.

            > sam <- UPopips(pikopt,"exponential")
            > getdata(MU281,sam)
                LABEL P85 P75 RMT85 CS82 SS82 S82 ME84 REV84 REG CL
                   74 17 18     113    8   20 49 784 1733      3 13
                  184 12 11      82    6   25 41 646     935   6 33

                     ...


5.2. Estimation Stage under Multiparameter Approach
   Once the sample is selected, the statistician is faced with the estimation of
several parameters of interest. It is possible to write a code of estimation for

                                     Revista Colombiana de Estadística 32 (2009) 79–97

94                                                               Hugo Andrés Gutiérrez

every single study variable (the traditional way) or it is possible to write a simple
matricial code using the proposed approach in this paper. Even though it is not
the issue here, the gain in computational efficiency is not negligible. Besides, if
the design stage is planned in a multiparameter context, then the estimation stage
should be carried out in the same way.
     In the MU281 example, with the new optimal inclusion probabilities, π(opt)k ,
the HT estimator of the total of study variables, ty , the total of auxiliary variables,
tx , and population size, N , given by (7) and (13), is computed by means of the
following code:

> Ys <- cbind(Y1,Y2,Y3)[sam,]
> Xs <- cbind(1,X1,X2)[sam,]
> PI <- diag(pikopt[sam])
> ones <- rep(1,n.st)

> TyHT <- t(Ys)%*%solve(PI)%*%ones
> TxHT <- t(Xs)%*%solve(PI)%*%ones
> NHT <- t(ones)%*%solve(PI)%*%ones

    The result of the previous computation is a vector of estimated totals; in par-
ticular, the HT estimation of the total of study variables is given by

> TyHT
         [,1]
Y1   6603.514
Y2 49078.942
Y3 719565.860

    If a domain is involved in the estimation stage, the matricial approach gives
a simple and comprehensive method of estimation. In the MU281 example, the
domain of interest corresponds to the REG variable which has 8 categories or ge-
ographic regions. Then, a discriminated estimation for all of the three study
variables is needed for each domain. By using the disjunctive function of the
sampling package, it is possible to create the indicator matrix of domain mem-
bership given by (20) and to obtain the corresponding estimates of (24) and (25).

> Z <- disjunctive(Z)[sam,]
> NdHT <- t(Z)%*%solve(PI)%*%ones
> Ty1d <- t(Ys[,1]*Z)%*%solve(PI)%*%ones
> Ty2d <- t(Ys[,2]*Z)%*%solve(PI)%*%ones
> Ty3d <- t(Ys[,3]*Z)%*%solve(PI)%*%ones

    It is feasible to summarize the estimations by means of a simple data frame,
as follows:

> TydHT <- data.frame(NdHT,Ty1d,Ty2d,Ty3d)

                                        Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                            95

> TydHT
      NdHT         Ty1d           Ty2d                Ty3d
1    24.17      1045.85        8711.74           109849.38
2    51.50       895.17        6707.68            90645.23
3    29.86       594.90        4449.43            60348.27
4    49.13      1072.34        7235.20           104268.22
5    64.01      1394.64        9930.63           142899.69
6    40.50       730.81        5521.88            78599.09
7     6.44       207.89        1560.50            22637.41
8    51.79       661.88        4961.85           110318.56

    If the statistician suspects that a model-assisted approach can be used, then
a relationship between the study variables and the auxiliary information must
be established by means of a working model. In the MU281 example, there are
three models, ξq (q=1,2,3), involved in a general superpopulation model ξ. The
relationships are as follows

                  Yq = βq0 + βq1 X1 + βq2 X2 + εi            q = 1, 2, 3             (60)

   Note that Eξi (εi ) = 0 and the structure of variance of the preceding models is
induced by step two of the design stage and it is given by


                        Σ1 = σ12 diag(x11 , x12 , . . . , x1N )1.4
                        Σ2 = σ22 diag(x11 , x12 , . . . , x1N )2
                        Σ3 = σ32 IN ×N

    Then, the general model takes the following form

                                                                                   
  Y11    Y21   Y31      1     X11     X21                             ε11   ε21   ε31
 Y12    Y22   Y32    1     X12     X22  β10        β20    β30      ε12   ε22   ε32 
                                                                                  
 .       ..    ..  =  ..    ..      ..  β11        β21    β31  +  .      ..    .. 
 ..       .     .  .         .       .  β                          ..      .     . 
                                              12       β22    β32
  Y1N    Y2N   Y3N        1 X1N       X2N                               ε1N   ε2N   ε3N

    In this way, the estimation of the finite population matrix of regression coeffi-
cients, involving the variance structure of each model, given by (43) is computed
by means of the following code

> A1 <- diag(pikopt[sam]*Xs[,2]^(1.4))
> B1 <- (solve(t(Xs)%*%A1%*%Xs))%*%(t(Xs)%*%A1%*%Ys[,1])
> A2 <- diag(pikopt[sam]*Xs[,2]^(2))
> B2 <- (solve(t(Xs)%*%A2%*%Xs))%*%(t(Xs)%*%A2%*%Ys[,2])
> A3 <- diag(pikopt[sam])
> B3 <- (solve(t(Xs)%*%A3%*%Xs))%*%(t(Xs)%*%A3%*%Ys[,3])

                                        Revista Colombiana de Estadística 32 (2009) 79–97

96                                                              Hugo Andrés Gutiérrez



> B <- matrix(c(B1,B2,B3),ncol=3,nrow=3)
> B
                [,1]            [,2]          [,3]
[1,]     -1.20582067     -25.5012341     868.01938
[2,]      1.05356147       8.3134903     104.90848
[3,]      0.01756820       0.4836855     -15.78483

   The next step is to implement the multiple generalized regression estimator
given by (46). The computational code requires just a line and it is given by

> TyMgreg <- TyHT+t(B)%*%(Tx - TxHT )
> TyMgreg
         [,1]
Y1   7079.411
Y2 53028.236
Y3 750689.737
    The multiple generalized regression estimator can take different forms. Among
others, it could be written in the simplified form given by (48). However, it is
necessary to compute the calibration matrix given by (49). In R, it can be done
as follows
> w1 <- solve(PI)%*%ones + (A1%*%Xs)%*%(solve(t(Xs)%*%A1%*%Xs))%*%(Tx - TxHT)
> w2 <- solve(PI)%*%ones + (A2%*%Xs)%*%(solve(t(Xs)%*%A2%*%Xs))%*%(Tx - TxHT)
> w3 <- solve(PI)%*%ones + (A3%*%Xs)%*%(solve(t(Xs)%*%A3%*%Xs))%*%(Tx - TxHT)
> W <- cbind(w1,w2,w3)

> TyMgreg <- t(W*Ys)%*%ones
> TyMgreg
          [,1]
Y1   7079.411
Y2 53028.236
Y3 750689.737

   The calibration principle given by (51) can be verified easily for each column of
the calibration matrix. Particularly for the second column this principle remains.

> t(w2)%*%Xs
           X1    X2
[1,] 281 6818 13257

    This section has shown how to perform a multiparameter survey by using the
Holmberg’s approach, in the design stage, and the matricial approach, in the
estimation stage, as proposed in this paper.


6. Conclusions
    When planning a survey, the traditional way focuses the sampling design on
a single study variable, which is insufficient for the practising survey statistician,

                                       Revista Colombiana de Estadística 32 (2009) 79–97

Estimation Stage in Survey Sampling: A Multiparameter Approach                     97

having to deal with several parameters of interest. In this paper, a potentially
useful approach in the estimation stage is presented by means of the matricial
perspective. The author stresses that more attention should be paid to the joint
estimation of the parameters of interest in multipurpose surveys. This way, sig-
nificant advantages will be achieved, in practical and theoretical aspects, through
a comprehensive approach of joint estimation in survey sampling that offers a
powerful way of estimation in multipurpose surveys.
   Apart from the computational advantages, this approach should be used in
order to introduce advanced topics in survey sampling such as the generalized
weight share method proposed by Lavallée & Caron (2001).
   Further work should be focused on the interpretation and use of covariances
among the estimators of the parameters of interest as a vehicle for improving the
planning, execution and estimation in business surveys.
References
Cassady, R. J. & Valiant, R. (1993), ‘Conditional Properties of Poststratified Estimators under Normal Theory’, Survey Methodology 19, 183–192.
Gupta, A. K. & Nagar, D. K. (2000), Matrix Variate Distributions, Chapmann and Hall, New York, United States.
Holmberg, A. (2002a), ‘A Multiparameter Perspective on the Choice of Sampling Design in Surveys’, Statistics in Transition 5, 969–994.
Holmberg, A. (2002b), On the Choice of Sampling Design under GREG Estimation in Multiparameter Surveys, Technical Report 1, RD Department, Statistics Sweden, SE-701 89 Örebro, Sweden.
Lavallée, P. & Caron, P. (2001), ‘Estimation Using the Generalized Weigth Share Method: The use of Record Linkage’, Survey Methodology 27, 155–169.
R Development Core Team (2008), R: A Language and Environment for Statistical Computing, R Foundation for Statistical Computing, Vienna, Austria. ISBN 3-900051-07-0.*http://www.R-project.org
Särndal, C. E., Swensson, B. & Wretman, J. (1992), Model Assisted Survey Sampling, Springer, New York, United States.
Tillé, Y. & Matei, A. (2008), Sampling: Survey Sampling. R package version 2.0