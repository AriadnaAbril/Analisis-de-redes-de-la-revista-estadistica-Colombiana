Imputación de datos en diseños switchback usando un modelo mixto con errores correlacionados
Universidad Nacional de Colombia
Resumen
Se trata el problema de imputar mediciones individuales en datos provenientes de diseños switchback con errores correlacionados, teniendo en cuenta la propuesta de Barroso et al. (1998), donde se considera el BLUP (Best Linear Unbiased Predictor ) para la imputación de datos. Se hizo uso de los valores propios de las matrices de cuadrados medios de los errores de las predicciones para comparar las estructuras de covarianza σ 2 I, AR(1) y CS asociadas a los errores. Los resultados sugieren que las dos primeras estructuras son más adecuadas que la tercera.
Palabras clave: datos faltantes, mı́nimos cuadrados generalizados, BLUP, estructura de covarianza.
Introducción
En muchas situaciones experimentales, la misma unidad experimental recibe dos o más tratamientos en periodos diferentes; cuando esto sucede, el diseño experimental se conoce como crossover, el cual puede estudiarse en Jones & Kenward (2003).
    Un caso especial, el cual constituye la base de este trabajo, es el diseño switch-
back : en este caso se aplican dos tratamientos a un mismo individuo durante tres
periodos; en el primero y el tercero se aplica el mismo tratamiento mientras que en
el segundo se aplica otro tratamiento; es decir, se presentan las secuencias ABA
o BAB, siendo A y B los tratamientos. Este diseño es uniforme en periodos, pero
no en sujetos.
    El uso más frecuente de estos diseños se encuentra en los ensayos clı́nicos
(Ebbutt 1984), ensayos de bioequivalencia (Jones & Kenward 2003) y experimentos
con ganado lechero (Oman & Seiden 1988, Li 1995, Macchiavelli 1997, Tempelman
2004); la mayorı́a de los análisis se hacen sobre datos completos.
    Matthews (1988) señala que se ha dedicado poca atención en la literatura a
los datos faltantes en los diseños crossover y aún menos en diseños switchback ;
esto sigue ocurriendo en la literatura posterior consultada. El objetivo del pre-
sente trabajo es imputar datos individuales en ensayos provenientes de diseños
switchback ; se proponen dos estrategias de imputación, las cuales son adaptación
y modificación de dos propuestas de la literatura: la primera propuesta por Yates
(1933), usando regresión lineal simple y efectos fijos; y la segunda por Barroso
et al. (1998), usando modelos mixtos y errores correlacionados para tres diferentes
estructuras de covarianza.


2.     Datos completos en diseño switchback
    El análisis Estadístico de datos completos lo inició Lucas (1956). Inicialmente
hizo un ensayo donde comparaba tres dietas A, B, y C, en 12 vacas, agrupadas
en tres bloques, uno de tamaño 6 y dos de tamaño 3. La variable respuesta fue
la producción de leche (en promedio), corregida por grasa, durante tres periodos
de cinco semanas cada uno. Entre cada periodo se dejó un espacio de una semana
como tiempo wash-out, con lo cual, para efectos del modelo, no necesita tenerse
en cuenta el efecto carry-over o de rezago. En el momento de analizar los datos, el
ensayo no habı́a terminado, por tanto, Lucas simuló los datos para los regı́menes
de tratamiento ABA, BAB, ACA, CAC, BCB y CBC. Los 36 valores simulados
se presentan en la tabla 2.
    El análisis de datos de Lucas se basó en el método de diferencias entre los
periodos para cada vaca: D = Y1 − 2Y2 + Y3 , siendo Yi la respuesta (producción)
en el i-ésimo periodo, i = 1, 2, 3. Con base en los valores de D en los tres bloques
obtuvo la tabla ANOVA, considerando un modelo de efectos fijos y errores inde-
pendientes. Oman & Seiden (1988) presentan la construcción de diseños switchback
con base en cuadros latinos cı́clicos y teorı́a de grafos; adicionalmente comparan


                                     Revista Colombiana de Estadística 29 (2006) 221–238

Imputación de datos switchback en modelo mixto con errores correlacionados           223


algunos diseños y sugieren el switchback para el caso en que las variaciones de
las curvas de respuesta se consideren importantes; reanalizaron los datos de Lucas
con un modelo que incluye periodo, tratamiento y añade los efectos producción
promedio y curva de lactancia de cada vaca, todos considerados efectos fijos; sin
embargo, en las expresiones de sumas de cuadrados dejan abierta la opción de con-
siderar como aleatorio el efecto de curva de lactancia. Los errores se consideraron
independientes.
    Li (1995) reanalizó los datos de Lucas (1956) aportando la presentación de
las expresiones matriciales del ANOVA por medio de IML (Interactive Matrix
Language) de SAS y la propuesta de considerar matrices de covarianza para los
errores.
    Macchiavelli (1997) adiciona, al trabajo de Li (1995), la consideración de un
modelo mixto con errores correlacionados, teniendo como efectos aleatorios bloque,
vaca y pendiente de la curva de lactancia; en la estimación y pruebas de hipótesis
considera las estructuras de covarianza σ 2 I (independencia), AR(1) (autorregresiva
de orden 1 ) y CS (Compound Symmetry). Utilizó el Procedure Mixed de SAS para
las estimaciones y los contrastes de hipótesis.



3.     Datos faltantes en diseño switchback
    De acuerdo con la naturaleza del diseño switchback, los principales problemas
que origina la información faltante son los siguientes: pérdida de ortogonalidad,
estimación sesgada y un cálculo inapropiado de las sumas de cuadrados.
    El primer problema se debe a que un sujeto con el régimen de tratamiento ABA
y un dato faltante ya no podrı́a compararse con otro sujeto con el tratamiento BAB,
pues los valores de la respuesta del primero serı́an de una de las formas (Y1 , Y2 , ◦),
(Y1 , ◦, Y3 ), (◦, Y2 , Y3 ), donde ◦ indica dato faltante.
    De otro lado, el sesgo de los análisis de datos incompletos ya ha sido discutido
por varios autores; se destaca principalmente a Little & Rubin (2002) y Richardson
& Flack (1996); estos últimos, después de analizar solo los casos completos de
un diseño switchback, encontraron los sesgos de dicho análisis y en la discusión
afirman que deberı́a evitarse el análisis de los casos completos en presencia de
datos faltantes en los estudios.
    Finalmente, cuando faltan datos, las sumas de cuadrados y los Estadísticos de
prueba tradicionales ya no son adecuados (Little & Rubin 2002).
    La primera consideración de datos faltantes en el diseño switchback se hace
en Lucas (1956); allı́ propone una fórmula para imputar un dato, pero el proceso
de imputación presenta dos situaciones inadecuadas: i) La fórmula presentada no
imputa el dato faltante en sı́, lo que hace es completar, para el sujeto del dato
faltante, el valor de una transformación, y ii) la propuesta se hace únicamente
para modelo de efectos fijos y errores independientes. Li (1964) imputó datos de
diseños switchback usando métodos de cuadros latinos y bloques aleatorizados,
pero no consideró efectos aleatorios.


                                      Revista Colombiana de Estadística 29 (2006) 221–238

224                                             Luis Fernando Grajales & Luis Alberto López


    A nivel general, en otros diseños, la imputación de datos usando regresión
y ANOVA, la literatura es bastante amplia. Se resaltan los trabajos de Yates
(1933), el cual se adapta en este estudio; Carriere (1994) analiza medidas repetidas
incompletas, considerando el diseño crossover con las secuencias ABB y BAA y
pérdidas dropout (caso donde la información falta en el último periodo); toma en
cuenta únicamente el modelo de efectos fijos. En Barroso et al. (1998) se propone
una metodologı́a para la imputación con modelo mixto y errores correlacionados,
la cual también se adaptó en el presente trabajo.
    Con base en las dos secciones anteriores se tomaron los elementos para proponer
la imputación de datos en el diseño switchback. Esto se detallará en la sección 5.
En la siguiente sección se presentan la notación y el modelo que se utilizarán.


4.      Modelo y notación
4.1.     El modelo mixto
     El modelo propuesto para este trabajo es el siguiente:

                         yijk = µ + πi + τj + ck + (i − 2)sk + εijk                          (1)

donde:

       yijk hace referencia a la producción de leche de la k-ésima vaca, después de
       recibir la j-ésima dieta, en el i-ésimo periodo.
       i, j = 1, 2, 3 y k = 1, . . . , 12.
       µ es la media global.
       πi es el efecto del i-ésimo periodo, i = 1, 2, 3.
       τj es el efecto del j-ésimo tratamiento, j = 1, 2, 3.
       ck y sk son, respectivamente, el intercepto y la pendiente de la curva de
       lactancia de la k-ésima vaca, y
       εijk es un término de error aleatorio para la k-ésima vaca, después de recibir
       la j-ésima dieta, en el i-ésimo periodo.

    En el modelo (1) los efectos µ, πi y τj se consideran fijos y los efectos ck y
sk se consideran aleatorios. La escritura i − 2 garantiza la ortogonalidad entre las
filas de la matriz diseño que se asociará más adelante a los efectos aleatorios; ver
detalles en Macchiavelli (1997).
    Matricialmente, el modelo (1) se escribe como:

                                      Y = X0 β0 + Zγ + ξ                                     (2)




                                             Revista Colombiana de Estadística 29 (2006) 221–238

Imputación de datos switchback en modelo mixto con errores correlacionados               225



donde:

      Y es el vector de respuesta.
      X0 es la matriz diseño asociada con los efectos fijos.
      β0 = [µ π1     π2   π3   τ1    τ2       τ3 ]t es un vector desconocido de efectos fijos.
      Z es la matriz diseño asociada a los efectos aleatorios.
      γ un vector, desconocido, de efectos aleatorios, y
      ξ es el vector de errores aleatorios no observados.

   Por facilidad en el análisis, el modelo (2) se reparametrizó en el modelo

                                    Y = Xβ + Zγ + ξ                                       (3)

   La matriz X va a ser de tamaño 36 × 5, con
                                                                
                          β t = µ φ1 φ2 θ1                  θ2

donde los nuevos parámetros son: φ1 = π1 − π2                   φ2 = π2 − π3   θ1 = τ1 − τ2
θ2 = τ2 − τ3 .
   En el modelo (3) se supone que:

  a) Los vectores γ y ξ siguen una distribución normal.
  b) El vector de respuestas Y tiene distribución normal multivariada con vector
     de medias y matriz de covarianzas dados por las expresiones:

                    E[Y ] = Xβ            y       V ar[Y ] = V = ZGZ t + R                (4)

   donde G y R son matrices no singulares, simétricas y desconocidas.
   El tercer supuesto es que, conjuntamente, γ y ξ tienen distribución normal,
con vector de medias y matriz de covarianzas dados por:
                                                   
                        γ      0             γ      G 0
                     E     =        y V ar      =                           (5)
                        ε      0             ε      0 R

   Como se observa en el modelo (4), la matriz V se puede modelar tomando la
matriz diseño Z de efectos aleatorios y especificando las estructuras de covarianza
para las matrices G y R. Teniendo en cuenta (4), la matriz V , para cada vaca,
cumple:
                                                
                                          1 −1                   
                                                       1 1 1
            V ar Y1jk Y2jk Y3jk = 1           0  Gk               + Rk
                                                        −1 0 1
                                          1    1

                                       Revista Colombiana de Estadística 29 (2006) 221–238

226                                            Luis Fernando Grajales & Luis Alberto López


donde:                                                                   
                               1 1     1                        σc2   σcs
                      Zkt =                      y   Gk =
                              −1 0     1                        σcs   σs2

    Los componentes de la matriz no-estructurada Gk son: σc2 , varianza del inter-
cepto; σs2 , varianza de la pendiente de la curva de lactancia, y σcs , covarianza entre
el intercepto y la pendiente.
    Finalmente, en (4), para la matriz de errores, Rk , se consideraron en este
trabajo las siguientes estructuras, para cada vaca:
           2                                                                          
           σε   0     0                         1      ρ    ρ2                   1   ρ   ρ
  σε2 I =  0   σε2   0          AR(1) = σε2  ρ      1    ρ         CS = σε2 ρ   1   ρ
            0   0     σε2                      ρ2      ρ    1                    ρ   ρ   1


4.2.     Ecuaciones de estimación
    Dado que una forma de imputación usada en este trabajo se hace a través del
BLUP, es necesario caracterizar las ecuaciones de estimación tanto de la parte
fija como de la aleatoria. Si se tiene en cuenta el modelo (3), bajo el supuesto de
normalidad, la función de densidad conjunta f (y, β, γ) es:

     N +q         1
                         h 1                                  1          i
(2π)− 2 (|R||G|)− 2 × exp − (y − Xβ − Zγ)t R−1 (y − Xβ − Zγ) − γ t G−1 γ
                           2                                  2

   Al derivar parcialmente el logaritmo de la función de verosimilitud con respecto
a β y γ e igualar a cero se obtienen las dos soluciones:
                         −1 t −1
         βb = X t V −1 X    X V
               t −1
                              −1  t −1                                  
         γ = Z R Z + G−1
         b                         Z R − Z t R−1 X(X t V −1 X)−1 X t V −1

    Generalmente no se conocen G ni R y deben estimarse a partir de los da-
tos. En este trabajo se escogen matrices de acuerdo con la literatura para poder
comparar los resultados: para G, una matriz no-estructurada y, para la matriz
R, estructuras σ 2 I, AR(1) y CS. Sin embargo, existen muchos textos y métodos
en la literatura para encontrar estas estimaciones; se destacan principalmente los
métodos MIVQUE0, ML y REML (Restricted Estimation Maximum Likelihood ),
los cuales pueden estudiarse en Searle et al. (1992).
    En el procedimiento Mixed de SAS (2005) se usan los valores iniciales de MIV-
QUE0 para conseguir las estimaciones del REML. El proceso de estimación depen-
de del conocimiento que se tenga de la estructura de la matriz de covarianza; en
Wolfinger (1993) se presentan diferentes estrategias para tomar una decisión sobre
la estructura más adecuada; en la comparación y elección de estas estructuras se
puede hacer uso del criterio de información de Akaike (AIC), el criterio bayesiano
de Schwarz (BIC) y el criterio basado en el error cuadrado medio (ECM) de los
BLUP. En el presente trabajo se utilizó este último.


                                        Revista Colombiana de Estadística 29 (2006) 221–238

Imputación de datos switchback en modelo mixto con errores correlacionados                 227


    En la sección siguiente se presenta la metodologı́a utilizada en el trabajo que
consiste en simulación de datos, posteriormente la eliminación, para finalizar con
la imputación de datos.


5.     Metodologı́a
    Muchos detalles de la metodologı́a completa del trabajo no pueden darse acá. El
trabajo de simulación, eliminación de datos e imputación se realizó con el paquete
Estadístico SAS; los detalles de programación en IM L y Mixed pueden hallarse en
Grajales (2006); el proceso se presenta a continuación.


5.1.     Proceso de simulación
    En el proceso de simulación se utilizaron algunos valores de medias y varianzas
hallados en la literatura de referencia, especialmente los trabajos de Oman & Sei-
den (1988) y Macchiavelli (1997). En la simulación se llevaron a cabo los siguientes
pasos:

  1. Se generó un vector Y , de tamaño 36 × 1, el cual se supone que se distribuye
                                                                     t
     normal con vector de medias [µ1 µ2 µ3 ] = [40 35 30] y matriz de
     covarianzas
                                                               t
                   V ar(Y ) = V36×36 = R36×36 + Z36×72 G72×72 Z72×36

       donde: Z = [Z1 Z2 ]       con:

                                                                               
                          O 1           1 1                       O −1 0         1
                 Z1 = I12  1           1 1        y    Z2 = I12  −1 0         1
                            1           1 1                         −1 0         1

                                                                     N
                                                      
                                                         GC = 58 I12 I3
                                                                         N
                           GC    GCS
                  G=                          con         GCS = (−0.6) I12 I3
                           GCS   GS                     
                                                                       N
                                                        
                                                          GS = (0.9) I12 I3
       N
           indica el producto Kronecker.
       Esto se realizó para las tres matrices de correlación de errores: R = σ 2 I36 ,
       AR(1) y CS.

  2. Se simularon los 108 datos (36 valores para cada tipo de error), los cuales se
     muestran en la tabla 3.
       Los datos de Lucas (1956) se usan como ejemplo para la aplicación.


                                            Revista Colombiana de Estadística 29 (2006) 221–238

228                                              Luis Fernando Grajales & Luis Alberto López


5.2.    Eliminación MCAR de datos
    Para cada estructura de covarianza de los errores, con los 36 datos simulados,
se eliminó un dato a la vez, de la variable respuesta. De esta forma se obtuvieron
36 bases de datos, de 35 individuos cada una. Acá se considera el mecanismo
MCAR (Missing completely at random) para eliminación de datos. La idea básica
del mecanismo es que el dato faltante no depende de los valores presentes de la
variable respuesta; véase Little & Rubin (2002).


5.3.    Método de imputación de Yates
     El método considera que si falta una observación en la variable respuesta, dı́gase
yk , entonces se debe: a) estimar βb∗ en la información completa, y b) imputar el
dato faltante mediante la expresión ybk = Xk βb∗ .
     La justificación del procedimiento se basa en dos ventajas: i) produce estima-
ciones correctas de β, vı́a mı́nimos cuadrados, y ii) se logra una estimación correcta
de la suma de cuadrados de los errores.
     Además, aunque el método de Yates produce estimaciones sesgadas de la ma-
triz de covarianza de β, b los sesgos son relativamente menores cuando se tiene una
fracción pequeña de datos faltantes; véase Little & Rubin (2002). Como en este
trabajo se asume que hay alguna estructura de correlación de los errores, debe mo-
dificarse el método propuesto por Yates, teniendo en cuenta las matrices AR(1) y
CS. La imputación con este método se realizó asumiendo que la curva de lactancia
de cada vaca se ajusta mediante una lı́nea recta; esto se justifica porque las vacas
ingresan al estudio después del pico máximo de la curva, como se observa en la
figura 1. El modelo ajustado fue entonces ybi = b0 + b1 xi , siendo xi el tiempo y yi
la producción de leche.

                               95



                               90



                               85
                  Producción




                               80



                               75



                               70

                                    0   5   10       15      20   25      30

                                                   Semanas
             Figura 1: Ejemplos de curvas de lactancia con pico máximo.



                                            Revista Colombiana de Estadística 29 (2006) 221–238

Imputación de datos switchback en modelo mixto con errores correlacionados                 229


  Como ilustración del procedimiento, si suponemos que faltó el dato de la se-
mana 5, entonces:
         "      #                              
          βb0,5                                Y10
 i) βb5 = b       = (X5t V5−1 X5 )−1 X5t V5−1      ,
          β1,5                                 Y15
                                     
             1 10                  1 0.2
    con X5 =       y V5 = 1.2 ∗
             1 15                 0.2 1
                        "      #
                       βb0,5
 ii) Y5,pred = 1      5 b
                         β1,5

    Con errores CS, la cual coincide con la matriz V5 para los errores AR(1). Se
usaron σε2 = 1.2 y ρ = 0.2 ; estos valores se toman con base en el trabajo de
Macchiavelli (1997). Las imputaciones con el método de Yates se presentan en la
tabla 1; estas imputaciones coinciden, para los tres tipos de errores, porque las
tres matrices de covarianzas coinciden debido a que las matrices X y V son 2 × 2
e invertibles; por tanto, se cumple la siguiente relación matricial, cuyo resultado
final no depende de V :
                      −1                             −1
         X t V −1 X         X t V −1 y = X −1 V X t         X t V −1 y = X −1 Iy = X −1 y

   Finalmente, puede verse que el método de Yates solo tiene en cuenta la pen-
diente y el intercepto de la curva de lactancia, ambos como efectos fijos.


5.4.    Método de imputación de Barroso et al. (1998)
    Este método considera la imputación de datos en modelos mixtos, cuando se
presenta algún tipo de correlación de los errores.
    En el proceso de imputación, cuando se tienen m datos faltantes, el método es
el siguiente:

  1. Se parte de un modelo como el (3), con los siguientes órdenes de vectores y
     matrices:

        • y un vector de orden d × 1,
        • β un vector de tamaño p × 1, asociado a los efectos fijos,
        • γ es un vector de tamaño q × 1, asociado a los efectos aleatorios,
        • X y Z matrices conocidas, y
        • ε es el vector de errores, de orden d × 1.

  2. Las matrices G y R son definidas positivas, de rango completo, conocidas,
     con dimensiones q × q y d × d, respectivamente.


                                          Revista Colombiana de Estadística 29 (2006) 221–238

230                                      Luis Fernando Grajales & Luis Alberto López


    En el arreglo del ensayo utilizado en este trabajo, se tiene que: d = 36; p = 5;
q = 72 y m = 1.
    Adicionalmente se impone la condición que los errores correspondientes a las
mediciones observadas y faltantes no tienen correlación; supuesto que se cumple en
las condiciones del modelo del presente trabajo. El método de Barroso et al. (1998)
supone que si m de las d mediciones son faltantes, sin pérdida de generalidad, el
modelo se puede con:
                                                    
                            y        X0         Z0         ε
                       y= 0 =             β+        γ+ 0                         (6)
                           ym        Xm         Zm         εm

    La expresión (6) es similar a la que se presenta en el método de análisis de
covarianza de Bartlett (Little & Rubin 2002); sin embargo, la diferencia conceptual
consiste en que la matriz Z particionada en (6) indica la matriz diseño de los efectos
aleatorios del modelo mixto, mientras que en el método de Bartlett, la matriz Z
representa la matriz diseño de los datos faltantes. Con la notación usada en (6) se
encuentra el BLUP:

   1. Haciendo una partición de la matriz de covarianzas del vector de efectos
      aleatorios:                                 
                                  γ       G 0      0
                           V ar  ε0  =  0 R0    0  σ2
                                 εm        0 0 Rm
      donde los subı́ndices en ε y R hacen referencia a los datos observados y
      faltantes, respectivamente.
   2. Considerando la relación
                                     t        −1  
                                   γ
                                   b    γ
                                        b          γ
                                                   b      γ
                                                          b
                           ECM        =      V ar
                                   εb   εb         εb     εb

   Con estas dos relaciones, el BLUP se obtiene minimizando la forma cuadrática:
                               t  −1                                
                     γ              G      0     0             γ
                                                                    
     H =                        
           y0 − X0 β − Z0 γ   0       R0−1    0                     
                                                      y0 − X0 β − Z0 γ  (7)
            ym − Xm β − Zm γ         0     0     −1
                                                Rm     ym − Xm β − Zm γ

   La expresión (7) se simplifica al tomar la igualdad ym = Xm β − Zm γ y, por
tanto, la minimización de H sobre β, γ y ym se logra al tomar los datos observados
y ajustarles el modelo para conseguir los BLUP de β y γ.
   De esta forma se imputan los valores en ym reemplazando las cantidades des-
conocidas en ym = Xm β − Zm γ + εm por el respectivo BLUP.
   Las estimaciones, de acuerdo con Barroso et al. (1998), son ybm , βb y γ   b, las
cuales vienen dadas por:
                                   ybm = Π × Θ


                                     Revista Colombiana de Estadística 29 (2006) 221–238

Imputación de datos switchback en modelo mixto con errores correlacionados            231


donde:
                        −1  t                 −1
  Π = Im − Xm X t W −1 X      Xm − X t R−1 ZAZ t Rm  −
              t                        −1                      −1 −1
         Zm A Zm − Z t R−1 X X t W −1 X     Xmt               t
                                                 − X t R−1 ZAZm   Rm


                   −1  t                
  Θ = Xm X t W −1 X      X0 − X t R−1 ZAZ0t +
                                          −1 t                  −1
          Zm A Z0t − Z t R−1 X X t W −1 X     X0 − X t R−1 ZAZ0t   R0 y0
                −1 t −1
βb = X t W −1 X    X W yb y
                    −1 t −1                      −1 t −1 
b = Z t R−1 Z + G−1
γ                      Z R − Z t R−1 X X t W −1 X    X W    yb

   con:
                                                                                
                 t   −1    −1             1                                 y0
          A = (Z R        Z)          W = 2V               y          yb =
                                         σ                                 ybm

   La imputación de datos se realiza con la fórmula:

                                   ybm = Xm βb + Zm γ
                                                    b                                  (8)

     Estos estimadores también pueden hallarse de manera simplificada, usando
matrices indicadoras de valores observados y valores faltantes. Dicha simplificación
se utilizó en los análisis del presente trabajo. La simplificación parte de la siguiente
notación: E es la matriz indicadora de valores faltantes, tiene dimensión d × m,
donde cada columna corresponde a uno de los valores faltantes. Cada columna de
E tiene d−1 ceros y un 1, ubicado en la fila correspondiente al valor faltante.
F es la matriz indicadora de los valores observados, con dimensión d × (d − m) y
es análoga a E pero indicando los valores observados. Con la notación usada para
ybm , βb y γ
           b se tienen los siguientes resultados:

                                  y0 = F t y                         ym = E t y
                                 X0 = F t X                         Xm = E t X
                                  Z0 = F t Z                         Zm = E t Z
                                R0−1 = F t R−1 F                     −1
                                                                    Rm  = E t R−1 E
                                E t E = Im                          F t F = Id−m
                                EtF = 0                    EE t + F F t = Id
    F F t R−1 F F t + EE t R−1 EE t = R−1

  Con la notación simplificada de las matrices E y F , los errores cuadrados
medios de ybm , βb y γ
                     b son:
                             ECM (ycm) = ∆ × Υ



                                       Revista Colombiana de Estadística 29 (2006) 221–238

232                                         Luis Fernando Grajales & Luis Alberto López


donde:
                                             
           ∆ = J −1 E t QF F t R−1 F F t − E t V
                                                      −1    
           Υ = F F t R−1 F F t QE Im − E t R−1 EE t QE     − E σ2
           b = BV B t σ 2
      ECM (β)
                          −1 t −1                           
           B = X t V −1 X      X V R Id + EE t R−1 EJ −1 E t Q F F t R−1 F F t
                                                
           γ ) = CV C t − CZG − GZ t C t + G σ 2
      ECM (b

con

  J = Im − E t QEE t R−1 E
 C = AZ t Id − R−1 X X t V −1 X         X t V −1 R Id + EE t R−1 EJ −1 E t Q F F t R−1 F F t
            ˆ          `          ´−1             ˜ˆ                        ˜


    Para la imputación las matrices E y F utilizadas para este trabajo fueron las
siguientes:
                          
                          0                                 
                         0                            I35
                          
                   E = .        =−→e 36        F =  ... 
                          .. 
                                                       01×35
                          1 36×1

    Es decir, de acuerdo con la notación del trabajo de Barroso et al. (1998), m = 1,
la matriz E tiene tamaño 36 × 1 y la matriz F tiene tamaño 36 × 35. Se utilizaron
estas dos matrices ubicando el valor faltante en la última fila. Con estas matrices
pueden verificarse las propiedades de simplificación mencionadas en dicho trabajo.


5.5.     Método de comparación de BLUP
   Con el fin de comparar los BLUP, para cada estructura de covarianzas, se
procedió de la siguiente manera, con cada dato faltante:

  1. Se calcularon los BLUP de efectos fijos.

  2. Se calcularon las matrices 5 × 5 del ECM.

  3. Para cada estructura de covarianza, se calcularon las tres posibles diferencias
     de matrices de ECM.

  4. Se hallaron los valores propios de las diferencias de matrices calculadas en
     3. y se determinó, con el mı́nimo y máximo valor propio de las matrices, si
     ellas eran definidas no-negativas.

Estos pasos también se realizaron para los BLUP de efectos aleatorios (matrices
72 × 72).


                                        Revista Colombiana de Estadística 29 (2006) 221–238

Imputación de datos switchback en modelo mixto con errores correlacionados          233


6.    Resultados y discusión
   Esta sección presenta los resultados básicos con su respectiva interpretación
y discusión. En la parte final se presentan consideraciones finales, a modo de
conclusiones y temas a seguir.

  1. Imputaciones de los datos de Lucas (1956)
      La última columna de la tabla 1 presenta los resultados de los 36 valores
      imputados con el método de Yates para los datos simulados por Lucas. En
      la sección 5 se mencionó la razón por la cual coinciden las imputaciones para
      las tres estructuras de covarianza de los errores.
      De otro lado, la tabla 2 presenta los valores imputados con el método de
      Barroso et al. (1998) para los mismos datos de Lucas (1956).
      Llama la atención el hecho de que las imputaciones de Yates hayan sido
      más cercanas que las de Barroso et al. (1998). Una razón para esto es que
      en el método de Yates se están tomando como fijos los efectos intercepto
      y pendiente de la curva de lactancia y la estimación mı́nimo cuadrática es
      insesgada E(β) b = β y es el único parámetro a estimar; en cambio, en Ba-
      rroso et al. (1998) estos efectos son aleatorios y aunque las predicciones son
      insesgadas: E(β)b = E(β), es necesario estimar otros efectos. Sin embargo,
      aunque sale favorecido en estos datos, el método de Yates tiene la limitante
      de admitir solo efectos fijos. En este punto queda abierta la discusión de la
      comparación de estos dos métodos en datos con otras magnitudes o con otras
      estructuras y estimaciones de los efectos aleatorios.

  2. ECM en los datos de Lucas
      El método de Barroso-Bussab-Knott permite el cálculo del ECM del valor
      imputado. La parte derecha de la tabla 2 presenta los ECM del valor impu-
      tado para los datos de Lucas. Allı́ puede verse que, en general, la imputación
      con errores independientes produce un ECM menor que la imputación con
      las estructuras AR(1) y CS. Este resultado no sorprende teniendo en cuenta
      que la idea original de los datos de Lucas consideraba errores independien-
      tes. La ventaja de la estructura σ 2 I sobre AR(1) también fue hallada por
      Macchiavelli (1997) para datos completos y con prueba de razón de verosimi-
      litud. La ventaja de la estructura σ 2 I sobre CS es opuesta a la hallada por
      Li (1995), aunque allı́ lo hace con datos completos y usando un modelo que
      incluye bloque y la interacción periodo × tratamiento. La ventaja de AR(1)
      sobre CS, aunque no se tienen resultados en la literatura para comparar,
      podrı́a explicarse en la diferencia entre ρ2 = 0.02 para AR(1) y ρ = 0.4
      para CS; estos son los valores usados para la correlación de errores de los
      tiempos 1 y 3. Como puede verse, la correlación más grande afecta negati-
      vamente la imputación con los errores CS. En la tabla 2 se tiene una razón
      más para pensar que la estructura CS tiene menor ECM que la estructura
      AR(1) cuando se imputa el dato del periodo 2; sin embargo, esto queda para
      explorar.


                                     Revista Colombiana de Estadística 29 (2006) 221–238

234                                      Luis Fernando Grajales & Luis Alberto López


Tabla 1: Datos originales de Lucas (1956) e imputación con el método de Yates.

                    Vaca    Periodo    Dieta    Leche    Imputación
                      1        1         1       34.6      36.10
                      1        2         2       32.3      31.55
                      1        3         1       28.5      30.00
                     10        1         1       38.7      40.40
                     10        2         2       37.4      36.55
                     10        3         1       34.4      36.10
                      2        1         2       22.8      23.40
                      2        2         3       21.0      20.70
                      2        3         2       18.6      19.20
                     11        1         2       25.7      28.80
                     11        2         3       26.1      24.55
                     11        3         2       23.4      26.50
                      3        1         3       32.9      38.70
                      3        2         1       33.1      30.20
                      3        3         3       27.5      33.30
                     12        1         3       21.4      24.60
                     12        2         1       22.0      20.40
                     12        3         3       19.4      22.60
                      4        1         1       48.9      51.80
                      4        2         3       46.9      45.45
                      4        3         1       42.0      44.90
                      7        1         1       30.4      32.30
                      7        2         3       29.5      28.55
                      7        3         1       26.7      28.60
                      5        1         2       21.8      26.10
                      5        2         1       23.9      21.75
                      5        3         2       21.7      26.00
                      8        1         2       35.2      32.20
                      8        2         1       33.5      31.80
                      8        3         2       28.4      31.80
                      6        1         3       25.4      28.10
                      6        2         2       26.0      24.65
                      6        3         3       23.9      26.60
                      9        1         3       30.8      32.20
                      9        2         2       29.3      28.60
                      9        3         3       26.4      27.80



  3. Imputaciones de los datos simulados
      La tabla 3 presenta los datos simulados en el presente trabajo, con su res-
      pectiva imputación (Barroso et al. 1998) y el ECM del dato imputado. Los
      resultados de ECM son similares a los hallados en los datos de Lucas y tienen
      la misma interpretación y discusión anterior. Debe hacerse una discusión adi-
      cional, teniendo el hecho de que los ECM sean tan grandes, en especial para
      la estructura CS; como estos son ECM de datos imputados, teóricamente no
      pueden compararse con el ECM (único) de los datos completos. Una forma
      de explorar esto serı́a por medio de las covarianzas estimadas de la matriz Gk
      con cada dato faltante. Como se tendrı́an 36 valores para cada parámetro,


                                      Revista Colombiana de Estadística 29 (2006) 221–238

Imputación de datos switchback en modelo mixto con errores correlacionados           235


      serı́a necesario buscar una medida resumen para que haya un único valor de
      comparación entre las estructuras de covarianzas.
  4. Comparaciones de los BLUP
      Al hallar los valores propios de las matrices correspondientes a las prediccio-
      nes:
      Para efectos aleatorios. Al hallar los valores propios, no se puede decir que el
      BLUP de una estructura de covarianza de los errores sea mejor que el BLUP
      de otra estructura.

    Tabla 2: Datos de Lucas e imputación con el método de Barroso et al.

                      Y imp     Y imp    Y imp     ECM       ECM       ECM
          Y -Lucas
                        σ2 I     AR(1)     CS        σ2 I     AR(1)     CS
            34.6       44.53      50.80   58.01      0.5     15.6       73.1
            32.3       45.29      69.50   64.20      0.6    119.5      112.3
            28.5       41.18      47.71   56.02      0.5     15.6       73.1
            38.7       52.27      59.58   68.19      0.5     15.6       73.1
            37.4       52.22      80.26   74.10      0.6    119.5      112.3
            34.4       47.20      54.66   64.05      0.5     15.6       73.1
            22.8       29.96      34.14   38.75      0.5     15.6       73.1
            21.0       31.31      47.32   43.71      0.6    119.5      112.3
            18.6       24.80      29.13   34.50      0.5     15.6       73.1
            25.7       37.08      42.22   48.07      0.5     15.6       73.1
            26.1       36.11      55.02   50.81      0.6    119.5      112.3
            23.4       30.05      35.28   41.54      0.5     15.6       73.1
            32.9       43.85      50.27   57.29      0.5     15.6       73.1
            33.1       44.45      67.71   62.53      0.6    119.5      112.3
            27.5       39.82      46.47   54.47      0.5     15.6       73.1
            21.4       31.18      35.58   40.37      0.5     15.6       73.1
            22.0       31.37      47.18   43.59      0.6    119.5      112.3
            19.4       23.86      28.33   33.49      0.5     15.6       73.1
            48.9       63.58      72.65   83.29      0.5     15.6       73.1
            46.9       64.33      99.15   91.53      0.6    119.5      112.3
            42.0       61.00      70.37   82.25      0.5     15.6       73.1
            30.4       41.79      47.55   54.26      0.5     15.6       73.1
            29.5       40.97      62.88   58.06      0.6    119.5      112.3
            26.7       36.12      42.02   49.40      0.5     15.6       73.1
            21.8       34.38      39.15   44.50      0.5     15.6       73.1
            23.9       32.96      49.78   45.99      0.6    119.5      112.3
            21.7       25.21      29.98   35.35      0.5     15.6       73.1
            35.2       44.42      50.96   58.16      0.5     15.6       73.1
            33.5       47.21      71.72   66.24      0.6    119.5      112.3
            28.4       41.76      48.59   57.00      0.5     15.6       73.1
            25.4       37.42      42.57   48.49      0.5     15.6       73.1
            26.0       36.42      55.41   51.18      0.6    119.5      112.3
            23.9       29.61      34.82   41.01      0.5     15.6       73.1
            30.8       40.87      46.66   53.23      0.5     15.6       73.1
            29.3       42.23      64.27   59.36      0.6    119.5      112.3
            26.4       35.88      41.84   49.21      0.5     15.6       73.1
          Y imp : valor imputado.
          ECM : Error cuadrado medio de imputación.

                                      Revista Colombiana de Estadística 29 (2006) 221–238

 236                                          Luis Fernando Grajales & Luis Alberto López


         Para efectos fijos. En algunos datos faltantes, el BLUP (AR(1)) es mejor
         que el BLUP (CS) (ver tabla 3).
         En términos de ECM, no hay forma de comparar este resultado con la lite-
         ratura consultada. En efectos fijos, no se puede concluir sobre las otras dos
         estructuras de correlación de errores.



Tabla 3: Datos simulados e imputados con tres estructuras de covarianza de errores.

   Original                     Original                         Original
               Imputado   ECM                Imputado    ECM                Imputado   ECM
     σ2 I                       AR(1)                              CS
       39.64    39.80     2.3    39.64         53.20     84.9     39.64      68.30     369.2
       34.54    33.73     2.7    34.55         69.04     649.2    34.55      67.95     567.4*
       29.32    29.88     2.3    29.33         41.77     84.9     29.34      57.06     369.2
       38.12    39.28     2.3    38.12         52.43     84.9     38.12      67.21     369.2
       33.42    33.01     2.7    33.40         67.48     649.2    33.40      66.37     567.4*
       29.20    28.39     2.3    29.17         39.77     84.9     29.15      54.44     369.2
       27.12    30.87     2.3    27.12         40.90     84.9     27.12      51.90     369.2
       24.55    23.98     2.7    24.42         48.81     649.2    24.42      47.92     567.4*
       21.11    17.89     2.3    21.13         25.61     84.9     21.01      35.70     369.2
       41.49    39.87     2.3    41.49         53.51     84.9     41.49      68.81     369.2
       34.43    36.58     2.7    34.61         73.60     649.2    34.60      72.63     567.4*
       30.60    30.38     2.3    30.45         42.71     84.9     30.59      58.34     369.2
       34.54    37.30     2.3    34.54         49.97     84.9     34.54      63.71     369.2
       32.37    31.13     2.7    32.16         63.07     649.2    32.16      61.91     567.4*
       27.06    25.38     2.3    27.20         35.89     84.9     27.02      49.22     369.2
       48.16    47.35     2.3    48.16         63.89     84.9     48.16      82.20     369.2
       43.08    43.50     2.7    43.03         87.70     649.2    43.03      86.31     567.4*
       37.37    37.80     2.3    37.40         52.85     84.9     37.35      71.65     369.2
       47.22    47.33     2.3    47.22         63.53     84.9     47.22      81.76     369.2
       42.40    40.94     2.7    42.33         83.89     649.2    42.33      82.46     567.4*
       36.56    37.68     2.3    36.61         52.35     84.9     36.55      71.01     369.2
       45.27    43.83     2.3    45.27         58.78     84.9     45.27      75.72     369.2
       38.34    39.28     2.7    38.48         79.84     649.2    38.48      78.69     567.4*
       34.00    34.61     2.3    33.87         48.30     84.9     33.98      65.71     369.2
       52.47    51.36     2.3    52.47         69.51     84.9     52.47      89.45     369.2
       48.56    46.22     2.7    48.37         94.01     649.2    48.37      92.41     567.4*
       39.96    43.03     2.3    40.21         59.80     84.9     40.07      80.77     369.2
       26.82    26.42     2.3    26.82         26.82     84.9     26.82      35.31     369.2
       21.43    22.88     2.7    21.56         45.55     649.2    21.56      45.06     567.4*
       16.98    16.18     2.3    16.94         23.48     84.9     17.08      32.89     369.2
       43.10    41.60     2.3    43.10         55.88     84.9     43.10      71.89     369.2
       36.30    38.19     2.7    36.44         76.91     649.2    36.44      75.86     567.4*
       32.20    32.10     2.3    32.09         45.05     84.9     32.20      61.42     369.2
       39.71    38.67     2.3    39.71         51.96     84.9     39.71      66.61     369.2
       34.14    34.11     2.7    34.19         69.17     649.2    34.19      68.17     567.4*
       28.41    29.47     2.3    28.43         41.37     84.9     28.49      56.51     369.2
   *Indica BLUP (AR(1)) mejor que BLUP(CS) en efectos fijos, cuando falta el dato.




                                           Revista Colombiana de Estadística 29 (2006) 221–238

Imputación de datos switchback en modelo mixto con errores correlacionados          237


7.    Consideraciones finales
      De acuerdo con lo analizado en el presente trabajo, el método de Barroso
      et al. (1998) se considera una herramienta valiosa para la imputación de
      datos cuando se tiene en cuenta un modelo de efectos mixtos.
      En el trabajo se consideró el caso de un dato faltante, pero el método puede
      generalizarse a más de uno; para ello puede seguirse a Barroso et al. (1998).
      Los datos provenientes de diseños crossover en algunos casos consideran
      modelos que incluyen el efecto residual (carryover) del tratamiento; esto
      puede verse en Oman & Seiden (1988). El presente trabajo deja planteada la
      posibilidad de imputar datos en dichos casos, modificando la matriz diseño
      de los efectos aleatorios.
      Uno de los temas para continuar es el estudio de las distribuciones de los
      Estadísticos de prueba, después de imputación.


Agradecimientos
    Agradecemos a los evaluadores por sus valiosos aportes que permitieron mejorar
el artı́culo. Este trabajo hace parte de la producción del Grupo de Investigación
en Estadística Aplicada del Departamento de Estadística.

Referencias
Barroso L,Bussab W,Knott M.Best Linear Unbiased Predictor in the Mixed Model with Incomplete Data.(1998).Commun Statis.
Carriere K.Incomplete Repeated Measures Data Analysis in the Presence of Treatments Effects.(1994).Journal of the American Statistical Association.
Ebbutt A.Three-Period Crossover Design for Two Treatments.(1984).Biometrics.
Grajales L.Imputación de datos en modelos mixtos con errores correlacionados: caso de diseños switchback.(2006).Universidad Nacional de Colombia.Bogotá.
Jones B,Kenward M.Design and Analysis of Cross-Over Trials.(2003).Chapman and Hall.
Li C.Introduction to Experimental Statistics.(1964).McGraw-Hill.
Li J.Analysis of Switchback Designs.(1995).Louisiana State University.
Little R,Rubin D B.Statistical Analysis with Missing Data.(2002).Jonh Wiley & Sons.
Lucas H L.Switchback Trials for more than two Treatments.(1956).Journal of Dairy Science.
Macchiavelli R.Analysis of switch-back designs in dairy experiments.(1997).Meeting of the International Biometric Society Network for Central America, the Caribbean, Mexico, Colombia and Venezuela.
Matthews J.Recent Developments in Crossover Designs.(1988).International Statistical Review.
Oman S,Seiden E.Switch-back Designs.(1988).Biometrika.
Richardson B,Flack V.The Analysis of Incomplete Data in Three period Two treatment Cross over Design for Clinical Trials.(1996).Statistics in Medicine.
SAS.SAS/STAT software: changes and enhancements.(2005).SAS.
Searle S,Casella G,McCulloch C.Variance Components.(1992).Jonh Wiley & Sons.
Tempelman R.Experimental Design and Statistical Methods for Classical and Bioequivalence Hypothesis Testing with an Application to Dairy Nutrition Studies.(2004).Journal of Animal Science.
Wolfinger R D.Covariance Structure Selection in General Mixed Models.(1993).Communication in Statistics.
Yates F.The Analysis of Replicated Experiments when the Field Results are Incomplete.(1933).Annals of Eugenics.