Un modelo spline para el pron√≥stico de la demanda de energ√≠a el√©ctrica
Universidad del Valle
Resumen
El prop√≥sito de este trabajo es modelar, con fines de pron√≥stico, la demanda diaria de energ√≠a el√©ctrica en una regi√≥n del suroccidente colombiano, mediante la implementaci√≥n de modelos de regresi√≥n no param√©trica teniendo en cuenta factores de influencia tales como hora del d√≠a, d√≠a de la semana, mes y a√±o, entre otros. Los datos empleados en el desarrollo de este proyecto provienen de una compa√±√≠a local de distribuci√≥n de energ√≠a el√©ctrica y se tomaron de Valencia (2005). La informaci√≥n disponible va desde enero de 2001 hasta noviembre de 2004. Estos datos muestran un comportamiento complejo, dif√≠cil de modelar con la teor√≠a b√°sica de los m√©todos param√©tricos. Dado que un an√°lisis exploratorio de la informaci√≥n sugiere la existencia de una curva t√≠pica diaria de demanda, se eligi√≥ estimarla utilizando modelos de regresi√≥n no param√©trica. Para efectos comparativos, se propuso la aplicaci√≥n de otras metodolog√≠as que involucran modelos ARIMA y variables macroecon√≥micas. Todo el procesamiento estad√≠stico se ejecut√≥ con R.
Palabras clave: suavizaci√≥n, regresi√≥n no param√©trica, modelos ARIMA.
Introducci√≥n
El constante desarrollo de los mercados de energ√≠a el√©ctrica genera escenarios cada vez m√°s competitivos, por lo que es de crucial importancia poseer sistemas de distribuci√≥n con planes de manejo bien estructurados. El objetivo es disponer de sistemas que suministren energ√≠a el√©ctrica con el menor n√∫mero de interrupciones y al menor costo posible, mejorando as√≠ la calidad del servicio. Esta calidad depende en gran medida de la capacidad que tengan las empresas responsables de proveer y distribuir este servicio, de determinar a largo y corto plazo cu√°l ser√° la demanda futura de energ√≠a. En este trabajo se utilizan datos de demanda horaria en megavatios (MW), recolectados por una entidad local de distribuci√≥n que controla algunas zonas de la regi√≥n objeto de estudio. Los datos provienen del trabajo de Valencia (2005).
El prop√≥sito de este trabajo es modelar y pronosticar la demanda horaria de energ√≠a el√©ctrica en una regi√≥n del suroccidente colombiano mediante la implementaci√≥n de modelos de regresi√≥n no param√©trica usando suavizaci√≥n spline, teniendo en cuenta factores de influencia tales como d√≠a de la semana, mes y a√±o, entre otros. Dado que los registros de demanda de energ√≠a el√©ctrica son tomados a trav√©s del tiempo, se ajustan modelos de series de tiempo tipo ARIMA para generar pron√≥sticos y realizar comparaciones con los obtenidos a partir del modelo propuesto.
Para la aplicaci√≥n y comparaci√≥n de estas dos metodolog√≠as de pron√≥stico se to-
mar√° como ejemplo los d√≠as mi√©rcoles y para el modelo ARIMA la hora 20:00 de
este mismo d√≠a.


2. Antecedentes
    Varios han sido los m√©todos empleados para pronosticar la demanda de energ√≠a
el√©ctrica. En general estos m√©todos pueden ser clasificados en tres grandes grupos:
los primeros se basan en modelos estad√≠sticos (regresi√≥n, series de tiempo y/o
econom√©tricos); los segundos en inteligencia artificial; y, finalmente, aquellos que
dependen del juicio y la intuici√≥n humana. En Valencia (2005) se puede encontrar
un cuadro detallado de cada uno de estos grupos, al igual que sus ventajas y
desventajas.
    Fern√°ndez (2006) desarrolla una aplicaci√≥n de modelos de regresi√≥n. En este
estudio la ecuaci√≥n de demanda establece una relaci√≥n no lineal entre el consumo
dom√©stico de electricidad y el precio de ese consumo, as√≠ como un conjunto de
caracter√≠sticas del hogar que se trate, personales y demogr√°ficas, de los individuos

                                      Revista Colombiana de Estad√≠stica 30 (2007) 187‚Äì202

Un modelo spline para el pron√≥stico de la demanda de energ√≠a el√©ctrica              189

que forman parte de la muestra. La estimaci√≥n se realiza a trav√©s de un an√°lisis
param√©trico de m√≠nimos cuadrados en dos etapas, as√≠ como de un an√°lisis de regre-
si√≥n no param√©trica, mediante t√©cnicas kernel, que permite fundamentar de forma
m√°s robusta la especificaci√≥n funcional param√©trica.

    Murillo et al. (2003) realizan un estudio usando modelos de tipo ARIMA. En
este caso el pron√≥stico de demanda de energ√≠a el√©ctrica se basa en datos hist√≥ricos
suministrados por la Empresa de Energ√≠a de Pereira en el periodo comprendido
entre el 1 de enero de 2001 y el 31 de diciembre de 2001.

    Por otra parte, Blacon√° & Abril (2000) realizan un estudio para el MEM (Mer-
cado El√©ctrico Mayorista) en Argentina. De acuerdo con los autores, las series
relacionadas con la demanda de energ√≠a el√©ctrica contienen procesos estacionales
muy complejos, que resultan dif√≠ciles de modelar con la teor√≠a b√°sica de series de
tiempo. Por esta raz√≥n prefieren apoyarse en los MBEE (Modelo B√°sico de Es-
pacio de Estado). La serie de tiempo de la demanda diaria promedio de energ√≠a
el√©ctrica de Argentina contiene dos tipos de estacionalidad, una semanal y otra
anual. La estacionalidad semanal resulta f√°cil de modelar con variables DUMMY,
mientras la estacional anual se modela mediante un modelo spline de regresi√≥n no
param√©trica descrito por Poirier (1973).

    Harvey & Koopman (1993) emplean tambi√©n MBEE y la t√©cnica Time-Varying
splines para obtener un modelo de pron√≥stico horario de la demanda de electricidad
de la compa√±√≠a americana Puget Sound Power and Light. Poirier et al. (1979)
realizaron un estudio para el Electric Power Research Institute, el cual involucr√≥
modelos de tipo econom√©trico y splines con el fin de estimar la demanda residencial
para un peque√±o conjunto de consumidores en Estados Unidos de Am√©rica, de los
cuales se contaba con informaci√≥n cada 15 minutos.

   Modelos spline jer√°rquicos fueron empleados por Hendricks & Koenker (1992)
para modelar la demanda de electricidad horaria de cuatrocientas residencias ubi-
cadas en el √°rea metropolitana de Chicago, medidas durante cuatro meses en 1985.
Smith et al. (1998) modelaron 264 datos mensuales de demanda residencial toma-
dos del trabajo realizado por Harris & Liu (1993), usando cuatro variables indepen-
dientes e implementando una metodolog√≠a basada en una aproximaci√≥n bayesiana
para regresi√≥n spline no param√©trica aditiva con errores autocorrelacionados.

    En resumen, se han implementado distintas aproximaciones con el fin de reali-
zar proyecciones de demanda de energ√≠a el√©ctrica. En todas ellas se ha considerado
la inclusi√≥n de otras variables, las cuales contribuyen significativamente a la ex-
plicaci√≥n de la demanda. Se deduce de esta revisi√≥n de la literatura que no se ha
establecido un m√©todo est√°ndar para solucionar este problema, debido a la comple-
jidad que conlleva el mismo. Igualmente, se han empleado con frecuencia algunas
t√©cnicas de suavizaci√≥n para dar soluci√≥n a este problema, algunas veces utiliza-
das como herramienta de apoyo a otras metodolog√≠as estad√≠sticas de predicci√≥n.
A partir de estas experiencias, este trabajo propone ajustar un modelo spline de
regresi√≥n no param√©trica con este prop√≥sito.

                                     Revista Colombiana de Estad√≠stica 30 (2007) 187‚Äì202

190                   Andr√©s Felipe Barrientos, Javier Olaya & V√≠ctor Manuel Gonz√°lez

3. Modelos de regresi√≥n no param√©trica
      Los objetivos del an√°lisis de regresi√≥n no param√©trica son los mismos
      de su contraparte param√©trica, vale decir, estimar y probar las carac-
      ter√≠sticas de la funci√≥n de regresi√≥n.
                                                               (Olaya 2002)

   La idea general de los modelos de regresi√≥n consiste en aproximar a partir de
un conjunto de n datos (xi , yi ) la funci√≥n f en la siguiente expresi√≥n:
                           yi = f (xi ) + Œµi ,   i = 1, 2, . . . , n
donde Y es continua, denominada generalmente variable respuesta; X =
(X1 , X2 , . . . , Xp ) denota p variables continuas denominadas covariables, variables
predictoras, variables explicativas o variables independientes; f (x) es la respuesta
media y referida en la literatura como funci√≥n de regresi√≥n o curva de regresi√≥n; y
Œµ se conoce com√∫nmente como error o ruido con E[Œµi ] = 0 y V ar[Œµi ] = œÉ 2 < ‚àû, ‚àÄi.
    En el an√°lisis de regresi√≥n param√©trica, el investigador presupone una forma
de la funci√≥n de regresi√≥n, de la cual solo se desconoce el valor de los par√°metros
asociados a la misma. Por el contrario, el an√°lisis de regresi√≥n no param√©trica no
asume un comportamiento del fen√≥meno a priori, sino que concibe la forma de la
curva o funci√≥n ‚Äúa partir de lo que los datos digan‚Äù. La curva se escoge de entre
un conjunto de curvas con ciertas propiedades de continuidad y diferenciabilidad.
    En el caso de la regresi√≥n no param√©trica simple puede haber varias maneras de
estimar
Pn       f (x). En este trabajo se emple√≥ un estimador lineal de la forma fŒª (x) =
   i=1 K(x,   xi ; Œª)yi , donde K(x, xi ; Œª), i = 1, 2, . . . , n es una colecci√≥n de pesos
(funciones) que depende de la covariable X y del par√°metro de suavizaci√≥n Œª. As√≠
que se dispone de un estimador fŒª (x) de f (x) para cada Œª, por lo que la elecci√≥n
del par√°metro Œª es decisiva.
    El par√°metro Œª puede estimarse a partir de la funci√≥n de riesgo del estimador,
la cual puede expresarse como R(Œª) = B 2 (fŒª ) + var(fŒª ), donde B 2 (fŒª ) y var(fŒª )
representan el sesgo y la varianza del estimador fŒª (x), respectivamente. El valor de
Œª que minimiza esta funci√≥n provee una estimaci√≥n de f (¬∑) que puede ser empleada
en una situaci√≥n en general y de la cual se esperan obtener buenas predicciones.
Œª tambi√©n podr√≠a P         estimarse usando el riesgo de predicci√≥n del estimador definido
                              n
por, p(Œª) = n‚àí1 i=1 E[yi‚àó ‚àí fŒª (xi )]2 = œÉ 2 + R(Œª). Este indicador se emplea
para evaluar la funcionalidad de un estimador como un predictor de observaciones
futuras y1‚àó , y2‚àó , . . . , yn‚àó .
    Si se conoce œÉ 2 , entonces R(Œª) y P (Œª) se pueden estimar directamente; sin
embargo, en la pr√°ctica este no es el caso y resulta necesario estimar œÉ 2 . En el
marco de la regresi√≥n no param√©trica existe un buen n√∫mero de estimadores de
œÉ 2 que no dependen del par√°metro de suavizaci√≥n y en su mayor√≠a se apoyan en
diferencias sucesivas de las respuestas yi asociadas a una vecindad predeterminada
de xi . Un ejemplo de esta clase de estimadores es el presentado en la ecuaci√≥n (1),
denominado estimador de Gasser, Sroka and Jennen-Steinmetz (citado por Green
& Silverman (2000)). Algunos autores denotan este estimador de la varianza como
estimador GSJS; de esta manera se citar√° en este trabajo.

                                       Revista Colombiana de Estad√≠stica 30 (2007) 187‚Äì202

Un modelo spline para el pron√≥stico de la demanda de energ√≠a el√©ctrica               191


                                                h                          i2
                            n           n           yi ‚àíAi yi‚àí1 ‚àíBi yi+1
                           X    Œµei2   X                1+A2i +Bi2
                     2
                   œÉ
                   bGSJS =           =                                               (1)
                           i=2
                               n‚àí2     i=2
                                                           n‚àí2
                                                                   
                                  xi+1 ‚àí xi                xi ‚àí xi‚àí1
    En la ecuaci√≥n (1), Ai =                    y Bi =                  . Los Œµei se
                                 xi+1 ‚àí xi‚àí1              xi+1 ‚àí xi‚àí1
llaman, en este contexto, seudo-residuales. Aunque el estimador de varianza GSJS
se presenta con mayor frecuencia en el contexto de suavizaci√≥n kernel, se debe
tener en cuenta, como se mencionar√° en la secci√≥n 3.1, que un suavizador spline
puede ser expresado como un suavizador kernel ; por tal motivo las propiedades de
este √∫ltimo son heredadas para la suavizaci√≥n spline. Por otra parte, es necesario
considerar que existen algunos estimadores com√∫nmente usados en el contexto de
regresi√≥n con splines (v√©ase Wood 2006), tal como el presentado en la ecuaci√≥n (2);
no obstante Eubank (1999) menciona que existen algunos problemas debido a que
este estimador est√° en funci√≥n del par√°metro de suavizaci√≥n, el cual puede ser
calculado mediante la minimizaci√≥n del riesgo de predicci√≥n, que a su vez depende
de œÉ 2 .
                                   Xn
                                       (yi ‚àí fŒª (xi ))2
                              b2 =
                              œÉ                                                  (2)
                                   i=1
                                         n ‚àí tr(SŒª )

donde SŒª es una matriz equivalente a la matriz HAT en regresi√≥n param√©trica.
Sin embargo, en algunos casos œÉ 2 es razonablemente dif√≠cil de estimar, por lo que
se hace necesario el uso de m√©todos alternativos para estimar el par√°metro de
suavizaci√≥n (Œª), tales como el criterio de validaci√≥n cruzada CV (Œª) y el criterio
de validaci√≥n cruzada generalizada CV G(Œª), el cual no es una generalizaci√≥n del
primero. Estos criterios est√°n definidos por
                                          n 
                                          X                2
                                              yi ‚àí f (xi )
                          CV (Œª) = n‚àí1
                                          i=1
                                                      1 ‚àí si

y
                                n 
                                X                2                            2
                                    yi ‚àí f (xi )              1 ‚àí si
               CV G(Œª) = n‚àí1
                                i=1
                                        1 ‚àí si            n‚àí1 tr[I ‚àí SŒª ]

En las expresiones para CV y CV G, si es el i-√©simo elemento de la diagonal de
SŒª . El c√°lculo de estos criterios es computacionalmente intensivo, pero se han
desarrollado rutinas muy eficientes que est√°n disponibles en R (R Development
Core Team 2006).


3.1. Suavizaci√≥n spline
    Algunos autores (Wegman & Wrigth 1983, Green & Silverman 2000) describen
un spline como una ‚Äúdelgada tira de madera‚Äù que se puede hacer pasar a trav√©s
de un conjunto de puntos gracias a que posee una determinada energ√≠a de de-
flexi√≥n. En su mayor√≠a, los splines han sido estudiados en el marco del an√°lisis
num√©rico como m√©todo de interpolaci√≥n m√°s que en el estad√≠stico como m√©todo

                                      Revista Colombiana de Estad√≠stica 30 (2007) 187‚Äì202

192                     Andr√©s Felipe Barrientos, Javier Olaya & V√≠ctor Manuel Gonz√°lez

de suavizaci√≥n. Eubank (1999, pp. 229-230) menciona que los splines tuvieron sus
or√≠genes desde 1923 gracias a Whittaker, mientras que su formulaci√≥n moderna
fue planteada por Sch√∂enberg en 1964 y por Reinsche en 1967; finalmente su im-
plementaci√≥n en Estad√≠stica se da alrededor de 1990 por Wahba. En Estad√≠stica
existen b√°sicamente tres m√©todos de suavizaci√≥n spline, donde la aplicabilidad de
cada uno de ellos depende de la estructura de los errores asociados a los datos.


3.2. M√©todo spline - m√≠nimos cuadrados penalizado

    P regresi√≥n, una medida de bondad de ajuste para f est√° dada por la expresi√≥n
   En
n‚àí1 ni=1 (yi ‚àí f (xi ))2 , mientras que una medida de suavidad asociada con una
                                                                    R1
funci√≥n f que pertenece al espacio de Sobolev1 W2m est√° dada por 0 (f (m) (x))2 dx
(penalizaci√≥n por aspereza). Este m√©todo usa ambas medidas para estimar una
funci√≥n spline √∫nica fŒª minimizando la siguiente combinaci√≥n convexa:
                n
                X                     Z 1
                                 2
    (1 ‚àí q)n ‚àí1
                   (yi ‚àí f (xi )) + q     (f (m) (x))2 dx para alg√∫n 0 < q < 1
                  i=1                         0

esto es equivalente a:
                              n
                              X                           Z 1
                        n‚àí1         (yi ‚àí f (xi ))2 + Œª         (f (m) (x))2 dx                (3)
                              i=1                          0


    En la ecuaci√≥n (3), Œª = q/(q ‚àí 1) es el par√°metro de suavizaci√≥n y representa la
tasa de intercambio entre el error residual y la variaci√≥n local. El problema puede
resumirse de la siguiente forma: si fŒª (x) es un spline natural (definido bajo ciertas
condiciones de diferenciabilidad de f (¬∑) al evaluarla en el valor m√≠nimo y m√°ximo de
la covariable), entonces el problema de minimizar (3) sobre todas las funciones en
W2m se reduce a un espacio finito n-dimensional de los splines naturales. Eubank
(1999) menciona que las de funciones Demmler-Reinch conforman una base del
espacio de los splines naturales para la estimaci√≥n de f , la cual se puede representar
como un suavizador kernel ; por tanto, las propiedades asint√≥ticas establecidas para
el m√©todo kernel son equivalentes para el m√©todo spline. Otra clase de base son
los B-splines considerados como una generalizaci√≥n de las curvas Bezier, cuyas
funciones se calculan de forma recursiva (v√©ase Eilers & Marx 1996).


4. Base de datos
    De acuerdo con Valencia (2005), el consumo de energ√≠a est√° distribuido prin-
cipalmente en los sectores residencial (36.67 %), industrial (9.98 %) y comercial
(6.64 %). Para evitar confusiones en la base de datos, se consider√≥ la unificaci√≥n
de la nomenclatura; por este motivo en las siguientes secciones de este documen-
to, cuando se hable de la hora 0 se har√° referencia al periodo comprendido entre
   1 Un espacio de Sobolev provee condiciones generales suficientes de continuidad de las funciones

elegibles como funci√≥n de regresi√≥n.


                                            Revista Colombiana de Estad√≠stica 30 (2007) 187‚Äì202

Un modelo spline para el pron√≥stico de la demanda de energ√≠a el√©ctrica               193

la hora 00:00 y las 00:59, y as√≠ sucesivamente hasta la hora 23, que se refiere al
periodo comprendido entre la 23:00 y las 23:59. La base de datos est√° conformada
por los registros de la demanda horaria de energ√≠a durante los d√≠as de enero 1 de
2001 hasta noviembre 4 de 2004. Cada d√≠a registra 24 lecturas correspondientes a
la hora 0, 1, 2, . . . , 23. As√≠, se tiene por ejemplo informaci√≥n de la hora 20 de cada
mi√©rcoles a lo largo del periodo de an√°lisis.
    Con el fin de evaluar la calidad de los pron√≥sticos de los modelos de regresi√≥n
no param√©trica y ARIMA, se seleccion√≥ como horizonte de pron√≥stico el mes de
octubre de 2004. Para ajustar los modelos basados en suavizaci√≥n spline para un
d√≠a de la semana en particular, la base de datos fue estructurada de tal forma que
la covariable en el modelo fuese la hora del d√≠a y la variable respuesta los datos de
demanda; es decir, por cada hora del d√≠a hay tantas observaciones como d√≠as de
inter√©s en el mes de an√°lisis. Respecto a la metodolog√≠a ARIMA se deben ajustar
24 modelos por d√≠a, uno por cada hora; en este caso cada serie estar√° conformada
por los datos registrados desde enero de 2001 hasta septiembre de 2004. Por tanto,
los cuatro o cinco primeros pron√≥sticos de cada modelo estimar√°n la demanda
horaria para determinado d√≠a durante todo el mes de octubre de 2004.


5. Resultados
    El an√°lisis exploratorio mostr√≥ que el consumo de energ√≠a se incrementa a
trav√©s de los a√±os, lo que convierte la predicci√≥n de la demanda horaria de energ√≠a
el√©ctrica en un problema interesante. Adem√°s, la demanda horaria no pareci√≥ estar
considerablemente influida por el mes, caso contrario al que ocurre con el d√≠a de la
semana. En la figura 1 se puede observar que los mayores consumos se presentan
los d√≠as martes, mi√©rcoles, jueves y viernes cuya distribuci√≥n es similar, seguidos
de los d√≠as s√°bado y lunes, siendo este ultimo el d√≠a m√°s variable. Finalmente, el
domingo es el d√≠a donde el consumo de energ√≠a es menor, al igual que su variabilidad
comparada con los dem√°s.
    En la figura 2 se observa que en general la demanda durante las horas de la
madrugada es baja, luego se presenta un incremento a las 6 y 7 a.m. debido a
la iniciaci√≥n de actividades. Seguidamente se observa un crecimiento progresivo
hasta las 12 del d√≠a donde presenta un pico; all√≠ comienza un descenso que finaliza
a las 6 p.m., hora en la cual el consumo se incrementa hasta las 8 p.m. cuando
usualmente la demanda es m√°xima. A partir de las 9 p.m. la demanda desciende
hasta finalizar el d√≠a. Este comportamiento seguramente obedece a los horarios
establecidos para tomar las comidas, trabajar, estudiar y descansar. N√≥tese, ade-
m√°s, que la distribuci√≥n de la demanda en cada hora es similar, lo cual conduce a
suponer que el consumo horario de energ√≠a tiene varianza constante. Esto √∫ltimo
es un resultado importante para la validaci√≥n de los supuestos de los modelos que
fueron ajustados.
   A partir del an√°lisis exploratorio de la informaci√≥n se encontr√≥ que la deman-
da horaria de energ√≠a el√©ctrica en el Valle del Cauca posee un comportamiento
caracter√≠stico condicionado por el d√≠a de la semana; adem√°s, fue posible concluir
que los d√≠as martes, mi√©rcoles, jueves y viernes poseen comportamientos similares,

Figura 1: Diagrama de cajas y alambres de la demanda horaria de energ√≠a el√©ctrica
          considerando el d√≠a de la semana.
                                                                                                       Horas
Figura 2: Diagrama de cajas y alambres de la demanda horaria de energ√≠a el√©ctrica
          considerando la hora del d√≠a.


raz√≥n por la cual se sugiere el agrupamiento de estos d√≠as para su posterior mo-
delaci√≥n. En la metodolog√≠a planteada en este trabajo, se propuso usar la t√©cnica
de suavizaci√≥n spline para estimar la curva t√≠pica que represente la demanda de

                                                                                                   Revista Colombiana de Estad√≠stica 30 (2007) 187‚Äì202

Un modelo spline para el pron√≥stico de la demanda de energ√≠a el√©ctrica               195

energ√≠a de un conjunto de d√≠as en un periodo de tiempo dado, donde la variable
predictora es la hora del d√≠a y la independiente es la demanda. El m√©todo spline
seleccionado fue m√≠nimos cuadrados penalizados calculados a partir de una base
de funciones B-splines, donde el par√°metro de suavizaci√≥n √≥ptimo se obtuvo me-
diante el criterio de validaci√≥n cruzada generalizada. El c√°lculo de las bandas del
95 % de confianza, asociadas a la curva estimada, se realiz√≥ asumiendo normalidad
y usando el estimador de varianza œÉ                                    b.
                                     bGSJS , el cual fue comparado con œÉ
    En el planteamiento y dise√±o de los modelos de pron√≥stico spline y ARIMA no
se tuvieron en cuenta los factores regulatorios que definen las condiciones tempo-
rales reales del pron√≥stico. Los modelos basados en la t√©cnica de suavizaci√≥n spline
se usan para predecir a partir de la informaci√≥n disponible desde enero de 2001
hasta septiembre de 2004 la curva t√≠pica del d√≠a seleccionado en el horizonte de
pron√≥stico.
    Dado que la demanda de energ√≠a el√©ctrica es una variable que puede ser con-
siderada de tipo macroecon√≥mico, se espera que esta tenga alg√∫n tipo de relaci√≥n
posiblemente lineal con el Producto Interno Bruto (PIB). Por esta raz√≥n, el primer
modelo de pron√≥stico planteado se basa en la tasa de crecimiento del PIB calculada
para octubre de 2004. Al consultar la p√°gina web del DANE, se encontr√≥ que la
tasa de crecimiento del PIB en Colombia para el √∫ltimo trimestre de 2004 fue del
4.415 %. Esta tasa fue hallada respecto al valor del PIB presentado en el mismo
trimestre del a√±o anterior. Obs√©rvese que el PIB no puede ser incluido como va-
riable ex√≥gena explicativa para estimar la demanda, puesto que no est√° medido de
forma horaria. Teniendo en cuenta estas consideraciones, el m√©todo de pron√≥stico
consisti√≥ en estimar la curva t√≠pica de los d√≠as mi√©rcoles del mes de octubre de
2003 con sus respectivas bandas de confianza; luego sobre estas estimaciones se
aplic√≥ el 4.415 % y as√≠ se proyect√≥ esta curva a octubre de 2004. Otro m√©todo de
pron√≥stico consisti√≥ en estimar la curva t√≠pica con sus bandas de confianza del mes
que precede al horizonte de pron√≥stico, en este caso septiembre de 2004, y luego
usarla como pron√≥stico de octubre.
    Los pron√≥sticos de la curva de demanda horaria de energ√≠a el√©ctrica de los
d√≠as mi√©rcoles del mes de octubre de 2004 fueron obtenidos usando la funci√≥n
smooth.spline() existente en el software estad√≠stico R y son presentados en las
figuras 3 y 4, donde se observa que al aplicar la tasa de crecimiento del PIB a la
curva estimada para el mes de octubre de 2003, las bandas de confianza estimadas
incluyen la curva t√≠pica y la mayor√≠a de los registros de consumo del horizonte
de pron√≥stico; de igual forma sucede con los pron√≥sticos obtenidos a partir de
las curvas estimadas para el mes de septiembre de 2004. Para el c√°lculo de la
varianza fue necesario considerar que la estructura de los datos no permit√≠a usar
de forma directa el estimador GSJS, puesto que asociado a un valor de xi (hora)
hay diversos valores de y (demanda), es decir, existe un problema de medidas
repetidas que hace compleja la implementaci√≥n de este estimador. Por este motivo
la variable respuesta fue ordenada de acuerdo con la fecha y hora en que fue
tomado el registro. Seg√∫n este enfoque, la variable independiente fue recodificada
de la siguiente forma:

en este caso x1 corresponde a la hora 00:00 del primero de los d√≠as considerados
para la estimaci√≥n de la curva t√≠pica, seguidamente x2 equivale a la hora 01:00
de ese mismo d√≠a y as√≠ sucesivamente hasta xn que representa la hora 23:00 del
√∫ltimo d√≠a. La estimaci√≥n de la varianza por medio de œÉ  bGSJS utilizada para reali-
zar los pron√≥sticos presentados en las figuras 3 y 4 dio como resultado 116.5446
MW2 y 127.9824 MW2 , respectivamente. Estas estimaciones fueron comparadas
con las obtenidas mediante el estimador œÉ  b , dando como resultado 42.65659 MW2
                2
y 87.03438 MW , es decir, los errores est√°ndar obtenidos con œÉ   bGSJS son mayores
que con œÉb. Para efecto de comparaci√≥n con la metodolog√≠a ARIMA se seleccion√≥
                                                            bGSJS . Los estimadores
el caso m√°s cr√≠tico, esto es, las estimaciones derivadas de œÉ
bGSJS y œÉ
œÉ       b fueron programados directamente en el software estad√≠stico R.
                                                              Horas
Figura 3: Pron√≥stico de la curva t√≠pica de demanda horaria de energ√≠a el√©ctrica de
          octubre de 2004 usando la tasa de crecimiento del PIB.


    Respecto a la validaci√≥n de los supuestos de incorrelaci√≥n y valor esperado igual
a cero en los errores de estos modelos seg√∫n el m√©todo gr√°fico, se pudo observar
que posiblemente estos supuestos se cumplen, dado que no se observ√≥ alg√∫n tipo de
tendencia y los residuos se encuentran concentrados alrededor de cero. Al realizar
la prueba de Levene y comparar el valor P con un nivel de significancia igual a 0.05,
en ambos casos mostr√≥ que existe suficiente evidencia para no rechazar la hip√≥tesis
de homogeneidad de varianza de los errores en los modelos. En las figuras 5 y 6 se
presentan los gr√°ficos de los residuales asociados al modelo ajustado para el mes
de septiembre de 2004 (caso similar al de octubre de 2003), en los cuales se puede
observar que los residuales tienen media cero, varianza constante y no presentan
un comportamiento de correlaci√≥n seriada. No obstante, debido a que los datos han
sido tomados a trav√©s del tiempo, se podr√≠a considerar la posibilidad de que los
errores sean una secuencia estacionaria autocorrelacionada y, por tanto, modelarse
mediante un proceso autorregresivo, tal como lo propone Smith et al. (1998); sin
embargo la estructura de la base de datos necesaria para la implementaci√≥n de

                                                               Horas
Figura 4: Pron√≥stico de la curva t√≠pica de demanda horaria de energ√≠a el√©ctrica de
          octubre de 2004 usando la curva obtenida en el mes de septiembre de 2004.


esta clase de metodolog√≠as no coincide con la usada en este problema, puesto que
se requiere por cada punto de dise√±o un solo dato en la variable repuesta, y en
este caso, por cada punto de dise√±o hay tantos datos como mi√©rcoles hay en el mes
a suavizar. Trabajos m√°s recientes, tales como el de Krivobokoa & Kauermann
(2007) y Currie & Durban (2002), no presentan una alternativa de modelaci√≥n
que permita abordar el problema de regresi√≥n spline no param√©trica con errores
autocorrelacionados y medidas repetidas por punto de dise√±o.
    Una de las principales ventajas de usar modelos spline en la predicci√≥n de la
demanda radica en que solo se necesita un modelo para realizar los pron√≥sticos de
un mes completo. Por su parte, el m√©todo basado en la tasa de crecimiento del PIB
permite predecir la curva t√≠pica para periodos m√°s cortos (trimestral, semestral)
o m√°s largos (superiores a un a√±o) siempre y cuando se cuente con los pron√≥sticos
de la tasa de crecimiento para esos periodos, caso contrario al que sucede con
el m√©todo que emplea el mes anterior al horizonte. Sin embargo, la exactitud de
los pron√≥sticos de la curva t√≠pica de demanda depende de la confiabilidad de la
predicci√≥n de la tasa de crecimiento del PIB, lo cual se convierte en una desventaja
teniendo en cuenta que determinar el PIB en el futuro es un problema que encierra
mucha incertidumbre. Las predicciones obtenidas con el mes anterior al horizonte
solo se pueden realizar siempre y cuando se cuente con todos los datos de demanda
del mes. Esto √∫ltimo representa una de las principales desventajas de este m√©todo,
debido a que los planes de manejo de las empresas generadoras de energ√≠a requieren
las predicciones del horizonte antes de que este inicie. Una posible soluci√≥n ser√≠a
construir los modelos de pron√≥stico con un peque√±o desfase, por ejemplo utilizando
datos del 15 de un mes al 14 del siguiente.
   El siguiente paso consisti√≥ en realizar pron√≥sticos con modelos ARIMA. Pa-
ra construir estos modelos, se debe dividir la informaci√≥n disponible para el d√≠a

                                             Demanda de energ√≠a (MW) estimada

Figura 5: Residuales de la curva t√≠pica de demanda horaria de energ√≠a el√©ctrica estimada
          para el mes de septiembre de 2004 vs. demanda de energ√≠a (MW) estimada.

Figura 6: Residuales de la curva t√≠pica de demanda horaria de energ√≠a el√©ctrica estimada
          para el mes de septiembre de 2004 vs. hora del d√≠a.



mi√©rcoles en 24 series, de tal forma que cada una de ellas represente una hora es-
pec√≠fica. N√≥tese que los pron√≥sticos no corresponder√≠an a la curva t√≠pica asociada
al horizonte de predicci√≥n establecido, ya que los modelos han sido construidos con
los datos puros; por tanto, es necesario realizar tantos pron√≥sticos como mi√©rcoles
tenga este mes.
    Por motivos pr√°cticos y para realizar la comparaci√≥n con los modelos spline
solo se ajust√≥ un ARIMA para una hora espec√≠fica, en este caso la hora 20:00.
Esta hora fue seleccionada porque normalmente es en ese instante del d√≠a cuando
se produce el pico m√°ximo de demanda horaria, el cual es de gran inter√©s para
las empresas que conforman el mercado el√©ctrico. Al aplicar el m√©todo del m√≠nimo
coeficiente de variaci√≥n, se determin√≥ que la serie no requiere ser transformada
para lograr su estabilidad en varianza; adem√°s, debe diferenciarse una vez para
alcanzar estacionariedad en media. Para determinar los √≥rdenes del modelo ARI-
MA se implement√≥ la metodolog√≠a propuesta por BOX-JENKINS basada en el
comportamiento de las funciones de autocorrelaci√≥n simple y parcial. Al analizar
estas funciones se estableci√≥ que no presentan periodos de estacionalidad bien defi-
nidos, puesto que la serie est√° conformada para una misma hora y d√≠a, eliminando
con ello los efectos diarios y horarios; sin embargo, el comportamiento de estas
funciones permiti√≥ establecer que los √≥rdenes de los polinomios autorregresivos y
de promedios m√≥viles son iguales a 3. En la ecuaci√≥n (4) se presenta la estimaci√≥n
del modelo ARIMA(3, 1, 3) asociado a la serie de demanda de energ√≠a el√©ctri-
ca de los mi√©rcoles a las 20:00 conformada con los registros recolectados desde
enero de 2001 hasta septiembre de 2004. Las funciones de autocorrelaci√≥n simple
y parcial fueron estimadas usando el software R y las rutinas acf() y pacf(), res-
pectivamente; la funci√≥n arima() fue implementada para estimar los coeficientes
asociados al modelo ARIMA propuesto.

 Yet = ‚àí0.0207Yet‚àí3 ‚àí0.7732Yet‚àí2 +0.3055Yet‚àí1 ‚àí0.4402at‚àí3 +0.6167at‚àí2 ‚àí0.8388at‚àí1 (4)

donde Yt es el valor de la demanda de energ√≠a en el tiempo t, Yet = Yt ‚àí ¬µ, ¬µ
es la media de la demanda y at es el residual en el tiempo t. Al comparar los
pron√≥sticos generados por este modelo con datos medios en el horizonte de pro-
n√≥stico se encontr√≥ que en t√©rminos generales el error porcentual de pron√≥stico no
fue superior al 2 %, siendo este √∫ltimo un resultado satisfactorio. Los supuestos de
incorrelaci√≥n y normalidad en errores fueron validados y evaluados con la prueba
de Durbin-Watson y Shapiro-Wilk‚Äôs, respectivamente. El m√©todo gr√°fico mostr√≥
que la varianza de los errores parece ser constante a trav√©s del tiempo.
   La desventaja que presenta la implementaci√≥n de modelos ARIMA se encuentra
en la necesidad de ajustar 24 modelos para realizar los pron√≥sticos de un d√≠a,
adem√°s de realizar la validaci√≥n de los supuestos en los que se basa cada uno
de estos modelos. Este hecho demuestra que los ARIMA en la modelaci√≥n de la
demanda de energ√≠a no son viables desde un punto de vista pr√°ctico, puesto que es
una tarea complicada que requiere mucho tiempo. Adem√°s no es posible realizar la
predicci√≥n de la demanda para las horas en las que no se cuente con informaci√≥n.
    Finalmente, al comparar los resultados en la hora 20:00 los errores porcentua-
les de pron√≥stico tanto de los splines como los ARIMA fueron en ambos casos
satisfactorios (< 2 %); sin embargo, el error est√°ndar de los pron√≥sticos genera-
dos por el modelo spline basado en la tasa de crecimiento del PIB (10.3 MW) y
en el mes anterior al pron√≥stico (10.8 MW) son menores que los de los ARIMA
(> 13.3 MW). Esto √∫ltimo conduce a ubicar esta t√©cnica de suavizaci√≥n en posici√≥n
m√°s ventajosa comparada con este modelo de series de tiempo.

    Dado que se contaba con informaci√≥n disponible 45 meses atr√°s (enero de 2001
a septiembre de 2004), se propuso una metodolog√≠a que permitiera estimar la curva
t√≠pica de demanda de energ√≠a el√©ctrica del mes de octubre de 2004, en la cual se
usara la t√©cnica de suavizaci√≥n spline para encontrar la curva caracter√≠stica de los
d√≠as mi√©rcoles en cada uno de estos 45 meses, y luego emplearlas como una serie de
tiempo que pronostique la curva asociada al horizonte de pron√≥stico. No obstante,
considerar modelos de pron√≥stico obtenidos a partir de la combinaci√≥n de modelos
param√©tricos y no param√©tricos implic√≥ un complejo problema te√≥rico relacionado
con la validez del modelo y con la estimaci√≥n de la varianza del estimador. Este
es un problema abierto.
    Se debe mencionar que en el trabajo original los modelos aplicados y propuestos
en este documento fueron aplicados para generar los pron√≥sticos de todos los d√≠as
de la semana. En el caso de los ARIMA se ajustaron 24 modelos por d√≠a.



6. Conclusiones
    Los resultados parecen mostrar que la variable macroecon√≥mica Producto In-
terno Bruto (PIB) tiene una importante relaci√≥n con la demanda de energ√≠a el√©c-
trica del Valle del Cauca, por lo que los modelos que consideran la tasa de creci-
miento de esta variable lucen adecuados para el pron√≥stico de la demanda horaria
en este caso particular. Una generalizaci√≥n de este resultado requerir√≠a un estudio
diferente.
    La calidad de los pron√≥sticos obtenidos a partir de los modelos spline basados
en el mes anterior al horizonte indican que para realizar predicciones de la deman-
da de energ√≠a el√©ctrica del Valle del Cauca en el corto plazo es suficiente contar
con informaci√≥n reciente. La implementaci√≥n de modelos ARIMA no es operacio-
nalmente eficiente para realizar pron√≥sticos de demanda horaria en el corto plazo,
ya que para realizar predicciones se requieren tantos modelos como horas-d√≠as por
estimar; es decir, desde un punto de vista pr√°ctico, la dificultad se encuentra en
la validaci√≥n de los supuestos a tantos modelos. Este es un problema ideal para el
uso de modelos no param√©tricos.
    Adem√°s, no es razonable plantear un modelo multivariante de series de tiem-
po como VAR (Vectores Autorregresivos) para un d√≠a en particular, puesto que
cada serie horaria est√° conformada por datos de demanda registrados en tiempos
diferentes; en otras palabras, estas series no son equivalentes en el tiempo.
    Finalmente, utilizando criterios tales como el error absoluto medio porcentual,
el error porcentual de pron√≥stico y el error est√°ndar de pron√≥stico se determin√≥ que
las metodolog√≠as apoyadas en la t√©cnica de suavizaci√≥n spline en general arrojaron
resultados similares y los pron√≥sticos fueron acertados respecto a las curvas t√≠picas
asociadas al horizonte preestablecido; entre tanto, los modelos ARIMA ajustados
sobre los datos puros no realizaron en la mayor√≠a de los casos un buen pron√≥stico
de los d√≠as del mes de octubre de 2004. Los errores est√°ndar de pron√≥stico de los
modelos ARIMA son mayores que los generados por los modelos spline.
7. Posibles extensiones de este trabajo
    Con el fin de mejorar estos procesos de estimaci√≥n se establece alternativamen-
te desarrollar en el futuro algunos trabajos tales como el planteamiento de modelos
de regresi√≥n no param√©trica que consideren los factores regulatorios que definen
las condiciones temporales reales del pron√≥stico de la demanda horaria de ener-
g√≠a el√©ctrica en Colombia; tambi√©n podr√≠a considerarse la inclusi√≥n en el an√°lisis
de intervalos de confianza de la tasa de crecimiento del Producto Interno Bruto
para realizar pron√≥sticos de demanda horaria de energ√≠a. Igualmente, se podr√≠a
intentar ajustar un modelo de pron√≥stico de demanda considerando el impacto de
variables clim√°ticas y macroecon√≥micas. Otra opci√≥n ser√≠a evaluar el uso de mo-
delos de regresi√≥n param√©trica, tales como polinomios, usando una metodolog√≠a
similar a la planteada en este trabajo. En este caso se debe tener en cuenta la
validez de estos modelos de acuerdo con el n√∫mero de grados de libertad efectivos
y la falta de ajuste. Adem√°s, es necesario determinar metodolog√≠as que permitan
analizar este problema usando modelos de regresi√≥n no param√©trica con errores
autocorrelacionados. Finalmente, se podr√≠an plantear modelos de series de tiempo
no param√©trico.
Referencias
Blacon√° M T,Abril J C.Modelo estructural de espacio de estado para la demanda diaria promedio de energ√≠a el√©ctrica en la rep√∫blica Argentina.(2000).Asociaci√≥n Argentina de Econom√≠a Pol√≠tica.
Currie I,Durban M.Flexible Smoothing with P-splines: An Unified Approach.(2002).Statistical Modelling.
Eilers P,Marx B.Flexible smoothing with B-splines and Penalties.(1996).Statistical Science.
Eubank R L.Nonparametric Regresi√≥n and Spline Smoothing.(1999).Marcel Dekker.New York.
Fern√°ndez L.La demanda residencial de electricidad en Espa√±a: un an√°lisis microeconom√©trico de la demanda el√©ctrica residencial de corto plazo en Espa√±a.(2006).Universidad de Vigo.Vigo - Espa√±a.
Green P J,Silverman B W.Nonparametric Regression and Generalized Linear Models.(2000).Chapman and Hall.New York.
Harris J,Liu L.Dynamic Structural Analysis and Forecasting of Residential Electricity Consumption.(1993).International Journal of Forecasting.
Harvey A,Koopman S J.Forescasting Hourly Electricity Demand using Time Varying Splines.(1993).Journal of American Statistics Association.
Hendricks W,Koenker R.Hierarchical Spline Models for Conditional Quantiles and the Demand for Electricity.(1992).Journal of the American Statistical Association.
Krivobokoa T,Kauermann G.A Note on Penalized Smoothing with Correlated Errors.(2007).Journal of the American Statistical Association.
Murillo J,Trejos,Carvajal P.Estudio del pron√≥stico de la demanda de energ√≠a el√©ctrica, utilizando modelos de series de tiempo.(2003).Scientia et Technica.
Olaya J.Suavizaci√≥n y regresi√≥n no param√©trica.(2002).Universidad del Valle.Santiago de Cali.
Poirier D L.Piecewise Regression using Cubic Splines.(1973).Journal of the American Statistical Association.
Poirier D L,Hendricks W,Koenker R.Residential Demand for Electricity: An Econometric Approach.(1979).Journal of Econometrics.
R Development Core Team.R: A Language and Environment for Statistical Computing.(2006).R Foundation for Statistical Computing.Austria.
Smith M,Wong C,Kohn R.Additive Nonparametric Regression with Autocorrelated Errors.(1998).Journal of the Royal Statistical Society.
Valencia A L.Diagn√≥stico del modelo de pron√≥stico de demanda de potencia y energ√≠a el√©ctrica de EPSA.(2005).Universidad del Valle.
Wegman E J,Wrigth I W.Splines in Statistics.(1983).Journal of American Statistical Association.
Wood S.Generalized Additive Models: An introduction with R.(2006).Chapman & Hall.Florida.