Metodologı́a para estimar celdas vacı́as con el modelo de medias de celdas en diseños conectados
Universidad Nacional de Colombia
Resumen
En este artı́culo se proponen dos métodos para estimar celdas vacı́as y para imputar datos faltantes en diseños conectados en un experimento multifactorial, a partir del modelo de medias de celdas modificado. La primera propuesta tiene como soporte teórico el método de covarianza de Bartlett con base en el modelo de medias de celdas con restricción de efectos; la segunda se basa en la estimación por mı́nimos cuadrados con restricciones de no interacción. Además, se presenta una expresión general para estimar celdas con información faltante, con cualquiera de los métodos propuestos. Se demuestra que el estimador obtenido por el método de covarianza coincide con el de mı́nimos cuadrados con la restricción de no interacción entre los efectos. Se propone una metodologı́a para determinar el número mı́nimo de celdas que se deben estimar para que el diseño se conecte, y además se muestra cuáles celdas son las que se deben imputar para lograr la conexión. Una vez hecha la imputación de la información faltante, se plantea el análisis de varianza con los ajustes respectivos en las sumas de cuadrados. Por último, se ilustra la aplicación de las propuestas con un ejemplo numérico a tres vı́as de clasificación, sin interacción, con efectos fijos.
Palabras claves: Diseños conectados, modelos de medias de celda, funciones estimables, modelo con restricción, diseños desbalanceados.
Abstract
In this paper we propose two methods to estimate empty cells and to impute missing data in connected designs. The first is supported on Bartlett’s covariance method on the basis of cell means model with effect restriction; the second is based on the least squares estimation method with no interaction. A general expression is proposed to estimate cells with missing information. The equality of the estimators obtained by these methods is demonstrated and a lower bound to the number of cells needed to be estimated, so that the design is connected, is calculated.
The adjusted anova is presented and finally, a 3-way no interaction fixed effects model is used to illustrate the two methods.
Keywords: Connected designs, cell means models, estimable functions, restriction model, unbalanced designs.



1.     Introducción
    En el estudio de diseños de experimentos se hace uso de modelos superpa-
rametrizados y modelos de medias de celdas. La estructura de los datos puede
ser balanceada o desbalanceada, y aún más, de acuerdo con la naturaleza del
problema y la complejidad del experimento, puede haber celdas vacı́as, cuya
presencia, por lo general, no es planteada por el investigador y se debe más a
causas ajenas al experimento que a las condiciones propias del material expe-
rimental.
    Cuando hay celdas vacı́as, no todas sus medias asociadas son estimables y,
en consecuencia, las hipótesis sobre combinaciones lineales de medias pueden
no tener ningún interés práctico o no tener solución dentro de la teorı́a general
de las hipótesis lineales. Sin embargo, si se imponen restricciones sobre las
interacciones de efectos, es posible conectar el diseño y tener todas las hipótesis
efectivas de interés práctico para la investigación.
    Imponer restricciones para lograr que el diseño se conecte, debe ser una
tarea conjunta entre el experimentador y el estadı́stico. En un arreglo factorial
con tres factores, por ejemplo, puede suceder que la condición de no interacción
entre los tres factores sea suficiente para que el diseño se conecte; si esto no
se logra, se debe imponer restricciones de no interacción sobre algunos efectos
dobles procurando ası́ conectar el diseño para poder estimar algunas medias de
celdas donde inicialmente no se tenı́a información.
    La disponibilidad de paquetes estadı́sticos ha permitido manejar, dentro
del marco del modelo lineal general, el análisis de varianza con modelos multi-
factoriales con presencia de celdas vacı́as. Sin embargo, se debe tener extremo

Metodologı́a para la estimación de celdas vacı́as                                  45


cuidado con el uso de aquellos paquetes que no hacen referencia explı́cita a las
expresiones utilizadas para calcular las diferentes sumas de cuadrados, lo cual
dificulta la identificación de las hipótesis asociadas a los factores e interacciones
del arreglo.
   En estudios experimentales multifactoriales, las celdas vacı́as generan pro-
blemas para identificar las funciones estimables. Desde la década de los 60 se ha
venido trabajando en este tema, destacándose el trabajo de Weeks y Williams
(1964) como marco para la identificación de funciones estimables en modelos
a n-vı́as de clasificación. A pesar de los avances logrados en el tema, como se
muestra en Dodge (1985), no hay consenso en cuanto a las metodologı́as que
conllevan tanto a la identificación de funciones estimables, como a la estimación
de celdas vacı́as.
    Cuando hay información con celdas vacı́as, surge la preocupación por esta-
blecer con claridad el conjunto de medias de celdas estimables, y la base de las
funciones estimables. La naturaleza de estas funciones depende de si el modelo
puede conectarse, puesto que esta propiedad se relaciona con la cantidad de
información que se pierde por las celdas vacı́as y la que queda disponible para
el análisis.
    El concepto de conectés fue introducido por Bose y Srivastava (1964) quienes
la definieron para modelos a dos vı́as de clasificación, estableciendo una cadena
entre bloques y tratamientos. Para el modelo de bloques, por ejemplo, dos
celdas cualesquiera, (i, j) y (r, t), se dicen conectadas si se puede pasar de una
a la otra a lo largo de una fila (o columna) de celdas observadas; el camino
puede ser descrito como:

                      (i, j) → (i, v) → (u, v) → (u, t) → (r, t),

donde, todas las celdas en el camino contienen información. Si esta condición
se tiene para todas las parejas de celdas observadas, el diseño se dice conectado.
    Para el caso de información con celdas vacı́as, Searle (1971) y Graybill
(1976) describen la conectés para modelos a dos vı́as de clasificación, donde
es posible llevar a cabo la estimación de las medias correspondientes a celdas
vacı́as, y además proponen una metodologı́a simple para determinar la conectés.
Searle (1987) presenta para el caso de dos factores la conectés geométrica, la
cual suministra un método directo para determinar si los datos de un modelo
a dos vı́as de clasificación son conectados. En el caso de la conectés a n vı́as de
clasificación Weeks y Williams (1964), Murray y Smith (1985), Birkes (1976)
y Dodge (1985) describen diferentes métodos para encontrar si un conjunto de
datos obtenidos a partir de arreglos factoriales está conectado; además ilustran
la forma de encontrar la base generadora de las funciones estimables, cuando

46                               Sandra E. Melo & Luis A. López & Oscar O. Melo


se tienen arreglos con celdas vacı́as.
    En este artı́culo inicialmente se estudia el método de conectés descrito en
Murray y Smith (1985), cuando se tiene el modelo de medias de celdas pre-
sentado en Hocking (1985). La técnica de conexión se basa en el modelo de
medias de celdas modificado, imponiendo restricciones de no interacción entre
efectos, con lo cual se reduce su dimensionalidad. En el modelo con restriccio-
nes, se examina el rango de la matriz diseño; si es de rango completo, el diseño
es conectado; en el caso contrario, se debe determinar el número de celdas por
estimar para conectar el diseño y realizar luego los análisis respectivos sobre los
diferentes factores de interés. En este artı́culo se proponen dos métodos estimar
celdas vacı́as, sujetos a la restricción de no interacción.


2.     Conceptos básicos de modelos lineales
    En este apartado se muestran algunas ideas básicas sobre modelos linea-
les superparametrizados, como marco teórico inicial para el desarrollo de esta
propuesta.
   El modelo lineal presentado en Graybill (1961, 1976), Searle (1971, 1987),
Hocking (1985), está dado por:

                                   Y = Xθ + e,                                   (1)

donde: Yn×l es un vector de variables aleatorias, Xn×p es una matriz conocida
(matriz de diseño) de rango k ≤ mı́n{n, p}, θp×1 es un vector de parámetros
desconocidos y en×1 es un vector de variables aleatorias no observables. Se
supone que e ∼ N (0, σ 2 I).
   El modelo de medias de celdas estudiado, entre otros, por Speed (1978),
Hocking (1985, 1996), Searle (1987) y Murray y Smith (1985), está dado por:

                                   Y = W µ + e,                                  (2)

sujeto a
                                      Gµ = g,                                    (3)
donde, Y y e son vectores descritos en (1), W es una matriz de incidencia
de orden n × p que asocia las observaciones con sus valores medios e indica
el número de observaciones con media µij···s , µ es un vector de p medias po-
blacionales desconocidas y G una matriz s × p, de constantes desconocidas de
rango s, la cual representa las relaciones lineales conocidas sobre las medias de
celdas, especificando contrastes sin interacción.

Metodologı́a para la estimación de celdas vacı́as                               47


    Si no hay celdas vacı́as, W tiene rango columna completo. Si las hay, en-
tonces W tiene una columna igual a cero por cada celda vacı́a y µ mantiene su
estructura; es decir, mantiene el mismo número de parámetros como si todas las
celdas hubiesen sido observadas. En la siguiente sección se presenta el método
de Murray y Smith, soporte para el desarrollo de los métodos propuestos.



3.     Método de Murray y Smith
    El investigador, por lo general, está interesado en saber si los parámetros
pueden ser estimados con la información disponible. En el caso de celdas vacı́as,
la estimación de parámetros y la formulación de hipótesis sobre los parámetros,
depende de que el diseño se pueda conectar, al imponer restricciones especı́ficas
sobre éste. Si los datos del experimento son conectados con respecto al modelo
original, entonces pueden ser estimados y además, el investigador puede plan-
tear todas las hipótesis de interés práctico para la investigación. El método
basado en el modelo de medias de celdas modificado presenta adicionalmente
una prueba simple para determinar si el diseño es conectado.
    El modelo de medias de celda modificado es más útil que el modelo (2) y
(3) cuando hay celdas vacı́as. Se obtiene sustituyendo el conjunto de contrastes
Gµ = 0, directamente dentro del modelo, con lo cual se reduce su dimen-
sionalidad. Para ello se hace un reordenamiento de las columnas de G como
G = [G1 | G2 ], donde G2 es una matriz s × s de rango s y G1 una matriz
de orden s × (p − s). Las filas de µ se particionan en correspondencia con la
partición de G: µ0 = [µ01 | µ02 ]. Entonces, el contraste Gµ = 0 implica que

                              Gµ = G1 µ1 + G2 µ2 = 0.                           (4)

Como G2 es de rango completo, existe una solución única para µ2 en términos
de µ1 , dada por:
                           µ2 = −G−1 2 G1 µ1 .                             (5)

     G2 se elige arbitariamente, pero debe ser una matriz no singular. En muchas
situaciones experimentales es fácil encontrar el conjunto de medias para µ1 y
µ2 , lo cual lleva a que la matriz G2 sea no singular y por lo tanto invertible.
     La partición de µ es independiente de los datos obtenidos; en particular, es
independiente del número de celdas vacı́as (m) y de su localización. La partición
sólo depende de G y de las relaciones lineales entre las medias involucradas;
ası́ que esta partición está basada en cómo se concibió el experimento y no en
cómo se realizó.

48                               Sandra E. Melo & Luis A. López & Oscar O. Melo


    La partición (4) lleva a un reordenamiento de la matriz de incidencia W ,
en concordancia con las particiones de G y de µ, es decir, W = [W1 | W2 ]; ası́,
al sustituir (5) en (2), se llega al modelo de celdas modificado, más útil que (2)
y (3) cuando hay celdas vacı́as. Por otro lado, si se sustituye (4) directamente
dentro del modelo, se llega al modelo particionado:
                                       µ ¶
                                        µ1
                        Y = [W1 | W2 ]      +e                                  (6)
                                        µ2
                                       µ        ¶
                                           I
                          = [W1 | W2 ]            µ1 + e                        (7)
                                        −G−1
                                           2 G1
                          = V µ1 + e,                                           (8)

donde V = W1 − W2 G−1    2 G1 , es de tamaño n × (p − s). En (8) si el rango de
V es (p − s), entonces V 0 V es no singular y se puede aplicar el método usual
de mı́nimos cuadrados para modelos de rango completo sin restricción para la
solución de µ1 , y entonces el M ELI(µ1 ) es

                                b1 = (V 0 V )−1 V 0 Y,
                                µ                                               (9)

y el M ELI(µ2 ) es
                                b2 = −G−1
                                µ           b1 .
                                       2 G1 µ                                  (10)

    Cuando no hay celdas vacı́as, el rango de V es (p − s), las soluciones (9) y
(10) siguen siendo los únicos M ELI de µ1 y µ2 y la solución de parámetros es
entonces µ           b02 ]0 . Si el rango de V es menor que (p − s), escencialmente
               µ01 | µ
          b = [b
se tiene el mismo problema del modelo superparametrizado cuando la matriz
X no es de rango completo. En Murray y Smith (1985) y Hocking (1985) se
muestra que cuando hay celdas vacı́as, el modelo descrito por (2), (3) y (8) es
conectado si V tiene rango columna completo.
  Es conveniente tener en cuenta los siguientes puntos cuando se hace uso del
modelo de medias de celda modificado:


     i. G puede obtenerse de infinitas formas, para un conjunto especı́fico de
        contrastes.

     ii. Según Murray (1986), puede ser complicado encontrar la submatriz G2
         cuando el número de contrastes es grande, lo cual complica también la
         partición de la matriz G.

Metodologı́a para la estimación de celdas vacı́as                               49


3.1.    Estimabilidad y conectés

    El concepto de estimabilidad en el modelo de medias de celdas es simple y se
puede sintetizar en la siguiente pregunta: ¿hay suficiente información disponible
para estimar funciones lineales de las medias de celdas? La respuesta a esta
pregunta es muy sencilla si todas las celdas son observadas; sin embargo, cuando
hay celdas vacı́as y se encuentran relaciones apropiadas entre las medias de
las celdas teniendo en cuenta la restricción Gµ = g, entonces el problema
importante se centra en la estimación. El método relaciona la estimabilidad de
las medias de celda con el concepto de conectés y posteriormente se desarrolla
una prueba simple para la estimabilidad de µ cuando el diseño se ha conectado,
basado en el modelo (8). La siguiente definición ilustra el concepto de conectés
según Hocking (1985, 1996).

Definición 3.1. Un experimento conformado por un conjunto de datos y un
modelo de medias de celdas asociado, (modelo M ) como en (8), se dice conec-
tado si µ es linealmente estimable, de forma única.

   Se puede notar en las definiciones dadas por Searle (1971, 1987) y Weeks
y William (1964) que la conectés se restringe a modelos de efectos principales,
mientras que la definición 3.1 se aplica a cualquier modelo de medias de celda
con o sin restricción (Murray y Smith, 1985).
    Un conjunto particular de datos puede ser conectado por un modelo y no
por otro. Por ejemplo, en el modelo de clasificación con tres factores, se tienen
varios niveles de conectés dependiendo de la restricción necesaria para alcanzar
la estimabilidad de µ. La condición de no interacción entre los factores puede ser
suficiente para obtener la estimación de todos los µijk cuando hay celdas vacı́as
en un diseño a tres vı́as de clasificación. Si ésta no es suficiente, entonces la
imposición de restricciones sobre una o más de las interacciones de dos factores
puede conducir a la estimabilidad.
   Un nuevo criterio para establecer la conectés, basado en el modelo de medias
de celdas modificado (8) y la definición 3.1, es objeto del siguiente teorema,
propuesto y demostrado por Murray y Smith (1985):

Teorema 3.1. Para el modelo (2) y (3) el experimento es conectado si y sólo
si V = W1 − W2 G−1
                2 G1 tiene rango columna completo, es decir, el rango de V
es p − s < n.

    Si V tiene rango columna completo, entonces el experimento es conectado, µ
es linealmente estimable en su totalidad y el análisis original puede ser llevado
a cabo como se planeó. Si V no tiene rango columna completo, entonces el

experimento no es conectado, µ no es linealmente estimable y el análisis original
no puede realizarse. En este caso el modelo de medias de celdas (2) y (3) no es
de rango completo.


3.2.       Expresión matricial para la restricción de no
           interacción

   En Murray y Smith (1985) se presenta una expresión matricial conveniente
para la restricción de interacción en el modelo de dos vı́as de clasificación:

                                         Da ⊗ Db ,                             (11)

donde Di está definido por:

                                   Di = (Ii−1 | −Ji−1 ).                       (12)

Ii−1 es la matriz identidad de dimensión i−1 y Ji−1 , el vector columna de unos,
de longitud i − 1. El uso de estas matrices Di es conveniente para describir las
restricciones que involucran interacciones de orden dos o superior.
   Esta idea puede ser generalizada para n-vı́as de clasificación con factores
con mi niveles, i = 1, 2, . . . , n.
     Sea              ½
                          Di     si la interacción involucra el factor i,
               Mi =                                                            (13)
                          Ji0    en caso contrario,
entonces la matriz de restricciones (3) para una interacción dada es:

                                G = M1 ⊗ M2 ⊗ · · · ⊗ Mn .                     (14)


4.     Métodos propuestos para estimar las celdas
       vacı́as
     En esta sección se presentan dos métodos diferentes para estimar las celdas
vacı́as teniendo como base, en primer lugar, el modelo de covariable con restric-
ción a través del modelo de medias de celdas. El segundo método, permite la
estimación de datos faltantes cuando se imponen restricciones de no interacción
al modelo, pero la estimación se hace con mı́nimos cuadrados ponderados. En
los dos casos, para que el método sea aplicado, se requiere que el diseño sea
conectado; cuando no lo es, se deben tener en cuenta algunas consideraciones
adicionales.



4.1.    Método de estimación por mı́nimos cuadrados con
        restricción

    Para implementar el método, se considera el modelo presentado en (2) su-
     µ ¶que hay m celdas vacias; luego, se realiza una partición del vector
poniendo
       y1
Y =        , donde y1 se arregla de tal forma que contenga la información ob-
       y2
servada y y2 sea el vector asociado con la información faltante. En forma similar
se hace la partición de la matriz W , de tal forma que las matrices de diseño
W1 y W2 se asocien con la información observada y faltante respectivamente.
Se puede escribir ahora (2) como:
                              µ ¶ µ ¶
                                y1       W1
                                    =          µ + e,                         (15)
                                y2       W2

sujeto a la restricción (4).
   Se hace luego una partición adicional de las submatrices W1 y W2 , que
corresponda con la partición de la matriz de restricciones G. Ası́, (15) se escribe
como:                 µ ¶ µ                  ¶µ ¶
                        y1        W11 W12        µ1
                              =                        + e,
                        y2        W21 W22        µ2
donde W11 , W12 , W21 , W22 son de orden (n−m)×(p−s), (n−m)×s, m×(p−s),
m × s respectivamente. Esta partición lleva a los siguientes modelos:

                                y1 = W11 µ1 + W12 µ2 + e1                      (16)
                                y2 = W21 µ1 + W22 µ2 + e2 ,                    (17)

sustituyendo (5) en (16) se obtiene:

                         y1 = W11 µ1 − W12 G−1
                                            2 G1 µ1 + e1 ,

la cual también puede expresarse como:

                                     y1 = V1 µ1 + e1 ,                         (18)

donde, V1 = W11 − W12 G−1 2 G1 es una matriz de orden (n − m) × (p − s), V1
es la submatriz de indicadores con las restricciones de no interacción asociada
a los datos observados.
   El estimador de mı́nimos cuadrados de µ1 en el modelo (18) es:

                                   b1 = (V10 V1 )−1 V10 y1 .
                                   µ                                           (19)

52                              Sandra E. Melo & Luis A. López & Oscar O. Melo


Por otra parte, sustituyendo (5) en (17), se llega al modelo:

                       y2 = W21 µ1 − W22 G−1
                                          2 G1 µ1 + e2 ,

que puede reducirse a:
                                y2 = V2 µ1 + e2 ,                            (20)
donde V2 = W21 − W22 G−1
                      2 G1 es una matriz de orden m × (p − s), que corres-
ponde a la submatriz de indicadores con las restricciones de no interacción
correspondiente a los datos no observados. A partir del modelo (20) y del es-
timador para µ1 , obtenido en (19), se encuentra la expresión alternativa para
la estimación de información faltante, cuando se imponen restricciones en el
modelo:
                                 b1 = V2 (V10 V1 )−1 V10 y1 .
                        yb2 = V2 µ                                         (21)
El estimador presentado en (21) depende del vector de datos observados y de
las matrices V2 y V1 .
    Es importante determinar cuántas celdas deben ser estimadas para que el
diseño se pueda conectar, pues la conectés del diseño garantiza la posibilidad
de aplicar los resultados encontrados en (21). Para ello, se realiza una nueva
partición del vector de datos faltantes y2 . De esta manera se determinan las
celdas que no se pueden conectar. El conjunto de estas celdas indica las que
deben ser estimadas para lograr la conectés. Ası́, una vez lograda la conexión,
se puede utilizar el método de estimación por mı́nimos cuadrados sujeto a la
restricción para estimar estas celdas vacı́as o el método de covariable sujeto a
la restricción de no interacción, propuestos en este artı́culo.
                                     µ ¶
                                       y3
    Si se realiza la partición y2 =      , donde y3 corresponde a las celdas que
                                       y4
se pueden conectar y y4 a las que no, entonces el modelo (20) se puede escribir
como:                               µ ¶
                                      y3
                               y2 =       = V2 µ1 + e2 .                      (22)
                                      y4

   Si ahora se particiona la matriz V2 de forma que corresponda a la partición
hecha para y2 , el modelo anterior se puede escribir como:
                          µ ¶ µ ¶             µ ¶
                            y3       V3         e
                                 =       µ1 + 3 ,                         (23)
                            y4       V4         e4

o en forma explı́cita los modelos:

     i) y3 = V3 µ1 + e3 . Este modelo se puede conectar y, en consecuencia,
        todas las celdas vacı́as son estimables.

Metodologı́a para la estimación de celdas vacı́as                                 53


  ii) y4 = V4 µ1 + e4 . Con este modelo se debe determinar el conjunto de
      celdas no conectadas para estimarlas y lograr la conectés. La estimación
                             b∗1 = (V10 V1 )− V10 y1 , donde (V10 V1 )− es una inversa
      de µ1 se encuentra con µ
      generalizada. La solución para las celdas desconectadas es entonces:

                                  yb4 = V4 (V10 V1 )− V10 y1 .                   (24)


    En un diseño desconectado, las estimaciones negativas o cero para los datos
faltantes, obtenidas por el proceso de estimación descrito, son las que generan la
desconectés del diseño. En el caso de diseños conectados, el método propuesto
es una buena alternativa para la estimación de los datos faltantes.


4.2.    Metodologı́a para determinar el número de celdas
        por estimar para conectar el diseño

    Para determinar el número de celdas vacı́as que deben ser estimadas para
conectar el diseño, es necesario encontrar en (24) el número filas que convierte
la matriz V10 V1 en una de rango completo, ya que siendo singular, el diseño es
desconectado. La diferencia entre el número de filas de la matriz V10 V1 y su
rango determina el número de celdas que es necesario estimar para tener un
diseño conectado. Además, es posible desarrollar una expresión algebraica que
permite determinar las filas de V2 en el modelo (20) que causan la desconexión
del diseño.
    Como V2 es una submatriz de indicadores con las restricciones de no inter-
acción, asociada a los datos no observados, la matriz V ∗ = V2 (V10 V1 )− (V10 V1 )
contiene las filas que corresponden a celdas conectadas y no conectadas. Al
establecer una correspondencia de filas entre la matriz V2 y V ∗ , aquellas cuyos
elementos coinciden corresponden a las filas de las celdas que se conectan, en
tanto que las filas que no coinciden, corresponden a las filas de las celdas no
conectadas.
    Por otra parte, V3 (V10 V1 )− (V10 V1 ) = V3 , pues las filas de V3 son combina-
ciones lineales de las filas de V1 , ya que en esta matriz se encuentran las celdas
que se pueden conectar.
    Las filas de la matriz V3 son precisamente las que corresponden a las celdas
conectadas, mientras que el resto son las que generan la desconectés del diseño
y por esta razón deben ir en la matriz V4 . Las filas de V2 que no coincidan con
sus correspondientes en la matriz V ∗ están determinando las celdas se deben
ser estimadas para conectar el diseño.


4.3.     Método de estimación por covariable sujeto a
         restricción

    En esta sección se presenta el segundo método propuesto, denominado méto-
do de estimación por covariable, sujeto a la restricción de no interacción entre
efectos. Con él se llega a una expresión para la estimación de celdas vacı́as que
coincide con la obtenida por mı́nimos cuadrados, como se muestra en la sección
4.4.
     Se considera el siguiente modelo de medias de celdas con covariable:
                               µ ¶ µ ¶
                                y1      W1
                         Y∗ =       =       µ + Zγ + e,                        (25)
                                0       W2

                                 b2 dado por (10).
sujeto a la restricción (4) con µ
   En este caso la matriz W se particiona como en la sección 4.1, de tal forma
que corresponda con la partición hecha de la matriz de restricciones G, y como
por el método de covariable y2 = 0, entonces se tiene el sistema:
                µ ¶ µ                 ¶µ ¶ µ            ¶
                  y1      W11 W12         µ1         O
                      =                        +          γ + e,            (26)
                  0       W21 W22         µ2        −I

donde W11 , W12 , W21 y W22 son matrices de orden (n−m)×(p−s), (n−m)×s,
m × (p − s) y m × s respectivamente.
   De (26) y sustituyendo por la expresión obtenida para µ2 en (5) se tiene
que:        µ ¶ µ                              ¶ µ ¶
              y1      W11 µ1 −W12 G−1 2  G1 µ1       O
                   =                            +        γ + e.         (27)
              0       W21 µ1 −W22 G−1 2  G  µ
                                           1 1      −I


     De (27) se obtiene el modelo presentado a continuación:
                             µ ¶ µ ¶
                               y1       V1
                        Y∗ =       =       µ1 + Zγ + e,                        (28)
                               0        V2

donde, V1 = W11 − W12 G−1
                        2 G1 matriz de orden (n − m) µ ×¶(p − s), V2 =
                                                       O
W21 − W22 G−1
           2 G1 una matriz de orden m × (p − s) y Z = −I , con I = Im .


     Reescribiendo (28) se obtiene:
                                                    µ ¶
                     ∗
                                      ¡            ¢ µ1
                   Y = V µ1 + Zγ + e = V         Z      + e.                   (29)
                                                     γ

Metodologı́a para la estimación de celdas vacı́as                                          55


   Entonces (30) y (31) pueden ser escritos de la siguiente manera:

                           V 0 Y ∗ = V10 y1 = V 0 V µ1 − V20 γ
                           Z 0 Y ∗ = 0 = −V2 µ1 + Im γ.

   Por otro lado, premultiplicando (30) por V (V 0 V )−1 se obtiene la siguiente
expresión:

            V (V 0 V )−1 V 0 Y ∗ = V (V 0 V )−1 V 0 V µ1 + V (V 0 V )−1 V 0 Zγ,

de la anterior ecuación se sabe que PV = V (V 0 V )−1 V 0 es el proyector ortogonal;
por lo tanto, la ecuación anterior se escribe también como:

                               PV Y ∗ = V µ1 + PV Zγ,

agrupando términos se obtiene:

                                PV (Y ∗ − Zγ) = V µ1 ,                                     (32)

56                                              Sandra E. Melo & Luis A. López & Oscar O. Melo


si se premultiplica (29) por Z 0 , y si Z 0 e = 0, se obtiene la expresión:

                                            Z 0 Y ∗ = Z 0 V µ1 + Z 0 Zγ.                                    (33)

         Reemplazando (32) en (33) se tiene que:

                                  Z 0 Y ∗ = Z 0 PV (Y ∗ − Zγ) + Z 0 Zγ,

y reagrupando términos se encuentra el sistema de ecuaciones normales:

                                  Z 0 (I − PV )Y ∗ = Z 0 (I − PV )Zγ.                                       (34)

                                                     ¶              µ
                                              S M
         Ahora, sea I − PV = I − V (V 0 V )−1 V 0 =    , donde S, M y L son
matrices de orden (n − m) × (n − m), (n − m) × m y m × m respectivamente,
con n el tamaño de Y ∗ . Como I − PV es idempotente, se cumple que:

    La expresión anterior permite estimar la información faltante en las celdas,
cuando los datos se ajustan a un modelo de medias de celdas y se imponen
restricciones de no interacción. Es importante que se tenga en cuenta que si el
diseño no se puede conectar, la matriz L es singular, por lo tanto la expresión
(37) no es pertinente.

Metodologı́a para la estimación de celdas vacı́as                                    57


4.4.    Comparación de los métodos propuestos

    El teorema 4.1 muestra la equivalencia entre los dos métodos de estimación
propuestos en este trabajo para la estimación de información faltante cuando
los datos se ajustan con modelos de medias de celdas sujetos a restricciones de
no interacción.
Teorema 4.1. El estimador γ    b, obtenido por el método de covariables y el esti-
mador yb2 , obtenido por el método de los mı́nimos cuadrados, son equivalentes.

Demostración: Teniendo en cuenta que

Es decir, se ha comprobado que el estimador por covariable (37) es equivalente
al de mı́nimos cuadrados expuesto en (21).


4.5.    Descomposición de las sumas de cuadrados con la
        información imputada

    En esta sección se lleva a cabo la descomposición de las sumas de cuadrados
del análisis de varianza a partir de la metodologı́a propuesta, cuando se incluyen

los valores estimados en las celdas donde inicialmente no se tenı́a información.
     Se sabe que la suma de cuadrados total corregida por la media es:
La suma total de cuadrados con los datos imputados es:
donde el subı́ndice CDI significa “con datos imputados”.
   Cuando no se incluyen las estimaciones de las celdas en el modelo, la suma
total de cuadrados se obtiene como:
                                          1 0
                       SCTSID = y10 y1 −    y 11 10 y1 .
                                         n1 1 1
donde el subı́ndice SID significa “sin imputar datos”.
    Comparando la expresión anterior con (39), se observa que la suma total de
cuadrados imputando datos es mayor o igual que la suma total de cuadrados
sin imputar.
   Por otra parte, la suma de cuadrados del modelo (8) es SCM = Y 0 V (V 0 V )−1 V 0 Y ,
luego la suma de cuadrados del modelo al imputar los datos es:
                      µ ¶µ            µ ¶¶−1               µ ¶
           ¡        ¢ V1     ¡ 0     ¢ V1       ¡ 0       ¢ y1
SCMCDI = y10 yb20             V1 V20             V1 V20
                        V2              V2                  yb2
           = (y10 V1 + yb20 V2 )(V10 V1 + V20 V2 )−1 (V10 y1 + V20 yb2 )
           = (y10 V1 + y10 V1 (V10 V1 )−1 V20 V2 )(V10 V1 + V20 V2 )−1 (V10 y1 + V20 V2 (V10 V1 )−1 V10 y1 )
           = y10 V1 (V10 V1 )−1 V10 y1 + y10 V1 (V10 V1 )−1 (V20 V2 )(V10 V1 )−1 V10 y1
           = y10 V1 (V10 V1 )−1 V10 y1 + yb20 yb2 .                                             (40)
La suma de cuadrados corregida por la media, imputando los datos, es:
                                                 1
SCMCDICM = y10 V1 (V10 V1 )−1 V10 y1 + yb20 yb2 − (y10 11 101 y1 + 2b
                                                                    y20 12 101 y1 + yb20 12 102 yb2 ),
                                                 n
y la suma de cuadrados del modelo sin imputar los datos es:
                               SCMSID = y10 V1 (V10 V1 )−1 V10 y1 .

Metodologı́a para la estimación de celdas vacı́as                                             59


En forma semejante, la suma de cuadrados del modelo, corregida por la media,
sin imputar los datos, es:
                                                                 1 0
                SCMSDICM = y10 V1 (V10 V1 )−1 V10 y1 −            (y 11 10 y1 ).
                                                                 n 1 1
De (40) se observa que la suma de cuadrados del modelo al imputar los datos,
es mayor o igual que la suma de cuadrados del modelo sin imputar.
   La suma de cuadrados del error, sin imputación de datos es:

                         SCE = Y 0 (I − PV )Y
                                 = Y 0 Y − Y 0 V (V 0 V )−1 V 0 Y

y con imputación de datos es:
                                         µ ¶
                     ¡                  ¢ y1
             SCECDI = y10        yb20         − y10 V1 (V10 V1 )−1 V10 y1 − yb20 yb2 ,
                                          yb2
                       = y10 y1 + yb20 yb2 − y10 V1 (V10 V1 )−1 V10 y1 − yb20 yb2
                       = y10 (I1 − V1 (V10 V1 )−1 V10 )y1 .                                   (41)

Ası́, la suma de cuadrados del error con imputación de datos es igual a la suma
de cuadrados del error sin imputación.
   La Tabla 1 resume el análisis de varianza con los datos imputados.


Tabla 1: Análisis de varianza para el modelo de medias de celdas, corregido por
la media, imputando datos.

5.      Ejemplo de aplicación
     En esta sección se presenta, como ejemplo, un diseño a tres vı́as de cla-
sificación con efectos fijos, sin interacción, para ilustrar el desarrollo de las
metodologı́as propuestas en la sección 4.

                Tabla 2: Arreglo de una estructura factorial 2 × 3 × 4

    El ejemplo es tomado de Myers & Montgomery (1995). En el experimento
se consideraron tres factores que influyen sobre la superficie terminal de una
partı́cula metálica: tasa de desgaste (en pulgadas por minuto), profundidad de
corte (en pulgadas) y tipo de material. Se tomaron dos observaciones para cada
una de las 24 combinaciones, obteniendo el conjunto de datos que se muestra
en la Tabla 2. Suponiendo una pérdida aleatoria de información, se procedió a
retirar la información que aparece en negrilla en esta tabla.


5.1.     Ilustración del método de covariable sujeto a
         restricción

   Con la información de la Tabla 2 se ilustra el método presentado en la
sección 4, a partir de la cual se llega a la imputación del conjunto de datos que
aparecen en negrilla.
    Para obtener estas estimaciones, se trabaja con el modelo de covariable bajo
restricción, presentado en (29). Se construye la matriz de incidencia W de orden

48 × 24, que luego se particiona en dos submatrices W1 de orden 42 × 24 y W2
de orden 6 × 24, que identifican, por celda, el número de datos observados y el
número de datos faltantes, respectivamente. Luego, se particiona como sigue:

Estas cuatro submatrices corresponden a la partición de la matriz de restric-
ciones, G. Las matrices W21 y W22 son de orden 6 × 7 y 6 × 17 respectivamente.
Con las submatrices W11 y W12 se obtiene la matriz V1 = W11 − W12 G−1  2 G1 de
orden 42 × 7; similarmente se obtiene V2 = W21 − W22 G−1 2 G 1 de orden  6 × 7:

Con V1 y V2 se construye la matriz V =          , de orden 48 × 7, a partir de
                                            V2
la cual se obtiene el proyector ortogonal PV = V (V 0 V )−1 V 0 de orden 48 × 48;
además,

como esta matriz es no singular, el diseño es conectado.
                                                                              Ã           !
                                                                                  S   M
   Con el proyector ortogonal se obtiene la matriz I − PV =                               , con
                                                              M0 L
S, M y L, matrices de orden 42 × 42, 42 × 6 y 6 × 6 respectivamente.

     Especificamente,                                       ¢
El vector de datos observados es: y10 = 74, 78, 79, 82, 89, 102, 98, · · · , 122 ,
de tamaño 1 × 42.
    Utilizando (37), se construye el vector de estimaciones de los datos faltantes
                           b0 = (88,6; 92,8; 120,1; 73,1; 78,1; 110,35). El valor
en las celdas de interés: γ
real para los datos de estas celdas está dado por los resultados en negrilla de la
Tabla 2. Como puede verse, las estimaciones obtenidas por el método propuesto
son cercanas a los valores reales, aunque algunos datos son subestimados y otros
sobreestimados.



5.2.     Ilustración del método de mı́nimos cuadrados con
         restricción

   La matriz de incidencia, W , coincide con la que se obtuvo para el mode-
lo de covariables con restricción y, como en 5.1, se particiona en las cuatro
submatrices ya mencionadas.
   Se construyen dos modelos a partir de las matrices V1 y V2 obtenidas en
(18) y (20). Se estima inicialmente el vector de medias de celdas µ1 encontrado
en (19); para esto se calcula

     Con esta matriz y aplicando (19), se encuentra que
                      ³                                 ´
                b01 = 134 92 102 100 105 110 124 .
                µ

Por (21), la estimación de la información faltante del vector yb2 es:
                              ³                                         ´
                   b1 ; yb20 = 88,6 92,8 120,1 73,1 78,1 110,35 .
          yb2 = V2 µ

Este resultado coincide, como se demostró teóricamente, con el obtenido me-
diante el método de estimación presentado en la sección 5.1.


6.     Conclusiones
    Se presentaron dos nuevos métodos para imputar información faltante a
partir del modelo de medias de celdas, sujetos a la restricción de no interacción
entre los efectos. Además, se mostró que los dos métodos son equivalentes, pues
los dos dan como resultado el mismo estimador.
    Los métodos propuestos, además de estimar las celdas vacı́as, permiten
estimar los datos individuales en las celdas, asi como corregir la diferentes
sumas de cuadrados del análisis de varianza.
    Como otro resultado importante, se detemina el número de celdas vacı́as
que deben ser estimadas para conectar el diseño, y una vez determinado, se sa-
be cuáles son las celdas que deben ser estimadas. Esto resuelve el problema de
la desconectés en el diseño y por lo tanto, todos los contrastes de efectos princi-
pales resultan estimables, lo cual facilita la prueba de las hipótesis linealmente
independientes que se generen.
Agradecimientos
Este trabajo tuvo el apoyo económico de la División de Investigación de la Universidad Nacional de Colombia, Sede Bogotá, a través del proyecto Metodología estadı́stica en análisis de datos longitudinales y medidas repetidas.
Bibliografía
Birkes, D., Dodge, Y. & Seely, J. (1976), ‘Spanning sets for estimable contrasts in classification models’, Ann. Statist 4, 86–107.
Bose, R. C. & Srivastava, J.Ñ. (1964), ‘Mathematical theory of factorial designs: I analysis, II construction’, Bull Int Stat Inst pp. 780–794.
Dodge, Y. (1985), Analysis of Experiments with Missing Data, John Wiley & Sons.
Graybill, F. A. (1961), An Introduction to Linear Statistical Models, Vol. I, McGraw-Hill.
Graybill, F. A. (1976), Theory and Application of the Linear Model, North Scituate.
Hocking, R. R. (1985), The Analysis of Linear Models, Brooks/Cole.
Hocking, R. R. (1996), Methods and Application of Linear Models, John Wiley & Sons.
López, L. A. (1999), ‘Los modelos de medias de celdas, una herramienta fundamental en la estadı́stica industrial’, Simposio de Estadı́stica .
Melo, O. O. & Lozano, A. R. (1998), ‘Funciones estimables en modelos de clasificación con datos desbalanceados a través del algoritmo de Cholesky’. Trabajo de grado.
Melo, O. O., Lozano, A. R. & López, L. A. (1999), ‘Funciones estimables en modelos de clasificación con datos desbalanceados a través del algoritmo de Cholesky’, Revista Multiciencia 3(2), 131–147.
Melo, S. E. (2000), ‘Comparación de métodos de conectés en modelos a n vías de clasificación sin interacción’. Trabajo de grado.
Murray, L. W. (1986), ‘Estimation of missing cells in randomized block and latin square designs’, The American Statistical Association 40(4), 289–293.
Murray, L. W. & Smith, D. W. (1985), ‘Estimability, testability and connectedness in the cell mean model’, Communications in Statistic, Part A-Theory and Methods 14, 1889–1915.
Myers, R. H. & Montgomery, D. C. (1995), Response Surface Methodology :Process and Product Optimization Using Designed Experiments, John Wiley & Sons.
Rao, C. R. (1945), ‘On the linear combination of observations and the general theory of least squares’, Sankhyâ 7, 237–256.
Rao, C. R. & Mitra, S. R. (1971), Generalized Inverse of Matrices and its Applications, John Wiley & Sons.
Searle, S. (1987), Linear Models for Unbalanced Data, John Wiley & Sons.
Searle, S. R. (1971), Linear Models, John Wiley & Sons.
Speed, F. M., Hocking, R. R. & Hackney, O. P. (1978), ‘Methods of analysis of linear models with unbalanced data’, Journal of the American Statistical Association 73, 105–112.
Weeks, D. L. & Williams, D. R. (1964), ‘A note on the determination of connectedness in a n-way cross classification’, Technometrics 6(3), 319–324.